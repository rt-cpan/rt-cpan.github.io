<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #95809 for Inline: [PATCH] Using Inline in a distribution with multiple modules</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #95809 for Inline: [PATCH] Using Inline in a distribution with multiple modules</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Inline/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Inline/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Inline/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Inline/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/ingydotnet/inline-pm/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Inline">Inline CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">95809</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Inline/Active/">Inline</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
slam [...] parasite.cc

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-16878-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-16879-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




Foo-2.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1367644/726100/Foo-2.tar.gz">
Sat May 24 08:57:51 2014 (1009b) by sisyphus1 [...] optusnet.com.au
</a>
</font></li>
</ul>


Foo-3.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1367644/726101/Foo-3.tar.gz">
Sat May 24 08:57:51 2014 (1k) by sisyphus1 [...] optusnet.com.au
</a>
</font></li>
</ul>


Foo-fixed.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1368665/726610/Foo-fixed.tar.gz">
Mon May 26 20:17:10 2014 (964b) by sisyphus1 [...] optusnet.com.au
</a>
</font></li>
</ul>


Foo.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1368172/726353/Foo.tar.gz">
Sun May 25 15:49:48 2014 (1k) by slam [...] parasite.cc
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/1365632/725011/Foo.tar.gz">
Wed May 21 07:40:52 2014 (950b) by sisyphus1 [...] optusnet.com.au
</a>
</font></li>
</ul>


Inline-mjm-shogun-v3.tar.gz<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1375438/730382/Inline-mjm-shogun-v3.tar.gz">
Fri Jun 13 22:01:37 2014 (267.4k) by slam [...] parasite.cc
</a>
</font></li>
</ul>


Inline.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1371748/728351/Inline.pm">
Tue Jun 03 22:37:16 2014 (57.5k) by slam [...] parasite.cc
</a>
</font></li>
</ul>


inline_shotgun.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1370409/727662/inline_shotgun.patch">
Sat May 31 17:58:18 2014 (4k) by slam [...] parasite.cc
</a>
</font></li>
</ul>


MakeMaker.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1375145/730215/MakeMaker.pm">
Fri Jun 13 06:29:43 2014 (3.3k) by sisyphus [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;20&nbsp;18:43:06&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 20 May 2014 17:42:54 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m working on a distribution which has multiple modules using Inline.  Something like the following

Foo
Foo::Bar - uses Inline
Foo::Bar::Baz - uses Inline


I couldn&#39;t figure out how to make Inline::MakeMaker work in this scenario, so I&#39;ve patched it to do what I think is correct.  The only problem I have now is that it fails if I do a make -j n where n &gt; 1, but I think that&#39;s a different problem so I thought I&#39;d submit this patch first.

With this patch Inline::MakeMaker will work as it does now &#40;with a slight change behind the scenes&#41;.  I&#39;ve added a parameter that is passed to Inline::MakeMaker in its argument hash, %args, &#39;INLINE_MODULES&#39; which is a reference to an array of modules that use Inline and should be included in the generated Makefile.


diff -r 8a9bc8d83cc9 -r e52ea446fd77 Inline.pm
--- a/Inline.pm Thu May 15 07:03:36 2014 -0500
+++ b/Inline.pm Thu May 15 07:14:25 2014 -0500
@@ -515,12 +515,12 @@ sub load {
     my $o = shift;
 
     if &#40;$o-&gt;{CONFIG}{_INSTALL_}&#41; {
-       my $inline = &#34;$o-&gt;{API}{modfname}.inl&#34;;
+       my $inline = $o-&gt;{API}{modinlname};
        open INLINE, &#34;&gt; $inline&#34;
          or croak M24_open_for_output_failed&#40;$inline&#41;;
        print INLINE &#34;*** AUTOGENERATED by Inline.pm ***\n\n&#34;;
        print INLINE &#34;This file satisfies the make dependency for &#34;;
-       print INLINE &#34;$o-&gt;{API}{modfname}.pm\n&#34;;
+       print INLINE &#34;$o-&gt;{API}{module}\n&#34;;
        close INLINE;
        return;
     }
@@ -983,6 +983,7 @@ sub install {
     my @modparts = split&#40;/::/,$o-&gt;{API}{module}&#41;;
     $o-&gt;{API}{modfname} = $modparts[-1];
     $o-&gt;{API}{modpname} = File::Spec-&gt;catdir&#40;@modparts&#41;;
+    $o-&gt;{API}{modinlname} = join&#40;&#39;-&#39;,@modparts&#41;.&#39;.inl&#39;;
     $o-&gt;{API}{suffix} = $o-&gt;{INLINE}{ILSM_suffix};
     $o-&gt;{API}{build_dir} = File::Spec-&gt;catdir&#40;$o-&gt;{INLINE}{DIRECTORY},&#39;build&#39;,
                                               $o-&gt;{API}{modpname}&#41;;
diff -r 8a9bc8d83cc9 -r e52ea446fd77 lib/Inline/MakeMaker.pm
--- a/lib/Inline/MakeMaker.pm   Thu May 15 07:03:36 2014 -0500
+++ b/lib/Inline/MakeMaker.pm   Thu May 15 07:14:25 2014 -0500
@@ -23,8 +23,24 @@ sub WriteMakefile {
     my %args = @_;
     my $name = $args{NAME}
       or croak &#34;Inline::MakeMaker::WriteMakefile requires the NAME parameter\n&#34;;
-    my $object = &#40;split&#40;/::/, $name&#41;&#41;[-1];
     my $version = &#39;&#39;;
+    my @objects;
+
+    if &#40;defined $args{INLINE_MODULES}&#41; {
+        croak &lt;&lt;END unless ref&#40;$args{INLINE_MODULES}&#41; eq &#39;ARRAY&#39;;
+Inline::MakeMaker::WriteMakefile: INLINE_MODULES must be a reference to an 
+array of modules
+END
+        @objects = @{$args{INLINE_MODULES}};
+
+        # Don&#39;t pass this on to ExtUtils::MakeMaker, it will complain
+        delete $args{INLINE_MODULES} if defined $args{INLINE_MODULES};
+    } else {
+        @objects = $name;
+    }
+
+       my @obj_rules;
+    map { s/::/-/g; s/$/.inl/ } &#40;@obj_rules = @objects&#41;;
 
     croak &lt;&lt;END unless &#40;defined $args{VERSION} or defined $args{VERSION_FROM}&#41;;
 Inline::MakeMaker::WriteMakefile requires either the VERSION or VERSION_FROM
@@ -43,7 +59,7 @@ Must be of the form &#39;#.##&#39;. &#40;For instanc
 END
 
     # Provide a convenience rule to clean up Inline&#39;s messes
-    $args{clean} = { FILES =&gt; &#34;_Inline $object.inl&#34; }
+    $args{clean} = { FILES =&gt; &#34;_Inline &#34;.join&#40;&#39; &#39;, @obj_rules&#41; }
     unless defined $args{clean};
     # Add Inline to the dependencies
     $args{PREREQ_PM}{Inline} = &#39;0.44&#39; unless defined $args{PREREQ_PM}{Inline};
@@ -58,10 +74,17 @@ END
 
 # --- MakeMaker inline section:
 
-$object.inl : \$&#40;TO_INST_PM&#41;
-       \$&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -M$name -e1 $version \$&#40;INST_ARCHLIB&#41;
+MAKEFILE
+    for &#40;0..$#objects&#41; {
+        print MAKEFILE &lt;&lt;MAKEFILE;
+$obj_rules[$_]: \$&#40;TO_INST_PM&#41;
+       \$&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -M$objects[$_] -e1 $version \$&#40;INST_ARCHLIB&#41;
+MAKEFILE
+    }
 
-pure_all :: $object.inl
+print MAKEFILE &#34;\npure_all :: &#34;,join&#40;&#39; &#39;,@obj_rules&#41;,&#34;\n&#34;;
+
+print MAKEFILE &lt;&lt;MAKEFILE;
 
 # The End is here.
 MAKEFILE
diff -r e52ea446fd77 -r 8afe37491d63 Inline.pod
--- a/Inline.pod        Thu May 15 07:14:25 2014 -0500
+++ b/Inline.pod        Tue May 20 17:36:39 2014 -0500
@@ -921,6 +921,16 @@ to
 
     use Inline::MakeMaker;
 
+If you have multiple modules in your distribution that use Inline, you
+can make Inline::MakeMaker aware of them by adding an C&lt;INLINE_MODULES&gt;
+parameter to the arguments you pass to Inline::MakeMaker.  This parameter
+must be a reference to an array of module names.  For example:
+    
+    INLINE_MODULES =&gt; [qw&#40; Foo::Bar Foo::Bar::Baz &#41;],
+
+By doing this Inline::MakeMaker will make sure these get built and installed
+properly.
+
 And, in order that the module build work correctly in the cpan shell,
 add the following directive to the Makefile.PL&#39;s WriteMakefile&#40;&#41;:
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;21&nbsp;07:40:52&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 21 May 2014 21:39:54 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; I&#39;m working on a distribution which has multiple modules using Inline. 
&gt; Something like the following
&gt;
&gt; Foo
&gt; Foo::Bar - uses Inline
&gt;Foo::Bar::Baz - uses Inline
&gt;
&gt; I couldn&#39;t figure out how to make Inline::MakeMaker work in this scenario, 
&gt; so I&#39;ve patched it to do what I think is correct.
</div>
Hi Jason,

To achieve a better understanding of the issue, I created a distro 
&#40;attached&#41; that matches the description provided.
That is, it&#39;s a distro named &#39;Foo&#39; that contains a Foo.pm &#40;pure perl&#41;, a 
Foo/Bar/Bar.pm &#40;which uses Inline&#41; and a Foo/Bar/Baz/Baz.pm &#40;which uses 
Inline&#41; .... along with a MANIFEST, test scripts, and Makefiles.PL.

It builds and tests fine for me .... what modifications need to be made to 
it in order that the Inline::MakeMaker problems alluded to above become 
evident ?

Cheers,
Rob 
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1365632/725011/Foo.tar.gz">Download Foo.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 950b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;21&nbsp;07:40:53&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;24&nbsp;08:57:51&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 24 May 2014 22:56:52 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From: sisyphus1@optusnet.com.au via RT

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; To achieve a better understanding of the issue, I created a distro 
&gt; &#40;attached&#41; that matches the description provided.
</div>
In the absence of any further feedback, I then altered the Foo distro so 
that:

Foo uses Inline
Foo loads Foo::Bar &#40;which uses Inline&#41;
Foo also loads Foo::Bar::Baz &#40;which uses Inline&#41;

This distro &#40;attached as Foo-2.tar.gz&#41; also builds and tests fine for me.

I then changed it slightly so that:

Foo uses Inline
Foo loads Foo::Bar &#40;which uses Inline&#41;
Foo::Bar uses Foo::Bar::Baz &#40;which uses Inline&#41;

This distro &#40;attached as Foo-3.tar.gz&#41; also builds and tests fine for me.

I don&#39;t doubt that the patches provided by the OP fix *something*. But I&#39;m 
certainly not going to apply them until someone enlightens me as to exactly 
what it is that those patches fix.

Cheers,
Rob 
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1367644/726100/Foo-2.tar.gz">Download Foo-2.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 1009b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1367644/726101/Foo-3.tar.gz">Download Foo-3.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 1k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;24&nbsp;20:21:07&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 24 May 2014 19:20:55 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Rob,

I must apologize ... I am working on a response but I just haven&#39;t had/made the time.  I hope to rectify that soon!

Thanks,
Jason

On Sat, 24 May 2014 08:57:52 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; From: sisyphus1@optusnet.com.au via RT
&gt; 
<div class="message-stanza open">&gt; &gt; To achieve a better understanding of the issue, I created a distro 
&gt; &gt; &#40;attached&#41; that matches the description provided.
</div>&gt; 
&gt; In the absence of any further feedback, I then altered the Foo distro so 
&gt; that:
&gt; 
&gt; Foo uses Inline
&gt; Foo loads Foo::Bar &#40;which uses Inline&#41;
&gt; Foo also loads Foo::Bar::Baz &#40;which uses Inline&#41;
&gt; 
&gt; This distro &#40;attached as Foo-2.tar.gz&#41; also builds and tests fine for me.
&gt; 
&gt; I then changed it slightly so that:
&gt; 
&gt; Foo uses Inline
&gt; Foo loads Foo::Bar &#40;which uses Inline&#41;
&gt; Foo::Bar uses Foo::Bar::Baz &#40;which uses Inline&#41;
&gt; 
&gt; This distro &#40;attached as Foo-3.tar.gz&#41; also builds and tests fine for me.
&gt; 
&gt; I don&#39;t doubt that the patches provided by the OP fix *something*. But I&#39;m 
&gt; certainly not going to apply them until someone enlightens me as to exactly 
&gt; what it is that those patches fix.
&gt; 
&gt; Cheers,
&gt; Rob 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;25&nbsp;15:49:48&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 25 May 2014 14:49:38 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Rob,

I&#39;ve attached Foo.tar.gz which has an example of how to use Inline::MakeMaker with the new patch.

I noticed that in your Foo.tar.gz that you originally built each module had its own Makefile.PL, like each was its own distribution.  For what I&#39;m working on I have a single distribution containing multiple modules that use Inline.  I have changed the structure of my attached Foo distribution to mimic this.  There is just one top level Makefile.PL and still the Foo::Bar and Foo::Bar::Baz modules using Inline.

What I wanted &#40;and I originally thought Inline::MakeMaker would do&#41; is to compile all modules in the distribution that use Inline during the course of &#39;perl Makefile.PL; make&#39;.  Then when &#39;make install&#39; was run that the compiled code would be installed along side the rest of the distribution.  From what I could tell this only works for a single module, the one named in the Makefile.PL.

My patch addresses this by generating rules to compile all modules in the &#39;INLINE_MODULES&#39; argument to Inline::MakeMaker.

Hopefully this makes sense and that my attachment will help clear up what I&#39;m thinking.  Then again, maybe I&#39;m completely off base here as this was my first encounter with Inline and I may be missing something obvious!

Thanks for your time &#40;and patience&#41;,
Jason
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1368172/726353/Foo.tar.gz">Download Foo.tar.gz</a><br />
<span class="downloadcontenttype">application/gzip 1k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;26&nbsp;06:03:09&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 May 2014 20:02:20 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; I noticed that in your Foo.tar.gz that you originally built each module
&gt; had its own Makefile.PL, like each was its own distribution.  For what I&#39;m
&gt; working on I have a single distribution containing multiple modules that
&gt; use Inline.  I have changed the structure of my attached Foo distribution
&gt; to mimic this.
</div>
AFAIK, both structures should give the same end result.
Turns out that while the structure I was using successfully builds and
installs, it doesn&#39;t actually install the compiled libraries  - so it&#39;s
inadequate on that score. &#40;This also should be fixed.&#41;

Although I prefer to avoid the layout you&#39;re wanting to use, it&#39;s certainly
used by plenty of &#40;ie most&#41; source distros on CPAN.
It&#39;s therefore valid - and ought to be better accommodated.
Better still if we can fix things so that it &#34;simply works&#34; without any need 
for additional config options.

In fact I&#39;m hoping we can fix it without any need for additional
documentation, too - but that remains to be seen. In the meantime we have
your patches, to which I&#39;ll gladly resort if I don&#39;t come up with anything 
better.

Thanks for raising this, and for the patches !!

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;26&nbsp;08:20:03&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 May 2014 22:19:26 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: sisyphus1@optusnet.com.au via RT

<div class="message-stanza open">&gt; Turns out that while the structure I was using successfully builds and
&gt; installs, it doesn&#39;t actually install the compiled libraries  - so it&#39;s
&gt; inadequate on that score. &#40;This also should be fixed.&#41;
</div>
My mistake. Nothing to be fixed wrt that structure - it works perfectly so 
long as you set it up correctly &#40;ie as per modules/Math::Simple demo in the 
Inline source&#41;.
Attached Foo-4.tar.gz builds, tests, and installs fine - and there&#39;s no 
compilation to be done after &#39;make install&#39; has been run.
Points to watch:
1&#41; that the Makefiles.PL use Inline::MakeMaker &#40;not ExtUtils::MakeMaker&#41;;
2&#41; that the pm files contain the correct &#39;NAME&#39; and &#39;VERSION&#39; Config 
options;
3&#41; that the version number is of the form of x.xx.

Can now move on to the actual issue that is the subject of this bug report.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;26&nbsp;08:26:50&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 May 2014 07:26:40 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 26 May 2014 06:03:10 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Better still if we can fix things so that it &#34;simply works&#34; without any need 
&gt; for additional config options.
</div>
I agree that it would be much better without the additional config
options.  I may try to look at that too, although I&#39;m new to working
on MakeMaker so I&#39;m not exactly sure how one would go about making this
work.  I&#39;m more than happy to try to help if I&#39;m not getting in the
way.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In fact I&#39;m hoping we can fix it without any need for additional
&gt; documentation, too - but that remains to be seen. In the meantime we have
&gt; your patches, to which I&#39;ll gladly resort if I don&#39;t come up with anything 
&gt; better.
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks for raising this, and for the patches !!
</div>
I also agree that not having to add any documentation would be ideal.

Thank you for being receptive!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Although I prefer to avoid the layout you&#39;re wanting to use, it&#39;s certainly
&gt; used by plenty of &#40;ie most&#41; source distros on CPAN.
</div>
So just out of curiosity &#40;and this may not be the proper forum&#41; why do
you prefer your layout?  I&#39;m pretty new to module authoring so I&#39;m
always open to inpu.

Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;26&nbsp;09:56:36&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 26 May 2014 08:56:25 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 26 May 2014 08:20:04 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; -----Original Message----- 
&gt; From: sisyphus1@optusnet.com.au via RT
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attached Foo-4.tar.gz builds, tests, and installs fine - and there&#39;s no 
&gt; compilation to be done after &#39;make install&#39; has been run.
</div>
I don&#39;t see the Foo-4.tar.gz attachement?  Neither in my email or via
the web.


Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;26&nbsp;20:17:10&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 May 2014 10:16:08 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; I don&#39;t see the Foo-4.tar.gz attachement?  Neither in my email or via the 
&gt; web.
</div>
Don&#39;t worry - you&#39;re not going blind. &#40;I&#39;m just going mad ;-&#41;

I&#39;ve now attached it as Foo-fixed.tar.gz.
It&#39;s essentially the Foo distro that you sent, except that the layout has 
been changed to the one that I would normally use.
I&#39;ve also had to alter the top level Makefile.PL and, of course, insert the 
2 extra Makefiles.PL.
I don&#39;t think I made any other changes.

It should build, test, and install successfully - and install as per your 
expectations.

Incidentally, it only takes for Foo.pm to &#34;use Foo::Bar;&#34; and &#34;use 
Foo::Bar::Baz;&#34; and the version *you* sent would also build and install as 
desired. &#40;Though in that case, every time I run &#39;dmake&#39;, &#39;dmake test&#39; and 
&#39;dmake install&#39; the C code recompiles - but it results in a correct install 
in the end.&#41;
It&#39;s the fact that Foo.pm neither uses Inline, nor uses both of the other 
modules, that&#39;s providing the stumbling block. &#40;Or does Foo.pm still need to 
load the other 2 modules even if it uses Inline ? ... not sure now; I&#39;d need 
to check on that.&#41;

The distro you sent is tantalisingly close to working .... just can&#39;t quite 
nail it, and don&#39;t yet know whether that&#39;s because I&#39;m not being smart 
enough or because it is simply un-nailable without using your patch &#40;or 
something similar&#41;.

I&#39;ll look again tonight.

Cheers,
Rob 
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1368665/726610/Foo-fixed.tar.gz">Download Foo-fixed.tar.gz</a><br />
<span class="downloadcontenttype">application/x-gzip 964b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;26&nbsp;20:35:23&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 May 2014 10:34:37 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; So just out of curiosity &#40;and this may not be the proper forum&#41; why do you 
&gt; prefer your layout?
</div>
That&#39;s the layout I&#39;ve always used, and it has never given me any trouble. 
&#40;That&#39;s pretty much the full extent of my reasoning ;-&#41;
I also think the additional Makefiles.PL can only provide additional 
flexibility, as we&#39;re seeing here.

According to my &#40;admittedly unreliable&#41; memory, the layout I use dates back 
a long way, whereas the layout you&#39;re using is relatively recent.
I don&#39;t know why the &#34;newer&#34; layout became popular - I&#39;ll have to find out. 
Perhaps then things might be a little clearer.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;27&nbsp;10:16:00&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 27 May 2014 09:15:45 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 26 May 2014 20:17:11 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; -----Original Message----- 
&gt; From: Jason McCarver via RT
</div> 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Incidentally, it only takes for Foo.pm to &#34;use Foo::Bar;&#34; and &#34;use 
&gt; Foo::Bar::Baz;&#34; and the version *you* sent would also build and install as 
&gt; desired. &#40;Though in that case, every time I run &#39;dmake&#39;, &#39;dmake test&#39; and 
&gt; &#39;dmake install&#39; the C code recompiles - but it results in a correct install 
&gt; in the end.&#41;
</div>
Yes that makes sense since the XS gets built/compiled when the module
is initially &#39;use&#39;ed.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The distro you sent is tantalisingly close to working ....
</div>
Please forgive the following rambling .. it&#39;s more of a stream of
conscience and less than fully thought out :&#41;

I think the underlying problem here is how does Inline::MakeMaker know
which modules need to be &#39;use&#39;ed as part of the make process.  The way
it works without the patch is by relying on the fact that
Inline::MakeMaker is being used in place of ExtUtils::MakeMaker.  

I believe I::MM currently makes the following assumptions:
 - There is one perl module per Makefile.PL &#40;the layout you prefer I
   believe&#41;
 - That module needs to be &#39;use&#39;ed during &#39;make&#39;

For your layout these assumptions are fine.  This basically means that
the programmer is explicitly telling I::MM which modules to process by
using I::MM instead of ExtUtils::MakeMaker

But for the layout I&#39;m using that doesn&#39;t work so then it&#39;s back to how
does I::MM know which modules need to be &#39;use&#39;ed.  My attempt at a
solution was to force the programmer to explicitly tell I::MM by way of
the INLINE_MODULES argument.  I do agree it would be better to not have
to do that.  However I believe that would mean one of the following
would need to be done:
 - shotgun approach and &#39;use&#39; all modules in the distribution &#40;seems
   ugly, possibly error-prone&#41;
 - scan all modules somehow to find the ones that are using &#39;Inline&#39;
   and just &#39;use&#39; them during the &#39;make&#39; process.  Also error-prone.

It seems like the second of those might be doable but I&#39;m not sure how
ugly that would be :&#41;

And of course I could be way off here, still trying to learn as I go
with Inline.


Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;28&nbsp;05:55:22&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 28 May 2014 19:54:25 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; .......... so then it&#39;s back to how does I::MM know which modules need to 
&gt; be &#39;use&#39;ed. My attempt at a
&gt; solution was to force the programmer to explicitly tell I::MM by way of
&gt; the INLINE_MODULES argument.  I do agree it would be better to not have
&gt; to do that.  However I believe that would mean one of the following
&gt; would need to be done:
&gt;  - shotgun approach and &#39;use&#39; all modules in the distribution &#40;seems ugly, 
&gt; possibly error-prone&#41;
</div>
When I build the Foo.tar.gz source that you provided against Inline-0.55 
&#40;having first removed the &#34;INLINE_MODULES =&gt; [qw&#40;Foo::Bar Foo::Bar::Baz&#41;],&#34; 
entry in the Makefile.PL&#41;, at the make stage the following commands get run:

###########################
C:\_32\pscrpt\Foo-broken&gt;dmake
cp lib/Foo/Bar/Baz.pm blib\lib\Foo\Bar\Baz.pm
cp lib/Foo.pm blib\lib\Foo.pm
cp lib/Foo/Bar.pm blib\lib\Foo\Bar.pm
C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_ -MFoo -e1 2.01 
blib\arch
###########################

The commands we really want to be run there are:

###########################
C:\_32\pscrpt\Foo-broken&gt;dmake
cp lib/Foo/Bar/Baz.pm blib\lib\Foo\Bar\Baz.pm
cp lib/Foo.pm blib\lib\Foo.pm
cp lib/Foo/Bar.pm blib\lib\Foo\Bar.pm
C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_ -MFoo -e1 2.01 
blib\arch
C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_ -MFoo::Bar -e1 
2.01 blib\arch
C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_ -MFoo::Bar::Baz 
 -e1 2.01 blib\arch
###########################

In fact, the 
&#34;C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_ -MFoo -e1 
2.01 blib\arch&#34; command is not needed - but it doesn&#39;t do any harm. &#40;Foo.pm 
does not use Inline, not does it use a module that uses Inline, so nothing 
gets installed as a result of running that command.&#41;

Therefore, instead of the generated Makefile terminating with the following 
&#40;generated by Inline::MakeMaker&#41;:

###########################
# Well, not quite. Inline::MakeMaker is adding this:

# --- MakeMaker inline section:

Foo.inl : $&#40;TO_INST_PM&#41;
    $&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -MFoo -e1 2.01 $&#40;INST_ARCHLIB&#41;

pure_all :: Foo.inl

# The End is here.
###########################

we want it to terminate with:

###########################
# Well, not quite. Inline::MakeMaker is adding this:

# --- MakeMaker inline section:

Foo.inl : $&#40;TO_INST_PM&#41;
    $&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -MFoo -e1 2.01 $&#40;INST_ARCHLIB&#41;

pure_all :: Foo.inl

Bar.inl : $&#40;TO_INST_PM&#41;
    $&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -MFoo::Bar -e1 2.01 
$&#40;INST_ARCHLIB&#41;

pure_all :: Bar.inl

Baz.inl : $&#40;TO_INST_PM&#41;
    $&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -MFoo::Bar::Baz -e1 2.01 
$&#40;INST_ARCHLIB&#41;

pure_all :: Baz.inl

# The End is here.
###########################

And I think it would be straightforward to get Inline::MakeMaker to do this.
I::MM simply has to recurse through the ./lib folder and create the relevant 
entry in the Makefile for every pm file it finds &#40;irrespective of whether 
that pm file actually uses Inline&#41;.

I think this corresponds to your &#34;shotgun&#34; approach.
I don&#39;t think it&#39;s ugly. For sure it&#39;s an unnecessary step for the modules 
that don&#39;t use Inline but &#40;for those modules&#41; it  does no harm other than to 
consume a fraction of a second during the make stage.

It becomes &#40;possibly&#41; error prone when someone wants to bundle something 
like:

Foo
Foo::Bar
Foo::lib::Bar


but I&#39;d quite happily wait to cross that bridge if and when we come to it.

OTOH, it would require no new config options and no change to any 
documentation. All we need to do is to have I::MM loop recursively through 
the ./lib directory &#40;if such a directory exists&#41;.
What do you think ?

I&#39;ll probably be without an internet connection from Thursday night until 
Monday night, but I&#39;ll take my laptop with me and test out a proof of 
concept regarding this proposal over that period.

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;31&nbsp;17:58:18&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 31 May 2014 16:58:07 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 28 May 2014 05:55:23 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; And I think it would be straightforward to get Inline::MakeMaker to do this.
&gt; I::MM simply has to recurse through the ./lib folder and create the relevant 
&gt; entry in the Makefile for every pm file it finds &#40;irrespective of whether 
&gt; that pm file actually uses Inline&#41;.
&gt; 
&gt; I think this corresponds to your &#34;shotgun&#34; approach.
&gt; I don&#39;t think it&#39;s ugly. For sure it&#39;s an unnecessary step for the modules 
&gt; that don&#39;t use Inline but &#40;for those modules&#41; it  does no harm other than to 
&gt; consume a fraction of a second during the make stage.
</div>
Ok, so you talked me into the &#34;shotgun&#34; approach :&#41;  After digging a
bit I found that ExtUtils::MakeMaker was already locating all modules
to be installed and placing that list in $mm-&gt;{PM} &#40;where $mm is the
returned object from the call to ExtUtils::MakeMaker::WriteMakefile&#41;.

There is another attribute, $mm-&gt;{PMLIBDIRS} that contains a list of
directories those modules reside in.  I added some code to use those
two lists to generate the rules to add to the makefile without having
to scan for modules ourselves.

Let me know what you think.  It worked for my single-Makefile.PL
distribution and for your Foo-fixed distribution.

This method requires no additional config options nor documentation.

Thanks,
Jason
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;02&nbsp;08:35:54&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Jun 2014 22:35:07 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt;  After digging a bit I found that ExtUtils::MakeMaker was already locating 
&gt; all modules to be installed and placing that list in $mm-&gt;{PM} &#40;where $mm 
&gt; is the returned object from the call to 
&gt; ExtUtils::MakeMaker::WriteMakefile&#41;.
</div>
I didn&#39;t know that. &#40;You already know more about Inline than I do.&#41;

<div class="message-stanza open">&gt; There is another attribute, $mm-&gt;{PMLIBDIRS} that contains a list of 
&gt; directories those modules reside in.  I added some code to use those two 
&gt; lists to generate the rules to add to the makefile without having to scan 
&gt; for modules ourselves.
</div>
Didn&#39;t know that, either.
Yours is therefore probably a smarter solution than the one I envisaged. 
Mine is a solution that hacks &#40;solely&#41; I::MM to recurse thru the &#39;lib&#39; 
directory and locate all of the *.pm files &#40;using File::Find&#41;.

However, with your patch, for the distro you provided, I&#39;m getting:

##############################
C:\_32\pscrpt\Foo-broken&gt;perl Makefile.PL
Checking if your kit is complete...
Looks good
Writing Makefile for Foo
Writing MYMETA.yml and MYMETA.json

C:\_32\pscrpt\Foo-broken&gt;dmake
cp lib/Foo/Bar/Baz.pm blib\lib\Foo\Bar\Baz.pm
cp lib/Foo.pm blib\lib\Foo.pm
cp lib/Foo/Bar.pm blib\lib\Foo\Bar.pm
C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_ -MFoo::Bar::Baz 
 -e1 2.01 blib\arch
validate Stage
Starting Build Preprocess Stage
get_maps Stage
Finished Build Preprocess Stage

Starting Build Parse Stage
Finished Build Parse Stage

Starting Build Glue 1 Stage
Finished Build Glue 1 Stage

Starting Build Glue 2 Stage
Finished Build Glue 2 Stage

Starting Build Glue 3 Stage
Finished Build Glue 3 Stage

Starting Build Compile Stage
  Starting &#34;perl Makefile.PL&#34; Stage
  Finished &#34;perl Makefile.PL&#34; Stage

  Starting &#34;make&#34; Stage
  Finished &#34;make&#34; Stage

  Starting &#34;make install&#34; Stage
  Finished &#34;make install&#34; Stage

  Starting Cleaning Up Stage
  Finished Cleaning Up Stage

Finished Build Compile Stage

Can&#39;t open  for output.


at C:\_32\pscrpt\Foo-broken\blib\lib/Foo/Bar/Baz.pm line 9.
BEGIN failed--compilation aborted at 
C:\_32\pscrpt\Foo-broken\blib\lib/Foo/Bar/Baz.pm line 15.
Compilation failed in require.
BEGIN failed--compilation aborted.
dmake:  Error code 255, while making &#39;Foo-Bar-Baz.inl&#39;

C:\_32\pscrpt\Foo-broken&gt;
##############################

This might just be *my* mistake ... I might have messed something up. &#40;I 
don&#39;t think so but.&#41;
I&#39;ll have to check again tomorrow night.

What version of perl are you running ?

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;02&nbsp;21:18:33&nbsp;2014</span>
    <span class="description">trueability.com [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 2 Jun 2014 20:18:20 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;trueability.com [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 2 Jun 2014 08:35:55 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I didn&#39;t know that. &#40;You already know more about Inline than I do.&#41;
</div>
All I know is just from what I&#39;ve seen while digging around, trying to
get an understanding of how the MakeMaker stuff works :&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; There is another attribute, $mm-&gt;{PMLIBDIRS} that contains a list
&gt; &gt; of directories those modules reside in.  I added some code to use
&gt; &gt; those two lists to generate the rules to add to the makefile
&gt; &gt; without having to scan for modules ourselves.
</div>&gt; 
&gt; Didn&#39;t know that, either.
&gt; Yours is therefore probably a smarter solution than the one I
&gt; envisaged. Mine is a solution that hacks &#40;solely&#41; I::MM to recurse
&gt; thru the &#39;lib&#39; directory and locate all of the *.pm files &#40;using
&gt; File::Find&#41;.
</div>
My hope was that if we could use what EU::MM already located that we
would support the same code as EU:MM.  It appears to me that one can
change the PMLIBDIRS in the Makefile.PL and so assuming &#39;lib&#39; is the
only directory that would contain modules is a bad assumption.
Obviously I&#39;d like to stay away from assumptions where I can!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; However, with your patch, for the distro you provided, I&#39;m getting:
&gt; 
&gt; ##############################
&gt; C:\_32\pscrpt\Foo-broken&gt;perl Makefile.PL
&gt; Checking if your kit is complete...
&gt; Looks good
&gt; Writing Makefile for Foo
&gt; Writing MYMETA.yml and MYMETA.json
&gt; 
&gt; C:\_32\pscrpt\Foo-broken&gt;dmake
&gt; cp lib/Foo/Bar/Baz.pm blib\lib\Foo\Bar\Baz.pm
&gt; cp lib/Foo.pm blib\lib\Foo.pm
&gt; cp lib/Foo/Bar.pm blib\lib\Foo\Bar.pm
&gt; C:\MinGW\Perl516\bin\perl.exe -Mblib -MInline=NOISY,_INSTALL_
&gt; -MFoo::Bar::Baz -e1 2.01 blib\arch
&gt; validate Stage
&gt; Starting Build Preprocess Stage
&gt; get_maps Stage
&gt; Finished Build Preprocess Stage
&gt; 
&gt; Starting Build Parse Stage
&gt; Finished Build Parse Stage
&gt; 
&gt; Starting Build Glue 1 Stage
&gt; Finished Build Glue 1 Stage
&gt; 
&gt; Starting Build Glue 2 Stage
&gt; Finished Build Glue 2 Stage
&gt; 
&gt; Starting Build Glue 3 Stage
&gt; Finished Build Glue 3 Stage
&gt; 
&gt; Starting Build Compile Stage
&gt;   Starting &#34;perl Makefile.PL&#34; Stage
&gt;   Finished &#34;perl Makefile.PL&#34; Stage
&gt; 
&gt;   Starting &#34;make&#34; Stage
&gt;   Finished &#34;make&#34; Stage
&gt; 
&gt;   Starting &#34;make install&#34; Stage
&gt;   Finished &#34;make install&#34; Stage
&gt; 
&gt;   Starting Cleaning Up Stage
&gt;   Finished Cleaning Up Stage
&gt; 
&gt; Finished Build Compile Stage
&gt; 
&gt; Can&#39;t open  for output.
&gt; 
&gt; 
&gt; at C:\_32\pscrpt\Foo-broken\blib\lib/Foo/Bar/Baz.pm line 9.
&gt; BEGIN failed--compilation aborted at 
&gt; C:\_32\pscrpt\Foo-broken\blib\lib/Foo/Bar/Baz.pm line 15.
&gt; Compilation failed in require.
&gt; BEGIN failed--compilation aborted.
&gt; dmake:  Error code 255, while making &#39;Foo-Bar-Baz.inl&#39;
&gt; 
&gt; C:\_32\pscrpt\Foo-broken&gt;
&gt; ##############################
&gt; 
&gt; This might just be *my* mistake ... I might have messed something up.
&gt; &#40;I don&#39;t think so but.&#41;
&gt; I&#39;ll have to check again tomorrow night.
&gt; 
&gt; What version of perl are you running ?
</div>
Hrm that&#39;s strange.. I don&#39;t see that but at this point I have enough
versions of various distributions that I&#39;m not sure if I&#39;m testing
against the same thing you are!  I tried to replicate that error but it
seems to work for me.

I&#39;m running perl 5.18.1 under gentoo linux &#40;custom perl compile, not
using the gentoo package&#41;. You?

So to try to make sure we&#39;re on the same page, I&#39;ve uploaded a couple
things &#40;see below for link&#41;.  I&#39;d like to get the distribution you&#39;re
testing against and maybe the Inline source you&#39;re using that is failing
so I can see if I can make it happen too.

<span class="clickylink"><a target="new" rel="nofollow" href="http://cac.parasite.cc/~slam/Inline">http://cac.parasite.cc/~slam/Inline</a></span>

In that directory you will find a few things:
Foo-fixed.tar.gz - this was one you attached that is working with the patch
Foo-mjm.tar.gz - this &#40;I belive&#41; is the one I initially submitted to you, and it is working with the patch for me
Inline-mjm.tar.gz - this is the source I&#39;m using that I built the patch from.  This is a snapshot of the mercurial repo I&#39;m using
Inline-mjm/ - directory of Inline-mjm.tar.gz extracted

I&#39;ve also made available the mercurial repo I&#39;m using:
<span class="clickylink"><a target="new" rel="nofollow" href="http://cac.parasite.cc:8000">http://cac.parasite.cc:8000</a></span>

it has two branches&#34; 
&#39;default&#39; which is the baseline Inline-0.55 code I started with
&#39;mjm&#39; which is the branch with my changes applied

you can clone the repo via:
hg clone <span class="clickylink"><a target="new" rel="nofollow" href="http://cac.parasite.cc:8000">http://cac.parasite.cc:8000</a></span> Inline

if you do that and wnat to see my code, you&#39;ll need to change to the mjm branch
hg update -C mjm

If you send me what you&#39;re testing with I&#39;ll try it out too and hopefully I can reproduce the error
so I can fix it!

Thanks,
Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;03&nbsp;04:36:36&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Jun 2014 18:28:52 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://cac.parasite.cc/~slam/Inline">http://cac.parasite.cc/~slam/Inline</a></span>
</div>
Kept getting a gateway timeout error.
I&#39;ll install mercurial and check it out that way &#40;when I get a chance&#41;.

For the Foo distro I&#39;m currently using:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.sisyphusion.tk/scratch/Foo-broken.tar.gz">http://www.sisyphusion.tk/scratch/Foo-broken.tar.gz</a></span>

For the Inline version I&#39;m using:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.sisyphusion.tk/scratch/Inline-0.55-patched.tar.gz">http://www.sisyphusion.tk/scratch/Inline-0.55-patched.tar.gz</a></span>

&#40;I believe it&#39;s just Inline-0.55 with your most recent patch applied.&#41;

And with those Foo and Inline versions,  I&#39;m getting the &#34;Can&#39;t open  for 
output.&#34; error mentioned in my previous post.

I&#39;m on MS Windows 7 and my make flavour is &#39;dmake&#39;. I&#39;ve tested on both 
5.16.0 and 5.18.0 - same error.

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;03&nbsp;08:36:25&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Jun 2014 07:36:11 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 3 Jun 2014 04:36:36 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; -----Original Message----- 
&gt; From: Jason McCarver via RT
&gt; 
<div class="message-stanza open">&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://cac.parasite.cc/~slam/Inline">http://cac.parasite.cc/~slam/Inline</a></span>
</div>&gt; 
&gt; Kept getting a gateway timeout error.
&gt; I&#39;ll install mercurial and check it out that way &#40;when I get a
&gt; chance&#41;.
</div>
I had to fix a broken DNS record for that server last night, hopefully
that was the problem and if so it should work soon &#40;2014-06-03 8:00pm
CST, 2014-06-04 1:00am UTC&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; For the Foo distro I&#39;m currently using:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.sisyphusion.tk/scratch/Foo-broken.tar.gz">http://www.sisyphusion.tk/scratch/Foo-broken.tar.gz</a></span>
&gt; 
&gt; For the Inline version I&#39;m using:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.sisyphusion.tk/scratch/Inline-0.55-patched.tar.gz">http://www.sisyphusion.tk/scratch/Inline-0.55-patched.tar.gz</a></span>
&gt; 
&gt; &#40;I believe it&#39;s just Inline-0.55 with your most recent patch applied.&#41;
&gt; 
&gt; And with those Foo and Inline versions,  I&#39;m getting the &#34;Can&#39;t open
&gt; for output.&#34; error mentioned in my previous post.
&gt; 
&gt; I&#39;m on MS Windows 7 and my make flavour is &#39;dmake&#39;. I&#39;ve tested on
&gt; both 5.16.0 and 5.18.0 - same error.
</div>
I&#39;ll give yours a try tonight and see if I can replicate the problem.
I do have a windows 7 machine &#40;I&#39;ve never installed perl on windows
though&#41; so maybe I can try it there too.

Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;03&nbsp;22:37:16&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 3 Jun 2014 21:37:03 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, 3 Jun 2014 04:36:36 -0400
&#34;sisyphus1@optusnet.com.au via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

Ok, I when I run my patched version of Inline against your Foo-broken it works
When I ran your Inline-0.55-patched against your Foo-broken I get the same error you do.

So I diff&#39;d your patched version and mine and there is a difference in Inline.pm:

Here I&#39;m diffing my patched Inline against yours

--- Inline/Inline.pm    2014-05-31 14:51:53.391322710 -0500
+++ Inline-0.55-patched/Inline.pm       2014-06-03 21:29:20.420705471 -0500
@@ -914,6 +914,7 @@
        my @modparts = split /::/, $module2;
        $o-&gt;{API}{modfname} = $modparts[-1];
         $o-&gt;{API}{modpname} = File::Spec-&gt;catdir&#40;@modparts&#41;;
+        $o-&gt;{API}{modinlname} = join&#40;&#39;-&#39;,@modparts&#41;.&#39;.inl&#39;;
        $o-&gt;{API}{build_dir} =
           File::Spec-&gt;catdir&#40;$o-&gt;{INLINE}{DIRECTORY},
                              &#39;build&#39;,$o-&gt;{API}{modpname}&#41;;
@@ -983,7 +984,6 @@
     my @modparts = split&#40;/::/,$o-&gt;{API}{module}&#41;;
     $o-&gt;{API}{modfname} = $modparts[-1];
     $o-&gt;{API}{modpname} = File::Spec-&gt;catdir&#40;@modparts&#41;;
-    $o-&gt;{API}{modinlname} = join&#40;&#39;-&#39;,@modparts&#41;.&#39;.inl&#39;;
     $o-&gt;{API}{suffix} = $o-&gt;{INLINE}{ILSM_suffix};
     $o-&gt;{API}{build_dir} = File::Spec-&gt;catdir&#40;$o-&gt;{INLINE}{DIRECTORY},&#39;build&#39;,
                                               $o-&gt;{API}{modpname}&#41;;


It looks like a line of the patch was applied to the wrong location in Inline.pm.  
I have attached the correct Inline.pm in case you still can&#39;t get to
the links I sent.

Hopefully we&#39;re getting close! :&#41;

Jason
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;04&nbsp;05:11:58&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 4 Jun 2014 19:11:03 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; It looks like a line of the patch was applied to the wrong location in 
&gt; Inline.pm.
</div>
Sorry &#39;bout that.
Fixing it takes care of the problem.

<div class="message-stanza open">&gt; Hopefully we&#39;re getting close! :&#41;
</div>
I think so.

One thing I have noticed is that, for the distro we&#39;re looking at, if the 
Foo module loads &#40;uses&#41; Foo::Bar and Foo::Bar::Baz, then the Foo.inl target 
never gets met. This results in Inline compiling the C code for each of 
&#39;make&#39;, &#39;make test&#39; and &#39;make install&#39;.
Just insert a:

use Foo::Bar;
use Foo::Bar::Baz;

in Foo.pm, and rebuild - you should see what I mean.

Not sure why Foo.inl never appears under that scenario ... haven&#39;t had time 
to even think about it.
It doesn&#39;t matter greatly because &#39;make install&#39; still installs exactly what 
we want it to install - and no future compilation occurs.

Do you want to do anything about that aspect ?
I&#39;m not greatly fussed - if you don&#39;t want to do anything about it, just let 
me know and I&#39;ll push out a new devel release &#40;0.55_01&#41;  that includes the 
patches to Inline.pm and MakeMaker.pm that you&#39;ve already provided. &#40;It can 
always be addressed at a later stage.&#41;
But if you do want to do something about that &#40;and presently have the time&#41; 
then I&#39;ll wait for the additional patch before I release 0.55_01.

Thanks for the work you&#39;ve done !!

Cheers,
Rob
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;05&nbsp;00:00:57&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 04 Jun 2014 23:00:45 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> slam &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think I&#39;d like to look into that problem.  May be over the weekend before I have a chance though.

If you&#39;re wanting to release quickly that&#39;s fine too.

Thank you for being so receptive and offering help!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;05&nbsp;03:55:25&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 5 Jun 2014 17:54:33 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; I think I&#39;d like to look into that problem.  May be over the weekend 
&gt; before I have a chance though.
</div>
I&#39;m in no great hurry, so I&#39;ll wait until we get this sorted.
&#40;Sorry that I&#39;m not being more helpful - I have a rather full schedule 
already for the next couple of weeks.&#41;

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;08&nbsp;09:18:53&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 8 Jun 2014 23:18:07 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Jason McCarver via RT

<div class="message-stanza open">&gt; I think I&#39;d like to look into that problem.  May be over the weekend 
&gt; before I have a chance though.
</div>
I think there&#39;s another hiccup, too.
Using the patched Inline-0.55, the demo module in modules/Math/Simple &#40;in 
Inline-0.55 source&#41; then fails to build as there&#39;s no
&#34;# --- MakeMaker inline section&#34; written into the generated Makefile.

It would be nice if we can get the behaviour we want for the &#34;lib&#34; layout 
without breaking that Math::Simple demo ;-&#41;

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;09&nbsp;22:45:21&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 09 Jun 2014 21:45:09 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> slam &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok I&#39;ll check into that too :&#41;. Now I just have to find some time this week...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;11&nbsp;03:24:13&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jun 09 22:45:21 2014, slam@parasite.cc wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Ok I&#39;ll check into that too :&#41;. Now I just have to find some time this
&gt; week...
</div>
Hi Jason,

The problem seems to be mostly fixed if, at line 55 of &#40;your patched&#41; lib/Inline/Makemaker.pm we change:

    if &#40;$mm-&gt;{PMLIBDIRS} &#38;&#38; $mm-&gt;{PM}&#41; {
to:
    if &#40;@{$mm-&gt;{PMLIBDIRS}} &#38;&#38; $mm-&gt;{PM}&#41; {

That at least allows both &#34;layouts&#34; to build and install as desired. On the perls I&#39;ve just tested, an array reference is true even if the array being referenced is empty - hence the need for the alteration.
However, that change doesn&#39;t fix the annoyance of having the compilation re-run during each of the make steps &#40;which happens because the specified .inl target is not met&#41;.

Incidentally, for a long time Inline has shipped with the demo module named Math::Simple-1.23.
It was always packed into the source as:

modules/Math/Simple/Changes
modules/Math/Simple/Makefile.PL
modules/Math/Simple/MANIFEST
modules/Math/Simple/Simple.pl
modules/Math/Simple/test.pl

In git &#40;<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/ingydotnet/inline-pm&#41;">https://github.com/ingydotnet/inline-pm&#41;</a></span>, I&#39;ve now rearranged that as the more usual:

modules/Math-Simple-1.23/Changes
modules/Math-Simple-1.23/Makefile.PL
modules/Math-Simple-1.23/MANIFEST
modules/Math-Simple-1.23/Simple.pl
modules/Math-Simple-1.23/test.pl

And I&#39;ve also added a second demo which is essentially the same distro as the one we&#39;ve been using as our reference. &#40;I&#39;ve changed the names of the modules from Foo, Foo::Bar, and Foo::Bar::Baz to Boo, Boo::Far and Boo::Far::Faz - other than that it&#39;s the same&#41;.

So, in git, you&#39;ll also find:

modules/Boo-2.01/lib/Boo.pm
modules/Boo-2.01/lib/Boo/Far.pm
modules/Boo-2.01/lib/Boo/Far/Faz.pm
modules/Boo-2.01/Makefile.PL
modules/Boo-2.01/MANIFEST
modules/Boo-2.01/t/boo.t

These files will, of course ship with future Inline releases as demos of the 2 layouts.
Naturally, what we want is for both of those demos to build correctly out of the box.

With the above alteration to your patched MakeMaker.pm I think they do that - except that Math-Simple-1.23 wants to recompile the C code at every &#39;make&#39; step.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;13&nbsp;06:29:43&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">How about the attached version of lib/Inline/Makemaker.pm ?

It seems to do things right for me on Windows.

Cheers,
Rob
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> MakeMaker.pm</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package Inline::MakeMaker;

$Inline::MakeMaker::VERSION = &#39;0.55&#39;;
$Inline::MakeMaker::VERSION = eval $Inline::MakeMaker::VERSION;
@EXPORT = qw&#40;WriteMakefile WriteInlineMakefile&#41;;

use strict;
use base &#39;Exporter&#39;;
use ExtUtils::MakeMaker&#40;&#41;;
use Carp;

sub WriteInlineMakefile {
#    warn &lt;&lt;END;
#
#Inline::MakeMaker::WriteInlineMakefile&#40;&#41; is deprecated as of Inline-0.44.
#Inline::MakeMaker::WriteMakefile&#40;&#41; should be used instead.
#
#END
    goto &#38;WriteMakefile;
}

sub WriteMakefile {
    my %args = @_;
    my $name = $args{NAME}
      or croak &#34;Inline::MakeMaker::WriteMakefile requires the NAME parameter\n&#34;;
    my $version = &#39;&#39;;

    croak &lt;&lt;END unless &#40;defined $args{VERSION} or defined $args{VERSION_FROM}&#41;;
Inline::MakeMaker::WriteMakefile requires either the VERSION or VERSION_FROM
parameter.
END
    if &#40;defined $args{VERSION}&#41; {
        $version = $args{VERSION};
    }
    else {
        $version = ExtUtils::MM_Unix-&gt;parse_version&#40;$args{VERSION_FROM}&#41;
          or croak &#34;Can&#39;t determine version for $name\n&#34;;
    }
    croak &lt;&lt;END unless $version =~ /^\d\.\d\d$/;
Invalid version &#39;$version&#39; for $name.
Must be of the form &#39;#.##&#39;. &#40;For instance &#39;1.23&#39;&#41;
END

    # Provide a convenience rule to clean up Inline&#39;s messes
    $args{clean} = { FILES =&gt; &#34;_Inline *.inl &#34; }
    unless defined $args{clean};

    # Add Inline to the dependencies
    $args{PREREQ_PM}{Inline} = &#39;0.44&#39; unless defined $args{PREREQ_PM}{Inline};

    my $mm = &#38;ExtUtils::MakeMaker::WriteMakefile&#40;%args&#41;;

    my &#40;@objects, @obj_rules&#41;;

    if &#40;@{$mm-&gt;{PMLIBDIRS}} &#38;&#38; $mm-&gt;{PM}&#41; { #line 55 SIS alteration
        # Sort them longest first so we&#39;ll match subdirectories before their parents
        my @libdirs = sort { length&#40;$b&#41; &lt;=&gt; length&#40;$a&#41; } @{$mm-&gt;{PMLIBDIRS}};

        for my $path &#40;keys %{$mm-&gt;{PM}}&#41; {
            for my $lib &#40;@libdirs&#41; {
                if &#40;index&#40;$path,$lib&#41; == 0&#41; {
                    my &#40;$vol, $dirs, $file&#41; = File::Spec-&gt;splitpath&#40;substr&#40;$path, length&#40;$lib&#41;+1&#41;&#41;;
                    my @dirs = File::Spec-&gt;splitdir&#40;$dirs&#41;;
                    pop @dirs unless length&#40;$dirs[$#dirs]&#41;;
                    $file =~ s/\.[^.]+$//;

                    push @objects, join&#40;&#39;::&#39;, @dirs, $file&#41;;
                    push @obj_rules, join&#40;&#39;-&#39;, @dirs, &#34;$file.inl&#34;&#41;;
                    last;
                }
                croak &#34;Failed to find module path for &#39;$path&#39;&#34;;
            }
        }
    } else {
        # no modules found in PMLIBDIRS so assume we&#39;ve just got $name to do
        @objects = $name;
        $name =~ s/::/-/g;
        @obj_rules = &#40;&#34;$name.inl&#34;&#41;;
        #@obj_rules = &#40;split&#40;/::/, $name&#41;&#41;[-1].&#39;.inl&#39;;
    }

    if &#40;@objects&#41; {
        open MAKEFILE, &#39;&gt;&gt; Makefile&#39;
          or croak &#34;Inline::MakeMaker::WriteMakefile can&#39;t append to Makefile:\n$!&#34;;

        print MAKEFILE &lt;&lt;MAKEFILE;
# Well, not quite. Inline::MakeMaker is adding this:

# --- MakeMaker inline section:

MAKEFILE
    for &#40;0..$#objects&#41; {
        print MAKEFILE &lt;&lt;MAKEFILE;
$obj_rules[$_]: \$&#40;TO_INST_PM&#41;
	\$&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -M$objects[$_] -e1 $version \$&#40;INST_ARCHLIB&#41;
	\$&#40;PERL&#41; -e &#34;open WR, &#39;&gt;&#39;, &#39;$obj_rules[$_]&#39; unless -e &#39;$obj_rules[$_]&#39;;&#34;
MAKEFILE
    }

print MAKEFILE &#34;\npure_all :: &#34;,join&#40;&#39; &#39;,@obj_rules&#41;,&#34;\n&#34;;

print MAKEFILE &lt;&lt;MAKEFILE;

# The End is here.
MAKEFILE

        close MAKEFILE;
    }
}

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;13&nbsp;15:17:55&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 13 Jun 2014 14:17:45 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 13 Jun 2014 06:29:44 -0400
&#34;Sisyphus via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; How about the attached version of lib/Inline/Makemaker.pm ?
&gt; 
&gt; It seems to do things right for me on Windows.
</div>

It&#39;s funny, that&#39;s very close to what I had done a couple days ago but
just hadn&#39;t had the time to submit to you.  I&#39;ve included your fix to
checking the $mm-&gt;{PMLIBDIRS} array and attached my version.

I believe yours will work too.  Mine is slightly different, see which
you like better.

Neither &#40;I believe&#41; fix the issue of having something like Foo &#39;use&#39;ing
other modules that use Inline and then them being compiled multiple
times.  But after looking a bit I believe that one is going to be a
challenge &#40;at least for me!&#41; to figure out... I&#39;ll have to dig into
Inline some more.

Unless some other bug pops up I&#39;m thinking your or my latest code will
probably work!

Sorry for the delayed response.  Life gets in the way sometimes :&#41;

Thanks,
Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;13&nbsp;20:57:33&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Jun 13 15:17:55 2014, slam@parasite.cc wrote:
 I&#39;ve included your fix to
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; checking the $mm-&gt;{PMLIBDIRS} array and attached my version.
</div>
I&#39;d like to have a look at it but the attachment seems to have gone astray ;-&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Neither &#40;I believe&#41; fix the issue of having something like Foo &#39;use&#39;ing
&gt; other modules that use Inline and then them being compiled multiple
&gt; times.
</div>
Yes, some duplication of compilation still occurs - but, UIM, at least that now happens only for the first time that &#39;make&#39; is run. Subsequent running of make commands &#40;eg &#39;make test&#39;, &#39;make install&#39;&#41; no longer execute the
\$&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -M$name -e1 $version \$&#40;INST_ARCHLIB&#41;
command because the target now exists.
Still - I&#39;m surprised that the duplication of the same compilation occurs &#40;as I expected Inline to detect that such was unnecessary&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But after looking a bit I believe that one is going to be a
&gt; challenge &#40;at least for me!&#41; to figure out... I&#39;ll have to dig into
&gt; Inline some more.
</div>
Presently, it&#39;s not clear to me either just what is entailed in fixing that up.
But it doesn&#39;t really bother me, and I&#39;m prepared to leave it alone until either someone complains or I have time to look into it properly.
As far as I&#39;m concerned it&#39;s right to go - and it&#39;s now just a question of which of the two MakeMaker.pm files we use.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;13&nbsp;22:01:37&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 13 Jun 2014 21:01:17 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri, 13 Jun 2014 20:57:33 -0400
&#34;Sisyphus via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; On Fri Jun 13 15:17:55 2014, slam@parasite.cc wrote:
&gt;  I&#39;ve included your fix to
<div class="message-stanza open">&gt; &gt; checking the $mm-&gt;{PMLIBDIRS} array and attached my version.
</div>&gt; 
&gt; I&#39;d like to have a look at it but the attachment seems to have gone astray ;-&#41;
</div>
That&#39;s because I&#39;m an idiot and didn&#39;t actually attach it like I claimed to have done.  I have done that now :&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; Neither &#40;I believe&#41; fix the issue of having something like Foo &#39;use&#39;ing
&gt; &gt; other modules that use Inline and then them being compiled multiple
&gt; &gt; times.
</div>&gt; 
&gt; Yes, some duplication of compilation still occurs - but, UIM, at least that now happens only for the first time that &#39;make&#39; is run. Subsequent running of make commands &#40;eg &#39;make test&#39;, &#39;make install&#39;&#41; no longer execute the
&gt; \$&#40;PERL&#41; -Mblib -MInline=NOISY,_INSTALL_ -M$name -e1 $version \$&#40;INST_ARCHLIB&#41;
&gt; command because the target now exists.
&gt; Still - I&#39;m surprised that the duplication of the same compilation occurs &#40;as I expected Inline to detect that such was unnecessary&#41;.
</div>
I thought it would detect it too but from what I could see it appears that it doesn&#39;t do that detection when it&#39;s in _INSTALL_ mode.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; But after looking a bit I believe that one is going to be a
&gt; &gt; challenge &#40;at least for me!&#41; to figure out... I&#39;ll have to dig into
&gt; &gt; Inline some more.
</div>&gt; 
&gt; Presently, it&#39;s not clear to me either just what is entailed in fixing that up.
&gt; But it doesn&#39;t really bother me, and I&#39;m prepared to leave it alone until either someone complains or I have time to look into it properly.
&gt; As far as I&#39;m concerned it&#39;s right to go - and it&#39;s now just a question of which of the two MakeMaker.pm files we use.
</div>
Sounds good to me.  My change does also involve a change to Inline.pm as well but I didn&#39;t feel too bad about that since I was already changing it.  My version of this fix is to add a bit to the generated rule in the makefile to call a routine in Inline.pm which will create the .inl file.  That code was already in Inline.pm, I just moved it to its own sub and expect it to be called from perl snippet being executed by the -e command line argument in the makefile rule.  Hopefully that&#39;ll make more sense when you have a look at it.

Thanks,
Jason
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1375438/730382/Inline-mjm-shogun-v3.tar.gz">Download Inline-mjm-shogun-v3.tar.gz</a><br />
<span class="downloadcontenttype">application/gzip 267.4k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;15&nbsp;00:25:15&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hopefully that&#39;ll make more sense when you have a look at it.
</div>
Looks good to me.
Sub satisfy_makefile_dep&#40;&#41; would perhaps be better placed in MakeMaker.pm but I don&#39;t see any imperative to move it there - especially since it&#39;s doing stuff that was already being done in Inline.pm &#40;as you noted&#41;.

I&#39;ll get Inline-0.55_01 out in the next week, and we&#39;ll see how it goes.

Thanks for your work !!

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;15&nbsp;17:55:25&nbsp;2014</span>
    <span class="description">slam [...] parasite.cc -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 15 Jun 2014 16:55:15 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Inline [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jason McCarver &lt;slam [...] parasite.cc&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, 15 Jun 2014 00:25:16 -0400
&#34;Sisyphus via RT&#34; &lt;bug-Inline@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=95809">https://rt.cpan.org/Ticket/Display.html?id=95809</a></span> &gt;
&gt; 
&gt; Sub satisfy_makefile_dep&#40;&#41; would perhaps be better placed in MakeMaker.pm but I don&#39;t see any imperative to move it there - especially since it&#39;s doing stuff that was already being done in Inline.pm &#40;as you noted&#41;.
</div>
I hadn&#39;t really thought about that.  I guess I could see it in either place, but if it&#39;s moved to MakeMaker, then MakeMaker will have to be included in the command run by the generated Makefile which right now only includes Inline.  I guess in that sense it made sense for it to remain in the Inline module since it&#39;s code that&#39;s being using when Inline is in _INSTALL_ mode, not while it&#39;s generating the Makefile when perl Makefile.PL is run.  Or something. :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;ll get Inline-0.55_01 out in the next week, and we&#39;ll see how it goes.
&gt; 
&gt; Thanks for your work !!
</div>
Sounds great!  I enjoyed working with you on this, thanks for all the help and input...

Jason
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;21&nbsp;00:21:40&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Inline-0.55_01, which contains the fix for this bug was released to CPAN on 19th June 2014.

There&#39;s no testing of this specific bugfix in the test suite, though there are the 2 demo modules modules/Math-Simple-1.23 and modules/Boo-2.01 - both of which should build and test fine as a result of this bugfix.
Math-Simple-1.23 has always built fine, but Boo-2.01 &#40;added with this latest release&#41; does not build correctly with earlier versions of Inline.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;22&nbsp;21:12:16&nbsp;2014</span>
    <span class="description">ETJ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> sisyphus1 [...] optusnet.com.au, trueability.com [...] parasite.cc</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Jun 21 00:21:40 2014, SISYPHUS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; There&#39;s no testing of this specific bugfix in the test suite, though
&gt; there are the 2 demo modules modules/Math-Simple-1.23 and modules/Boo-
&gt; 2.01 - both of which should build and test fine as a result of this
&gt; bugfix.
&gt; Math-Simple-1.23 has always built fine, but Boo-2.01 &#40;added with this
&gt; latest release&#41; does not build correctly with earlier versions of
&gt; Inline.
</div>
Forgive my ignorance, including of MakeMaker - would it be possible to make a test for the generality of building a module, by installing it into a temporary directory, probably under /tmp? This would probably require using something like SITE_INSTALL? If that&#39;s right, let me know &#40;or correct me&#41;, and I&#39;ll knock something up.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;23&nbsp;11:06:50&nbsp;2014</span>
    <span class="description">sisyphus1 [...] optusnet.com.au -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #95809] [PATCH] Using Inline in a distribution with multiple modules</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 24 Jun 2014 01:05:53 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Inline [...] rt.cpan.org&gt;, &lt;inline [...] perl.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &lt;sisyphus1 [...] optusnet.com.au&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message----- 
From: Ed J via RT
Sent: Monday, June 23, 2014 11:12 AM

<div class="message-stanza open">&gt; Forgive my ignorance, including of MakeMaker - would it be possible to 
&gt; make a test for the generality of building a module, by installing it into 
&gt; a temporary directory, probably under /tmp? This would probably require 
&gt; using something like SITE_INSTALL? If that&#39;s right, let me know &#40;or 
&gt; correct me&#41;, and I&#39;ll knock something up.
</div>
There&#39;s now modules/Math-Simple-1.23 and modules/Boo-2.01 that ship with the 
Inline source. &#40;They&#39;re laid out differently - which is the reason that 
there&#39;s *two* modules.&#41;

I&#39;m thinking along the lines that the test could be constructed so that we:

1&#41; cd to modules/Math-Simple-1.23;
2&#41; check that &#39;perl -Mblib Makefile.PL INSTALL_BASE=../../_Inline_test&#39; 
succeeds;
3&#41; check that  &#39;$Config{make} test&#39; succeeds;
4&#41; check that  &#39;$Config{make} install&#39; succeeds;
5&#41; check that  &#39;$Config{make} realclean&#39; succeeds;

and do the same for modules/Boo-2.01.
I was thinking that could be done via system commands, but I&#39;m not sure if 
that&#39;s such a good idea given the odd configurations that some smokers seem 
to come up with.

Anyway, then we can rely on &#39;make clean&#39; to clean up the installed modules 
&#40;since it already cleans up the _Inline_test directory&#41;.

Trying to find the temporary directory seems messy to me - though File::Spec 
probably helps out. Since we already know that _Inline_test is writable, why 
not install the modules into there and let &#39;make clean&#39; remove them ?

I don&#39;t regard such tests as critical &#40;obviously&#41;, but they would be a 
useful addition to the test suite , imo - irrespective of precisely *how* 
you choose to implement them.

Cheers,
Rob 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;03:47:40&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Fixed as of Inline-0.55_01
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;03:47:42&nbsp;2014</span>
    <span class="description">sisyphus [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;09:20:20&nbsp;2014</span>
    <span class="description">ETJ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Would still like to make a test for this - reopening.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;24&nbsp;09:20:23&nbsp;2014</span>
    <span class="description">ETJ [...] cpan.org -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;19&nbsp;18:50:38&nbsp;2014</span>
    <span class="description">ETJ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> inline [...] perl.org, trueability.com [...] parasite.cc</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Test contributed by neomorphic, in Inline::C/test/27inline_maker.t. Closing.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jul&nbsp;19&nbsp;18:50:41&nbsp;2014</span>
    <span class="description">ETJ [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
