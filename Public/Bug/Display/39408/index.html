<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #39408 for POE-Component-Client-MPD: Fails to compile</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #39408 for POE-Component-Client-MPD: Fails to compile</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=POE-Component-Client-MPD">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=POE-Component-Client-MPD">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=POE-Component-Client-MPD">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=POE-Component-Client-MPD">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE-Component-Client-MPD">POE-Component-Client-MPD CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">39408</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=POE-Component-Client-MPD">POE-Component-Client-MPD</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">jquelin [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
andrew [...] etc.gen.nz

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-43434-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.9.0    </td>
  </tr>
  <tr id="CF-43435-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




MPD.pm<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/511332/254543/MPD.pm">
Sun Sep 21 17:04:09 2008 (2.6k) by andrew [...] etc.gen.nz
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=39408">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-509987" href="/Public/Bug/Display.html?id=39408#txn-509987">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;18&nbsp;22:32:58&nbsp;2008</span>
    <span class="description">andrew [...] etc.gen.nz -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Fails to compile</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/509987/253903/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/253903">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 433b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m trying to make a new POCOCM instance, but I&#39;m getting the following
error:

Can&#39;t locate object method &#34;put&#34; via package &#34;POE::Wheel::SocketFactory&#34;
at /usr/share/perl5/POE/Component/Client/MPD/Connection.pm line 216.

I&#39;m using code very similar to what you&#39;ve given in the man page, I&#39;m using:

use POE::Component::Client::MPD;
POE::Component::Client::MPD-&gt;spawn&#40; { alias =&gt; &#39;mpd&#39; } &#41;;

Can you shed any light on this?

Cheers!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-510015" href="/Public/Bug/Display.html?id=39408#txn-510015">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;19&nbsp;04:48:22&nbsp;2008</span>
    <span class="description">jquelin [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-510023" href="/Public/Bug/Display.html?id=39408#txn-510023">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;19&nbsp;04:55:45&nbsp;2008</span>
    <span class="description">jquelin [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/510023/253925/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/253925">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 564b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">i&#39;m missing some context here.
- are we talking pococm 0.9.0?
- what is your poe version?
- where is your mpd located, localhost?
- can you attach the faulty program?

this kind of error seems to come when one tries to send commands when
the pococm is not yet connected to mpd.

if that is the case:
 - i intend to put some checks for this later on.
 - you can spawn pococm with option
        status_msgs_to =&gt; $session
   with $session your own session. and then don&#39;t send anything unless
you&#39;ve received the mpd_connected event. &#40;this needs to be documented&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-510024" href="/Public/Bug/Display.html?id=39408#txn-510024">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;19&nbsp;04:55:50&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511332" href="/Public/Bug/Display.html?id=39408#txn-511332">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;21&nbsp;17:04:00&nbsp;2008</span>
    <span class="description">andrew [...] etc.gen.nz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andrew [...] etc.gen.nz</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/511332/254540/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/254540">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 973b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 19 04:55:45 2008, JQUELIN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; i&#39;m missing some context here.
&gt; - are we talking pococm 0.9.0?
</div>
Yes

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - what is your poe version?
</div>
1.0003

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - where is your mpd located, localhost?
</div>
Localhost

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - can you attach the faulty program?
</div>
It is a plugin for part of a Clutter app, I&#39;m writing.  I&#39;ve attached
the module that is doing it.  Interestingly enough it works okay on
another where the mpd daemon is on a remote computer.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; this kind of error seems to come when one tries to send commands when
&gt; the pococm is not yet connected to mpd.
&gt; 
&gt; if that is the case:
&gt;  - i intend to put some checks for this later on.
&gt;  - you can spawn pococm with option
&gt;         status_msgs_to =&gt; $session
&gt;    with $session your own session. and then don&#39;t send anything unless
&gt; you&#39;ve received the mpd_connected event. &#40;this needs to be documented&#41;
</div>
Okay, I&#39;ve added in the status_msgs_to event &#40;as you can see in the
attachment&#41; but it still isn&#39;t working.

Cheers!
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/511332/254543/MPD.pm">Download MPD.pm</a><br />
<span class="downloadcontenttype">text/x-perl 2.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">package Display::Plugins::MPD;

use Clutter;
use POSIX qw/strftime/;
use base &#40;&#39;Display::Plugin&#39;&#41;;
use POE qw{ Component::Client::MPD };

sub new {
  my $proto = shift;
  my $class = ref&#40;$proto&#41; || $proto;

  my $self = $class-&gt;SUPER::new&#40;@_&#41;;

  $self-&gt;{&#39;file&#39;} = &#39;&#39;;
  $self-&gt;{&#39;active&#39;} = 0;

  bless &#40;$self, $class&#41;;
  $self-&gt;init&#40;&#41;;
  return $self;
}

sub display {
  my &#40;$self, $msg, $answer&#41; = @_[OBJECT, ARG0, ARG1];

warn &#34;Got a response from MPD\n&#34;;
  my $current = $answer-&gt;current&#40;&#41;;

  if &#40;$self-&gt;{&#39;file&#39;} ne $current-&gt;file&#40;&#41;&#41; {
    my @lines = &#40;&#41;;
    push @lines, $current-&gt;title&#40;&#41;  if defined $current-&gt;title&#40;&#41;;
    push @lines, $current-&gt;album&#40;&#41;  if defined $current-&gt;album&#40;&#41;;
    push @lines, $current-&gt;artist&#40;&#41; if defined $current-&gt;artist&#40;&#41;;

    $self-&gt;{&#39;status&#39;}-&gt;set_text&#40;join&#40;&#34;\n&#34;, @lines&#41;&#41;;

    $self-&gt;{&#39;file&#39;} = $current-&gt;file&#40;&#41;;

    $self-&gt;{&#39;bg&#39;}-&gt;set_height&#40;$self-&gt;{&#39;status&#39;}-&gt;get_height&#40;&#41; + 10&#41;;
    $self-&gt;{&#39;bg&#39;}-&gt;set_anchor_point&#40;1, $self-&gt;{&#39;bg&#39;}-&gt;get_height&#40;&#41;&#41;;
    $self-&gt;{&#39;bg&#39;}-&gt;set_position&#40;10, $self-&gt;{&#39;stage&#39;}-&gt;get_height&#40;&#41; - 10&#41;;

    $self-&gt;{&#39;status&#39;}-&gt;set_anchor_point&#40;1, $self-&gt;{&#39;status&#39;}-&gt;get_height&#40;&#41;&#41;;
    $self-&gt;{&#39;status&#39;}-&gt;set_position&#40;15, $self-&gt;{&#39;stage&#39;}-&gt;get_height&#40;&#41; - 20&#41;;

    if &#40;! $self-&gt;{&#39;active&#39;}&#41; {
      $self-&gt;{&#39;stage&#39;}-&gt;add&#40;$self-&gt;{&#39;bg&#39;}&#41;;
      $self-&gt;{&#39;stage&#39;}-&gt;add&#40;$self-&gt;{&#39;status&#39;}&#41;;
      
      $self-&gt;{&#39;active&#39;} = time&#40;&#41; + 30;
    }

    $self-&gt;{&#39;KERNEL&#39;}-&gt;delay&#40; hide_display, 30 &#41;;
  }

  $self-&gt;{&#39;KERNEL&#39;}-&gt;delay&#40; mpd, 5, current &#41;;
}

sub hide_display {
  my $self = shift;

  if &#40;$self-&gt;{&#39;active&#39;} &lt;= time&#40;&#41;&#41; {
    $self-&gt;{&#39;stage&#39;}-&gt;remove&#40;$self-&gt;{&#39;status&#39;}&#41;;
    $self-&gt;{&#39;stage&#39;}-&gt;remove&#40;$self-&gt;{&#39;bg&#39;}&#41;;

    $self-&gt;{&#39;active&#39;} = 0;
  }

  return 0;
}

sub error {
  my &#40;$kernel, $msg, $errstr&#41; = @_[KERNEL, ARG0, ARG1];

  warn &#34;MPD: Error $errstr\n&#34;;

  $kernel-&gt;delay&#40; mpd, 5, current &#41;;
}

sub init {
  my $self = shift;

  $self-&gt;{&#39;kernel&#39;}-&gt;state&#40;&#39;mpd_result&#39;, $self, &#39;display&#39;&#41;;
  $self-&gt;{&#39;kernel&#39;}-&gt;state&#40;&#39;mpd_error&#39;, $self, &#39;error&#39;&#41;;
  $self-&gt;{&#39;kernel&#39;}-&gt;state&#40;&#39;mpd_hide_display&#39;, $self, &#39;hide_display&#39;&#41;;
  POE::Component::Client::MPD-&gt;new&#40; {
    alias =&gt; &#39;mpd&#39;,
    status_msgs_to =&gt; &#39;mpd_status_msgs&#39;,
  } &#41;;

  $self-&gt;{&#39;status&#39;} = Clutter::Label-&gt;new&#40;&#39;Sans 20&#39;, &#34;Song\nAlbum&#34;&#41;;
  $self-&gt;{&#39;status&#39;}-&gt;set_color&#40;Clutter::Color-&gt;parse&#40;&#39;White&#39;&#41;&#41;;

  $self-&gt;{&#39;bg&#39;} = Clutter::Rectangle-&gt;new&#40;Clutter::Color-&gt;parse&#40;&#39;Black&#39;&#41;&#41;;
  $self-&gt;{&#39;bg&#39;}-&gt;set_width&#40;$self-&gt;{&#39;stage&#39;}-&gt;get_width&#40;&#41; - 40&#41;;
  $self-&gt;{&#39;bg&#39;}-&gt;set_opacity&#40;100&#41;;
}

sub mpd_status_msgs {
  my &#40;$kernel, $arg&#41; = @_[KERNEL, ARG0];

  if &#40;$arg eq &#39;mpd_connected&#39;&#41; {
    $self-&gt;{&#39;kernel&#39;}-&gt;post&#40; &#39;mpd&#39;, &#39;current&#39; &#41;;
  } else {
    warn &#34;Failed to connected to MPD.  What now?\n&#34;;
  }
}

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511577" href="/Public/Bug/Display.html?id=39408#txn-511577">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;22&nbsp;12:44:56&nbsp;2008</span>
    <span class="description">jquelin [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/511577/254678/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/254678">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">uh, you misunderstood me.

status_msgs_to is *not* an event, it&#39;s a parameter telling the pococm
which session to send status events to. ie, if your poe session &#40;*your*
poe session, not the pococm&#41; is aliased to &#39;clutter&#39; or &#39;display&#39;, then
you should call the pococm with:

    POE::Component::Client::MPD-&gt;spawn&#40;{alias=&gt;&#39;mpd&#39;,
status_msgs_to=&gt;&#39;clutter&#39;}&#41;;

when this is done, pococm will send *additional* events [0] to &#39;clutter&#39;
such as:
 - &#39;mpd_connected&#39; when pococm is connected,
 - &#39;mpd_disconnected&#39; when pococm is disconnected,
 - etc.


then, you need to register some handlers for those events, and make sure
you don&#39;t fire any event when pococm is disconnected[1].


i could reliably reproduce your problem with the following scripts:

#!/usr/bin/perl
use POE qw{ Component::Client::MPD };
my $alias = &#39;foo&#39;;
POE::Component::Client::MPD-&gt;spawn&#40;{alias=&gt;&#39;mpd&#39;}&#41;;
POE::Session-&gt;create&#40;
    inline_states =&gt; {
        _start =&gt; \&#38;_start,
        _stop  =&gt; sub { print &#34;die\n&#34;; },
        
    }
&#41;;
POE::Kernel-&gt;run;
exit;
sub _start {
    $poe_kernel-&gt;alias_set&#40;$alias&#41;;
    $poe_kernel-&gt;post&#40; &#39;mpd&#39;, &#39;current&#39; &#41;;
}

==&gt; this example will produce a &#39;Can&#39;t locate object method &#34;put&#34;...&#39;


but now take this one:
#!/usr/bin/perl
use POE qw{ Component::Client::MPD };
my $me = &#39;foo&#39;;
POE::Component::Client::MPD-&gt;spawn&#40;{alias=&gt;&#39;mpd&#39;, status_msgs_to=&gt;$me}&#41;;
POE::Session-&gt;create&#40;
    inline_states =&gt; {
        _start =&gt; \&#38;_start,
        _stop  =&gt; sub { print &#34;die\n&#34;; },
        mpd_connected =&gt; \&#38;mpd_connected,
        mpd_result    =&gt; \&#38;mpd_result,
    }
&#41;;
POE::Kernel-&gt;run;
exit;
sub _start {
    $poe_kernel-&gt;alias_set&#40;$me&#41;;
}
sub mpd_connected {
    $poe_kernel-&gt;post&#40; &#39;mpd&#39;, &#39;current&#39; &#41;;
}
sub mpd_result {
    use Data::Dumper;
    print Dumper&#40;$_[ARG1]&#41;;
}


==&gt; this time, note that we&#39;re waiting for mpd_connected event before
firing the event &#39;current&#39;. and in this case, it works correctly...

[0] this needs to be documented
[1] future versions of pococm will take care of this, and:
 - check that pococm is connected
 - send errors when trying to send a command while not connected


but i&#39;m currently working on another module, so i don&#39;t have that much
time for pococm. i guess i&#39;ll have some time later on, and complete it.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511579" href="/Public/Bug/Display.html?id=39408#txn-511579">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;22&nbsp;12:45:13&nbsp;2008</span>
    <span class="description">jquelin [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511737" href="/Public/Bug/Display.html?id=39408#txn-511737">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;22&nbsp;19:10:58&nbsp;2008</span>
    <span class="description">andrew [...] etc.gen.nz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> andrew [...] etc.gen.nz</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/511737/254775/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/254775">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Sep 22 12:44:56 2008, JQUELIN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; uh, you misunderstood me.
&gt; 
&gt; status_msgs_to is *not* an event, it&#39;s a parameter telling the pococm
&gt; which session to send status events to. ie, if your poe session &#40;*your*
&gt; poe session, not the pococm&#41; is aliased to &#39;clutter&#39; or &#39;display&#39;, then
&gt; you should call the pococm with:
</div>
Ahhhh...  Right then.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; but now take this one:
&gt; #!/usr/bin/perl
&gt; use POE qw{ Component::Client::MPD };
&gt; my $me = &#39;foo&#39;;
</div>[snip]

Unfortunately this example doesn&#39;t rone for me, I get:

Can&#39;t locate object method &#34;date&#34; via package
&#34;Audio::MPD::Common::Item::Song&#34; at
/usr/share/perl5/POE/Component/Client/MPD/Connection.pm line 112.

I&#39;m using Audio::MPD 0.19.4, is a newer version required?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; ==&gt; this time, note that we&#39;re waiting for mpd_connected event before
&gt; firing the event &#39;current&#39;. and in this case, it works correctly...
&gt; 
&gt; [0] this needs to be documented
</div>
Documenting this better would be brilliant.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [1] future versions of pococm will take care of this, and:
&gt;  - check that pococm is connected
&gt;  - send errors when trying to send a command while not connected
</div>
:&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; but i&#39;m currently working on another module, so i don&#39;t have that much
&gt; time for pococm. i guess i&#39;ll have some time later on, and complete it.
</div>
I can understand that!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511738" href="/Public/Bug/Display.html?id=39408#txn-511738">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;22&nbsp;19:11:00&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511805" href="/Public/Bug/Display.html?id=39408#txn-511805">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;23&nbsp;02:29:08&nbsp;2008</span>
    <span class="description">jquelin [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/511805/254808/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/254808">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 407b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">all common structures between audio::mpd and pococm are now in their own
distrib audio::mpd::common. so you don&#39;t need to install audio::mpd to
use pococm - you need audio::mpd::common.

that said, audio::mpd::common::song is missing some fields, namely date
in your case. i&#39;ve opened a new ticket against audio::mpd::common, see
<span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=39529">http://rt.cpan.org/Ticket/Display.html?id=39529</a></span>

therefore, closing this bug.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-511807" href="/Public/Bug/Display.html?id=39408#txn-511807">#</a>      
    </span>
    <span class="date">Tue&nbsp;Sep&nbsp;23&nbsp;02:29:09&nbsp;2008</span>
    <span class="description">jquelin [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.482257</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
