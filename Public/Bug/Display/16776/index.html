<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #16776 for AxKit: current directory caching problems</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #16776 for AxKit: current directory caching problems</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/AxKit/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/AxKit/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/AxKit/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/AxKit/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/AxKit">AxKit CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">16776</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/AxKit/Active/">AxKit</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ajh [...] csse.monash.edu.au

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-3360-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.6.2    </td>
  </tr>
  <tr id="CF-3361-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;28&nbsp;17:18:28&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> current directory caching problems</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m using AxKit 1.6.2 on Mac OS X 10.4.3 &#40;Darwin ballarat 8.3.0 Darwin Kernel Version 8.3.0: Mon Oct  3 20:04:04 PDT 2005; root:xnu-792.6.22.obj~2/RELEASE_PPC Power Macintosh powerpc&#41;, with perl 5.8.6.

I am rendering pages of XML which define a photo album.  There are three types of pages: directory listings, thumbnails of images within a directory, and image pages themselves. Thumbnail pages visit the image XML files &#40;via a &#34;document&#34; call&#41; to retrieve description text.  This reference is via a relative path within the current directory.

The bug happens when I visit different thumbnail pages of the album from a directory listing.  Each image reference should retrieve within the current directory: however, the previous image directory/ies are used instead, which means that the retrieval fails because the file is not in that directory.

The bug appears to be due to some sort of caching of the previous path.  I have tried running it with AxNoCache both On and Off, however, the bug appears in both cases.

The bug does not appear when I run the system through the &#39;file&#39; protocol, only under &#39;http&#39;.  &#40;This I don&#39;t understand!&#41;  So this works:
  file:///home/ajh/www/personal/albums/2005/12/01/index.xml
But this doesn&#39;t:
  <span class="clickylink"><a target="new" rel="nofollow" href="http://localhost/~ajh/personal/albums/2005/12/01/index.xml">http://localhost/~ajh/personal/albums/2005/12/01/index.xml</a></span>

Here&#39;s the index file &#40;some entries removed to save space&#41;:
&lt;?xml version=&#34;1.0&#34; ?&gt;
&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;file:///home/ajh/Computers/python/photo/album.xsl&#34;?&gt;&lt;album&gt;
  &lt;title&gt; 01 Dec 2005 &lt;/title&gt;
  &lt;description&gt;ICCE2005, including conference dinner&lt;/description&gt;
  &lt;image name=&#34;IMG_20917&#34;/&gt;
  &lt;image name=&#34;IMG_20918&#34;/&gt;
  ...
  &lt;image name=&#34;IMG_20965&#34;/&gt;
  &lt;image name=&#34;IMG_20966&#34;/&gt;
&lt;/album&gt;

And here&#39;s the related image file:
&lt;?xml version=&#34;1.0&#34; ?&gt;
&lt;?xml-stylesheet type=&#34;text/xsl&#34; href=&#34;file:///home/ajh/Computers/python/photo/album.xsl&#34;?&gt;
&lt;album&gt;
  &lt;view name=&#34;IMG_20917&#34; prev=&#34;IMG_20917&#34; next=&#34;IMG_20918&#34;&gt;
    &lt;description&gt;
      Nanyang: Interesting flower, cf IMG_0202
    &lt;/description&gt;
    &lt;datetime&gt;2005:12:01 10:42:30&lt;/datetime&gt;
    &lt;shutter&gt;1/1000&lt;/shutter&gt;
    &lt;aperture&gt;6.3&lt;/aperture&gt;
  &lt;/view&gt;
&lt;/album&gt;

And here&#39;s the debug output from AxKit, with the two key directory references commented:

[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] fast handler called for /~ajh/personal/albums/2005/12/01/index.xml
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] Content Provider Override: Apache::AxKit::Provider::File
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] decoding from UTF-8
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [req] File Provider given $r: /home/ajh/www/personal/albums/2005/12/01/index.xml
****** this is the correct directory
****** &#39;index.xml&#39; refers to &#39;IMG_20917.xml&#39;, which does exist in .../2005/12/01

[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] checking if we process this resource
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] media: screen, preferred style: #default
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] Cache: key = c396b21e13fb121f11878ec606e3dd6c
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] getting styles and external entities from the XML
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] styles cached
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] cache doesn&#39;t exist
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] some condition failed. recreating output
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] styles: Apache::AxKit::Language::LibXSLT&#40;file:///home/ajh/Computers/python/photo/album.xsl&#41;
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] Style Provider Override: Apache::AxKit::Provider::File
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [file] File Provider given file: /home/ajh/Computers/python/photo/album.xsl
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] encoding to UTF-8
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] about to execute: Apache::AxKit::Language::LibXSLT::handler
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [LibXSLT] getting the XML
parser match_cb:  at /Library/Perl/5.8.6/darwin-thread-multi-2level/Apache/AxKit/Language/LibXSLT.pm line 55.
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [LibXSLT] parsing stylesheet
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [LibXSLT] checking if stylesheet is cached
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [LibXSLT] stylesheet cached
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [LibXSLT] performing transformation
$xmlname=IMG_20917.xml
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] LibXSLT match_uri: /~ajh/personal/albums/2005/12/23/IMG_20917.xml
******** this is a previously visited directory, and denotes a non-existent file

[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] LibXSLT open_content_uri: /~ajh/personal/albums/2005/12/23/IMG_20917.xml
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] Content Provider Override: Apache::AxKit::Provider::File
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] decoding from UTF-8
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] [req] File Provider given $r: /home/ajh/www/personal/albums/2005/12/23/IMG_20917.xml
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] encoding to UTF-8
[Thu Dec 29 08:48:03 2005] [warn] [client 127.0.0.1] [AxKit] Caught an exception
[Thu Dec 29 08:48:03 2005] [error] [client 127.0.0.1] [AxKit] [Error] input callback died: File &#39;/home/ajh/www/personal/albums/2005/12/23/IMG_20917.xml&#39; does not exist or is not readable at /Library/Perl/5.8.6/darwin-thread-multi-2level/Apache/AxKit/Language/LibXSLT.pm line 124.\n
[Thu Dec 29 08:48:03 2005] [error] [client 127.0.0.1] [AxKit] From: /Library/Perl/5.8.6/darwin-thread-multi-2level/Apache/AxKit/Exception.pm : 9
[Thu Dec 29 08:48:03 2005] [error] [client 127.0.0.1] [AxKit] [Backtrace] input callback died: File &#39;/home/ajh/www/personal/albums/2005/12/23/IMG_20917.xml&#39; does not exist or is not readable at /Library/Perl/5.8.6/darwin-thread-multi-2level/Apache/AxKit/Language/LibXSLT.pm line 124.\n at /Library/Perl/5.8.6/darwin-thread-multi-2level/Apache/AxKit/Exception.pm line 9\n\tApache::AxKit::Exception::new&#40;&#39;Apache::AxKit::Exception::Error&#39;, &#39;-text&#39;, &#39;input callback died: File \\&#39;/home/ajh/www/personal/albums/200...&#39;&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 1015\n\tAxKit::prep_exception&#40;&#39;input callback died: File \\&#39;/home/ajh/www/personal/albums/200...&#39;&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 173\n\tAxKit::__ANON__&#40;&#39;input callback died: File \\&#39;/home/ajh/www/personal/albums/200...&#39;&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/Apache/AxKit/Language/LibXSLT.pm line 124\n\tApache::AxKit::Language::LibXSLT::handler&#40;&#39;Apache::AxKit::Language::LibXSLT&#39;, &#39;AxKit::Apache=SCALAR&#40;0xf0fec&#41;&#39;, &#39;Apache::AxKit::Provider::File=HASH&#40;0xf158c&#41;&#39;, &#39;Apache::AxKit::Provider::File=HASH&#40;0xf1460&#41;&#39;, 1&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 759\n\tAxKit::process_request&#40;&#39;AxKit::Apache=SCALAR&#40;0xf0fec&#41;&#39;, &#39;Apache::AxKit::Provider::File=HASH&#40;0xf158c&#41;&#39;, &#39;ARRAY&#40;0xf13e8&#41;&#39;, &#39;undef&#39;&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 474\n\tAxKit::run_axkit_engine&#40;&#39;AxKit::Apache=SCALAR&#40;0xf0fec&#41;&#39;, &#39;Apache::AxKit::Provider::File=HASH&#40;0xf158c&#41;&#39;&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 300\n\teval {...} called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 291\n\tAxKit::main_handler&#40;&#39;AxKit::Apache=SCALAR&#40;0xf0fec&#41;&#39;, &#39;Apache::AxKit::Provider::File=HASH&#40;0xf158c&#41;&#39;&#41; called at /Library/Perl/5.8.6/darwin-thread-multi-2level/AxKit.pm line 204\n\tAxKit::fast_handler&#40;&#39;AxKit::Apache=SCALAR&#40;0xf0fec&#41;&#39;&#41; called at /dev/null line 0\n\teval {...} called at /dev/null line 0\n
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
