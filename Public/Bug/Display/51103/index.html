<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #51103 for Class-Data-Inheritable: [PATCH] Enhancement: Allow overridden class data to return to inheriting superclass data</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #51103 for Class-Data-Inheritable: [PATCH] Enhancement: Allow overridden class data to return to inheriting superclass data</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Class-Data-Inheritable/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Class-Data-Inheritable/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Class-Data-Inheritable/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Class-Data-Inheritable/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Class-Data-Inheritable">Class-Data-Inheritable CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">51103</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Class-Data-Inheritable/Active/">Class-Data-Inheritable</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
shay [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-6672-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.08    </td>
  </tr>
  <tr id="CF-6673-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;04&nbsp;06:59:21&nbsp;2009</span>
    <span class="description">shay [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] Enhancement: Allow overridden class data to return to
 inheriting superclass data</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I have a small enhancement for your Class::Data::Inheritable perl module
which allows overridden class data to be reset so that it sees an
inherited value once again, just like it would have done before
overriding it.

It works by passing in the undefined value as the new value of the
overridden data. I realize that this could cause trouble for anyone
actually wanting to set the undefined value as the overridden value, so
it would require at least a prominent warning about changed behaviour in
the new version, or maybe it should be optional behaviour that only
kicks in when some special &#39;import&#39; symbol is passed in?

I&#39;ve attached a patch against version 0.08. Only the &#39;Changes&#39; file has
not been updated. &#40;The patch also corrects a couple of uses of the word
&#34;effect&#34; which should be &#34;affect&#34;.&#41;

Regards,
Steve
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> C-D-I.patch</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ruN Class-Data-Inheritable-0.08/META.yml Class-Data-Inheritable-0.09/META.yml
--- Class-Data-Inheritable-0.08/META.yml	2008-01-25 11:51:08.000000000 +0000
+++ Class-Data-Inheritable-0.09/META.yml	2009-11-04 11:46:28.475438900 +0000
@@ -1,6 +1,6 @@
 --- #YAML:1.0
 name:                Class-Data-Inheritable
-version:             0.08
+version:             0.09
 abstract:            Inheritable, overridable class data
 license:             perl
 author:              ~
diff -ruN Class-Data-Inheritable-0.08/README Class-Data-Inheritable-0.09/README
--- Class-Data-Inheritable-0.08/README	2008-01-25 11:37:02.000000000 +0000
+++ Class-Data-Inheritable-0.09/README	2009-11-04 11:45:48.897060600 +0000
@@ -57,11 +57,17 @@
       Raygun-&gt;Suitcase&#40;&#39;Orange&#39;&#41;;
 
     Now that Raygun has overridden Pere::Ubu futher changes by Pere::Ubu no
-    longer effect Raygun.
+    longer affect Raygun.
 
       # Raygun still has an orange suitcase, but Pere::Ubu is using Samsonite.
       Pere::Ubu-&gt;Suitcase&#40;&#39;Samsonite&#39;&#41;;
 
+    Raygun can clear its override by setting its value to undef, and it will
+    then return to inheriting from Pere::Ubu once more.
+
+      # Raygun now shares Pere::Ubu&#39;s suitcase again
+      Raygun-&gt;Suitcase&#40;undef&#41;;
+
 Methods
   mk_classdata
       Class-&gt;mk_classdata&#40;$data_accessor_name&#41;;
diff -ruN Class-Data-Inheritable-0.08/lib/Class/Data/Inheritable.pm Class-Data-Inheritable-0.09/lib/Class/Data/Inheritable.pm
--- Class-Data-Inheritable-0.08/lib/Class/Data/Inheritable.pm	2008-01-25 11:51:00.000000000 +0000
+++ Class-Data-Inheritable-0.09/lib/Class/Data/Inheritable.pm	2009-11-04 11:44:45.693531100 +0000
@@ -2,7 +2,9 @@
 
 use strict qw&#40;vars subs&#41;;
 use vars qw&#40;$VERSION&#41;;
-$VERSION = &#39;0.08&#39;;
+$VERSION = &#39;0.09&#39;;
+
+use Class::ISA;
 
 sub mk_classdata {
     my &#40;$declaredclass, $attribute, $data&#41; = @_;
@@ -19,7 +21,13 @@
           if @_&gt;1 &#38;&#38; $wantclass ne $declaredclass;
 
         $data = $_[1] if @_&gt;1;
-        return $data;
+        return $data if defined $data;
+        foreach my $class &#40;Class::ISA::super_path&#40;$wantclass&#41;&#41; {
+            if &#40;my $accessor = $class-&gt;can&#40;$attribute&#41;&#41; {
+                return $class-&gt;$accessor&#40;&#41; if defined $class-&gt;$accessor&#40;&#41;;
+            }
+        }
+        return; # attribute not found
     };
 
     my $alias = &#34;_${attribute}_accessor&#34;;
@@ -93,11 +101,17 @@
   Raygun-&gt;Suitcase&#40;&#39;Orange&#39;&#41;;
 
 Now that Raygun has overridden Pere::Ubu futher changes by Pere::Ubu
-no longer effect Raygun.
+no longer affect Raygun.
 
   # Raygun still has an orange suitcase, but Pere::Ubu is using Samsonite.
   Pere::Ubu-&gt;Suitcase&#40;&#39;Samsonite&#39;&#41;;
 
+Raygun can clear its override by setting its value to undef, and it will
+then return to inheriting from Pere::Ubu once more.
+
+  # Raygun now shares Pere::Ubu&#39;s suitcase again
+  Raygun-&gt;Suitcase&#40;undef&#41;;
+
 =head1 Methods
 
 =head2 mk_classdata
diff -ruN Class-Data-Inheritable-0.08/t/Inheritable.t Class-Data-Inheritable-0.09/t/Inheritable.t
--- Class-Data-Inheritable-0.08/t/Inheritable.t	2005-09-24 14:52:16.000000000 +0100
+++ Class-Data-Inheritable-0.09/t/Inheritable.t	2009-11-04 11:37:18.251420100 +0000
@@ -1,5 +1,5 @@
 use strict;
-use Test::More tests =&gt; 15;
+use Test::More tests =&gt; 16;
 
 package Ray;
 use base qw&#40;Class::Data::Inheritable&#41;;
@@ -21,7 +21,7 @@
 		qw/mk_classdata Ubu _Ubu_accessor DataFile _DataFile_accessor/;
 }
 
-# Test that superclasses effect children.
+# Test that superclasses affect children.
 is +Gun-&gt;Ubu, &#39;Pere&#39;, &#39;Ubu in Gun&#39;;
 is +Suitcase-&gt;Ubu, &#39;Pere&#39;, &#34;Inherited into children&#34;;
 is +Ray-&gt;Ubu, undef, &#34;But not set in parent&#34;;
@@ -37,6 +37,9 @@
 is +Gun-&gt;DataFile, &#39;/tmp/stuff&#39;, &#34;filters down to unchanged children&#34;;
 is +Suitcase-&gt;DataFile, &#39;/etc/otherstuff/data&#39;, &#34;but not to changed&#34;;
 
+# Now reset in changed child
+Suitcase-&gt;DataFile&#40;undef&#41;;
+is +Suitcase-&gt;DataFile, &#39;/tmp/stuff&#39;, &#34;Data inherited when cleared&#34;;
 
 my $obj = bless {}, &#39;Gun&#39;;
 eval { $obj-&gt;mk_classdata&#40;&#39;Ubu&#39;&#41; };
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;18&nbsp;17:51:00&nbsp;2014</span>
    <span class="description">shay [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I no longer agree with my former self regarding this suggestion. The idea of allowing overridden class data to return to inheriting superclass data is fine, but this was not a good suggestion for how to go about it. Users might very well want to set class data to the undefined value...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;18&nbsp;17:51:01&nbsp;2014</span>
    <span class="description">shay [...] cpan.org -  Status changed from &#39;new&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
