<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #70232 for ExtUtils-MakeMaker: Hang in t/INSTALL_BASE.t on FreeBSD</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #70232 for ExtUtils-MakeMaker: Hang in t/INSTALL_BASE.t on FreeBSD</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=ExtUtils-MakeMaker">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=ExtUtils-MakeMaker">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=ExtUtils-MakeMaker">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=ExtUtils-MakeMaker">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ExtUtils-MakeMaker">ExtUtils-MakeMaker CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">70232</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=ExtUtils-MakeMaker">ExtUtils-MakeMaker</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
JPEREGR [...] cpan.org

<br />
ucjddavis [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-12494-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
6.58</li>
<li>
6.58_01</li>
<li>
6.59</li>
</ul>
    </td>
  </tr>
  <tr id="CF-12495-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




makefileplscript.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/985379/513058/makefileplscript.txt">
Thu Oct 06 17:11:39 2011 (435b) by james_peregrino [...] harvard.edu
</a>
</font></li>
</ul>


perldbopts-lastscreen.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/985379/513060/perldbopts-lastscreen.txt">
Thu Oct 06 17:11:39 2011 (4.5k) by james_peregrino [...] harvard.edu
</a>
</font></li>
</ul>


tperl.out<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/985379/513062/tperl.out">
Thu Oct 06 17:11:40 2011 (3200.2k) by james_peregrino [...] harvard.edu
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=70232">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-966499" href="/Public/Bug/Display.html?id=70232#txn-966499">#</a>      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;12&nbsp;09:47:16&nbsp;2011</span>
    <span class="description">ucjddavis [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/966499/502936/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/502936">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.6k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">ExtUtils-MakeMaker is not completing t/INSTALL_BASE.t runs during
package installations when it is called.

I am encountering this with every new FreeBSD server that I am building
and using CPAN to install modules.

## system info:
 8.2-RELEASE FreeBSD 8.2-RELEASE #0: Thu Feb 17 02:41:51 UTC 2011    
root@mason.cse.buffalo.edu:/usr/obj/usr/src/sys/GENERIC  amd64

## Perl Info:
5.12.4
standard freebsd port installation



## sample output
the out put here is from the installation of YAML as the first package
after running CPAN for the first time.


Manifying blib/man3/ExtUtils::MM_Any.3
  MSTROUT/ExtUtils-MakeMaker-6.59.tar.gz
  /usr/bin/make -- OK
Running make test
PERL_DL_NONLAZY=1 /usr/local/bin/perl &#34;-Iblib/arch&#34; &#34;-Iblib/lib&#34;
&#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; &#34;test_harness&#40;0, &#39;blib/lib&#39;,
&#39;blib/arch&#39;&#41;&#34; t/*.t
t/00compile.t ............. ok     
t/arch_check.t ............ ok   
t/backwards.t ............. ok   
t/basic.t ................. ok       
t/build_man.t ............. ok   
t/cd.t .................... ok   
t/config.t ................ ok   
t/dir_target.t ............ ok   
t/FIRST_MAKEFILE.t ........ ok   
t/fix_libs.t .............. ok   
t/fixin.t ................. ok     
t/hints.t ................. ok   
t/INST.t .................. ok     
t/INST_PREFIX.t ........... ok     
t/INSTALL_BASE.t .......... 1/20 

The system hangs here and will proceed no further.  If you ^c out of
this the install may proceed with seeming success or it may fail
depending on the package

This does not occur with ExUtils-MakeMaker-6.56 on the same system.

Any corrections to this issue or methods to work around it would be great.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-981320" href="/Public/Bug/Display.html?id=70232#txn-981320">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;25&nbsp;01:11:42&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Subject changed from &#40;no value&#41; to &#39;Hang in t/INSTALL_BASE.t on FreeBSD&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-981321" href="/Public/Bug/Display.html?id=70232#txn-981321">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;25&nbsp;01:11:42&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Severity Critical changed to Normal</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Create even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985037" href="/Public/Bug/Display.html?id=70232#txn-985037">#</a>      
    </span>
    <span class="date">Wed&nbsp;Oct&nbsp;05&nbsp;16:44:55&nbsp;2011</span>
    <span class="description">JPEREGR [...] cpan.org - Ticket #71480:  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> hangs during make test INSTALL_BASE</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985037/512888/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/512888">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 934b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">[peregrin@bert ExtUtils-MakeMaker-6.59]$ make test
PERL_DL_NONLAZY=1 /usr/bin/perl &#34;-Iblib/arch&#34; &#34;-Iblib/lib&#34; &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; 
&#34;test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/00compile.t ............. ok     
t/arch_check.t ............ ok   
t/backwards.t ............. ok   
t/basic.t ................. ok       
t/build_man.t ............. ok   
t/cd.t .................... ok   
t/config.t ................ ok   
t/dir_target.t ............ ok   
t/FIRST_MAKEFILE.t ........ ok   
t/fix_libs.t .............. ok   
t/fixin.t ................. ok     
t/hints.t ................. ok   
t/INST.t .................. ok     
t/INST_PREFIX.t ........... ok     
t/INSTALL_BASE.t .......... 1/20 ^C

sits at 1/20 until broken out with a ^C.  Happens in 6.59 and 6.61_01.
Also reported in bugreport #70232 and <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perlmonks.org/bare/index.pl">http://www.perlmonks.org/bare/index.pl</a></span>?
node_id=918565

OS: FreeBSD 7.4
Perl: 5.12.4 &#40;system perl via ports&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985141" href="/Public/Bug/Display.html?id=70232#txn-985141">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;06&nbsp;00:08:57&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org - Ticket #71480:  Merged into ticket #70232</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985142" href="/Public/Bug/Display.html?id=70232#txn-985142">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;06&nbsp;00:08:57&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Merged into ticket #70232</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985161" href="/Public/Bug/Display.html?id=70232#txn-985161">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;06&nbsp;00:35:15&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/985161/512955/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/512955">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Lacking a FreeBSD machine, or knowledge of FreeBSD&#39;s quirks, I&#39;m going
to have to rely on you to do some investigation.

I order to fix this, I need one of you to do the following...

1. Download a fresh copy of the ExtUtils-MakeMaker 6.61_01 tarball from
CPAN.
2. Unpack it.
3. Run &#34;perl Makefile.PL&#34; and send on the output.
4. Run this command and send the last screen full of output when it hangs.

    PERLDB_OPTS=&#39;NonStop AutoTrace&#39; perl -Ilib -dw t/INSTALL_BASE.t

5. Run this similar command and send me the contents of trace.out.

    PERLDB_OPTS=&#39;NonStop AutoTrace LineInfo=tperl.out&#39; perl -Ilib -dw
t/INSTALL_BASE.t

You may have to kill the program once it hangs.

Those last two will give complete traces of what&#39;s going on in the test
hopefully revealing the bug.  If you&#39;re knowledgeable with the debugger,
you can remove NonStop and try to debug it yourself.  That would be most
appreciated.


Let me check other things that might be interfering.

1. Please verify that you have the same problem when installing from a
fresh tarball downloaded directly from CPAN &#40;ie. not from the FreeBSD
ports collection&#41; and the install is done manually &#40;ie. not from in a
CPAN shell&#41;.

2. Please verify that you are not using a jail or other security system.
 If you are, lmk.

3. [Optional] Please download and compile 5.12.4 from source &#40;ie. not
from FreeBSD&#41; and see if the problem persists.

4. What version of ExtUtils::Install and ExtUtils::Packlist do you have
installed?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985164" href="/Public/Bug/Display.html?id=70232#txn-985164">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;06&nbsp;00:35:16&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985379" href="/Public/Bug/Display.html?id=70232#txn-985379">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;06&nbsp;17:11:37&nbsp;2011</span>
    <span class="description">james_peregrino [...] harvard.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> JPEREGR [...] cpan.org, ucjddavis [...] gmail.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #70232] Hang in t/INSTALL_BASE.t on FreeBSD</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 6 Oct 2011 17:11:06 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> James Peregrino &lt;james_peregrino [...] harvard.edu&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513057/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/513057">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Oct 6, 2011, at 12:35 AM, bug-ExtUtils-MakeMaker@rt.cpan.org wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Lacking a FreeBSD machine, or knowledge of FreeBSD&#39;s quirks, I&#39;m going
&gt; to have to rely on you to do some investigation.
&gt; 
&gt; I order to fix this, I need one of you to do the following...
&gt; 
&gt; 1. Download a fresh copy of the ExtUtils-MakeMaker 6.61_01 tarball from
&gt; CPAN.
&gt; 2. Unpack it.
&gt; 3. Run &#34;perl Makefile.PL&#34; and send on the output.
</div>
see attached file &#34;makefileplscript.txt

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 4. Run this command and send the last screen full of output when it hangs..
&gt; 
&gt; PERLDB_OPTS=&#39;NonStop AutoTrace&#39; perl -Ilib -dw t/INSTALL_BASE.t
</div>
see attached file perldbopts-lastscreen.txt

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 5. Run this similar command and send me the contents of trace.out.
&gt; 
&gt; PERLDB_OPTS=&#39;NonStop AutoTrace LineInfo=tperl.out&#39; perl -Ilib -dw
&gt; t/INSTALL_BASE.t
&gt; 
</div>
see attached file tperl.out

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [snip]
&gt; Let me check other things that might be interfering.
&gt; 
&gt; 1. Please verify that you have the same problem when installing from a
&gt; fresh tarball downloaded directly from CPAN &#40;ie. not from the FreeBSD
&gt; ports collection&#41; and the install is done manually &#40;ie. not from in a
&gt; CPAN shell&#41;.
</div>
same problem

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 2. Please verify that you are not using a jail or other security system.
&gt; If you are, lmk.
&gt; 
</div>
nope, no jails or other security.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 3. [Optional] Please download and compile 5.12.4 from source &#40;ie. not
&gt; from FreeBSD&#41; and see if the problem persists.
</div>
used perlbrew to install a virgin 5.12.4 -&gt; no problems, ExtUtils::MakeMaker passes all tests

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 4. What version of ExtUtils::Install and ExtUtils::Packlist do you have
&gt; installed?
</div>
System Perl &#40;via ports&#41; - ExtUtils::Install 1.54, ExtUtils::PackList 1.43 - these are installed as a separate port and are the latest version in the ports system.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
</div></div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513058/makefileplscript.txt">Download makefileplscript.txt</a><br />
<span class="downloadcontenttype">text/plain 435b</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513059/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/513059">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"> 
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513060/perldbopts-lastscreen.txt">Download perldbopts-lastscreen.txt</a><br />
<span class="downloadcontenttype">text/plain 4.5k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513061/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/513061">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"> 
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513062/tperl.out">Download tperl.out</a><br />
<span class="downloadcontenttype">application/octet-stream 3.1m</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985379/513063/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/513063">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 88b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
--
-- James Peregrino - <span class="clickylink"><a target="new" rel="nofollow" href="http://people.dce.harvard.edu/~peregrin/business-card.html">http://people.dce.harvard.edu/~peregrin/business-card.html</a></span>
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-985970" href="/Public/Bug/Display.html?id=70232#txn-985970">#</a>      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;08&nbsp;19:19:44&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #70232] Hang in t/INSTALL_BASE.t on FreeBSD</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 08 Oct 2011 16:19:28 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/985970/513347/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/513347">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011.10.6 2:11 PM, james_peregrino@harvard.edu via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; 1. Download a fresh copy of the ExtUtils-MakeMaker 6.61_01 tarball from
&gt;&gt; CPAN.
&gt;&gt; 2. Unpack it.
&gt;&gt; 3. Run &#34;perl Makefile.PL&#34; and send on the output.
</div>&gt; 
&gt; see attached file &#34;makefileplscript.txt
</div>
Ok, that tells me your modules are basically up to date.  Thanks.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; 5. Run this similar command and send me the contents of trace.out.
&gt;&gt;
&gt;&gt; PERLDB_OPTS=&#39;NonStop AutoTrace LineInfo=tperl.out&#39; perl -Ilib -dw
&gt;&gt; t/INSTALL_BASE.t
</div></div>
If that trace is correct, it appears to be hanging running &#34;make install 2&gt;&#38;1&#34;
on line 45:

  my $install_out = run&#40;&#34;$make install&#34;&#41;;

Please try some things to figure out what&#39;s causing the hang.  Replace line 45
with each of these in turn and tell me if it hangs or not.

  my $install_out = `$make install 2&gt;&#38;1`;

  my $install_out = `$make install`;

  my $install_out;  system&#40;&#34;$make install 2&gt;&#38;1&#34;&#41;;

  my $install_out;  system&#40;&#34;$make install&#34;&#41;;

Those last two will cause the next two tests to fail.  Send on the output of
each run please.  If the system&#40;&#41; calls hang they should tell us where.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; 3. [Optional] Please download and compile 5.12.4 from source &#40;ie. not
&gt;&gt; from FreeBSD&#41; and see if the problem persists.
</div>&gt; 
&gt; used perlbrew to install a virgin 5.12.4 -&gt; no problems, ExtUtils::MakeMaker
&gt; passes all tests
</div>
Thank you.  Now we know it&#39;s something FreeBSD did.  The question is what.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; 4. What version of ExtUtils::Install and ExtUtils::Packlist do you have
&gt;&gt; installed?
</div>&gt; 
&gt; System Perl &#40;via ports&#41; - ExtUtils::Install 1.54, ExtUtils::PackList 1.43
&gt; - these are installed as a separate port and are the latest version in the
&gt; ports system.
</div>
Hmm.  The real 5.12.4 is using ExtUtils::Install 1.55 and ExtUtils::PackList
1.44, but they don&#39;t contain any significant changes.

I don&#39;t see any changes to the CPAN module in the port.  Just to be sure,
could you diff the ports supplied ExtUtils::Install and ExtUtils::PackList
with the 1.54 on CPAN please?


-- 
Stabbing you in the face for your own good.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-991828" href="/Public/Bug/Display.html?id=70232#txn-991828">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;13:50:14&nbsp;2011</span>
    <span class="description">RWSTAUNER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> schwern [...] pobox.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/991828/516463/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/516463">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 691b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">trying FreeBSD 8.2 in a virtualbox vm I noticed this issue as well.

switching to system&#40;&#34;$make install 2&gt;&#38;1&#34;&#41; displays this additional output:

Installing ../dummy-install/lib/perl5/Big/Dummy.pm
Installing ../dummy-install/lib/perl5/Big/Liar.pm
Installing ../dummy-install/man/man1/program.1
Installing ../dummy-install/man/man3/Big::Dummy.pm
Installing ../dummy-install/bin/program
FreeBSD: Registering installation in the package database
FreeBSD: Cannot determine module description

Copying the &#39;AUTHOR =&gt; &#39;... line from Big/Dummy&#39;s Makefile to Big/Liar&#39;s
&#40;in t/lib/MakeMaker/Setup/BFD.pm&#41; seems to allow the system command to
proceed, though of course then lots of other things break.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-991920" href="/Public/Bug/Display.html?id=70232#txn-991920">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;15:41:22&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #70232] Hang in t/INSTALL_BASE.t on FreeBSD</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 25 Oct 2011 12:41:06 -0700</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/991920/516519/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/516519">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011.10.25 10:50 AM, Randy Stauner via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; trying FreeBSD 8.2 in a virtualbox vm I noticed this issue as well.
&gt; 
&gt; switching to system&#40;&#34;$make install 2&gt;&#38;1&#34;&#41; displays this additional output:
&gt; 
&gt; Installing ../dummy-install/lib/perl5/Big/Dummy.pm
&gt; Installing ../dummy-install/lib/perl5/Big/Liar.pm
&gt; Installing ../dummy-install/man/man1/program.1
&gt; Installing ../dummy-install/man/man3/Big::Dummy.pm
&gt; Installing ../dummy-install/bin/program
&gt; FreeBSD: Registering installation in the package database
&gt; FreeBSD: Cannot determine module description
</div>
Whoa.  That last bit is NOT from MakeMaker.  I think you&#39;re using some FreeBSD
patched version of ExtUtils::Install.  Could you please send me the contents
of your ExtUtils::Install?  &#34;perldoc -l ExtUtils::Install&#34; should find it.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Copying the &#39;AUTHOR =&gt; &#39;... line from Big/Dummy&#39;s Makefile to Big/Liar&#39;s
&gt; &#40;in t/lib/MakeMaker/Setup/BFD.pm&#41; seems to allow the system command to
&gt; proceed, though of course then lots of other things break.
</div>
That&#39;s... really strange.  I wonder if whatever they&#39;re doing cannot handle a
module without an author.


-- 
184. When operating a military vehicle I may *not* attempt something
     &#34;I saw in a cartoon&#34;.
    -- The 213 Things Skippy Is No Longer Allowed To Do In The U.S. Army
           <span class="clickylink"><a target="new" rel="nofollow" href="http://skippyslist.com/list/">http://skippyslist.com/list/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-991950" href="/Public/Bug/Display.html?id=70232#txn-991950">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;18:24:23&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/991950/516537/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/516537">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok, I installed a FreeBSD 8.2 VM and figured out what&#39;s going on.  Long
story short, the problem is likely upstream.  BSD is injecting code into
ExtUtils::MM_Unix, MakeMaker and Packlist which is likely interfering
with the install.  It should be reported to FreeBSD.

The problem is BSDPAN::ExtUtils::Packlist::get_dir_list&#40;&#41;.  It&#39;s
sneakily loaded by BSDPAN::Override which appears to be sneakily loaded
by BSDPAN&#39;s own Config.pm which is sneakily loaded when you &#34;use
Config&#34;.  BSDPAN::EU::Packlist adds code to register the module in the
package database.

get_dir_list&#40;&#41; is shaving entries off file paths using a regex instead
of File::Spec or File::Basename inside a loop.  The result is a path
like &#34;../dummy-install&#34; as used in the test causes an infinite loop.  It
attempts to guard against this but fails.  It would be much safer to
just split the whole path and iterate through it.

There is a work around.  The special BSD behavior can be turned off by
flipping some environment variables.  PORTOBJFORMAT seems most benign. 
I&#39;ll have the tests run with that when installing.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-991979" href="/Public/Bug/Display.html?id=70232#txn-991979">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;19:02:25&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/991979/516557/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/516557">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 313b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Okie doke, that should do it.  &#34;make test&#34; now passes on FreeBSD 8.2.
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/Perl-Toolchain-Gang/ExtUtils-MakeMaker/commit/eb2dae36fc298ca2a956b829c6256a1f4e1fded1">https://github.com/Perl-Toolchain-Gang/ExtUtils-MakeMaker/commit/eb2dae36fc298ca2a956b829c6256a1f4e1fded1</a></span>

I&#39;ve made that report about BSDPAN upstream.  It&#39;s supposed to be at
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.freebsd.org/cgi/query-pr.cgi?pr=162016">http://www.freebsd.org/cgi/query-pr.cgi?pr=162016</a></span> but it&#39;s not yet.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-991982" href="/Public/Bug/Display.html?id=70232#txn-991982">#</a>      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;25&nbsp;19:02:26&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.647843</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
