<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #105460 for Compress-Raw-Lzma: use of Compress::Raw::Lzma::RawDecoder fails with large amount of data</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #105460 for Compress-Raw-Lzma: use of Compress::Raw::Lzma::RawDecoder fails with large amount of data</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Compress-Raw-Lzma/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Compress-Raw-Lzma/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Compress-Raw-Lzma/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Compress-Raw-Lzma/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Compress-Raw-Lzma">Compress-Raw-Lzma CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">105460</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Compress-Raw-Lzma/Active/">Compress-Raw-Lzma</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
perl_monkey [...] Safe-mail.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230202-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-230203-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.072    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;24&nbsp;04:50:35&nbsp;2015</span>
    <span class="description">perl_monkey [...] Safe-mail.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> use of Compress::Raw::Lzma::RawDecoder fails with large amount of data</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 24 Jun 2015 04:50:21 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Compress-Raw-Lzma [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> perl_monkey [...] Safe-mail.net</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I recently discovered a little problem with a script I&#39;ve developed which uses the Compress::Raw::Lzma::RawEncoder / RawDecoder.
Basically, the problem is that when I compress a &#40;very&#41; large buffer it doesn&#39;t successfully decompress it. Instead I get the error &#34;Data is corrupted&#34;.

I&#39;m going to attach a minimal perl script &#40;simplified version of what I am trying to do&#41; that shows how to reproduce this problem. I am not quite sure yet if I am doing something wrong or not, but it seems to work perfectly with smaller input buffers.
Furthermore, I did try to find some hints if there are some limits or if that is a known problem &#40;or other users experienced the same issue&#41; but I didn&#39;t find much. Also playing around with MemLimit, Bufsize and LimitOutput didn&#39;t help at all.

To explain the code &#40;attached&#41;:
when using a small &#40;random&#41; input length to the lzma compression it always work. But after we increase that size/length to about 64k, it most of the time won&#39;t work. If it is much larger than 64k it always fails.
What I mean by &#34;it doesn&#39;t work&#34; is that the perl script isn&#39;t able to compress a &#40;huge&#41; random string and later on decompress it to the original string.

Can you please help me to understand the problem ?
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;05&nbsp;06:04:14&nbsp;2017</span>
    <span class="description">perl_monkey [...] Safe-mail.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [rt.cpan.org #105460] Successfully identified problem and patch proposal</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 5 Jan 2017 06:03:54 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Compress-Raw-Lzma [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> perl_monkey [...] Safe-mail.net</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hey,

after a lot of troubleshooting and debugging it seems that I was able to identify the main cause of the problem reported by me in <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=105460">https://rt.cpan.org/Public/Bug/Display.html?id=105460</a></span> .

I dissected my minimal perl script even further and tried to see when exactly the problems occur and if it is somehow reproduceable/understandable.

I made these changes to the lzma_test.pl script, provided &#40;by me&#41; in the orginal bug report. Diff:

- $status = $lz-&gt;code &#40;$random_input, $compressed_data&#41;;
- $status = $lz-&gt;flush &#40;$compressed_data&#41;;

+ my $temporary_res = &#34;&#34;;
+
+ $status = $lz-&gt;code &#40;$random_input, $compressed_data&#41;;
+ $temporary_res .= $compressed_data;
+
+ $status = $lz-&gt;flush &#40;$compressed_data&#41;;
+ $temporary_res .= $compressed_data;
+ 
+ $compressed_data = $temporary_res;

... and it surprisingly started to work even for larger inputs to the raw encoder.

Then I of course wanted to understand why we need to do so &#40;and why apparently only for large inputs&#41;.

I had a further look at the documentation at <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~pmqs/Compress-Raw-Lzma/lib/Compress/Raw/Lzma.pm">http://search.cpan.org/~pmqs/Compress-Raw-Lzma/lib/Compress/Raw/Lzma.pm</a></span> and of course noticed immediately the &#34;AppendOutput&#34; option &#40;which seemed to be related&#41;.
Furthermore, I saw that for Compress::Raw::Lzma::RawEncoder the default should be true/1 &#40;quote: &#34;Defaults to 1.&#34;&#41;.

I then tried to do a different patch to the original lzma_test.pl script:
- my &#40;$lz, $status&#41; = Compress::Raw::Lzma::RawEncoder-&gt;new;
+ my &#40;$lz, $status&#41; = Compress::Raw::Lzma::RawEncoder-&gt;new &#40;AppendOutput =&gt; 1&#41;;

... and it surprisingly started to work &#40;even without the &#34;$temporary_res&#34; changes above&#41;, even with very large inputs.

So my conclusion now was that the defaults somehow are not correct &#40;or at least do not reflect what the documentation says&#41;. They conflict with each other.

While looking at <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~pmqs/Compress-Raw-Lzma/lib/Compress/Raw/Lzma.pm">http://search.cpan.org/~pmqs/Compress-Raw-Lzma/lib/Compress/Raw/Lzma.pm</a></span> I came accross some further conflicts &#40;i.e. where the documentation does not reflect what the code does&#41;.

The funny thing is that I remember trying all possible options before submitting the bug, but it seems that I didn&#39;t test to specify only the &#34;AppendOutput =&gt; 1&#34; option.
Instead, as far as I remember, I tried to combine some options &#40;like AppendOutput + ForZip etc&#41; and therefore the output still was not as expected/correct.

Here are some other problems that I noticed while reading <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~pmqs/Compress-Raw-Lzma/lib/Compress/Raw/Lzma.pm">http://search.cpan.org/~pmqs/Compress-Raw-Lzma/lib/Compress/Raw/Lzma.pm</a></span> :
- There are no default values listed for Compress::Raw::Lzma::StreamDecoder and Compress::Raw::Lzma::RawDecoder &#40;which in my opinion would be important too&#41;.
- For Compress::Raw::Lzma::AutoDecoder and Compress::Raw::Lzma::AloneDecoder the documentation says MemLimit &#34;Default is unlimited.&#34;, while the code specifies a limit of 128 *1024 *1024

I will attach to this email a patch proposal. It changes the defaults within the code because in my opinion changing the documentation would not really solve the problem.
If instead you think solving the conflict by changing the documentation would be better, I highly suggest that we change the default example.
Most importantly this section:
my &#40;$lz, $status&#41; = new Compress::Raw::Lzma::RawEncoder [OPTS]
        or die &#34;Cannot create lzma object: $status\n&#34;;
    
$status = $lz-&gt;code&#40;$input, $output&#41;;
$status = $lz-&gt;flush&#40;$output&#41;;

... because we now know that this is not correct &#40;especially with the RawEncoder&#41;, because without forcing to set AppendOutput to 1, it will most likely fail &#40;at least with &#34;larger&#34; inputs&#41;.

Furthermore, if we would change only the documentation we must make it very clear that AppendOutput defaults to 0 and we need to add some warnings about not forgetting to save the temporary output to a variable if the whole output is expected to be within the &#34;output&#34;.

Since it is very likely that the users will make the mistake to forget to set AppendOutput =&gt; 1 or to forget to save the temporary results and &#34;concatenate&#34;/use them, I would suggest that the code fix &#40;see patch&#41; is much more appropriate and safer &#40;I have tested it of course and with the fixes the defaults are correct&#41;.

Thanks
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;08&nbsp;17:57:12&nbsp;2017</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hey,

thanks for the feedback.

My intention was that AppendOutout would default to 0, plus that is what the code actually does, and has been doing for years. Changing the code behavior to match the documentation runs the risk of breaking existing code. 

The fix I will make is to change the documentation to match the code.

Your original code &#40;below&#41; failed  because the call to flush overwrote the data stored in the $compressed_data variable that was populated by the call to $lz-&gt;code.

$status = $lz-&gt;code &#40;$random_input, $compressed_data&#41;;
$status = $lz-&gt;flush &#40;$compressed_data&#41;;

cheers
Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;08&nbsp;17:57:12&nbsp;2017</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;08&nbsp;17:57:17&nbsp;2017</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;10&nbsp;09:28:40&nbsp;2017</span>
    <span class="description">PERLMONKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hey Paul,

thanks for the reply... didn&#39;t honestly expect a reply that quickly! ;&#41;

I&#39;m just kiding... but I must honestly say I was desperately searching for a solution for this problem &#40;since 2015!&#41; and it seemed like &#40;and I think it really was the case that&#41; nobody could help me &#40;didn&#39;t receive a reply here, nobody could help me on various perl-related IRC channels, I even tried to email you directly... but without success&#41;.

That is also what makes me wondering... did you see the issue/problem in the past but you too were unsure what the problem could be ?
If that was the case, it would suggest that it is somehow non-intuitive that we need to temporarily store the intermediate results etc... and finally it would mean that my code &#40;also through your eyes&#41; looked perfectly fine and it didn&#39;t trigger an alert &#40;about the AppenOutput problem&#41;.

What I am trying to say is, that I still think that it is non-intuitive that AppendOutput defaults to 0 for all Encoders.

On the other side, I see your point about the risk of breaking perl scripts that are in the wild &#40;on the other hand... one could also discuss that maybe some of them are exactly having the same problem like I did and maybe just the authors didn&#39;t test them well enough. I instead, tested my code and that was the reason that I found this problem. But I guess not everybody would notice the problem immediately if the scripts were not tested carefully with various amount of data and especially very large random data!&#41;.
So one could in theory also speculate that by fixing the code &#40;instead of the documentation&#41; in some cases it would even fix those perl scripts &#40;instead of breaking them&#41;. I&#39;m not sure about the exact number of scripts that are broken &#40;because they forgot to set AppendOutput =&gt; 1&#41;, nor the exact number of scripts that do store the intermediate results &#40;or who force to set AppendOutput =&gt; 1&#41;. I have the feeling that many users &#40;of course me included&#41; who use this module would indeed take it for granted that the documentation matches the code and that AppendOutput always was set to 1.

Having that exact number would probably help to understand which fix would be better &#40;code fix or documentation fix?&#41;.

I can perfectly deal with your decision to &#34;never break existing code&#34; &#40;again: not sure if by &#34;fixing&#34; the code to suit the &#34;old&#34; documentation would do more harm than good or vice-versa&#41;.

What I really ask &#40;beg? ;&#41; &#41; you to do is to change the documentation in a way that it will deal with all these following points:
1. Fix the SYNOPSIS section and all examples within the documentation to make it clear that one needs to either store the output of both code &#40;&#41; and flush &#40;&#41; or specify AppendOutput =&gt; 1
2. Add a paragraph to the documentation explaining what code &#40;&#41; and flush &#40;&#41; do and why one needs to either store the result of both or specify AppendOutput =&gt; 1 for ALL encoders. Aka warn the user that for large inputs the overall output of LZMA is the concatenation of the results of code &#40;&#41; and flush &#40;&#41; and that the users of this modules should make sure to not forget that flush &#40;&#41; might override the variable &#40;if only a single variable was used&#41; if AppendOutput was not set to 1.
3. Whenever the AppendOutput option is explained &#40;i.e. where we find this sub string: &#34;AppendOutput =&gt; 0|1&#34;&#41; in the documentation, clearly state that one either needs to force AppendOutput to 1 or &#34;externally&#34; deal with the intermediate results &#40;and concatenate them to have the whole compressed data&#41;... this is the case for ALL encoders.
4. Add an easy noticeable note &#40;highlighted at the top?&#41; to the documentation &#40;and maybe to other files too, like the &#34;Changes&#34; file&#41; to make it clear that the documentation changed with version &gt; 2.071 and what those changes imply &#40;and maybe also explain that some older perl scripts which &#34;forgot&#34; to set AppendOutput to 1 may be broken&#41;. Essentially, add a warning messages that some scripts that were implemented with older versions &#40;&lt; 2.071&#41; might be broken or could return unexpected results.

For #1 I suggest to include this extended and fixed example:
SYNOPSIS
...
  # AppendOutput defaults to 0
  my &#40;$lz, $status&#41; = new Compress::Raw::Lzma::RawEncoder
   or die &#34;Cannot create lzma object: $status\n&#34;;
    
  $status = $lz-&gt;code&#40;$input, $output_code_part&#41;;

  # ...
  # use the intermediate encoder&#39;s output stored in $output_code_part
  # ...

  $status = $lz-&gt;flush&#40;$output_flush_part&#41;;

  # ...
  # use the second/final part of the encoder&#39;s output
  # Note: the concatenation of $output_code_part and $output_flush_part is equal to the full output of the LZMA encoder
  # ...

  # same example with concatenation of the intermediate outputs within this script
  my &#40;$lz, $status&#41; = new Compress::Raw::Lzma::RawEncoder
   or die &#34;Cannot create lzma object: $status\n&#34;;
    
  $status = $lz-&gt;code&#40;$input, $output_code_part&#41;;
  $status = $lz-&gt;flush&#40;$output_flush_part&#41;;

  my $output = $output_code_part . $output_flush_part;

  # same example with AppendOutput set to 1 &#40;AppendOutput defaults to 0&#41;
  my &#40;$lz, $status&#41; = new Compress::Raw::Lzma::RawEncoder &#40;AppendOutput =&gt; 1&#41;
   or die &#34;Cannot create lzma object: $status\n&#34;;
    
  $status = $lz-&gt;code&#40;$input, $output&#41;;
  $status = $lz-&gt;flush&#40;$output&#41;;
...

Thank you again Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;15&nbsp;14:13:30&nbsp;2017</span>
    <span class="description">pmqs [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the feedback. I will add more documentation to cover AppendOutput.

cheers
Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;10&nbsp;19:03:25&nbsp;2017</span>
    <span class="description">pmqs [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;10&nbsp;19:03:26&nbsp;2017</span>
    <span class="description">pmqs [...] cpan.org -  Fixed in 2.072 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
