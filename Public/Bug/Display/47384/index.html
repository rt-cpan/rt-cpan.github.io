<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #47384 for DBIx-Class-Schema-Loader: POD generation</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #47384 for DBIx-Class-Schema-Loader: POD generation</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/DBIx-Class-Schema-Loader/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBIx-Class-Schema-Loader">DBIx-Class-Schema-Loader CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">47384</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/DBIx-Class-Schema-Loader/Active/">DBIx-Class-Schema-Loader</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rmb32 [...] cornell.edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-38270-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38271-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;27&nbsp;00:59:26&nbsp;2009</span>
    <span class="description">rmb32 [...] cornell.edu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> POD generation</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Generated classes need POD.

Bare minimum:
- class name
- list of db columns in the module

Really good to have:
- any embedded documentation that the DB backend supports, such as table
comments, column comments, etc.


POD becomes really important when your DB layer has hundreds of tables.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;27&nbsp;01:11:39&nbsp;2009</span>
    <span class="description">rmb32 [...] cornell.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oh, also need to have table and schema name in that bare minimum list.

Bare minimum:
 - class name
 - table name &#40;with schema if used by backend&#41;
 - list of db columns in the module
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;27&nbsp;01:11:43&nbsp;2009</span>
    <span class="description">rmb32 [...] cornell.edu -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;11&nbsp;15:24:32&nbsp;2009</span>
    <span class="description">andrey [...] kostenko.name -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve made it for our projects.

Generates NAME, ACCESSORS, RELATIONSHIPS, for postgresql can import
comments for table

TODO: import comments for accessors
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: t/23dumpmore.t
===================================================================
--- t/23dumpmore.t	&#40;revision 7854&#41;
+++ t/23dumpmore.t	&#40;working copy&#41;
@@ -142,11 +142,15 @@
         ],
         Foo =&gt; [
             qr/package DBICTest::DumpMore::1::Foo;/,
+            qr/=head1 NAME/,
+            qr/=head1 ACCESSORS/,
             qr/-&gt;set_primary_key/,
             qr/1;\n$/,
         ],
         Bar =&gt; [
             qr/package DBICTest::DumpMore::1::Bar;/,
+            qr/=head1 NAME/,
+            qr/=head1 ACCESSORS/,
             qr/-&gt;set_primary_key/,
             qr/1;\n$/,
         ],
Index: lib/DBIx/Class/Schema/Loader/Base.pm
===================================================================
--- lib/DBIx/Class/Schema/Loader/Base.pm	&#40;revision 7854&#41;
+++ lib/DBIx/Class/Schema/Loader/Base.pm	&#40;working copy&#41;
@@ -852,15 +852,53 @@
     my $self = shift;
     my $class = shift;
     my $method = shift;
-
+    if &#40; $method eq &#39;table&#39; &#41; {
+        my &#40;$table&#41; = @_;
+        $self-&gt;_pod&#40; $class, &#34;=head1 NAME&#34; &#41;;
+        my $table_descr = $class;
+        if &#40; $self-&gt;can&#40;&#39;_table_comment&#39;&#41; &#41; {
+            my $comment = $self-&gt;_table_comment&#40;$table&#41;;
+            $table_descr .= &#34; - &#34; . $comment if $comment;
+        }
+        $self-&gt;_pod&#40; $class, $table_descr &#41;;
+        $self-&gt;_pod_cut&#40; $class &#41;;
+    } elsif &#40; $method eq &#39;add_columns&#39; &#41; {
+        my %columns = @_;
+        $self-&gt;_pod&#40; $class, &#34;=head1 ACCESSORS&#34; &#41;;
+        foreach &#40; keys %columns &#41; {
+            $self-&gt;_pod&#40; $class, &#39;=head2 &#39; . $_  &#41;;
+        }
+        $self-&gt;_pod_cut&#40; $class &#41;;
+    } elsif &#40; $method =~ /^&#40;belongs_to|has_many|might_have&#41;$/ &#41; {
+        $self-&gt;_pod&#40; $class, &#34;=head1 RELATIONS&#34; &#41; unless $self-&gt;{_relations_started} { $class } ;
+        my &#40; $accessor, $rel_class &#41; = @_;
+        $self-&gt;_pod&#40; $class, &#34;=head2 $accessor&#34; &#41;;
+        $self-&gt;_pod&#40; $class, &#39;Type: &#39; . $method &#41;;
+        $self-&gt;_pod&#40; $class, &#34;Related object: L&lt;$rel_class&gt;&#34; &#41;;
+        $self-&gt;_pod_cut&#40; $class &#41;;
+        $self-&gt;{_relations_started} { $class } = 1;
+    }
     my $args = dump&#40;@_&#41;;
     $args = &#39;&#40;&#39; . $args . &#39;&#41;&#39; if @_ &lt; 2;
     my $stmt = $method . $args . q{;};
 
     warn qq|$class\-&gt;$stmt\n| if $self-&gt;debug;
     $self-&gt;_raw_stmt&#40;$class, &#39;__PACKAGE__-&gt;&#39; . $stmt&#41;;
+    return;
+}
+
+# Stores a POD documentation
+sub _pod {
+    my &#40;$self, $class, $stmt&#41; = @_;
+    $self-&gt;_raw_stmt&#40; $class, &#34;\n&#34; . $stmt  &#41;;
+}
+
+sub _pod_cut {
+    my &#40;$self, $class &#41; = @_;
+    $self-&gt;_raw_stmt&#40; $class, &#34;\n=cut\n&#34; &#41;;
 }
 
+
 # Store a raw source line for a class &#40;for dumping purposes&#41;
 sub _raw_stmt {
     my &#40;$self, $class, $stmt&#41; = @_;
Index: lib/DBIx/Class/Schema/Loader/DBI/Pg.pm
===================================================================
--- lib/DBIx/Class/Schema/Loader/DBI/Pg.pm	&#40;revision 7854&#41;
+++ lib/DBIx/Class/Schema/Loader/DBI/Pg.pm	&#40;working copy&#41;
@@ -95,6 +95,18 @@
     return \@uniqs;
 }
 
+sub _table_comment {
+    my &#40; $self, $table &#41; = @_;
+     my &#40;$table_oid, $table_comment&#41; = $self-&gt;schema-&gt;storage-&gt;dbh-&gt;selectrow_array&#40;
+        q{SELECT oid,obj_description&#40;oid&#41; 
+            FROM pg_class 
+            WHERE relname=? AND relnamespace=&#40;
+                SELECT oid FROM pg_namespace WHERE nspname=?&#41;
+        }, undef, $table, $self-&gt;db_schema
+        &#41;;   
+    return $table_comment
+}
+
 sub _extra_column_info {
     my &#40;$self, $info&#41; = @_;
     my %extra_info;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;17&nbsp;09:45:31&nbsp;2009</span>
    <span class="description">andrey [...] kostenko.name -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">this patch handles also attributes with comments. Please, include it
into current svn branch, or tell me, why it is not acceptable.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: t/23dumpmore.t
===================================================================
--- t/23dumpmore.t	&#40;revision 7921&#41;
+++ t/23dumpmore.t	&#40;working copy&#41;
@@ -8,7 +8,7 @@
 
 $^O eq &#39;MSWin32&#39;
     ? plan&#40;skip_all =&gt; &#34;ActiveState perl produces additional warnings, and this test uses unix paths&#34;&#41;
-    : plan&#40;tests =&gt; 145&#41;;
+    : plan&#40;tests =&gt; 153&#41;;
 
 my $DUMP_PATH = &#39;./t/_dump&#39;;
 
@@ -142,11 +142,15 @@
         ],
         Foo =&gt; [
             qr/package DBICTest::DumpMore::1::Foo;/,
+            qr/=head1 NAME/,
+            qr/=head1 ACCESSORS/,
             qr/-&gt;set_primary_key/,
             qr/1;\n$/,
         ],
         Bar =&gt; [
             qr/package DBICTest::DumpMore::1::Bar;/,
+            qr/=head1 NAME/,
+            qr/=head1 ACCESSORS/,
             qr/-&gt;set_primary_key/,
             qr/1;\n$/,
         ],
Index: lib/DBIx/Class/Schema/Loader/Base.pm
===================================================================
--- lib/DBIx/Class/Schema/Loader/Base.pm	&#40;revision 7921&#41;
+++ lib/DBIx/Class/Schema/Loader/Base.pm	&#40;working copy&#41;
@@ -852,15 +852,59 @@
     my $self = shift;
     my $class = shift;
     my $method = shift;
-
+    if &#40; $method eq &#39;table&#39; &#41; {
+        my &#40;$table&#41; = @_;
+        $self-&gt;_pod&#40; $class, &#34;=head1 NAME&#34; &#41;;
+        my $table_descr = $class;
+        if &#40; $self-&gt;can&#40;&#39;_table_comment&#39;&#41; &#41; {
+            my $comment = $self-&gt;_table_comment&#40;$table&#41;;
+            $table_descr .= &#34; - &#34; . $comment if $comment;
+        }
+        $self-&gt;{_class2table}{ $class } = $table;
+        $self-&gt;_pod&#40; $class, $table_descr &#41;;
+        $self-&gt;_pod_cut&#40; $class &#41;;
+    } elsif &#40; $method eq &#39;add_columns&#39; &#41; {
+        $self-&gt;_pod&#40; $class, &#34;=head1 ACCESSORS&#34; &#41;;
+        my $i = 0;
+        foreach &#40; @_ &#41; {
+            $i++;
+            next unless $i % 2;
+            $self-&gt;_pod&#40; $class, &#39;=head2 &#39; . $_  &#41;;
+            my $comment;
+            $comment = $self-&gt;_column_comment&#40; $self-&gt;{_class2table}{$class}, &#40;$i - 1&#41; / 2 + 1  &#41; if $self-&gt;can&#40;&#39;_column_comment&#39;&#41;;
+            $self-&gt;_pod&#40; $class, $comment &#41; if $comment;
+        }
+        $self-&gt;_pod_cut&#40; $class &#41;;
+    } elsif &#40; $method =~ /^&#40;belongs_to|has_many|might_have&#41;$/ &#41; {
+        $self-&gt;_pod&#40; $class, &#34;=head1 RELATIONS&#34; &#41; unless $self-&gt;{_relations_started} { $class } ;
+        my &#40; $accessor, $rel_class &#41; = @_;
+        $self-&gt;_pod&#40; $class, &#34;=head2 $accessor&#34; &#41;;
+        $self-&gt;_pod&#40; $class, &#39;Type: &#39; . $method &#41;;
+        $self-&gt;_pod&#40; $class, &#34;Related object: L&lt;$rel_class&gt;&#34; &#41;;
+        $self-&gt;_pod_cut&#40; $class &#41;;
+        $self-&gt;{_relations_started} { $class } = 1;
+    }
     my $args = dump&#40;@_&#41;;
     $args = &#39;&#40;&#39; . $args . &#39;&#41;&#39; if @_ &lt; 2;
     my $stmt = $method . $args . q{;};
 
     warn qq|$class\-&gt;$stmt\n| if $self-&gt;debug;
     $self-&gt;_raw_stmt&#40;$class, &#39;__PACKAGE__-&gt;&#39; . $stmt&#41;;
+    return;
+}
+
+# Stores a POD documentation
+sub _pod {
+    my &#40;$self, $class, $stmt&#41; = @_;
+    $self-&gt;_raw_stmt&#40; $class, &#34;\n&#34; . $stmt  &#41;;
+}
+
+sub _pod_cut {
+    my &#40;$self, $class &#41; = @_;
+    $self-&gt;_raw_stmt&#40; $class, &#34;\n=cut\n&#34; &#41;;
 }
 
+
 # Store a raw source line for a class &#40;for dumping purposes&#41;
 sub _raw_stmt {
     my &#40;$self, $class, $stmt&#41; = @_;
Index: lib/DBIx/Class/Schema/Loader/DBI/Pg.pm
===================================================================
--- lib/DBIx/Class/Schema/Loader/DBI/Pg.pm	&#40;revision 7921&#41;
+++ lib/DBIx/Class/Schema/Loader/DBI/Pg.pm	&#40;working copy&#41;
@@ -35,6 +35,7 @@
     $self-&gt;{db_schema} ||= &#39;public&#39;;
 }
 
+
 sub _table_uniq_info {
     my &#40;$self, $table&#41; = @_;
 
@@ -95,6 +96,32 @@
     return \@uniqs;
 }
 
+sub _table_comment {
+    my &#40; $self, $table &#41; = @_;
+     my &#40;$table_comment&#41; = $self-&gt;schema-&gt;storage-&gt;dbh-&gt;selectrow_array&#40;
+        q{SELECT obj_description&#40;oid&#41; 
+            FROM pg_class 
+            WHERE relname=? AND relnamespace=&#40;
+                SELECT oid FROM pg_namespace WHERE nspname=?&#41;
+        }, undef, $table, $self-&gt;db_schema
+        &#41;;   
+    return $table_comment
+}
+
+
+sub _column_comment {
+    my &#40; $self, $table, $column_number &#41; = @_;
+     my &#40;$table_oid&#41; = $self-&gt;schema-&gt;storage-&gt;dbh-&gt;selectrow_array&#40;
+        q{SELECT oid
+            FROM pg_class 
+            WHERE relname=? AND relnamespace=&#40;
+                SELECT oid FROM pg_namespace WHERE nspname=?&#41;
+        }, undef, $table, $self-&gt;db_schema
+        &#41;;   
+    return $self-&gt;schema-&gt;storage-&gt;dbh-&gt;selectrow_array&#40;&#39;SELECT col_description&#40;?,?&#41;&#39;, undef, $table_oid,
+    $column_number &#41;;
+}
+
 sub _extra_column_info {
     my &#40;$self, $info&#41; = @_;
     my %extra_info;
Index: lib/DBIx/Class/Schema/Loader/DBI/Writing.pm
===================================================================
--- lib/DBIx/Class/Schema/Loader/DBI/Writing.pm	&#40;revision 7921&#41;
+++ lib/DBIx/Class/Schema/Loader/DBI/Writing.pm	&#40;working copy&#41;
@@ -40,6 +40,16 @@
       # concatenated if you wish.
   }
 
+  sub _table_comment {
+      my &#40; $self, $table &#41; = @_;
+      return &#39;Comment&#39;;
+  }
+
+  sub _column_comment {
+      my &#40; $self, $table, $column_number &#41; = @_;
+      return &#39;Col. comment&#39;;
+  }
+
   1;
 
 =head1 DETAILS
@@ -55,6 +65,9 @@
 C&lt;_tables_list&gt; and C&lt;_extra_column_info&gt;.  See the included DBD drivers
 for examples of these.
 
+To import comments from database you need to implement C&lt;_table_comment&gt;,
+C&lt;_column_comment&gt;
+
 =cut
 
 1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;29&nbsp;13:24:51&nbsp;2009</span>
    <span class="description">rkitover [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Appplied GUGU&#39;s patch, with extra tests for Pg.

Need implementations of _table_comment and _column_comment for more
backends before this ticket can be closed. &#40;oracle, db2, mssql...&#41;

With extra tests covering them of course.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;13:38:37&nbsp;2010</span>
    <span class="description">rmb32 [...] cornell.edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I added POD for the details of each column as well.  POD looks good to
me.  Closing.

Now we just need to actually push an official release.  What still needs
to be done?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;20&nbsp;13:38:39&nbsp;2010</span>
    <span class="description">rmb32 [...] cornell.edu -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
