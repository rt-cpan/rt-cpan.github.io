<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #31050 for Audio-MPD: man page is misleading about connection caching</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #31050 for Audio-MPD: man page is misleading about connection caching</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Audio-MPD/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Audio-MPD/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Audio-MPD/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Audio-MPD/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Audio-MPD">Audio-MPD CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">31050</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Audio-MPD/Active/">Audio-MPD</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">jquelin [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
joey [...] kitenet.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-3050-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.18.2    </td>
  </tr>
  <tr id="CF-3051-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




signature.asc<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/388530/178446/signature.asc">
Thu Nov 29 13:27:54 2007 (189b) by joey [...] kitenet.net
</a>
</font></li>


<li><font size="-2">
<a href="/Ticket/Attachment/388501/178421/signature.asc">
Thu Nov 29 11:54:50 2007 (189b) by joey [...] kitenet.net
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;28&nbsp;23:28:34&nbsp;2007</span>
    <span class="description">joey [...] kitenet.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> man page is misleading about connection caching</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Since the man page says &#34;A connection to the MPD server is established
as soon as a new Audio::MPD object is created.Commands are then sent to
the server as the class’s methods are called.&#34; -- I got the impression
that one connection is used for the whole session for the object. I was
saddened to find that this isn&#39;t true, and that my programs are, as a
consequence, rather slow.

Is this planned to be fixed? Should I use the POE module instead?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;10:21:50&nbsp;2007</span>
    <span class="description">jquelin [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Mer. Nov. 28 23:28:34 2007, JOEY a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Since the man page says &#34;A connection to the MPD server is established
&gt; as soon as a new Audio::MPD object is created.Commands are then sent
&gt; to the server as the class’s methods are called.&#34;
</div>
humm no, the module opens a new connection for each command issued.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I got the impression that one connection is used for the whole 
&gt; session for the object. I was saddened to find that this isn&#39;t true,
&gt; and that my programs are, as a consequence, rather slow.
</div>
my mistake, it&#39;s some remaining stuff from the original module that i
inherited when i took over ownership.

the original code was doing that, but:
 - it was buggy as hell, checking for timeouts but resulting in endless
loops
 - network connections were not correctly monitored / reset / checked / etc.

i therefore dumped this scheme for the safer &#40;but slower&#41; scheme:
    one connection per command

i *know* it sucks, but network programming is a pita to do correctly.

in the same time, i decided to try to write a poe module that would be
better networking-wise, since poe would manage all the non-blocking
socket i/o for me...

&#40;for the records, check
<span class="clickylink"><a target="new" rel="nofollow" href="http://groups.google.fr/group/audio-mpd/browse_frm/thread/2a738cd980793cb0#de40453995def4ed">http://groups.google.fr/group/audio-mpd/browse_frm/thread/2a738cd980793cb0#de40453995def4ed</a></span>
for the discussion of this change. there are some references to parts of
the old code, but...&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Is this planned to be fixed? 
</div>
i&#39;m going to fix the documentation. not sure that releasing a 0.18.4
version is worth it - what do you think?

regarding fixing the code: i&#39;m not sure i want to go down that road.
would you be interested to supply some patches to fix it? :-&#41;
&#40;note that i cleaned up the code to always call the _send_command&#40;&#41;
method, therefore changing the connection scheme &#34;only&#34; means changing
this method&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Should I use the POE module instead?
</div>
the poe module is indeed better for this: it keeps a connection open to
the mpd server, and it reconnects automatically if somehow deconnected.

having said that, please note that the poe module design is not
finished. i&#39;m not satisfied by its current api / internals, and i guess
it might change in future releases. &#40;it&#39;s mostly my fault, since it was
the first poe programming that i&#39;ve did&#41;

however, if you are:
  - concerned by network latencies implied by audio::mpd &#40;are you
accessing a remote server? then how do you listen to the music? via some
icecast?&#41;
  - ready to adapt to future api changes,
  - ready to change your program to be poe-aware &#40;it&#39;s a nice framework btw&#41;

==&gt;  the poe module is definitely the module you want to look at.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;10:21:53&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;11:54:50&nbsp;2007</span>
    <span class="description">joey [...] kitenet.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31050] man page is misleading about connection caching</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Nov 2007 11:54:10 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Jerome Quelin via RT &lt;bug-Audio-MPD [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Joey Hess &lt;joey [...] kitenet.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/388501/178421/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 189b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Jerome Quelin wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; my mistake, it&#39;s some remaining stuff from the original module that i
&gt; inherited when i took over ownership.
&gt; 
&gt; the original code was doing that, but:
&gt;  - it was buggy as hell, checking for timeouts but resulting in endless
&gt; loops
&gt;  - network connections were not correctly monitored / reset / checked / etc.
&gt; 
&gt; i therefore dumped this scheme for the safer &#40;but slower&#41; scheme:
&gt;     one connection per command
&gt; 
&gt; i *know* it sucks, but network programming is a pita to do correctly.
&gt; 
&gt; in the same time, i decided to try to write a poe module that would be
&gt; better networking-wise, since poe would manage all the non-blocking
&gt; socket i/o for me...
&gt; 
&gt; &#40;for the records, check
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://groups.google.fr/group/audio-mpd/browse_frm/thread/2a738cd980793cb0#de40453995def4ed">http://groups.google.fr/group/audio-mpd/browse_frm/thread/2a738cd980793cb0#de40453995def4ed</a></span>
&gt; for the discussion of this change. there are some references to parts of
&gt; the old code, but...&#41;
</div>
Something not mentioned in that thread is that every potential hang
mentioned there still exists in Audio::MPD. If the server crashes in
between it sending the password line and it sending the command, the
client will still hang, for example.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Is this planned to be fixed? 
</div>&gt; 
&gt; i&#39;m going to fix the documentation. not sure that releasing a 0.18.4
&gt; version is worth it - what do you think?
</div>
Well, I might have skipped over trying the module if its docs had said
it needed one connection per command.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; regarding fixing the code: i&#39;m not sure i want to go down that road.
&gt; would you be interested to supply some patches to fix it? :-&#41;
&gt; &#40;note that i cleaned up the code to always call the _send_command&#40;&#41;
&gt; method, therefore changing the connection scheme &#34;only&#34; means changing
&gt; this method&#41;
</div>
Well, it seems to me that you could add a flag that enables
an unsafe mode where one connection is reused, and if the server
times out/goes away/connection is dropped, the client is on its
own to notice this and avoid hanging. Or on its own to let it hang.
For certian types of clients, it doesn&#39;t really matter if they don&#39;t
deal gracefully with issues with the connection. For some others, it&#39;s
easy enough to set up an alarm and abort or retry.

IO::Socket::INET also has some options that can be used for simple
handling of timeouts, for some programs it might be enough for them to
get at and tune those options for their use cases.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Should I use the POE module instead?
</div>&gt; 
&gt; the poe module is indeed better for this: it keeps a connection open to
&gt; the mpd server, and it reconnects automatically if somehow deconnected.
&gt; 
&gt; having said that, please note that the poe module design is not
&gt; finished. i&#39;m not satisfied by its current api / internals, and i guess
&gt; it might change in future releases. &#40;it&#39;s mostly my fault, since it was
&gt; the first poe programming that i&#39;ve did&#41;
</div>
I looked at it, but it seemed much more difficult to program for if I
want to do a simple client that runs some scripted set of commands.
Maybe there&#39;s an easy way to do that that I didn&#39;t see, I am not really
familiar with POE.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; however, if you are:
&gt;   - concerned by network latencies implied by audio::mpd &#40;are you
&gt; accessing a remote server? then how do you listen to the music? via some
&gt; icecast?&#41;
</div>
The particular cases where multiple connections annoyed me were 

a&#41; Writing a program to copy the state of one mpd to another,
   I wanted to seek them to the same play position as closely as possible,
   and this works less well than I&#39;d have hoped since it has to open 
   a new connection to each, rather than using an existing open
   connection, which would be much faster.
b&#41; Writing a program to reverse the playlist, which involved a lot of
   move operations, and this is where I really noticed it was
   reconnecting per command, since the program is unusable with any
   sizable playlist.

FWIW, my current set of code using Audio::MPD is at
git://git.kitenet.net/mpdtoys

-- 
see shy jo
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/388501/178420/">Download &#40;untitled&#41;</a><br />
<span class="downloadcontenttype">application/x- 2.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;12:46:20&nbsp;2007</span>
    <span class="description">jquelin [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Jeu. Nov. 29 11:54:50 2007, JOEY a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Jerome Quelin wrote:
<div class="message-stanza open">&gt; &gt; &#40;for the records, check
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://groups.google.fr/group/audio-">http://groups.google.fr/group/audio-</a></span>
</div>&gt; mpd/browse_frm/thread/2a738cd980793cb0#de40453995def4ed
<div class="message-stanza open">&gt; &gt; for the discussion of this change. there are some references to
</div>&gt; parts of
<div class="message-stanza open">&gt; &gt; the old code, but...&#41;
</div>&gt; 
&gt; Something not mentioned in that thread is that every potential hang
&gt; mentioned there still exists in Audio::MPD. If the server crashes in
&gt; between it sending the password line and it sending the command, the
&gt; client will still hang, for example.
</div>
yup it is:
&#34;and it does not even protect us from problems appearing between write &#38;
read.&#34;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Is this planned to be fixed?
</div>&gt; &gt;
&gt; &gt; i&#39;m going to fix the documentation. not sure that releasing a 0.18.4
&gt; &gt; version is worth it - what do you think?
</div>&gt; 
&gt; Well, I might have skipped over trying the module if its docs had said
&gt; it needed one connection per command.
</div>
and you would have missed my great piece of software! :-&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; regarding fixing the code: i&#39;m not sure i want to go down that road.
&gt; &gt; would you be interested to supply some patches to fix it? :-&#41;
&gt; &gt; &#40;note that i cleaned up the code to always call the _send_command&#40;&#41;
&gt; &gt; method, therefore changing the connection scheme &#34;only&#34; means
</div>&gt; changing
<div class="message-stanza open">&gt; &gt; this method&#41;
</div>&gt; 
&gt; Well, it seems to me that you could add a flag that enables
&gt; an unsafe mode where one connection is reused, and if the server
&gt; times out/goes away/connection is dropped, the client is on its
&gt; own to notice this and avoid hanging. Or on its own to let it hang.
</div>
that&#39;s an interesting proposition. i&#39;ll implement it.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; b&#41; Writing a program to reverse the playlist, which involved a lot of
&gt;    move operations, and this is where I really noticed it was
&gt;    reconnecting per command, since the program is unusable with any
&gt;    sizable playlist.
</div>
uh, this one is easy: get playlist with as_items, reverse it, clear the
playlist, and add the reversed playlist.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; FWIW, my current set of code using Audio::MPD is at
&gt; git://git.kitenet.net/mpdtoys
</div>
i really need to learn a bit git. 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;12:46:27&nbsp;2007</span>
    <span class="description">jquelin [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;13:27:53&nbsp;2007</span>
    <span class="description">joey [...] kitenet.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #31050] man page is misleading about connection caching</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 29 Nov 2007 13:26:56 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Jerome Quelin via RT &lt;bug-Audio-MPD [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Joey Hess &lt;joey [...] kitenet.net&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Jerome Quelin:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Well, it seems to me that you could add a flag that enables
&gt; &gt; an unsafe mode where one connection is reused, and if the server
&gt; &gt; times out/goes away/connection is dropped, the client is on its
&gt; &gt; own to notice this and avoid hanging. Or on its own to let it hang.
</div>&gt; 
&gt; that&#39;s an interesting proposition. i&#39;ll implement it.
</div>
Thanks!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; uh, this one is easy: get playlist with as_items, reverse it, clear the
&gt; playlist, and add the reversed playlist.
</div>
Well, clearing the playlist stops the current song playing, I reversed
the playlist around the current song so it kept going..

-- 
see shy jo
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/388530/178446/signature.asc">Download signature.asc</a><br />
<span class="downloadcontenttype">application/pgp-signature 189b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;14:26:34&nbsp;2007</span>
    <span class="description">jquelin [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">0.19.0 on its way to cpan, allowing to change connection way of working.

note that constructor api has changed:
my $mpd = Audio::MPD-&gt;new&#40;
  host=&gt;$h, port=&gt;$p, password=&gt;$pw,
  conntype=&gt;$t
&#41;;

where conntype can be either $REUSE or $ONCE &#40;the default&#41;.

marking bug corrected.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;29&nbsp;14:26:39&nbsp;2007</span>
    <span class="description">jquelin [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
