<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #68718 for Regexp-Common: url obfuscation</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #68718 for Regexp-Common: url obfuscation</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Regexp-Common/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Regexp-Common/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Regexp-Common/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Regexp-Common/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Regexp-Common">Regexp-Common CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">68718</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Regexp-Common/Active/">Regexp-Common</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cpan [...] barely3am.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-27706-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2011041701    </td>
  </tr>
  <tr id="CF-27707-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;09&nbsp;09:34:27&nbsp;2011</span>
    <span class="description">cpan [...] barely3am.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> url obfuscation</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span class="clickylink"><a target="new" rel="nofollow" href="http://www.symantec.com/connect/blogs/dotted-decimal-url-obfuscation">http://www.symantec.com/connect/blogs/dotted-decimal-url-obfuscation</a></span>

Below are some of the IP address numeral system obfuscation techniques Symantec has observed of spammers. &#40;All of the samples below are just different numeral representations of the IP 
address for Symantec.com&#41;

An IP address converted to hexadecimal format. &#40;Hexadecimal is a base-16 numeral system.&#41;

http://0xD80C9114
An IP address converted to dotted hexadecimal format.

http://0xD8.0x0C.0x91.0x14
An IP address converted to dotted octal format. &#40;Octal is a base-8 numeral system.&#41;

<span class="clickylink"><a target="new" rel="nofollow" href="http://0330.0014.0221.0024">http://0330.0014.0221.0024</a></span>
A combination of Hexadecimal and Octal

http://0xd8.000000014.0x9114

{{{

#!/usr/bin/perl -w

use Regexp::Common qw/URI/;

use strict;

my @array = &#40;
  &#39;http://0xD80C9114&#39;,
  &#39;http://0xD8.0x0C.0x91.0x14&#39;,
  &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://0330.0014.0221.0024">http://0330.0014.0221.0024</a></span>&#39;,
  &#39;http://0xd8.000000014.0x9114&#39;
&#41;;

foreach &#40;@array&#41;{
    if&#40;/^$RE{&#39;URI&#39;}/&#41;{
        warn &#39;valid url: &#39;.$_;
    } else {
        warn &#39;invalid url: &#39;.$_;
    }
}
}}}


$ perl url.pl 
invalid url: http://0xD80C9114 at url.pl line 13.
invalid url: http://0xD8.0x0C.0x91.0x14 at url.pl line 13.
valid url: <span class="clickylink"><a target="new" rel="nofollow" href="http://0330.0014.0221.0024">http://0330.0014.0221.0024</a></span> at url.pl line 11.
invalid url: http://0xd8.000000014.0x9114 at url.pl line 13.


I haven&#39;t looked much further than that. just an fyi.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;09&nbsp;09:44:42&nbsp;2011</span>
    <span class="description">abigail [...] abigail.be -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> undisclosed-recipients: ;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #68718] url obfuscation</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 9 Jun 2011 15:45:16 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Wes Young via RT &lt;bug-Regexp-Common [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Abigail &lt;abigail [...] abigail.be&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, Jun 09, 2011 at 09:34:30AM -0400, Wes Young via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Jun 09 09:34:27 2011: Request 68718 was acted upon.
&gt; Transaction: Ticket created by SAXJAZMAN
&gt;        Queue: Regexp-Common
&gt;      Subject: url obfuscation
&gt;    Broken in: 2011041701
&gt;     Severity: Normal
&gt;        Owner: Nobody
&gt;   Requestors: cpan@barely3am.com
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=68718">https://rt.cpan.org/Ticket/Display.html?id=68718</a></span> &gt;
&gt; 
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.symantec.com/connect/blogs/dotted-decimal-url-obfuscation">http://www.symantec.com/connect/blogs/dotted-decimal-url-obfuscation</a></span>
&gt; 
&gt; Below are some of the IP address numeral system obfuscation techniques Symantec has observed of spammers. &#40;All of the samples below are just different numeral representations of the IP 
&gt; address for Symantec.com&#41;
&gt; 
&gt; An IP address converted to hexadecimal format. &#40;Hexadecimal is a base-16 numeral system.&#41;
&gt; 
&gt; http://0xD80C9114
&gt; An IP address converted to dotted hexadecimal format.
&gt; 
&gt; http://0xD8.0x0C.0x91.0x14
&gt; An IP address converted to dotted octal format. &#40;Octal is a base-8 numeral system.&#41;
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://0330.0014.0221.0024">http://0330.0014.0221.0024</a></span>
&gt; A combination of Hexadecimal and Octal
&gt; 
&gt; http://0xd8.000000014.0x9114
&gt; 
&gt; {{{
&gt; 
&gt; #!/usr/bin/perl -w
&gt; 
&gt; use Regexp::Common qw/URI/;
&gt; 
&gt; use strict;
&gt; 
&gt; my @array = &#40;
&gt;   &#39;http://0xD80C9114&#39;,
&gt;   &#39;http://0xD8.0x0C.0x91.0x14&#39;,
&gt;   &#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://0330.0014.0221.0024">http://0330.0014.0221.0024</a></span>&#39;,
&gt;   &#39;http://0xd8.000000014.0x9114&#39;
&gt; &#41;;
&gt; 
&gt; foreach &#40;@array&#41;{
&gt;     if&#40;/^$RE{&#39;URI&#39;}/&#41;{
&gt;         warn &#39;valid url: &#39;.$_;
&gt;     } else {
&gt;         warn &#39;invalid url: &#39;.$_;
&gt;     }
&gt; }
&gt; }}}
&gt; 
&gt; 
&gt; $ perl url.pl 
&gt; invalid url: http://0xD80C9114 at url.pl line 13.
&gt; invalid url: http://0xD8.0x0C.0x91.0x14 at url.pl line 13.
&gt; valid url: <span class="clickylink"><a target="new" rel="nofollow" href="http://0330.0014.0221.0024">http://0330.0014.0221.0024</a></span> at url.pl line 11.
&gt; invalid url: http://0xd8.000000014.0x9114 at url.pl line 13.
&gt; 
</div>

The regexp isn&#39;t designed to exactly match what a particular browser
or tool accepts as a URL, and to catch anything it manages to convert
into an IP address. That browsers are liberal in what they accept
in their navigation bar, or inside a &#34;src&#34; or &#34;href&#34; attribute is a
&#40;valuable!&#41; service to the user. But it would be very hard to reengineer
such a pattern - and you&#39;d need different patterns for different browser.

The pattern matches what the various RFC says is valid. Anything that
cannot be derived from the BNF for HTTP urls will be rejected.


Regards,


Abigail
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;09&nbsp;09:44:44&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;13&nbsp;12:28:43&nbsp;2011</span>
    <span class="description">cpan [...] abigail.be -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
