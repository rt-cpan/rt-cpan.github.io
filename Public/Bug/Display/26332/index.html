<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #26332 for Bio-Phylo: Bio::Phylo::Treedrawer</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #26332 for Bio-Phylo: Bio::Phylo::Treedrawer</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Bio-Phylo/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Bio-Phylo/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Bio-Phylo/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Bio-Phylo/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/rvosa/bio-phylo/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Bio-Phylo">Bio-Phylo CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">26332</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Bio-Phylo/Active/">Bio-Phylo</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
struckma [...] uni-greifswald.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-3770-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-3771-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




smime.p7s<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/309404/140684/smime.p7s">
Fri Apr 13 12:58:07 2007 (6.1k) by struckma [...] uni-greifswald.de
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;13&nbsp;12:58:07&nbsp;2007</span>
    <span class="description">struckma [...] uni-greifswald.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bio::Phylo::Treedrawer</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 13 Apr 2007 18:57:38 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bio-Phylo [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Stephan Struckmann &lt;struckma [...] uni-greifswald.de&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear Bio-Phylo Team

I have two issues that concern using Bio::Phylo via a &#40;Web-&#41;Frontend. If
Treedrawer is called twice, the second SVG unfortunately will always
have wrong y-coordinates:

In Bio::Phylo::Treedrawer you have:

{
    my $tips = 0.000_000_000_000_01;

    sub _y_terminals {
        my $self = shift;
        my $node = $_[0];
        if &#40; !$node-&gt;get_first_daughter &#41; {
            $tips++;
            $node-&gt;set_generic&#40;
                y =&gt; &#40; &#40; $tips * $self-&gt;_get_scaley &#41; +
$self-&gt;get_padding &#41; &#41;;
        }
        else {
            $node = $node-&gt;get_first_daughter;
            $self-&gt;_y_terminals&#40;$node&#41;;
            while &#40; $node-&gt;get_next_sister &#41; {
                $node = $node-&gt;get_next_sister;
                $self-&gt;_y_terminals&#40;$node&#41;;
            }
        }
    }
}

Thus $tips is never reset after the first call of the draw function. I
worked around that by subclassing Treedrawer, but probably Treedrawer
should reset $tips when the Bio::Phylo::Treedrawer::draw routine is
invoked. Thus $tips has to be a class variable not a local.

Some other remarks that may become feature requests, if You like to:

        * A reset routine for IDPool until no real serialization is implemented:

package Bio::Phylo::Util::IDPool;
[...]
    sub _reset {
        $obj_counter = 0 ;
        @reclaim = &#40;&#41; ;
    }
}
1;
__END__

=head1 NAME
[...]

So one could reinitialize the ID counter. If one tries to restore a
session in a web application it becomes possible as long as the objects
are regenerated always in the same order and get_id can be used to
identify e.g. a node the user clicked on.


I also adjusted bioperl&#39;s reroot routine for Bio::Phylo::Tree

package [...] ;

# Rerooting copied from Bioperl:
# Id: TreeFunctionsI.pm,v 1.14 2003/12/15 17:10:29 jason Exp
# Therein rerooting code was worked on by
# Daniel Barker and Ramiro Barrantes
# See
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/src/BIRNEY/bioperl-1.4/Bio/Tree/TreeFunctionsI.pm">http://search.cpan.org/src/BIRNEY/bioperl-1.4/Bio/Tree/TreeFunctionsI.pm</a></span>
# for original code

sub reroot {
    my &#40;$tree, $new_root&#41; = @_;
    unless &#40;defined $new_root &#38;&#38;
$new_root-&gt;isa&#40;&#34;Bio::Phylo::Forest::Node&#34;&#41;&#41; {
                die&#40;&#34;Must provide a valid Bio::Phylo::Forest::Node when rerooting&#34;&#41;;
                return 0;
    }
    if&#40; $new_root-&gt;is_terminal&#40;&#41; &#41; {
                warn&#40;&#34;Asking to root with a leaf, will use the leaf&#39;s ancestor&#34;&#41;;
                $new_root = $new_root-&gt;get_parent;
    }

    my $old_root = $tree-&gt;get_root;
#    print STDERR $new_root -&gt; get_id . &#39;/&#39; . $old_root -&gt; get_id . &#34;\n&#34; ;
    if&#40; $new_root == $old_root &#41; {
                warn&#40;&#34;Node requested for reroot is already the root node!&#34;&#41;;
                return 0;
    }

    my @path = &#40;&#41;;      # along tree, from newroot to oldroot
    my $node = $new_root;
    while &#40;$node&#41; {
                push @path, $node;
                $node = $node-&gt;get_parent;
    }

    my @path_from_oldroot = reverse @path;
    for &#40;my $i = 0; $i &lt; @path_from_oldroot - 1; $i++&#41; {
                my $current = $path_from_oldroot[$i];
                my $next = $path_from_oldroot[$i + 1];
                [...]::remove_Descendent&#40;$current, $next&#41;;
                $current-&gt;set_branch_length&#40;$next-&gt;get_branch_length&#41;;
                $next-&gt;set_child&#40;$current&#41;;
    }

    $new_root-&gt;set_branch_length&#40;undef&#41;;

    return 1;
}

sub remove_Descendent {
# may be substituted by a tree-&gt;_analyze call, but _analyze is not
# documented in the official CPAN documentation
        my $parent = shift ;
        my $child = shift ;
        
        die &#39;Internal error.&#39; unless $child-&gt;get_parent eq $parent ;
        
        $child -&gt; set_parent &#40; &#41; ;

        if &#40;$parent -&gt; get_first_daughter eq $child&#41; {
                $parent -&gt; set_first_daughter&#40; $child -&gt; get_next_sister &#41; ;
        }

        if &#40;$parent -&gt; get_last_daughter eq $child&#41; {
                $parent -&gt; set_last_daughter&#40; $child -&gt; get_previous_sister &#41; ;
        }
        
        if &#40;my $ps = $child -&gt; get_previous_sister&#41; {
                $ps-&gt;set_next_sister&#40;$child-&gt;get_next_sister&#41;;
                $ps-&gt;get_next_sister-&gt;set_previous_sister&#40;$ps&#41; if defined
$ps-&gt;get_next_sister;
                $child-&gt;set_previous_sister&#40;&#41;;
                $child-&gt;set_next_sister&#40;&#41;;
        } elsif &#40;my $ns = $child -&gt; get_next_sister&#41; {
                $ns-&gt;set_previous_sister&#40;$child-&gt;get_previous_sister&#41;;
                $ns-&gt;get_previous_sister-&gt;set_next_sister&#40;$ns&#41; if defined
$ns-&gt;get_previous_sister;
                $child-&gt;set_previous_sister&#40;&#41;;
                $child-&gt;set_next_sister&#40;&#41;;
        }
}

Finally I would like to ask, why the Bio::Phylo::Forest::make_taxa was
removed after revision 0.15? The Mrp unparser would need it yet. But
probably You plan to adjust the unparser accordingly.

So far my remarks. I hope, that you find these helpful. Thank You very
much for your great Phylogeny library,

        Yours sincerely

Stephan Struckmann
struckma@uni-greifswald.de
Germany
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 &#40;MingW32&#41;
Comment: Using GnuPG with Mozilla - <span class="clickylink"><a target="new" rel="nofollow" href="http://enigmail.mozdev.org">http://enigmail.mozdev.org</a></span>

iD8DBQFGH7aC8viug4UfhY8RAvprAJwOxONcitFn+doLsgMGHSPHaKW7KQCeKTKb
4wC3yrHyUQJjQvavEhHd2Dg=
=TSgS
-----END PGP SIGNATURE-----
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/309404/140684/smime.p7s">Download smime.p7s</a><br />
<span class="downloadcontenttype">application/x-pkcs7-signature 6.1k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;11&nbsp;17:40:57&nbsp;2007</span>
    <span class="description">rutgeraldo [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Stephan,

thanks for your remarks! I do actually check these bug reports, but not
that often, apparently.

1. we&#39;re reworking the treedrawer, the issue with the static $tips
variable will be fixed in the next release.

2. the ID reinitialize function is an interesting idea, but ids are used
in many places, accidentally resetting when another object with the same
id still exists would be disastrous. I can see the persistence argument
though, so I&#39;ll give it some thought.

3. a reroot method is definitely a good idea, though I think it should
be a node method &#40;not a tree method, so no argument with checks necessary&#41;.

4. the way links between trees/matrices/taxa are managed has changed
internally &#40;using a mediator&#41;. The complete removal of make_taxa is
frankly a mistake, it should be moved up in the inheritance tree to the
TaxaLinker superclass.

Thanks for your kind words, best wishes,

Rutger Vos

On Fri Apr 13 12:58:07 2007, struckma@uni-greifswald.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; Hash: SHA1
&gt; 
&gt; Dear Bio-Phylo Team
&gt; 
&gt; I have two issues that concern using Bio::Phylo via a &#40;Web-&#41;Frontend. If
&gt; Treedrawer is called twice, the second SVG unfortunately will always
&gt; have wrong y-coordinates:
&gt; 
&gt; In Bio::Phylo::Treedrawer you have:
&gt; 
&gt; {
&gt;     my $tips = 0.000_000_000_000_01;
&gt; 
&gt;     sub _y_terminals {
&gt;         my $self = shift;
&gt;         my $node = $_[0];
&gt;         if &#40; !$node-&gt;get_first_daughter &#41; {
&gt;             $tips++;
&gt;             $node-&gt;set_generic&#40;
&gt;                 y =&gt; &#40; &#40; $tips * $self-&gt;_get_scaley &#41; +
&gt; $self-&gt;get_padding &#41; &#41;;
&gt;         }
&gt;         else {
&gt;             $node = $node-&gt;get_first_daughter;
&gt;             $self-&gt;_y_terminals&#40;$node&#41;;
&gt;             while &#40; $node-&gt;get_next_sister &#41; {
&gt;                 $node = $node-&gt;get_next_sister;
&gt;                 $self-&gt;_y_terminals&#40;$node&#41;;
&gt;             }
&gt;         }
&gt;     }
&gt; }
&gt; 
&gt; Thus $tips is never reset after the first call of the draw function. I
&gt; worked around that by subclassing Treedrawer, but probably Treedrawer
&gt; should reset $tips when the Bio::Phylo::Treedrawer::draw routine is
&gt; invoked. Thus $tips has to be a class variable not a local.
&gt; 
&gt; Some other remarks that may become feature requests, if You like to:
&gt; 
&gt;       * A reset routine for IDPool until no real serialization is implemented:
&gt; 
&gt; package Bio::Phylo::Util::IDPool;
&gt; [...]
&gt;     sub _reset {
&gt;       $obj_counter = 0 ;
&gt;       @reclaim = &#40;&#41; ;
&gt;     }
&gt; }
&gt; 1;
&gt; __END__
&gt; 
&gt; =head1 NAME
&gt; [...]
&gt; 
&gt; So one could reinitialize the ID counter. If one tries to restore a
&gt; session in a web application it becomes possible as long as the objects
&gt; are regenerated always in the same order and get_id can be used to
&gt; identify e.g. a node the user clicked on.
&gt; 
&gt; 
&gt; I also adjusted bioperl&#39;s reroot routine for Bio::Phylo::Tree
&gt; 
&gt; package [...] ;
&gt; 
&gt; # Rerooting copied from Bioperl:
&gt; # Id: TreeFunctionsI.pm,v 1.14 2003/12/15 17:10:29 jason Exp
&gt; # Therein rerooting code was worked on by
&gt; # Daniel Barker and Ramiro Barrantes
&gt; # See
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/src/BIRNEY/bioperl-1.4/Bio/Tree/TreeFunctionsI.pm">http://search.cpan.org/src/BIRNEY/bioperl-1.4/Bio/Tree/TreeFunctionsI.pm</a></span>
&gt; # for original code
&gt; 
&gt; sub reroot {
&gt;     my &#40;$tree, $new_root&#41; = @_;
&gt;     unless &#40;defined $new_root &#38;&#38;
&gt; $new_root-&gt;isa&#40;&#34;Bio::Phylo::Forest::Node&#34;&#41;&#41; {
&gt;               die&#40;&#34;Must provide a valid Bio::Phylo::Forest::Node when rerooting&#34;&#41;;
&gt;               return 0;
&gt;     }
&gt;     if&#40; $new_root-&gt;is_terminal&#40;&#41; &#41; {
&gt;               warn&#40;&#34;Asking to root with a leaf, will use the leaf&#39;s ancestor&#34;&#41;;
&gt;               $new_root = $new_root-&gt;get_parent;
&gt;     }
&gt; 
&gt;     my $old_root = $tree-&gt;get_root;
&gt; #    print STDERR $new_root -&gt; get_id . &#39;/&#39; . $old_root -&gt; get_id . &#34;\n&#34; ;
&gt;     if&#40; $new_root == $old_root &#41; {
&gt;               warn&#40;&#34;Node requested for reroot is already the root node!&#34;&#41;;
&gt;               return 0;
&gt;     }
&gt; 
&gt;     my @path = &#40;&#41;;    # along tree, from newroot to oldroot
&gt;     my $node = $new_root;
&gt;     while &#40;$node&#41; {
&gt;               push @path, $node;
&gt;               $node = $node-&gt;get_parent;
&gt;     }
&gt; 
&gt;     my @path_from_oldroot = reverse @path;
&gt;     for &#40;my $i = 0; $i &lt; @path_from_oldroot - 1; $i++&#41; {
&gt;               my $current = $path_from_oldroot[$i];
&gt;               my $next = $path_from_oldroot[$i + 1];
&gt;               [...]::remove_Descendent&#40;$current, $next&#41;;
&gt;               $current-&gt;set_branch_length&#40;$next-&gt;get_branch_length&#41;;
&gt;               $next-&gt;set_child&#40;$current&#41;;
&gt;     }
&gt; 
&gt;     $new_root-&gt;set_branch_length&#40;undef&#41;;
&gt; 
&gt;     return 1;
&gt; }
&gt; 
&gt; sub remove_Descendent {
&gt; # may be substituted by a tree-&gt;_analyze call, but _analyze is not
&gt; # documented in the official CPAN documentation
&gt;       my $parent = shift ;
&gt;       my $child = shift ;
&gt;       
&gt;       die &#39;Internal error.&#39; unless $child-&gt;get_parent eq $parent ;
&gt;       
&gt;       $child -&gt; set_parent &#40; &#41; ;
&gt; 
&gt;       if &#40;$parent -&gt; get_first_daughter eq $child&#41; {
&gt;               $parent -&gt; set_first_daughter&#40; $child -&gt; get_next_sister &#41; ;
&gt;       }
&gt; 
&gt;       if &#40;$parent -&gt; get_last_daughter eq $child&#41; {
&gt;               $parent -&gt; set_last_daughter&#40; $child -&gt; get_previous_sister &#41; ;
&gt;       }
&gt;       
&gt;       if &#40;my $ps = $child -&gt; get_previous_sister&#41; {
&gt;               $ps-&gt;set_next_sister&#40;$child-&gt;get_next_sister&#41;;
&gt;               $ps-&gt;get_next_sister-&gt;set_previous_sister&#40;$ps&#41; if defined
&gt; $ps-&gt;get_next_sister;
&gt;               $child-&gt;set_previous_sister&#40;&#41;;
&gt;               $child-&gt;set_next_sister&#40;&#41;;
&gt;       } elsif &#40;my $ns = $child -&gt; get_next_sister&#41; {
&gt;               $ns-&gt;set_previous_sister&#40;$child-&gt;get_previous_sister&#41;;
&gt;               $ns-&gt;get_previous_sister-&gt;set_next_sister&#40;$ns&#41; if defined
&gt; $ns-&gt;get_previous_sister;
&gt;               $child-&gt;set_previous_sister&#40;&#41;;
&gt;               $child-&gt;set_next_sister&#40;&#41;;
&gt;       }
&gt; }
&gt; 
&gt; Finally I would like to ask, why the Bio::Phylo::Forest::make_taxa was
&gt; removed after revision 0.15? The Mrp unparser would need it yet. But
&gt; probably You plan to adjust the unparser accordingly.
&gt; 
&gt; So far my remarks. I hope, that you find these helpful. Thank You very
&gt; much for your great Phylogeny library,
&gt; 
&gt;       Yours sincerely
&gt; 
&gt; Stephan Struckmann
&gt; struckma@uni-greifswald.de
&gt; Germany
&gt; -----BEGIN PGP SIGNATURE-----
&gt; Version: GnuPG v1.4.5 &#40;MingW32&#41;
&gt; Comment: Using GnuPG with Mozilla - <span class="clickylink"><a target="new" rel="nofollow" href="http://enigmail.mozdev.org">http://enigmail.mozdev.org</a></span>
&gt; 
&gt; iD8DBQFGH7aC8viug4UfhY8RAvprAJwOxONcitFn+doLsgMGHSPHaKW7KQCeKTKb
&gt; 4wC3yrHyUQJjQvavEhHd2Dg=
&gt; =TSgS
&gt; -----END PGP SIGNATURE-----
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;11&nbsp;17:40:59&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;11&nbsp;21:34:07&nbsp;2007</span>
    <span class="description">rutgeraldo [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The &#39;bad y-coordinates after multiple draws&#39; bug has been fixed, I added
a regression test #26332 to the test suite. I now consider this bug
resolved, the fixed treedrawer will be part of release v.0.17

Best wishes,

Rutger
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;11&nbsp;21:34:14&nbsp;2007</span>
    <span class="description">rutgeraldo [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
