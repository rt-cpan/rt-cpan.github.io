<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #64478 for Bread-Board: depends_on&#40;&#39;../foo&#39;&#41; causes Deep recursion</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #64478 for Bread-Board: depends_on&#40;&#39;../foo&#39;&#41; causes Deep recursion</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Bread-Board/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Bread-Board/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Bread-Board/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Bread-Board/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/stevan/BreadBoard/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Bread-Board">Bread-Board CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">64478</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Bread-Board/Active/">Bread-Board</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">stevan.little [...] gmail.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
hanenkamp [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-220110-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.15    </td>
  </tr>
  <tr id="CF-220111-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;04&nbsp;18:16:00&nbsp;2011</span>
    <span class="description">hanenkamp [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> depends_on&#40;&#39;../foo&#39;&#41; causes Deep recursion</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I don&#39;t think this is a bug, but I do find it counter-intuitive. Consider the following 
Bread::Board:

my $c = container &#39;Star_Wars&#39; =&gt; as {
    service han_solo =&gt; &#39;Shot First&#39;;

    container Mos_Eisley =&gt; as {
        service han_solo =&gt; &#39;Shot Back&#39;;
        service cantina =&gt; &#40;
            block =&gt; sub {
                my $s = shift;
                return {
                    han_solo =&gt; $s-&gt;param&#40;&#39;han_solo&#39;&#41;,
                };
            },
            dependencies =&gt; {
                han_solo =&gt; depends_on&#40;&#39;../../../han_solo&#39;&#41;,
            },
        &#41;;
    };
};

my $cantina = $c-&gt;resolve&#40; service =&gt; &#39;Mos_Eisley/cantina&#39; &#41;;
say &#34;Han Solo $cantina-&gt;{han_solo}&#34;;

This will print the correct string, &#34;Han Solo Shot First&#34; &#40;which we all know is true&#41;. However, 
the line:

                han_solo =&gt; depends_on&#40;&#39;../../../han_solo&#39;&#41;,

seems counter-intuitive.

I would expect:

                han_solo =&gt; depends_on&#40;&#39;han_solo&#39;&#41;,

to give the wrong answer &#34;Han Solo Shot Back&#34; and it does.

I would expect:

                han_solo =&gt; depends_on&#40;&#39;../han_solo&#39;&#41;,

to do what I got with ../../../han_solo, but instead we crash altogether:

Deep recursion on subroutine &#34;Bread::Board::Dependency::is_locked&#34; at 
.../lib/site_perl/5.12.1/darwin-2level/Moose/Meta/Method/Delegation.pm line 108.

I don&#39;t expect ../../han_solo to do anything correctly at all, but:

                han_solo =&gt; depends_on&#40;&#39;../../han_solo&#39;&#41;,

Actually yields &#34;Han Solo Shot Back&#34; which is so wrong and also the same as 
depends_on&#40;&#39;han_solo&#39;&#41; which does seem right.

Now, I understand why each of these is happening, because the dependency object gets the 
service itself as it&#39;s parent. So ../han_solo refers to the dependency, so it is referring back to 
itself, which wreaks havoc. This also means that we have to do .. to traverse to the cantina 
service, .. to get to the Mos_Eisley container, and .. to get to the Star_wars container to finally 
get to a place we can get to the correct han_solo.

This does not match up at all with my expectation since:

depends_on&#40;&#39;han_solo&#39;&#41; === depends_on&#40;&#39;../../han_solo&#39;&#41;

I did not expect to be dependencies to be traversed this way. If at all traversable, I would 
expect them to be available depends_on&#40;&#39;cantina/han_solo&#39;&#41; so that the notion would match 
up with usual directory traversal &#40;where I&#39;ve added the notion of &#34;.&#34;&#41;:

depends_on&#40;&#39;.&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley&#39;&#41;
depends_on&#40;&#39;..&#39;&#41; === depends_on&#40;&#39;/&#39;&#41;
depends_on&#40;&#39;../han_solo&#39;&#41; === depends_on&#40;&#39;/han_solo&#39;&#41;
depends_on&#40;&#39;./han_solo&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley/han_solo&#39;&#41; === 
depends_on&#40;&#39;han_solo&#39;&#41;
depends_on&#40;&#39;./cantina&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley/cantina&#39;&#41; === depends_on&#40;&#39;cantina&#39;&#41;
depends_on&#40;&#39;./cantina/han_solo&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley/cantina/han_solo&#39;&#41; == 
depends_on&#40;&#39;cantina/han_solo&#39;&#41;

Why does it work this way so that &#39;foo&#39; === &#39;../../foo&#34; within the injector? 

I&#39;m assuming, since I have lots of respect for Stevan&#39;s designs, that there are good reasons for 
this. However, would it be possible to get a &#34;./&#34; prefix or &#34;~/&#34; or something that could be 
used as a shortcut that would make up for the deficiency?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;04&nbsp;18:28:51&nbsp;2011</span>
    <span class="description">stevan.little [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Wow, that is a thorough bug report, thanks! 

I will be honest, I don&#39;t think that I really have a good reason for this behavior, but I also 
don&#39;t currently have the time to look deeply into this. I always felt the whole ../../ stuff was 
kinda hackish and ugly so I tend to not use them too heavily. 

That said the path metaphor is an easy one for people to understand, so to continue it with ./ 
and ~/ might not be a bad idea and i would be open to a patch to support that. All this code 
is contained in Bread::Board::Traversable and should be fairly easy to isolate and extend.

I will try and carve out some time later this week to look into this more.

Thanks,

- Stevan


On Tue Jan 04 18:16:00 2011, HANENKAMP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t think this is a bug, but I do find it counter-intuitive.
&gt; Consider the following
&gt; Bread::Board:
&gt; 
&gt; my $c = container &#39;Star_Wars&#39; =&gt; as {
&gt;     service han_solo =&gt; &#39;Shot First&#39;;
&gt; 
&gt;     container Mos_Eisley =&gt; as {
&gt;         service han_solo =&gt; &#39;Shot Back&#39;;
&gt;         service cantina =&gt; &#40;
&gt;             block =&gt; sub {
&gt;                 my $s = shift;
&gt;                 return {
&gt;                     han_solo =&gt; $s-&gt;param&#40;&#39;han_solo&#39;&#41;,
&gt;                 };
&gt;             },
&gt;             dependencies =&gt; {
&gt;                 han_solo =&gt; depends_on&#40;&#39;../../../han_solo&#39;&#41;,
&gt;             },
&gt;         &#41;;
&gt;     };
&gt; };
&gt; 
&gt; my $cantina = $c-&gt;resolve&#40; service =&gt; &#39;Mos_Eisley/cantina&#39; &#41;;
&gt; say &#34;Han Solo $cantina-&gt;{han_solo}&#34;;
&gt; 
&gt; This will print the correct string, &#34;Han Solo Shot First&#34; &#40;which we
&gt; all know is true&#41;. However,
&gt; the line:
&gt; 
&gt;                 han_solo =&gt; depends_on&#40;&#39;../../../han_solo&#39;&#41;,
&gt; 
&gt; seems counter-intuitive.
&gt; 
&gt; I would expect:
&gt; 
&gt;                 han_solo =&gt; depends_on&#40;&#39;han_solo&#39;&#41;,
&gt; 
&gt; to give the wrong answer &#34;Han Solo Shot Back&#34; and it does.
&gt; 
&gt; I would expect:
&gt; 
&gt;                 han_solo =&gt; depends_on&#40;&#39;../han_solo&#39;&#41;,
&gt; 
&gt; to do what I got with ../../../han_solo, but instead we crash
&gt; altogether:
&gt; 
&gt; Deep recursion on subroutine &#34;Bread::Board::Dependency::is_locked&#34; at
&gt; .../lib/site_perl/5.12.1/darwin-2level/Moose/Meta/Method/Delegation.pm
&gt; line 108.
&gt; 
&gt; I don&#39;t expect ../../han_solo to do anything correctly at all, but:
&gt; 
&gt;                 han_solo =&gt; depends_on&#40;&#39;../../han_solo&#39;&#41;,
&gt; 
&gt; Actually yields &#34;Han Solo Shot Back&#34; which is so wrong and also the
&gt; same as
&gt; depends_on&#40;&#39;han_solo&#39;&#41; which does seem right.
&gt; 
&gt; Now, I understand why each of these is happening, because the
&gt; dependency object gets the
&gt; service itself as it&#39;s parent. So ../han_solo refers to the
&gt; dependency, so it is referring back to
&gt; itself, which wreaks havoc. This also means that we have to do .. to
&gt; traverse to the cantina
&gt; service, .. to get to the Mos_Eisley container, and .. to get to the
&gt; Star_wars container to finally
&gt; get to a place we can get to the correct han_solo.
&gt; 
&gt; This does not match up at all with my expectation since:
&gt; 
&gt; depends_on&#40;&#39;han_solo&#39;&#41; === depends_on&#40;&#39;../../han_solo&#39;&#41;
&gt; 
&gt; I did not expect to be dependencies to be traversed this way. If at
&gt; all traversable, I would
&gt; expect them to be available depends_on&#40;&#39;cantina/han_solo&#39;&#41; so that the
&gt; notion would match
&gt; up with usual directory traversal &#40;where I&#39;ve added the notion of
&gt; &#34;.&#34;&#41;:
&gt; 
&gt; depends_on&#40;&#39;.&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley&#39;&#41;
&gt; depends_on&#40;&#39;..&#39;&#41; === depends_on&#40;&#39;/&#39;&#41;
&gt; depends_on&#40;&#39;../han_solo&#39;&#41; === depends_on&#40;&#39;/han_solo&#39;&#41;
&gt; depends_on&#40;&#39;./han_solo&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley/han_solo&#39;&#41; ===
&gt; depends_on&#40;&#39;han_solo&#39;&#41;
&gt; depends_on&#40;&#39;./cantina&#39;&#41; === depends_on&#40;&#39;/Mos_Eisley/cantina&#39;&#41; ===
&gt; depends_on&#40;&#39;cantina&#39;&#41;
&gt; depends_on&#40;&#39;./cantina/han_solo&#39;&#41; ===
&gt; depends_on&#40;&#39;/Mos_Eisley/cantina/han_solo&#39;&#41; ==
&gt; depends_on&#40;&#39;cantina/han_solo&#39;&#41;
&gt; 
&gt; Why does it work this way so that &#39;foo&#39; === &#39;../../foo&#34; within the
&gt; injector?
&gt; 
&gt; I&#39;m assuming, since I have lots of respect for Stevan&#39;s designs, that
&gt; there are good reasons for
&gt; this. However, would it be possible to get a &#34;./&#34; prefix or &#34;~/&#34; or
&gt; something that could be
&gt; used as a shortcut that would make up for the deficiency?
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;04&nbsp;18:28:51&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;04&nbsp;18:28:52&nbsp;2011</span>
    <span class="description">stevan.little [...] gmail.com -  Given to STEVAN</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;11&nbsp;16:41:17&nbsp;2011</span>
    <span class="description">hanenkamp [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Understood. After more thought, I&#39;m wondering if adding another notation might not be the 
wrong solution. Adding another esoteric notation to fix the deficiency in an already somewhat 
hacky notation is probably the wrong thing.

Instead, what if there was a way to alias containers.

container star_wars =&gt; as {
  container a_new_hope =&gt; as {
    container millenium_falcon =&gt; as {
      service hyperdrive =&gt; &#39;works&#39;;
    };

    service death_star_attack_fleet =&gt; &#40;
      block =&gt; sub { ... },
      dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
    &#41;;
  };
  container empire_strikes_back =&gt; as {
    container millenium_falcon =&gt; as {
      service hyperdrive =&gt; &#39;broken&#39;;
    };
  };
  container return_of_the_jedi =&gt; as {
    alias millenium_falcon =&gt; &#39;/a_new_hope/millenium_falcon&#39;;

    service death_star_attack_fleet =&gt; &#40;
      block =&gt; sub { ... },
      dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
    &#41;;
  };
};

That might more easily solve my worry that someday I&#39;m going to shuffle the container 
hierarchy, which is the real source of my desire for a useful &#34;..&#34;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;11&nbsp;17:49:06&nbsp;2011</span>
    <span class="description">stevan.little [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I had pondered some kind of alias before, but it never seemed to make sense and always felt 
like to many level of indirection. It really would only be useful if it was extremely lazy.

Additionally, your example would still fail if you refactored like this:

container &#39;lucasfilm&#39; =&gt; as {
   container &#39;star_wars&#39; =&gt; as { .... };
   container &#39;indiana_jones&#39; =&gt; as { ... };
};

The alias would no longer work since star-wars was not at the root of it.

I actually released a new version of Bread::Board the other day and was looking over the 
traversal code some. I see where the confusion you originally had is coming from, which was 
exactly as you diagnosed it.  

I also realised that while i think heavy use of the ../../ notation can feel hackish, the path 
notation itself is not. And the idea of a ~ notation, which simply means &#34;the container I am in&#34; 
is pretty simple and really unambiguous. I think being able to navigate in a such a relative 
fashion would actually make the ../../ stuff less mucky too. And in some ways I wonder if the 
hackish feeling of ../../ is not simply because it doesn&#39;t actually implement all the various path 
notations that we are comfortable with &#40;like ~&#41;. 

So, to re-use your example &#40;which btw is broken cause you can&#39;t depend on a container, but 
sokay I get the idea you&#39;re trying to convey&#41;, it would become:

container star_wars =&gt; as {
    container a_new_hope =&gt; as {
        container millenium_falcon =&gt; as {
            service hyperdrive =&gt; &#39;works&#39;;
        };
        
        service death_star_attack_fleet =&gt; &#40;
            block =&gt; sub { ... },
            dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
        &#41;;
    };
    container empire_strikes_back =&gt; as {
        container millenium_falcon =&gt; as {
            service hyperdrive =&gt; &#39;broken&#39;;
        };
    };
    container return_of_the_jedi =&gt; as {
        service death_star_attack_fleet =&gt; &#40;
            block =&gt; sub { ... },
            dependencies =&gt; {
                millenium_falcon =&gt; &#39;~/../a_new_hope/millenium_falcon
            }
        &#41;;
    };
};

So in this case you are saying, take me to the return_of_the_jedi container, then navigate up 
one, and descend into the a_new_hope container. This approach is, IMO, safer for refactoring, 
however that is probably biased by the fact I tend to wrap my containers often and usually don&#39;t 
want the subcontainers to know that they are being wrapped.

Thoughts?

- Stevan


On Tue Jan 11 16:41:17 2011, HANENKAMP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Understood. After more thought, I&#39;m wondering if adding another
&gt; notation might not be the
&gt; wrong solution. Adding another esoteric notation to fix the deficiency
&gt; in an already somewhat
&gt; hacky notation is probably the wrong thing.
&gt; 
&gt; Instead, what if there was a way to alias containers.
&gt; 
&gt; container star_wars =&gt; as {
&gt;   container a_new_hope =&gt; as {
&gt;     container millenium_falcon =&gt; as {
&gt;       service hyperdrive =&gt; &#39;works&#39;;
&gt;     };
&gt; 
&gt;     service death_star_attack_fleet =&gt; &#40;
&gt;       block =&gt; sub { ... },
&gt;       dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
&gt;     &#41;;
&gt;   };
&gt;   container empire_strikes_back =&gt; as {
&gt;     container millenium_falcon =&gt; as {
&gt;       service hyperdrive =&gt; &#39;broken&#39;;
&gt;     };
&gt;   };
&gt;   container return_of_the_jedi =&gt; as {
&gt;     alias millenium_falcon =&gt; &#39;/a_new_hope/millenium_falcon&#39;;
&gt; 
&gt;     service death_star_attack_fleet =&gt; &#40;
&gt;       block =&gt; sub { ... },
&gt;       dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
&gt;     &#41;;
&gt;   };
&gt; };
&gt; 
&gt; That might more easily solve my worry that someday I&#39;m going to
&gt; shuffle the container
&gt; hierarchy, which is the real source of my desire for a useful &#34;..&#34;.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Feb&nbsp;22&nbsp;11:46:18&nbsp;2011</span>
    <span class="description">stevan.little [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">If you have a moment I would appreciate if you could test out the latest Bread::Board in 
github 

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/stevan/BreadBoard">https://github.com/stevan/BreadBoard</a></span>

In particular this fix:

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/stevan/BreadBoard/commit/86dbb5268ec5d1d9c0be1ca58a5b1a6159ba">https://github.com/stevan/BreadBoard/commit/86dbb5268ec5d1d9c0be1ca58a5b1a6159ba</a></span>
4996

After much discussion with Jesse &#40;doy&#41; we decided that sanity should prevail and that the 
whole ../../ business really had not usage and was just laziness in the design. The change 
really ends up being quite small, but should fix the issues you noticed.

Let me know, I wont release quite yet, I need to see how much &#40;if anything&#41; it breaks for me 
first.

Thanks,

- Stevan

On Tue Jan 11 17:49:06 2011, STEVAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I had pondered some kind of alias before, but it never seemed to make
&gt; sense and always felt
&gt; like to many level of indirection. It really would only be useful if
&gt; it was extremely lazy.
&gt; 
&gt; Additionally, your example would still fail if you refactored like
&gt; this:
&gt; 
&gt; container &#39;lucasfilm&#39; =&gt; as {
&gt;    container &#39;star_wars&#39; =&gt; as { .... };
&gt;    container &#39;indiana_jones&#39; =&gt; as { ... };
&gt; };
&gt; 
&gt; The alias would no longer work since star-wars was not at the root of
&gt; it.
&gt; 
&gt; I actually released a new version of Bread::Board the other day and
&gt; was looking over the
&gt; traversal code some. I see where the confusion you originally had is
&gt; coming from, which was
&gt; exactly as you diagnosed it.
&gt; 
&gt; I also realised that while i think heavy use of the ../../ notation
&gt; can feel hackish, the path
&gt; notation itself is not. And the idea of a ~ notation, which simply
&gt; means &#34;the container I am in&#34;
&gt; is pretty simple and really unambiguous. I think being able to
&gt; navigate in a such a relative
&gt; fashion would actually make the ../../ stuff less mucky too. And in
&gt; some ways I wonder if the
&gt; hackish feeling of ../../ is not simply because it doesn&#39;t actually
&gt; implement all the various path
&gt; notations that we are comfortable with &#40;like ~&#41;.
&gt; 
&gt; So, to re-use your example &#40;which btw is broken cause you can&#39;t depend
&gt; on a container, but
&gt; sokay I get the idea you&#39;re trying to convey&#41;, it would become:
&gt; 
&gt; container star_wars =&gt; as {
&gt;     container a_new_hope =&gt; as {
&gt;         container millenium_falcon =&gt; as {
&gt;             service hyperdrive =&gt; &#39;works&#39;;
&gt;         };
&gt; 
&gt;         service death_star_attack_fleet =&gt; &#40;
&gt;             block =&gt; sub { ... },
&gt;             dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
&gt;         &#41;;
&gt;     };
&gt;     container empire_strikes_back =&gt; as {
&gt;         container millenium_falcon =&gt; as {
&gt;             service hyperdrive =&gt; &#39;broken&#39;;
&gt;         };
&gt;     };
&gt;     container return_of_the_jedi =&gt; as {
&gt;         service death_star_attack_fleet =&gt; &#40;
&gt;             block =&gt; sub { ... },
&gt;             dependencies =&gt; {
&gt;                 millenium_falcon =&gt; &#39;~/../a_new_hope/millenium_falcon
&gt;             }
&gt;         &#41;;
&gt;     };
&gt; };
&gt; 
&gt; So in this case you are saying, take me to the return_of_the_jedi
&gt; container, then navigate up
&gt; one, and descend into the a_new_hope container. This approach is, IMO,
&gt; safer for refactoring,
&gt; however that is probably biased by the fact I tend to wrap my
&gt; containers often and usually don&#39;t
&gt; want the subcontainers to know that they are being wrapped.
&gt; 
&gt; Thoughts?
&gt; 
&gt; - Stevan
&gt; 
&gt; 
&gt; On Tue Jan 11 16:41:17 2011, HANENKAMP wrote:
<div class="message-stanza open">&gt; &gt; Understood. After more thought, I&#39;m wondering if adding another
&gt; &gt; notation might not be the
&gt; &gt; wrong solution. Adding another esoteric notation to fix the
</div>&gt; deficiency
<div class="message-stanza open">&gt; &gt; in an already somewhat
&gt; &gt; hacky notation is probably the wrong thing.
&gt; &gt;
&gt; &gt; Instead, what if there was a way to alias containers.
&gt; &gt;
&gt; &gt; container star_wars =&gt; as {
&gt; &gt;   container a_new_hope =&gt; as {
&gt; &gt;     container millenium_falcon =&gt; as {
&gt; &gt;       service hyperdrive =&gt; &#39;works&#39;;
&gt; &gt;     };
&gt; &gt;
&gt; &gt;     service death_star_attack_fleet =&gt; &#40;
&gt; &gt;       block =&gt; sub { ... },
&gt; &gt;       dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
&gt; &gt;     &#41;;
&gt; &gt;   };
&gt; &gt;   container empire_strikes_back =&gt; as {
&gt; &gt;     container millenium_falcon =&gt; as {
&gt; &gt;       service hyperdrive =&gt; &#39;broken&#39;;
&gt; &gt;     };
&gt; &gt;   };
&gt; &gt;   container return_of_the_jedi =&gt; as {
&gt; &gt;     alias millenium_falcon =&gt; &#39;/a_new_hope/millenium_falcon&#39;;
&gt; &gt;
&gt; &gt;     service death_star_attack_fleet =&gt; &#40;
&gt; &gt;       block =&gt; sub { ... },
&gt; &gt;       dependencies =&gt; wire_names&#40;qw&#40; millenium_falcon ... &#41;&#41;,
&gt; &gt;     &#41;;
&gt; &gt;   };
&gt; &gt; };
&gt; &gt;
&gt; &gt; That might more easily solve my worry that someday I&#39;m going to
&gt; &gt; shuffle the container
&gt; &gt; hierarchy, which is the real source of my desire for a useful &#34;..&#34;.
</div>&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;12&nbsp;05:50:06&nbsp;2012</span>
    <span class="description">DOY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This fix has been released for a while, and seems to work well, so I
think I&#39;ll close this. Feel free to reopen it if there are still any issues.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;12&nbsp;05:50:10&nbsp;2012</span>
    <span class="description">DOY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
