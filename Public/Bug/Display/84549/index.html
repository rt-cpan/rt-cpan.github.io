<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #84549 for Unicode-LineBreak: String trimming</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #84549 for Unicode-LineBreak: String trimming</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Unicode-LineBreak">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Unicode-LineBreak">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Unicode-LineBreak">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Unicode-LineBreak">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Unicode-LineBreak">Unicode-LineBreak CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">84549</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Unicode-LineBreak">Unicode-LineBreak</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MARKOV [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-227344-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-227345-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2012.10    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=84549">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200495" href="/Public/Bug/Display.html?id=84549#txn-1200495">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;10&nbsp;07:05:40&nbsp;2013</span>
    <span class="description">MARKOV [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> String trimming</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200495/633791/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633791">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 557b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Nezumi,

I really like your complex module ;-&#41;

What I have is a sprintf&#40;&#41; extension in Log::Report::Message.  I will base its %s printing on Unicode::CGString.  It is not difficult to support &#34;%10s&#34;, however how do I implement &#34;%.10s&#34; fast?

A slow way would be:

  chop $string while Unicode::CGString-&gt;new&#40;$string&#41;-&gt;columns &gt; 10;

Better &#40;untested as well&#41;

  my $r = Unicode::CGString-&gt;new&#40;$string&#41;;
  $r-&gt;substr&#40;-1&#41; while $r-&gt;columns &gt; 10;
  &#34;$r&#34;;

Do you have a fast solution for me which implements it in 1 call?  Something like:

  $r-&gt;trim&#40;10&#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200712" href="/Public/Bug/Display.html?id=84549#txn-1200712">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;10&nbsp;23:20:31&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200712/633901/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633901">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Mark,

On 2013-4æœˆ-10 æ°´ 07:05:40, MARKOV wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Nezumi,
&gt; 
&gt; I really like your complex module ;-&#41;
&gt; 
&gt; What I have is a sprintf&#40;&#41; extension in Log::Report::Message.  I will
&gt; base its %s printing on Unicode::CGString.  It is not difficult to
&gt; support &#34;%10s&#34;, however how do I implement &#34;%.10s&#34; fast?
&gt; 
&gt; A slow way would be:
&gt; 
&gt;   chop $string while Unicode::CGString-&gt;new&#40;$string&#41;-&gt;columns &gt; 10;
&gt; 
&gt; Better &#40;untested as well&#41;
&gt; 
&gt;   my $r = Unicode::CGString-&gt;new&#40;$string&#41;;
&gt;   $r-&gt;substr&#40;-1&#41; while $r-&gt;columns &gt; 10;
&gt;   &#34;$r&#34;;
&gt; 
&gt; Do you have a fast solution for me which implements it in 1 call?
&gt; Something like:
&gt; 
&gt;   $r-&gt;trim&#40;10&#41;;
</div>
A straight way may be:

  sub trim {
      my $self = shift;
      my $len = shift;
  
      my $ret = &#39;&#39;;
      foreach my $gc &#40;@$self&#41; {
          last if $len &lt; &#40;$ret . $gc&#41;-&gt;columns;
          $ret .= $gc;
      }
      return &#34;$ret&#34;;
  }

&#39;@&#39;, &#39;.&#39; and &#39;&#34;&#34;&#39; are overloaded operators.
It may be a bit faster.  That&#39;s all I come up with at present.


Thanks,

--- nezumi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200713" href="/Public/Bug/Display.html?id=84549#txn-1200713">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;10&nbsp;23:20:31&nbsp;2013</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200729" href="/Public/Bug/Display.html?id=84549#txn-1200729">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;11&nbsp;03:52:59&nbsp;2013</span>
    <span class="description">secretaris [...] nluug.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84549] String trimming</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 11 Apr 2013 09:52:38 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Hatuka*nezumi - IKEDA Soji via RT &lt;bug-Unicode-LineBreak [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;secretaris [...] nluug.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200729/633907/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633907">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-LineBreak@rt.cpan.org&#41; [130411 03:20]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84549">https://rt.cpan.org/Ticket/Display.html?id=84549</a></span> &gt;
<div class="message-stanza open">&gt; &gt;   $r-&gt;trim&#40;10&#41;;
</div>&gt; 
&gt; A straight way may be:
&gt; 
&gt;   sub trim {
&gt;       my $self = shift;
&gt;       my $len = shift;
&gt;   
&gt;       my $ret = &#39;&#39;;
&gt;       foreach my $gc &#40;@$self&#41; {
&gt;           last if $len &lt; &#40;$ret . $gc&#41;-&gt;columns;
&gt;           $ret .= $gc;
&gt;       }
&gt;       return &#34;$ret&#34;;
&gt;   }
&gt; 
&gt; &#39;@&#39;, &#39;.&#39; and &#39;&#34;&#34;&#39; are overloaded operators.
&gt; It may be a bit faster.  That&#39;s all I come up with at present.
</div>
It looks to me as an algorithm close to line-folding, only as first
step, because there is no need for word boundary.

I have the impression that above algorithm could be quite slow, especially
when strings get large.  On websites, you often see the first few lines of
an article, say 500 columns worth.  So, the function I suggest could be
more useful than just my implementation of %10.10s.

Am I right to suspect &#39;columns&#39; to be quite expensive?  O&#40;n&#41;
Efficient would be something along the lines of:

    sub trim&#40;$&#41; {
        my &#40;$self, $max&#41; = @_;
        my $pos = $self-&gt;char_on&#40;$max&#41;;
        $self-&gt;substr&#40;$pos&#41; = &#39;&#39; if defined $pos;
        $self;
    }

    # probably off-by-one errors :&#40;  Do we start counting column by 0 or 1?
    # return undef when outside string.
    sub char_on&#40;$&#41; {
        my &#40;$self, $col&#41; = @_;

        my $taken_col  = 0;
        my $pos;
        for&#40;$pos = 0; $pos &lt;= $#self &#38;&#38; $taken_col &lt; $col; $pos++&#41;
        {   $taken_col  += $self[$pos]-&gt;columns;
        }
        $taken_col &lt; $col ? undef : $pos;
    }

It seems to me, this is much more efficient in C than via Perl&#39;s tied
interface.  That&#39;s why I put it on the wishlist of your nice module.
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200808" href="/Public/Bug/Display.html?id=84549#txn-1200808">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;11&nbsp;08:36:38&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200808/633949/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633949">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2013-4æœˆ-11 æœ¨ 03:52:59, secretaris@nluug.nl wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-
&gt; LineBreak@rt.cpan.org&#41; [130411 03:20]:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84549">https://rt.cpan.org/Ticket/Display.html?id=84549</a></span> &gt;
<div class="message-stanza open">&gt; &gt; &gt;   $r-&gt;trim&#40;10&#41;;
</div>&gt; &gt;
&gt; &gt; A straight way may be:
&gt; &gt;
&gt; &gt;   sub trim {
&gt; &gt;       my $self = shift;
&gt; &gt;       my $len = shift;
&gt; &gt;
&gt; &gt;       my $ret = &#39;&#39;;
&gt; &gt;       foreach my $gc &#40;@$self&#41; {
&gt; &gt;           last if $len &lt; &#40;$ret . $gc&#41;-&gt;columns;
&gt; &gt;           $ret .= $gc;
&gt; &gt;       }
&gt; &gt;       return &#34;$ret&#34;;
&gt; &gt;   }
&gt; &gt;
&gt; &gt; &#39;@&#39;, &#39;.&#39; and &#39;&#34;&#34;&#39; are overloaded operators.
&gt; &gt; It may be a bit faster.  That&#39;s all I come up with at present.
</div>&gt; 
&gt; It looks to me as an algorithm close to line-folding, only as first
&gt; step, because there is no need for word boundary.
&gt; 
&gt; I have the impression that above algorithm could be quite slow,
&gt; especially
&gt; when strings get large.  On websites, you often see the first few
&gt; lines of
&gt; an article, say 500 columns worth.  So, the function I suggest could
&gt; be
&gt; more useful than just my implementation of %10.10s.
&gt; 
&gt; Am I right to suspect &#39;columns&#39; to be quite expensive?  O&#40;n&#41;
&gt; Efficient would be something along the lines of:
&gt; 
&gt;     sub trim&#40;$&#41; {
&gt;         my &#40;$self, $max&#41; = @_;
&gt;         my $pos = $self-&gt;char_on&#40;$max&#41;;
&gt;         $self-&gt;substr&#40;$pos&#41; = &#39;&#39; if defined $pos;
&gt;         $self;
&gt;     }
&gt; 
&gt;     # probably off-by-one errors :&#40;  Do we start counting column by 0
&gt; or 1?
&gt;     # return undef when outside string.
&gt;     sub char_on&#40;$&#41; {
&gt;         my &#40;$self, $col&#41; = @_;
&gt; 
&gt;         my $taken_col  = 0;
&gt;         my $pos;
&gt;         for&#40;$pos = 0; $pos &lt;= $#self &#38;&#38; $taken_col &lt; $col; $pos++&#41;
&gt;         {   $taken_col  += $self[$pos]-&gt;columns;
&gt;         }
&gt;         $taken_col &lt; $col ? undef : $pos;
&gt;     }
&gt; 
&gt; It seems to me, this is much more efficient in C than via Perl&#39;s tied
&gt; interface.  That&#39;s why I put it on the wishlist of your nice module.
</div>
How about next&#40;&#41; method?  It seems approximately O&#40;1&#41;.

  sub trim {
      my $self = shift;
      my $len = shift;
      return &#39;&#39; if $len &lt;= 0;
  
      my $pos = $self-&gt;pos;
      $self-&gt;pos&#40;0&#41;;
  
      my $cols = 0;
      my $gc;
      while &#40;defined&#40;$gc = $self-&gt;next&#41;&#41; {
        if &#40;$len &lt; &#40;$cols += $gc-&gt;columns&#41;&#41; {
            my $ret = $self-&gt;substr&#40;0, $self-&gt;pos - 1&#41;;
            $self-&gt;pos&#40;$pos&#41;;
            return $ret;
        }
      }
  
      $self-&gt;pos&#40;$pos&#41;;
      return $self;
  }
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1200829" href="/Public/Bug/Display.html?id=84549#txn-1200829">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;11&nbsp;10:09:00&nbsp;2013</span>
    <span class="description">secretaris [...] nluug.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84549] String trimming</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 11 Apr 2013 16:08:09 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Hatuka*nezumi - IKEDA Soji via RT &lt;bug-Unicode-LineBreak [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;secretaris [...] nluug.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1200829/633961/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/633961">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-LineBreak@rt.cpan.org&#41; [130411 12:36]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84549">https://rt.cpan.org/Ticket/Display.html?id=84549</a></span> &gt;
<div class="message-stanza open">&gt; &gt;     sub trim&#40;$&#41; {
&gt; &gt;         my &#40;$self, $max&#41; = @_;
&gt; &gt;         my $pos = $self-&gt;char_on&#40;$max&#41;;
&gt; &gt;         $self-&gt;substr&#40;$pos&#41; = &#39;&#39; if defined $pos;
&gt; &gt;         $self;
&gt; &gt;     }
&gt; &gt; 
&gt; &gt;     # probably off-by-one errors :&#40;  Do we start counting column by 0 or 1?
&gt; &gt;     # return undef when outside string.
&gt; &gt;     sub char_on&#40;$&#41; {
&gt; &gt;         my &#40;$self, $col&#41; = @_;
&gt; &gt; 
&gt; &gt;         my $taken_col  = 0;
&gt; &gt;         my $pos;
&gt; &gt;         for&#40;$pos = 0; $pos &lt;= $#self &#38;&#38; $taken_col &lt; $col; $pos++&#41;
&gt; &gt;         {   $taken_col  += $self[$pos]-&gt;columns;
&gt; &gt;         }
&gt; &gt;         $taken_col &lt; $col ? undef : $pos;
&gt; &gt;     }
&gt; &gt; 
&gt; &gt; It seems to me, this is much more efficient in C than via Perl&#39;s tied
&gt; &gt; interface.  That&#39;s why I put it on the wishlist of your nice module.
</div>&gt; 
&gt; How about next&#40;&#41; method?  It seems approximately O&#40;1&#41;.
&gt; 
&gt;   sub trim {
&gt;       my $self = shift;
&gt;       my $len = shift;
&gt;       return &#39;&#39; if $len &lt;= 0;
&gt;   
&gt;       my $pos = $self-&gt;pos;
&gt;       $self-&gt;pos&#40;0&#41;;
&gt;   
&gt;       my $cols = 0;
&gt;       my $gc;
&gt;       while &#40;defined&#40;$gc = $self-&gt;next&#41;&#41; {
&gt;       if &#40;$len &lt; &#40;$cols += $gc-&gt;columns&#41;&#41; {
&gt;           my $ret = $self-&gt;substr&#40;0, $self-&gt;pos - 1&#41;;
&gt;           $self-&gt;pos&#40;$pos&#41;;
&gt;           return $ret;
&gt;       }
&gt;       }
&gt;   
&gt;       $self-&gt;pos&#40;$pos&#41;;
&gt;       return $self;
&gt;   }
&gt; 
</div>
That&#39;s the iterative version of my last example.
You do not think that a pure XS implementation for this is useful?
-- 
Regards,
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1201063" href="/Public/Bug/Display.html?id=84549#txn-1201063">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;11&nbsp;21:57:55&nbsp;2013</span>
    <span class="description">hatuka [...] nezumi.nu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84549] String trimming</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Apr 2013 10:57:21 +0900</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Unicode-LineBreak [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Hatuka*nezumi - IKEDA Soji &lt;hatuka [...] nezumi.nu&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1201063/634088/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634088">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu, 11 Apr 2013 10:09:01 -0400
&#34;Mark Overmeer via RT&#34; &lt;bug-Unicode-LineBreak@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Unicode-LineBreak
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84549">https://rt.cpan.org/Ticket/Display.html?id=84549</a></span> &gt;
&gt; 
&gt; * Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-LineBreak@rt.cpan.org&#41; [130411 12:36]:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=84549">https://rt.cpan.org/Ticket/Display.html?id=84549</a></span> &gt;
<div class="message-stanza open">&gt; &gt; &gt;     sub trim&#40;$&#41; {
&gt; &gt; &gt;         my &#40;$self, $max&#41; = @_;
&gt; &gt; &gt;         my $pos = $self-&gt;char_on&#40;$max&#41;;
&gt; &gt; &gt;         $self-&gt;substr&#40;$pos&#41; = &#39;&#39; if defined $pos;
&gt; &gt; &gt;         $self;
&gt; &gt; &gt;     }
&gt; &gt; &gt; 
&gt; &gt; &gt;     # probably off-by-one errors :&#40;  Do we start counting column by 0 or 1?
&gt; &gt; &gt;     # return undef when outside string.
&gt; &gt; &gt;     sub char_on&#40;$&#41; {
&gt; &gt; &gt;         my &#40;$self, $col&#41; = @_;
&gt; &gt; &gt; 
&gt; &gt; &gt;         my $taken_col  = 0;
&gt; &gt; &gt;         my $pos;
&gt; &gt; &gt;         for&#40;$pos = 0; $pos &lt;= $#self &#38;&#38; $taken_col &lt; $col; $pos++&#41;
&gt; &gt; &gt;         {   $taken_col  += $self[$pos]-&gt;columns;
&gt; &gt; &gt;         }
&gt; &gt; &gt;         $taken_col &lt; $col ? undef : $pos;
&gt; &gt; &gt;     }
&gt; &gt; &gt; 
&gt; &gt; &gt; It seems to me, this is much more efficient in C than via Perl&#39;s tied
&gt; &gt; &gt; interface.  That&#39;s why I put it on the wishlist of your nice module.
</div>&gt; &gt; 
&gt; &gt; How about next&#40;&#41; method?  It seems approximately O&#40;1&#41;.
&gt; &gt; 
&gt; &gt;   sub trim {
&gt; &gt;       my $self = shift;
&gt; &gt;       my $len = shift;
&gt; &gt;       return &#39;&#39; if $len &lt;= 0;
&gt; &gt;   
&gt; &gt;       my $pos = $self-&gt;pos;
&gt; &gt;       $self-&gt;pos&#40;0&#41;;
&gt; &gt;   
&gt; &gt;       my $cols = 0;
&gt; &gt;       my $gc;
&gt; &gt;       while &#40;defined&#40;$gc = $self-&gt;next&#41;&#41; {
&gt; &gt;     if &#40;$len &lt; &#40;$cols += $gc-&gt;columns&#41;&#41; {
&gt; &gt;         my $ret = $self-&gt;substr&#40;0, $self-&gt;pos - 1&#41;;
&gt; &gt;         $self-&gt;pos&#40;$pos&#41;;
&gt; &gt;         return $ret;
&gt; &gt;     }
&gt; &gt;       }
&gt; &gt;   
&gt; &gt;       $self-&gt;pos&#40;$pos&#41;;
&gt; &gt;       return $self;
&gt; &gt;   }
&gt; &gt; 
</div>&gt; 
&gt; That&#39;s the iterative version of my last example.
</div>
Yes, and it doesn&#39;t extract GCString to array.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; You do not think that a pure XS implementation for this is useful?
</div>
I had thought of similar thing.  I believe XS version should have
slightly generalized function: It would like to support left-side
trim along with right-side trim and so on.

Since it will not be in time for next stable release &#40;this May to
June&#41;, it would be better to use Perl version for the present.

Regards,

-- 
 --- nezumi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1201098" href="/Public/Bug/Display.html?id=84549#txn-1201098">#</a>      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;12&nbsp;02:17:05&nbsp;2013</span>
    <span class="description">secretaris [...] nluug.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #84549] String trimming</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 12 Apr 2013 08:16:27 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Hatuka*nezumi - IKEDA Soji via RT &lt;bug-Unicode-LineBreak [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;secretaris [...] nluug.nl&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1201098/634104/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/634104">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 889b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">* Hatuka*nezumi - IKEDA Soji via RT &#40;bug-Unicode-LineBreak@rt.cpan.org&#41; [130412 01:58]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; You do not think that a pure XS implementation for this is useful?
</div>&gt; 
&gt; I had thought of similar thing.  I believe XS version should have
&gt; slightly generalized function: It would like to support left-side
&gt; trim along with right-side trim and so on.
</div>
Starts with the generic &#34;char_on_column&#40;&#41;&#34;  Then any kind of trim is
easy.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Since it will not be in time for next stable release &#40;this May to
&gt; June&#41;, it would be better to use Perl version for the present.
</div>
Sure.  Thanks!
-- 
               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.4807</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
