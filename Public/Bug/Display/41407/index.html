<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #41407 for HTTP-Body: HTTP::Body multipart boundary parser is not RFC 2046 complient.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #41407 for HTTP-Body: HTTP::Body multipart boundary parser is not RFC 2046 complient.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/HTTP-Body/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/HTTP-Body/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/HTTP-Body/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/HTTP-Body/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/HTTP-Body">HTTP-Body CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">41407</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/HTTP-Body/Active/">HTTP-Body</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bobtfish [...] bobtfish.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-16270-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.05    </td>
  </tr>
  <tr id="CF-16271-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;03&nbsp;10:26:51&nbsp;2008</span>
    <span class="description">bobtfish [...] bobtfish.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> HTTP::Body multipart boundary parser is not RFC 2046 complient.</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hiya, I have an issue where a client library &#40;which I do not control&#41; is
making POST requests to my application with boundaries containing the
&#39;,&#39; character.

This is specifically excluded from HTTP::Body::MultiPart by the boundary
matching regex, but the BNF for a boundary from RFC 2046 is:

boundary := 0*69&lt;bchars&gt; bcharsnospace

bchars := bcharsnospace / &#34; &#34;

bcharsnospace := DIGIT / ALPHA / &#34;&#39;&#34; / &#34;&#40;&#34; / &#34;&#41;&#34; /
                 &#34;+&#34; / &#34;_&#34; / &#34;,&#34; / &#34;-&#34; / &#34;.&#34; /
                 &#34;/&#34; / &#34;:&#34; / &#34;=&#34; / &#34;?&#34;

Please find test cases for the issue attached.

Cheers
t0m
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> http_body-rfc2046-boundary-test.diff</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: t/04multipart.t
===================================================================
--- t/04multipart.t	&#40;revision 8701&#41;
+++ t/04multipart.t	&#40;working copy&#41;
@@ -3,7 +3,7 @@
 use strict;
 use warnings;
 
-use Test::More tests =&gt; 98;
+use Test::More tests =&gt; 102;
 
 use Cwd;
 use HTTP::Body;
@@ -14,7 +14,7 @@
 
 my $path = catdir&#40; getcwd&#40;&#41;, &#39;t&#39;, &#39;data&#39;, &#39;multipart&#39; &#41;;
 
-for &#40; my $i = 1; $i &lt;= 12; $i++ &#41; {
+for &#40; my $i = 1; $i &lt;= 13; $i++ &#41; {
 
     my $test    = sprintf&#40; &#34;%.3d&#34;, $i &#41;;
     my $headers = YAML::LoadFile&#40; catfile&#40; $path, &#34;$test-headers.yml&#34; &#41; &#41;;
@@ -47,7 +47,8 @@
 
     is_deeply&#40; $body-&gt;body, $results-&gt;{body}, &#34;$test MultiPart body&#34; &#41;;
     is_deeply&#40; $body-&gt;param, $results-&gt;{param}, &#34;$test MultiPart param&#34; &#41;;
-    is_deeply&#40; $body-&gt;upload, $results-&gt;{upload}, &#34;$test MultiPart upload&#34; &#41;;
+    is_deeply&#40; $body-&gt;upload, $results-&gt;{upload}, &#34;$test MultiPart upload&#34; &#41;
+        if $results-&gt;{upload};
     cmp_ok&#40; $body-&gt;state, &#39;eq&#39;, &#39;done&#39;, &#34;$test MultiPart state&#34; &#41;;
     cmp_ok&#40; $body-&gt;length, &#39;==&#39;, $body-&gt;content_length, &#34;$test MultiPart length&#34; &#41;;
     
Index: t/data/multipart/013-headers.yml
===================================================================
--- t/data/multipart/013-headers.yml	&#40;revision 0&#41;
+++ t/data/multipart/013-headers.yml	&#40;revision 0&#41;
@@ -0,0 +1,4 @@
+---
+Content-Length: 1817
+Content-Type: multipart/form-data; boundary=----------0x&#39;K&#40;&#41;h+T_m,L-b.O/u:N=d?ArY
+User-Agent: &#39;Mozilla/5.0 &#40;Macintosh; U; PPC Mac OS X; en&#41; AppleWebKit/312.1 &#40;KHTML, like Gecko&#41; Safari/312&#39;
Index: t/data/multipart/013-content.dat
===================================================================
--- t/data/multipart/013-content.dat	&#40;revision 0&#41;
+++ t/data/multipart/013-content.dat	&#40;revision 0&#41;
@@ -0,0 +1,23 @@
+------------0x&#39;K&#40;&#41;h+T_m,L-b.O/u:N=d?ArY
+Content-Disposition: form-data; name=&#34;text1&#34;
+
+Ratione accusamus aspernatur aliquam
+------------0x&#39;K&#40;&#41;h+T_m,L-b.O/u:N=d?ArY
+Content-Disposition: form-data; name=&#34;text2&#34;
+
+
+------------0x&#39;K&#40;&#41;h+T_m,L-b.O/u:N=d?ArY
+Content-Disposition: form-data; name=&#34;select&#34;
+
+A
+------------0x&#39;K&#40;&#41;h+T_m,L-b.O/u:N=d?ArY
+Content-Disposition: form-data; name=&#34;select&#34;
+
+B
+------------0x&#39;K&#40;&#41;h+T_m,L-b.O/u:N=d?ArY
+Content-Disposition: form-data; name=&#34;textarea&#34;
+
+Voluptatem cumque voluptate sit recusandae at. Et quas facere rerum unde esse. Sit est et voluptatem. Vel temporibus velit neque odio non.
+
+Molestias rerum ut sapiente facere repellendus illo. Eum nulla quis aut. Quidem voluptas vitae ipsam officia voluptatibus eveniet. Aspernatur cupiditate ratione aliquam quidem corrupti. Eos sunt rerum non optio culpa.
+------------0xKhTmLbOuNdArY--
Index: t/data/multipart/013-results.yml
===================================================================
--- t/data/multipart/013-results.yml	&#40;revision 0&#41;
+++ t/data/multipart/013-results.yml	&#40;revision 0&#41;
@@ -0,0 +1,9 @@
+---
+body: ~
+param:
+  select:
+    - A
+    - B
+  text1: Ratione accusamus aspernatur aliquam
+  text2: &#34;&#34;
+  textarea: &#34;Voluptatem cumque voluptate sit recusandae at. Et quas facere rerum unde esse. Sit est et voluptatem. Vel temporibus velit neque odio non.\r\n\r\nMolestias rerum ut sapiente facere repellendus illo. Eum nulla quis aut. Quidem voluptas vitae ipsam officia voluptatibus eveniet. Aspernatur cupiditate ratione aliquam quidem corrupti. Eos sunt rerum non optio culpa.&#34;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;05&nbsp;13:19:22&nbsp;2008</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, would you be interested in also working on a patch?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;05&nbsp;13:19:24&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;07&nbsp;11:43:33&nbsp;2009</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in rev 10047.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;07&nbsp;11:43:35&nbsp;2009</span>
    <span class="description">AGRUNDMA [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
