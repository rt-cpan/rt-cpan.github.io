<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #54611 for Devel-StackTrace: Enhancement proposal: Allow user to format stacktrace</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #54611 for Devel-StackTrace: Enhancement proposal: Allow user to format stacktrace</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Devel-StackTrace/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Devel-StackTrace/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Devel-StackTrace/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Devel-StackTrace/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/houseabsolute/Devel-StackTrace/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Devel-StackTrace">Devel-StackTrace CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">54611</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Devel-StackTrace/Active/">Devel-StackTrace</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
milu71 [...] googlemail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-11208-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-11209-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;14&nbsp;21:37:28&nbsp;2010</span>
    <span class="description">milu71 [...] googlemail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Enhancement proposal: Allow user to format stacktrace</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&#40;As outlined by mail privately the other day:&#41;

Currently, the user has limited control over the way the stacktrace is
formatted for display. It would be nice to be able to have stacktraces
in ANSI colors, for example. They stand out better in the logfile.

The modifications required to accomodate this new feature are relatively
minor. See the attached patch &#40;not the same as the one 
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> dst.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- /usr/lib/perl5/site_perl/5.10/devel/stacktrace.pm	2010-02-10 22:28:43.000000000 +0100
+++ lib/Devel/StackTrace.pm	2010-02-15 03:07:29.453125000 +0100
@@ -32,6 +32,51 @@
                 %p,
               }, $class;
 
+    # provide missing main formatter
+
+    $self-&gt;{formatter} ||= sub {
+        my&#40; $sub, $args, $filename, $line, $first&#41; = @_;
+        return sprintf &#39;%s at %s line %s&#39;,
+            $first ? &#39;Trace begun&#39; : &#34;$sub$args called&#34;, $filename, $line;
+    };
+
+    # provide missing argument formatter
+    # if there are any arguments in the sub-routine call, format them
+    # according to the format variables defined elsewhere in this file
+
+    $self-&gt;{arg_formatter} ||= sub {
+        my&#40;$arg&#41; = @_;
+        # set args to the string &#34;undef&#34; if undefined
+        $arg = &#34;undef&#34;, next unless defined $arg;
+
+        $arg = $self-&gt;_ref_to_string&#40;$arg&#41;
+            if ref $arg;
+
+        eval
+        {
+            if &#40; $self-&gt;{max_arg_length}
+                 &#38;&#38; length $arg &gt; $self-&gt;{max_arg_length} &#41;
+            {
+                substr&#40; $arg, $self-&gt;{max_arg_length} &#41; = &#39;...&#39;;
+            }
+
+            s/&#39;/\\&#39;/g;
+
+            # &#39;quote&#39; arg unless it looks like a number
+            $arg = &#34;&#39;$arg&#39;&#34; unless /^-?[\d.]+$/;
+
+            # print control/high ASCII chars as &#39;M-&lt;char&gt;&#39; or &#39;^&lt;char&gt;&#39;
+            s/&#40;[\200-\377]&#41;/sprintf&#40;&#34;M-%c&#34;,ord&#40;$1&#41;&#38;0177&#41;/eg;
+            s/&#40;[\0-\37\177]&#41;/sprintf&#40;&#34;^%c&#34;,ord&#40;$1&#41;^64&#41;/eg;
+        };
+
+        if &#40; my $e = $@ &#41;
+        {
+            $arg = $e =~ /malformed utf-8/i ? &#39;&#40;bad utf-8&#41;&#39; : &#39;?&#39;;
+        }
+        return $arg;
+    };
+
     $self-&gt;_record_caller_data&#40;&#41;;
 
     return $self;
@@ -147,7 +192,7 @@
 
     push @{ $self-&gt;{frames} },
         Devel::StackTraceFrame-&gt;new&#40; $c, $args,
-                                     $self-&gt;{respect_overload}, $self-&gt;{max_arg_length} &#41;;
+                                     $self-&gt;{formatter}, $self-&gt;{arg_formatter} &#41;;
 }
 
 sub next_frame
@@ -277,9 +322,9 @@
 
         $self-&gt;{args} = $_[1];
 
-        $self-&gt;{respect_overload} = $_[2];
+        $self-&gt;{formatter} = $_[2];
 
-        $self-&gt;{max_arg_length} = $_[3];
+        $self-&gt;{arg_formatter} = $_[3];
 
         return $self;
     }
@@ -298,13 +343,10 @@
     my $first = shift;
 
     my $sub = $self-&gt;subroutine;
+    my $sub_args = &#39;&#39;;
     # This code stolen straight from Carp.pm and then tweaked.  All
     # errors are probably my fault  -dave
-    if &#40;$first&#41;
-    {
-        $sub = &#39;Trace begun&#39;;
-    }
-    else
+    unless &#40;$first&#41;
     {
         # Build a string, $sub, which names the sub-routine called.
         # This may also be &#34;require ...&#34;, &#34;eval &#39;...&#39; or &#34;eval {...}&#34;
@@ -325,54 +367,14 @@
             $sub = &#39;eval {...}&#39;;
         }
 
-        # if there are any arguments in the sub-routine call, format
-        # them according to the format variables defined earlier in
-        # this file and join them onto the $sub sub-routine string
-        #
-        # We copy them because they&#39;re going to be modified.
-        #
-        if &#40; my @a = $self-&gt;args &#41;
-        {
-            for &#40;@a&#41;
-            {
-                # set args to the string &#34;undef&#34; if undefined
-                $_ = &#34;undef&#34;, next unless defined $_;
-
-                # hack!
-                $_ = $self-&gt;Devel::StackTrace::_ref_to_string&#40;$_&#41;
-                    if ref $_;
-
-                eval
-                {
-                    if &#40; $self-&gt;{max_arg_length}
-                         &#38;&#38; length $_ &gt; $self-&gt;{max_arg_length} &#41;
-                    {
-                        substr&#40; $_, $self-&gt;{max_arg_length} &#41; = &#39;...&#39;;
-                    }
-
-                    s/&#39;/\\&#39;/g;
-
-                    # &#39;quote&#39; arg unless it looks like a number
-                    $_ = &#34;&#39;$_&#39;&#34; unless /^-?[\d.]+$/;
-
-                    # print control/high ASCII chars as &#39;M-&lt;char&gt;&#39; or &#39;^&lt;char&gt;&#39;
-                    s/&#40;[\200-\377]&#41;/sprintf&#40;&#34;M-%c&#34;,ord&#40;$1&#41;&#38;0177&#41;/eg;
-                    s/&#40;[\0-\37\177]&#41;/sprintf&#40;&#34;^%c&#34;,ord&#40;$1&#41;^64&#41;/eg;
-                };
-
-                if &#40; my $e = $@ &#41;
-                {
-                    $_ = $e =~ /malformed utf-8/i ? &#39;&#40;bad utf-8&#41;&#39; : &#39;?&#39;;
-                }
-            }
+        # format subroutine arguments for inclusion in output
+        my @a = map $self-&gt;{arg_formatter}&#40;$_&#41;, $self-&gt;args;
 
-            # append &#40;&#39;all&#39;, &#39;the&#39;, &#39;arguments&#39;&#41; to the $sub string
-            $sub .= &#39;&#40;&#39; . join&#40;&#39;, &#39;, @a&#41; . &#39;&#41;&#39;;
-            $sub .= &#39; called&#39;;
-        }
+        # append &#40;&#39;all&#39;, &#39;the&#39;, &#39;arguments&#39;&#41; to the $sub string
+        $sub_args = &#39;&#40;&#39; . join&#40;&#39;, &#39;, @a&#41; . &#39;&#41;&#39;;
     }
 
-    return &#34;$sub at &#34; . $self-&gt;filename . &#39; line &#39; . $self-&gt;line;
+    return $self-&gt;{formatter}&#40; $sub, $sub_args, $self-&gt;filename, $self-&gt;line, $first&#41;;
 }
 
 1;
@@ -506,6 +508,16 @@
 argument&#39;s string representation if it is longer than this number of
 characters.
 
+=item * formatter =&gt; $subroutine_reference
+
+You can take control of how the stacktrace is formatted. Details to
+be specified.
+
+=item * arg_formatter =&gt; $subroutine_reference
+
+You can take control of how arguments to subroutine calls appearing in
+the stacktrace are formatted. Details to be specified.
+
 =back
 
 =item * $trace-&gt;next_frame
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ColorStackTrace.pm</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package ColorStackTrace;
use strict;
use warnings;
use base &#39;Devel::StackTrace&#39;;
use Term::ANSIColor; # use colors in output
use Cwd &#40;&#41;; # clear up paths
use constant DFLT_LOGFILE =&gt;
    sprintf &#39;/tmp/%s.log&#39;, join &#39;-&#39;, split &#39;::&#39;, __PACKAGE__;

my %counters; # count subroutine invocations

# print colored stacktrace
# aggressively try to get relative path
sub new {
    my&#40; $self, $cwd, %args &#41; = @_;
    $cwd ||= Cwd::cwd;
    my $fmt = sub { # callback for stacktrace formatting
        my&#40; $pkg_and_sub, $subargs, $file, $line, $first &#41; = @_;
        $counters{ $pkg_and_sub }++;
        # match package &#40;1&#41;, subroutine &#40;2&#41; and arguments &#40;3&#41;
        $pkg_and_sub =~ m/&#40;&#40;?:\w+::&#41;*&#41;&#40;\w+&#41;$/;
        my $func = color&#40;&#39;bold blue&#39;&#41;; # package color
        $func .= &#40; $1 &#38;&#38; $2 &#41;
            # subroutine and arguments colors
            ? $1 . color&#40;&#39;bold green&#39;&#41; . $2 . color&#40;&#39;magenta&#39;&#41; . $subargs
            : $pkg_and_sub;
        &#40;my $rel = Cwd::abs_path&#40; $file &#41;&#41; =~ s#^$cwd/##; # get relative path
        return sprintf &#34;%s%s %s %s %s&#34;,
            $first ? &#34;\n&#34; : &#39;&#39;, # insert newline to mark ST beginning
            color&#40;&#39;bold red&#39;&#41;    . $rel,
            color&#40;&#39;bold yellow&#39;&#41; . $line,
            $func,
            color&#40;&#39;bold yellow&#39;&#41; . &#34;&#40;$counters{ $pkg_and_sub }&#41;&#34;
            . color&#40;&#39;reset&#39;&#41;;
    };
    # add myself to the list of ignored packages
    return $self-&gt;SUPER::new&#40; formatter     =&gt; $fmt,
                            # arg_formatter =&gt; sub { &#39;xxx&#39; },
                              ignore_class =&gt; __PACKAGE__, %args &#41;;
}

# convenience constructor
sub cwd {
    my $frame_filter = sub {
        #use Data::Dumper; warn Dumper \@_;
        my %args = %{ $_[0] };
        my $pkg = $args{caller}[0];
        return if $pkg =~ m/^Class::MOP\b/;
        return 1;
    };
    return $_[0]-&gt;new&#40; &#39;/virtual/www/michael.ludwig/sandbox/eins/perl&#39;,
        frame_filter =&gt; $frame_filter,
    &#41;;
}

sub logfile {
    my&#40; $self, $logfile &#41; = @_;
    $logfile ||= DFLT_LOGFILE;
    open my $fh, &#39;&gt;&gt;&#39;, $logfile or die &#34;open $logfile: $!&#34;;
    return print $fh $self-&gt;as_string;
    close $fh;
}

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;14&nbsp;22:04:56&nbsp;2010</span>
    <span class="description">autarch [...] urth.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 14 Feb 2010 21:04:00 -0600 &#40;CST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael Ludwig via RT &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Rolsky &lt;autarch [...] urth.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, 14 Feb 2010, Michael Ludwig via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;As outlined by mail privately the other day:&#41;
&gt;
&gt; Currently, the user has limited control over the way the stacktrace is
&gt; formatted for display. It would be nice to be able to have stacktraces
&gt; in ANSI colors, for example. They stand out better in the logfile.
&gt;
&gt; The modifications required to accomodate this new feature are relatively
&gt; minor. See the attached patch &#40;not the same as the one
</div>
I think this would be better done as hooks to allow the use of subclasses 
as needed, rather than adding functionality to D::ST itself.

If you&#39;re using Exception::Class, you might also want to tweak that module 
to allow for a custom stacktrace subclass.


-dave

/*============================================================
<span class="clickylink"><a target="new" rel="nofollow" href="http://VegGuide.org">http://VegGuide.org</a></span>               <span class="clickylink"><a target="new" rel="nofollow" href="http://blog.urth.org">http://blog.urth.org</a></span>
Your guide to all that&#39;s veg      House Absolute&#40;ly Pointless&#41;
============================================================*/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;14&nbsp;22:04:57&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;15&nbsp;05:54:50&nbsp;2010</span>
    <span class="description">milu71 [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> milu71 [...] googlemail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am So 14. Feb 2010, 22:04:56, autarch@urth.org schrieb:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; The modifications required to accomodate this new feature are relatively
&gt; &gt; minor. See the attached patch &#40;not the same as the one
</div>&gt; 
&gt; I think this would be better done as hooks to allow the use of subclasses 
&gt; as needed, rather than adding functionality to D::ST itself.
</div>
My patch does not add any functionality at all to D::ST. It just allows the user to pass in 
subroutine references as parameters, defaulting to the existing formatting implementation.

Plus, it resolves what you&#39;ve marked as &#34;hack&#34; in the code, where StackFrame explicitly calls 
StackTrace&#39;s method, and it also gets rid of one redundant if statement preceding a for loop.

Maybe you could take another look at the patch? The documentation will be updated once 
you agree this enhancement makes sense.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you&#39;re using Exception::Class, you might also want to tweak that module 
&gt; to allow for a custom stacktrace subclass.
</div>
I&#39;m not using Exception::Class. Devel::StackTrace is just really fine in that it has almost zero 
dependencies.

Best,

Michael
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;15&nbsp;05:59:20&nbsp;2010</span>
    <span class="description">milu71 [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> milu71 [...] googlemail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am So 14. Feb 2010, 22:04:56, autarch@urth.org schrieb:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I think this would be better done as hooks to allow the use of subclasses 
&gt; as needed, rather than adding functionality to D::ST itself.
</div>
I considered subclassing, but the arrangement of D::ST as a pair of classes - Devel::StackTrace 
and Devel::StackTraceFrame - made parametrizing seem to me less intrusive and easier.

Michael
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Mar&nbsp;07&nbsp;14:52:09&nbsp;2010</span>
    <span class="description">milu71 [...] googlemail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> milu71 [...] googlemail.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Dave,

Am So 14. Feb 2010, 22:04:56, autarch@urth.org schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I think this would be better done as hooks to allow the use of subclasses 
&gt; as needed, rather than adding functionality to D::ST itself.
</div>
Hi Dave,

are you still considering the issue or have you made up your mind about
it? It would be good to let me know.

If you tend to decline the patch, are you considering releasing a new
version of D::ST that provides hooks for formatting?

Please note that my patch does not add functionality to D::ST itself, it
just allows for parameterizing the formatting code, leaving your
formatting implementation as the default handler.

I think that&#39;s preferable to having to extend D::ST in order to modify
how messages are formatted, and it exploits the great Perl feature of
subroutines as data objects, but ultimately it might be a matter of
taste, and some people just prefer inheritance, despite Perl&#39;s poor OO
support built up around @ISA.

Best,

Michael
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;09&nbsp;22:16:19&nbsp;2010</span>
    <span class="description">autarch [...] urth.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 9 Mar 2010 21:15:18 -0600 &#40;CST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael Ludwig via RT &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Rolsky &lt;autarch [...] urth.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun, 7 Mar 2010, Michael Ludwig via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If you tend to decline the patch, are you considering releasing a new
&gt; version of D::ST that provides hooks for formatting?
</div>
Like I said, I&#39;d rather see a hooks to allow using a different Frame class 
in D::ST itself. Then you can easily write a subclass which formats 
however you like. That way, in the future, if someone else wants an 
unrelated feature which would otherwise need a hook, they can just write a 
subclass.


-dave

/*============================================================
<span class="clickylink"><a target="new" rel="nofollow" href="http://VegGuide.org">http://VegGuide.org</a></span>               <span class="clickylink"><a target="new" rel="nofollow" href="http://blog.urth.org">http://blog.urth.org</a></span>
Your guide to all that&#39;s veg      House Absolute&#40;ly Pointless&#41;
============================================================*/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;07:59:02&nbsp;2010</span>
    <span class="description">milu71 [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Mar 2010 08:31:01 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;autarch [...] urth.org via RT&#34; &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Ludwig &lt;milu71 [...] gmx.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">autarch@urth.org via RT schrieb am 09.03.2010 um 22:16:26 &#40;-0500&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=54611">http://rt.cpan.org/Ticket/Display.html?id=54611</a></span> &gt;
&gt; 
&gt; On Sun, 7 Mar 2010, Michael Ludwig via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; If you tend to decline the patch, are you considering releasing a
&gt; &gt; new version of D::ST that provides hooks for formatting?
</div>&gt; 
&gt; Like I said, I&#39;d rather see a hooks to allow using a different Frame
&gt; class in D::ST itself. Then you can easily write a subclass which
&gt; formats however you like. That way, in the future, if someone else
&gt; wants an unrelated feature which would otherwise need a hook, they can
&gt; just write a subclass.
</div>
Well, fair enough, it&#39;s your module. I think that way, it&#39;ll take a
little more refactoring than going with callback parameters. I&#39;m waiting
for the release, then.

-- 
Michael Ludwig
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;12:33:42&nbsp;2010</span>
    <span class="description">autarch [...] urth.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Mar 2010 09:43:23 -0600 &#40;CST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael Ludwig via RT &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Rolsky &lt;autarch [...] urth.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 10 Mar 2010, Michael Ludwig via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Well, fair enough, it&#39;s your module. I think that way, it&#39;ll take a
&gt; little more refactoring than going with callback parameters. I&#39;m waiting
&gt; for the release, then.
</div>
You might be waiting a while. I think this is _your_ itch, not mine.


-dave

/*============================================================
<span class="clickylink"><a target="new" rel="nofollow" href="http://VegGuide.org">http://VegGuide.org</a></span>               <span class="clickylink"><a target="new" rel="nofollow" href="http://blog.urth.org">http://blog.urth.org</a></span>
Your guide to all that&#39;s veg      House Absolute&#40;ly Pointless&#41;
============================================================*/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;15:31:15&nbsp;2010</span>
    <span class="description">milu71 [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Mar 2010 21:28:48 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;autarch [...] urth.org via RT&#34; &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Ludwig &lt;milu71 [...] gmx.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">autarch@urth.org via RT schrieb am 10.03.2010 um 12:33:43 &#40;-0500&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=54611">https://rt.cpan.org/Ticket/Display.html?id=54611</a></span> &gt;
&gt; 
&gt; On Wed, 10 Mar 2010, Michael Ludwig via RT wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; Well, fair enough, it&#39;s your module. I think that way, it&#39;ll take a
&gt; &gt; little more refactoring than going with callback parameters. I&#39;m
&gt; &gt; waiting for the release, then.
</div>&gt; 
&gt; You might be waiting a while. I think this is _your_ itch, not mine.
</div>
Cool! Maybe a fork will do then :-&#41;

-- 
Michael Ludwig
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;16:55:50&nbsp;2010</span>
    <span class="description">autarch [...] urth.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Mar 2010 15:54:49 -0600 &#40;CST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Michael Ludwig via RT &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Dave Rolsky &lt;autarch [...] urth.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, 10 Mar 2010, Michael Ludwig via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       Queue: Devel-StackTrace
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=54611">http://rt.cpan.org/Ticket/Display.html?id=54611</a></span> &gt;
&gt;
&gt; autarch@urth.org via RT schrieb am 10.03.2010 um 12:33:43 &#40;-0500&#41;:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=54611">https://rt.cpan.org/Ticket/Display.html?id=54611</a></span> &gt;
&gt;&gt;
&gt;&gt; On Wed, 10 Mar 2010, Michael Ludwig via RT wrote:
&gt;&gt;
<div class="message-stanza open">&gt;&gt;&gt; Well, fair enough, it&#39;s your module. I think that way, it&#39;ll take a
&gt;&gt;&gt; little more refactoring than going with callback parameters. I&#39;m
&gt;&gt;&gt; waiting for the release, then.
</div>&gt;&gt;
&gt;&gt; You might be waiting a while. I think this is _your_ itch, not mine.
</div>&gt;
&gt; Cool! Maybe a fork will do then :-&#41;
</div>
A fork isn&#39;t necessary. Just give me a patch to add subclassibility and 
I&#39;ll apply it and release.


-dave

/*============================================================
<span class="clickylink"><a target="new" rel="nofollow" href="http://VegGuide.org">http://VegGuide.org</a></span>               <span class="clickylink"><a target="new" rel="nofollow" href="http://blog.urth.org">http://blog.urth.org</a></span>
Your guide to all that&#39;s veg      House Absolute&#40;ly Pointless&#41;
============================================================*/
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;10&nbsp;17:57:31&nbsp;2010</span>
    <span class="description">milu71 [...] gmx.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #54611] Enhancement proposal: Allow user to format stacktrace</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 10 Mar 2010 23:56:21 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;autarch [...] urth.org via RT&#34; &lt;bug-Devel-StackTrace [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael Ludwig &lt;milu71 [...] gmx.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">autarch@urth.org via RT schrieb am 10.03.2010 um 16:55:51 &#40;-0500&#41;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=54611">http://rt.cpan.org/Ticket/Display.html?id=54611</a></span> &gt;
&gt; 
&gt; On Wed, 10 Mar 2010, Michael Ludwig via RT wrote:
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Cool! Maybe a fork will do then :-&#41;
</div>&gt; 
&gt; A fork isn&#39;t necessary. Just give me a patch to add subclassibility
&gt; and I&#39;ll apply it and release.
</div>
Okay, that&#39;s a different song. I&#39;ll see what I can come up - later.
Won&#39;t have time to look at this during the next couple of days.

-- 
Michael Ludwig
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;07&nbsp;14:52:27&nbsp;2016</span>
    <span class="description">DROLSKY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ticket migrated to GitHub as <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/houseabsolute/Devel-StackTrace/issues/12">https://github.com/houseabsolute/Devel-StackTrace/issues/12</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;07&nbsp;14:52:28&nbsp;2016</span>
    <span class="description">DROLSKY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
