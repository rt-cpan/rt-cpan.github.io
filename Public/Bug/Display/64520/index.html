<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #64520 for ZeroMQ: ZeroMQ-0.04 Fails to compile on RHEL 5, Perl 5.8.8.</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #64520 for ZeroMQ: ZeroMQ-0.04 Fails to compile on RHEL 5, Perl 5.8.8.</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/ZeroMQ/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/ZeroMQ/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/ZeroMQ/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/ZeroMQ/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ZeroMQ">ZeroMQ CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">64520</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/ZeroMQ/Active/">ZeroMQ</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jason [...] ball.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-233900-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.04    </td>
  </tr>
  <tr id="CF-233901-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;00:03:20&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ZeroMQ-0.04 Fails to compile on RHEL 5, Perl 5.8.8.</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have tested the build with zeromq-2.1.0 and 2.0.10 and get the same
errors.

=======================================
[root@bjbld02 ZeroMQ-0.04]# make
gcc -c  &#34;-I.&#34; &#34;-I.&#34; -D_REENTRANT -D_GNU_SOURCE -fno-strict-aliasing
-pipe -Wdeclaration-after-statement -I/usr/local/include
-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/include/gdbm -Wall
-Wextra -Wdeclaration-after-statement -Wc++-compat -O2 -g -pipe -Wall
-Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector
--param=ssp-buffer-size=4 -m64 -mtune=generic   -DVERSION=\&#34;0.04\&#34;
-DXS_VERSION=\&#34;0.04\&#34; -o xs/perl_zeromq.o -fPIC
&#34;-I/usr/lib64/perl5/5.8.8/x86_64-linux-thread-multi/CORE&#34;  -DUSE_PPPORT
xs/perl_zeromq.c
In file included from xs/perl_zeromq.xs:2:
xs/perl_zeromq.h:20: error: expected specifier-qualifier-list before &#39;tTHX&#39;
In file included from xs/perl_zeromq.xs:2:
xs/perl_zeromq.h:47:30: warning: no newline at end of file
xs/perl_zeromq.xs: In function &#39;PerlZMQ_Raw_Context_mg_free&#39;:
xs/perl_zeromq.xs:62: error: &#39;PerlZMQ_Raw_Context&#39; has no member named
&#39;interp&#39;
xs/perl_zeromq.xs:67: error: &#39;PerlZMQ_Raw_Context&#39; has no member named
&#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_init&#39;:
xs/perl_zeromq.xs:191: warning: value computed is not used
xs/perl_zeromq.xs:192: error: &#39;PerlZMQ_Raw_Context&#39; has no member named
&#39;interp&#39;
xs/perl_zeromq.xs:193: error: &#39;PerlZMQ_Raw_Context&#39; has no member named
&#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_term&#39;:
xs/perl_zeromq.xs:208: error: &#39;PerlZMQ_Raw_Context&#39; has no member named
&#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_socket&#39;:
xs/perl_zeromq.xs:311: error: &#39;PerlZMQ_Raw_Context&#39; has no member named
&#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_poll&#39;:
xs/perl_zeromq.xs:547: warning: comparison between signed and unsigned
xs/perl_zeromq.xs:548: warning: comparison between signed and unsigned
xs/perl_zeromq.xs:567: warning: passing argument 5 of &#39;Perl_hv_fetch&#39;
makes integer from pointer without a cast
xs/perl_zeromq.xs:578: warning: passing argument 5 of &#39;Perl_hv_fetch&#39;
makes integer from pointer without a cast
xs/perl_zeromq.xs:587: warning: passing argument 5 of &#39;Perl_hv_fetch&#39;
makes integer from pointer without a cast
xs/perl_zeromq.xs:595: warning: passing argument 5 of &#39;Perl_hv_fetch&#39;
makes integer from pointer without a cast
xs/perl_zeromq.c: In function &#39;boot_ZeroMQ&#39;:
xs/perl_zeromq.c:1492: error: &#39;ZMQ_XSUB&#39; undeclared &#40;first use in this
function&#41;
xs/perl_zeromq.c:1492: error: &#40;Each undeclared identifier is reported
only once
xs/perl_zeromq.c:1492: error: for each function it appears in.&#41;
xs/perl_zeromq.c:1534: error: &#39;ZMQ_RECOVERY_IVL_MSEC&#39; undeclared &#40;first
use in this function&#41;
xs/perl_zeromq.c:1548: error: &#39;ZMQ_XPUB&#39; undeclared &#40;first use in this
function&#41;
make: *** [xs/perl_zeromq.o] Error 1
=================================
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;00:15:35&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Argh, I know what the error is. Thanks for the report.
I&#39;ll get around to fixing it soon-ish, hopefully within a day &#40;cross my fingers&#41;

--d
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;00:15:36&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;00:57:26&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, can you check if this tarball works for you?

<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/lestrrat/ZeroMQ-Perl/tarball/master">https://github.com/lestrrat/ZeroMQ-Perl/tarball/master</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;01:26:14&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 06 00:57:26 2011, DMAKI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi, can you check if this tarball works for you?
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/lestrrat/ZeroMQ-Perl/tarball/master">https://github.com/lestrrat/ZeroMQ-Perl/tarball/master</a></span>
</div>
A different error this time - not sure why on this one..

Writing README from lib/ZeroMQ.pm
Can&#39;t locate object method &#34;output_fh&#34; via package &#34;Pod::Text&#34; at
/usr/lib/perl5/vendor_perl/5.8.8/Module/Install/ReadmeFromPod.pm line 24.


if I bypass that step in the Makefile.PL the build dies due to dependencies:

/usr/bin/perl &#34;-Iinc&#34; /usr/lib/perl5/vendor_perl/5.8.8/ExtUtils/xsubpp 
-typemap /usr/lib/perl5/5.8.8/ExtUtils/typemap  xs/perl_zeromq.xs &gt;
xs/perl_zeromq.xsc &#38;&#38; mv xs/perl_zeromq.xsc xs/perl_zeromq.c
Cannot open &#39;const-xs.inc&#39;: No such file or directory in perl_zeromq.xs,
line 178
make: *** [xs/perl_zeromq.c] Error 1


Ive had this problem with all the releases since ZeroMQ_02, it&#39;s only
today I&#39;m trying to upgrade due to some nasty bugs...


Cheers
J.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;01:32:35&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Writing README from lib/ZeroMQ.pm
&gt; Can&#39;t locate object method &#34;output_fh&#34; via package &#34;Pod::Text&#34; at
&gt; /usr/lib/perl5/vendor_perl/5.8.8/Module/Install/ReadmeFromPod.pm line 24.
&gt; 
&gt; 
&gt; if I bypass that step in the Makefile.PL the build dies due to dependencies:
</div>
Okay, let&#39;s just remove that one bit. I don&#39;t need to include it in the dist.
I&#39;ll go ahead and remove that from the Makefile.PL

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; /usr/bin/perl &#34;-Iinc&#34; /usr/lib/perl5/vendor_perl/5.8.8/ExtUtils/xsubpp 
&gt; -typemap /usr/lib/perl5/5.8.8/ExtUtils/typemap  xs/perl_zeromq.xs &gt;
&gt; xs/perl_zeromq.xsc &#38;&#38; mv xs/perl_zeromq.xsc xs/perl_zeromq.c
&gt; Cannot open &#39;const-xs.inc&#39;: No such file or directory in perl_zeromq.xs,
&gt; line 178
&gt; make: *** [xs/perl_zeromq.c] Error 1
&gt; 
&gt; 
&gt; Ive had this problem with all the releases since ZeroMQ_02, it&#39;s only
&gt; today I&#39;m trying to upgrade due to some nasty bugs...
</div>

Now, this is presumably because you&#39;re failing to run tools/genfiles.pl

can you simply run perl tools/genfiles.pl by hand and tell me what happens? I guess there&#39;s 
an error.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;01:44:18&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Now, this is presumably because you&#39;re failing to run
&gt; tools/genfiles.pl
&gt; 
&gt; can you simply run perl tools/genfiles.pl by hand and tell me what
&gt; happens? I guess there&#39;s
&gt; an error.
</div>
===
$perl tools/genfiles.pl
Could not open file /usr/local/include/zmq.h for reading: No such file
or directory at tools/genfiles.pl line 79
===

Changing genfiles.pl to specify /usr/include to match this install fixed
that error.  Easily patched.

Rerunning the build failed with the same error as first reported:

=====
In file included from xs/perl_zeromq.xs:2:
xs/perl_zeromq.h:20: error: expected specifier-qualifier-list before &#39;tTHX&#39;
In file included from xs/perl_zeromq.xs:2:
xs/perl_zeromq.h:47:30: warning: no newline at end of file
xs/perl_zeromq.xs: In function &#39;PerlZMQ_Raw_Context_mg_free&#39;:
======

etc.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;01:46:51&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">hold on ---  some of the constants are from zeromq 2.1.0.  I&#39;ll update
and retry with that version tonight.

Cheers
J.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;01:51:06&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">okay, so right now I&#39;m hardcoding /usr/local/include/zmq.h because in my environment 
there&#39;s no way to auto-detect the location of your .h file.

in the future you can do 

    ZMQ_H=/usr/include/zmq.h perl Makefile.PL

or you can give me a patch that uses pkg-config to auto-probe where zmq.h is :&#41;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In file included from xs/perl_zeromq.xs:2:
&gt; xs/perl_zeromq.h:20: error: expected specifier-qualifier-list before &#39;tTHX&#39;
&gt; In file included from xs/perl_zeromq.xs:2:
</div>
that above tTHX looks odd. hmm. 
are you using threaded or non-threaded perl?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;01:52:12&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">BTW, just to make sure, please run make clean, and THEN run perl tools/genfiles.pl.

On 2011-1月-06 木 01:46:51, agronaught wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; hold on ---  some of the constants are from zeromq 2.1.0.  I&#39;ll update
&gt; and retry with that version tonight.
&gt; 
&gt; Cheers
&gt; J.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;02:11:24&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; In file included from xs/perl_zeromq.xs:2:
&gt; &gt; xs/perl_zeromq.h:20: error: expected specifier-qualifier-list before
</div>&gt; &#39;tTHX&#39;
<div class="message-stanza open">&gt; &gt; In file included from xs/perl_zeromq.xs:2:
</div>&gt; 
&gt; that above tTHX looks odd. hmm.
&gt; are you using threaded or non-threaded perl?
</div>
ah, tTHX doesn&#39;t exist in perl-5.8.8. I&#39;m going to have to think of a better way to do this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;03:15:42&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; ah, tTHX doesn&#39;t exist in perl-5.8.8. I&#39;m going to have to think of a
&gt; better way to do this.
&gt;
</div>
I&#39;m not even sure what tTHX is.. some reading to do...

The build fails against 0MQ 2.1.0 and 2.0.10.  There are some errors that show this version of 
the perl module will only work against 2.1.0 and above - not the end of the world there ;&#41;

====
In file included from xs/perl_zeromq.xs:2:
xs/perl_zeromq.h:20: error: expected specifier-qualifier-list before &#39;tTHX&#39;
In file included from xs/perl_zeromq.xs:2:
xs/perl_zeromq.h:47:30: warning: no newline at end of file
xs/perl_zeromq.xs: In function &#39;PerlZMQ_Raw_Context_mg_free&#39;:
xs/perl_zeromq.xs:62: error: &#39;PerlZMQ_Raw_Context&#39; has no member named &#39;interp&#39;
xs/perl_zeromq.xs:67: error: &#39;PerlZMQ_Raw_Context&#39; has no member named &#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_init&#39;:
xs/perl_zeromq.xs:191: warning: value computed is not used
xs/perl_zeromq.xs:192: error: &#39;PerlZMQ_Raw_Context&#39; has no member named &#39;interp&#39;
xs/perl_zeromq.xs:193: error: &#39;PerlZMQ_Raw_Context&#39; has no member named &#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_term&#39;:
xs/perl_zeromq.xs:208: error: &#39;PerlZMQ_Raw_Context&#39; has no member named &#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_socket&#39;:
xs/perl_zeromq.xs:311: error: &#39;PerlZMQ_Raw_Context&#39; has no member named &#39;ctxt&#39;
xs/perl_zeromq.xs: In function &#39;XS_ZeroMQ__Raw_zmq_poll&#39;:
xs/perl_zeromq.xs:547: warning: comparison between signed and unsigned
xs/perl_zeromq.xs:548: warning: comparison between signed and unsigned
xs/perl_zeromq.xs:567: warning: passing argument 5 of &#39;Perl_hv_fetch&#39; makes integer from 
pointer without a cast
xs/perl_zeromq.xs:578: warning: passing argument 5 of &#39;Perl_hv_fetch&#39; makes integer from 
pointer without a cast
xs/perl_zeromq.xs:587: warning: passing argument 5 of &#39;Perl_hv_fetch&#39; makes integer from 
pointer without a cast
xs/perl_zeromq.xs:595: warning: passing argument 5 of &#39;Perl_hv_fetch&#39; makes integer from 
pointer without a cast
make: *** [xs/perl_zeromq.o] Error 1
===
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;03:23:09&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">which version of perl are you using ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;04:44:53&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011-1月-06 木 03:23:09, agronaught wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; which version of perl are you using ?
</div>
my perl is:

$ perl -v
This is perl 5, version 12, subversion 2 &#40;v5.12.2&#41; built for darwin-thread-multi-2level

but I also switch back and forth between 5.12.2 threaded or not, and 5.10.1 threaded or not.


I&#39;m just ran a very rudimentary  test with perl-5.8.9 threaded.
Can you checkout the tarball again?

If it still doesn&#39;t work, please show me your perl -V.
If you can attach the entire build process to this ticket, that would help too.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;04:51:25&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jan 06 03:23:09 2011, agronaught wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; which version of perl are you using ?
</div>
I can confirm the build works with perl-5.12.2.  I&#39;ll proceed with this for now.

J.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;05:08:29&nbsp;2011</span>
    <span class="description">jason [...] ball.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jason [...] ball.net</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; $ perl -v
&gt; This is perl 5, version 12, subversion 2 &#40;v5.12.2&#41; built for darwin-
&gt; thread-multi-2level
&gt; 
&gt; but I also switch back and forth between 5.12.2 threaded or not, and
&gt; 5.10.1 threaded or not.
&gt; 
&gt; 
&gt; I&#39;m just ran a very rudimentary  test with perl-5.8.9 threaded.
&gt; Can you checkout the tarball again?
</div>
The module compiled that time and passed the tests with the stock perl on RHEL5 and Centos 
5.  I&#39;ll upgrade my environment &#40;large scale prototype in progress&#41; and see if I get the 
message corruptions I was seeing on earlier versions of the API -- no point raising a bug 
before testing the new version ;&#41;

===
[root@bjbld02 lestrrat-ZeroMQ-Perl-95ea6ea]# make test
PERL_DL_NONLAZY=1 /usr/bin/perl &#34;-MExtUtils::Command::MM&#34; &#34;-e&#34; &#34;\$ENV{q{LC_ALL}} = 
q{C}; test_harness&#40;0, &#39;inc&#39;, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;; &#34; t/*.t xt/*.t
t/000_compile.t .......... 1/? # 
#    This is ZeroMQ.pm version 0.04
#    Linked against zeromq2 2.1.0
t/000_compile.t .......... ok   
t/001_context.t .......... ok   
t/002_socket.t ........... ok   
t/003_message.t .......... ok   
t/004_version.t .......... ok   
t/005_poll.t ............. ok   
t/006_anyevent.t ......... ok   
t/100_basic.t ............ ok   
t/101_threads.t .......... ok   
t/103_json.t ............. ok    
t/104_ipc.t .............. ok   
xt/100_eg_hello_world.t .. ok   
xt/101_eg_pubsub.t ....... ok   
xt/102_eg_threaded.t ..... skipped: # Current version of Test::SharedFork does not supports 
ithreads. at /usr/lib/perl5/site_perl/5.8.8/Test/SharedFork.pm line 50.
xt/103_eg_xreqxrep.t ..... ok   
xt/999_leak.t ............ skipped: Set TEST_LEAK to run leak tests
xt/999_pod-coverage.t .... ok   
xt/999_pod.t ............. ok   
All tests successful.
Files=18, Tests=73,  6 wallclock secs &#40; 0.09 usr  0.18 sys +  1.45 cusr  0.52 csys =  2.24 CPU&#41;
Result: PASS

Thanks for the work :&#41;  Let me know how I can help.

Cheers
J.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;05:24:33&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The module compiled that time and passed the tests with the stock perl
&gt; on RHEL5 and Centos
&gt; 5. 
</div>
Cool, I believe RHEL was 5.8.8-threaded, so tTHX problem solved :&#41;

I&#39;ll close this ticket for now, and release 0.05 tonight.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;06&nbsp;05:24:35&nbsp;2011</span>
    <span class="description">dmaki [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
