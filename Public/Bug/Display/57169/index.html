<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #57169 for Date-Calc: Bug: Date-Calc-6.3 errors in parsing calendar profiles</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #57169 for Date-Calc: Bug: Date-Calc-6.3 errors in parsing calendar profiles</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Date-Calc/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Date-Calc/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Date-Calc/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Date-Calc/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Date-Calc">Date-Calc CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">57169</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">10 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Date-Calc/Active/">Date-Calc</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">STBEY [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
prote [...] fmi.uni-stuttgart.de

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-9494-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-9495-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;03&nbsp;09:39:30&nbsp;2010</span>
    <span class="description">prote [...] fmi.uni-stuttgart.de -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug: Date-Calc-6.3 errors in parsing calendar profiles</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 3 May 2010 15:39:13 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Date-Calc [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Horst Prote &lt;prote [...] fmi.uni-stuttgart.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello!

I&#39;m a Gentoo User and after upgrading from dev-perl/Date-Calc-5.4 to
dev-perl/Date-Calc-6.3 I got this error from a perl script using an
german calendar profile:
  Date::Calendar::Year::new&#40;&#41;: date &#39;#2/Sun/May&#39; for day &#39;Muttertag&#39; is invalid

Steps to Reproduce:
1. Upgrade to dev-perl/Date-Calc-6.3
2. Run this little perl script:

use Date::Calc qw&#40;Decode_Language&#41;;
use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
use Date::Calendar;
$cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;},
Decode_Language&#40;&#34;deutsch&#34;&#41; &#41;;


Actual Results:  
Date::Calendar::Year::new&#40;&#41;: date &#39;#2/Sun/May&#39; for day &#39;Muttertag&#39; is invalid
at - line 4


Expected Results:  
No error here



This is caused by adding the &#34;$lang&#34; parameter to
  &#38;_invalid_&#40;$item,$name&#41; unless &#40;$dow = Decode_Day_of_Week&#40;$dow,$lang&#41;&#41;;
in line 244 of /usr/lib/perl5/vendor_perl/5.8.8/Date/Calendar/Year.pm but still
using english tokens like &#34;Sun&#34; &#40;in german this would be &#34;Son&#34;&#41; in the calendar
profiles &#40;/usr/lib/perl5/vendor_perl/5.8.8/Date/Calendar/Profiles.pm&#41;. So this
may affect other languages too.

Possible fixes are:
- remove the optional &#34;$lang&#34; parameter &#40;as it was in dev-perl/Date-Calc-5.4&#41;
- change the english tokens in all affected non-english calendar profiles to
their language specific names


Horst
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;14&nbsp;05:20:15&nbsp;2010</span>
    <span class="description">STBEY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">10 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon May 03 09:39:30 2010, prote@fmi.uni-stuttgart.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hello!
&gt; 
&gt; I&#39;m a Gentoo User and after upgrading from dev-perl/Date-Calc-5.4 to
&gt; dev-perl/Date-Calc-6.3 I got this error from a perl script using an
&gt; german calendar profile:
&gt;   Date::Calendar::Year::new&#40;&#41;: date &#39;#2/Sun/May&#39; for day &#39;Muttertag&#39;
&gt; is invalid
&gt; 
&gt; Steps to Reproduce:
&gt; 1. Upgrade to dev-perl/Date-Calc-6.3
&gt; 2. Run this little perl script:
&gt; 
&gt; use Date::Calc qw&#40;Decode_Language&#41;;
&gt; use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
&gt; use Date::Calendar;
&gt; $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;},
&gt; Decode_Language&#40;&#34;deutsch&#34;&#41; &#41;;
&gt; 
&gt; 
&gt; Actual Results:
&gt; Date::Calendar::Year::new&#40;&#41;: date &#39;#2/Sun/May&#39; for day &#39;Muttertag&#39; is
&gt; invalid
&gt; at - line 4
&gt; 
&gt; 
&gt; Expected Results:
&gt; No error here
&gt; 
&gt; 
&gt; 
&gt; This is caused by adding the &#34;$lang&#34; parameter to
&gt;   &#38;_invalid_&#40;$item,$name&#41; unless &#40;$dow =
&gt; Decode_Day_of_Week&#40;$dow,$lang&#41;&#41;;
&gt; in line 244 of /usr/lib/perl5/vendor_perl/5.8.8/Date/Calendar/Year.pm
&gt; but still
&gt; using english tokens like &#34;Sun&#34; &#40;in german this would be &#34;Son&#34;&#41; in the
&gt; calendar
&gt; profiles &#40;/usr/lib/perl5/vendor_perl/5.8.8/Date/Calendar/Profiles.pm&#41;.
&gt; So this
&gt; may affect other languages too.
&gt; 
&gt; Possible fixes are:
&gt; - remove the optional &#34;$lang&#34; parameter &#40;as it was in dev-perl/Date-
&gt; Calc-5.4&#41;
&gt; - change the english tokens in all affected non-english calendar
&gt; profiles to
&gt; their language specific names
&gt; 
&gt; 
&gt; Horst
</div>
Since the calendar profile is written in English, adding the optional
parameter &#34;Decode_Language&#40;&#39;deutsch&#39;&#41;&#34; makes no sense.

Beware that the country for which a profile is written and the language
the dates are written in and the language of the names of the holidays
attributed to these dates are all independent from each other!

So you have to pick whatever you want, but of course you need to be
consistent.

The optional &#34;$lang&#34; parameter in Date::Calendar-&gt;new&#40;&#41; only refers to
the language of the dates, NOT to the country and neither to the
language of the holiday names.

And of course you can write your own profile using German dates, in
which case you need to use the &#34;Decode_Language&#40;&#39;deutsch&#39;&#41;&#34; parameter.

So it&#39;s not a bug, it&#39;s just a question of consistent use.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;14&nbsp;05:20:23&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;14&nbsp;05:20:25&nbsp;2010</span>
    <span class="description">STBEY [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;14&nbsp;05:20:26&nbsp;2010</span>
    <span class="description">STBEY [...] cpan.org -  Given to STBEY</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;14&nbsp;09:25:38&nbsp;2010</span>
    <span class="description">prote [...] fmi.uni-stuttgart.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #57169] Bug: Date-Calc-6.3 errors in parsing calendar profiles </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 14 May 2010 15:25:22 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Date-Calc [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Horst Prote &lt;prote [...] fmi.uni-stuttgart.de&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Steffen Beyer via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"> &gt; Since the calendar profile is written in English, adding the optional
 &gt; parameter &#34;Decode_Language&#40;&#39;deutsch&#39;&#41;&#34; makes no sense.
 &gt;
 &gt; ...
 &gt;
 &gt; The optional &#34;$lang&#34; parameter in Date::Calendar-&gt;new&#40;&#41; only refers to
 &gt; the language of the dates, NOT to the country and neither to the
 &gt; language of the holiday names.
</div>Oh, I see. So that was me misunderstanding the manual aka reading it
too fast, sorry.

But I&#39;m still left with one problem:
Before the upgrade to Date-Calc-6.3 I used the now deprecated global
setting of the language:
  Language&#40;Decode_Language&#40;&#34;deutsch&#34;&#41;&#41;;
which translated the names of days and months into german &#40;especially
the day-of-the-week returned by the labels&#40;&#41; function.

Now I learned from &#34;perldoc Date::Calc&#34;
  BEWARE that when using the function &#34;&#34;Language&#40;&#41;&#34;&#34;, the selected language is a
  global setting, shared by all threads or modules you might be running concurrently,
  thus possibly causing conflicts between them.

  In order to avoid these conflicts, you should NEVER use the function &#34;&#34;Language&#40;&#41;&#34;&#34;,
  but should ALWAYS pass a language number &#40;as returned by the function &#34;&#34;Decode_Lan-
  guage&#40;&#41;&#34;&#34;&#41; to the functions which are language-dependent, which are:

  &#34;Decode_Month&#40;&#41;&#34;, &#34;Decode_Day_of_Week&#40;&#41;&#34;, &#34;Compressed_to_Text&#40;&#41;&#34;, &#34;Date_to_Text&#40;&#41;&#34;,
  &#34;Date_to_Text_Long&#40;&#41;&#34;, &#34;Calendar&#40;&#41;&#34;, &#34;Month_to_Text&#40;&#41;&#34;, &#34;Day_of_Week_to_Text&#40;&#41;&#34;,
  &#34;Day_of_Week_Abbreviation&#40;&#41;&#34;, &#34;Decode_Date_EU&#40;&#41;&#34;, &#34;Decode_Date_US&#40;&#41;&#34;,
  &#34;Decode_Date_EU2&#40;&#41;&#34;, &#34;Decode_Date_US2&#40;&#41;&#34;, &#34;Parse_Date&#40;&#41;&#34;.
But labels&#40;&#41; is not in this list and so this Code
  use Date::Calc qw&#40;Decode_Language&#41;;
  use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
  use Date::Calendar;
  $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
  @labels = $cal-&gt;labels&#40;2010,5,13&#41;;
  print &#34;@labels&#34;,&#34;\n&#34;;
prints
  Thursday Christi Himmelfahrt

But as I now read the manuals carefully I found the solution:
  use Date::Calc qw&#40;Decode_Language Decode_Day_of_Week Day_of_Week_to_Text&#41;;
  use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
  use Date::Calendar;
  $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
  @labels = $cal-&gt;labels&#40;2010,5,13&#41;;
  $dow = shift&#40;@labels&#41;;
  $dow = Decode_Day_of_Week&#40;$dow&#41;;
  $dow = Day_of_Week_to_Text&#40;$dow,Decode_Language&#40;&#34;deutsch&#34;&#41; &#41;;
  print &#34;$dow @labels\n&#34;;
This now prints
  Donnerstag Christi Himmelfahrt

So as you said, it&#39;s not a bug, but as this bloats the code a bit:
Would it be possible to add an optional LANG argument to labels which
translates the returned day-of-the-week?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;14&nbsp;09:25:42&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;16&nbsp;09:10:48&nbsp;2010</span>
    <span class="description">STBEY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri May 14 09:25:38 2010, prote@fmi.uni-stuttgart.de wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; But I&#39;m still left with one problem:
&gt; Before the upgrade to Date-Calc-6.3 I used the now deprecated global
&gt; setting of the language:
&gt;   Language&#40;Decode_Language&#40;&#34;deutsch&#34;&#41;&#41;;
&gt; which translated the names of days and months into german &#40;especially
&gt; the day-of-the-week returned by the labels&#40;&#41; function.
&gt; 
&gt; Now I learned from &#34;perldoc Date::Calc&#34;
&gt;   BEWARE that when using the function &#34;&#34;Language&#40;&#41;&#34;&#34;, the selected
&gt; language is a
&gt;   global setting, shared by all threads or modules you might be
&gt; running concurrently,
&gt;   thus possibly causing conflicts between them.
&gt; 
&gt;   In order to avoid these conflicts, you should NEVER use the function
&gt; &#34;&#34;Language&#40;&#41;&#34;&#34;,
&gt;   but should ALWAYS pass a language number &#40;as returned by the
&gt; function &#34;&#34;Decode_Lan-
&gt;   guage&#40;&#41;&#34;&#34;&#41; to the functions which are language-dependent, which are:
&gt; 
&gt;   &#34;Decode_Month&#40;&#41;&#34;, &#34;Decode_Day_of_Week&#40;&#41;&#34;, &#34;Compressed_to_Text&#40;&#41;&#34;,
&gt; &#34;Date_to_Text&#40;&#41;&#34;,
&gt;   &#34;Date_to_Text_Long&#40;&#41;&#34;, &#34;Calendar&#40;&#41;&#34;, &#34;Month_to_Text&#40;&#41;&#34;,
&gt; &#34;Day_of_Week_to_Text&#40;&#41;&#34;,
&gt;   &#34;Day_of_Week_Abbreviation&#40;&#41;&#34;, &#34;Decode_Date_EU&#40;&#41;&#34;,
&gt; &#34;Decode_Date_US&#40;&#41;&#34;,
&gt;   &#34;Decode_Date_EU2&#40;&#41;&#34;, &#34;Decode_Date_US2&#40;&#41;&#34;, &#34;Parse_Date&#40;&#41;&#34;.
&gt; But labels&#40;&#41; is not in this list and so this Code
&gt;   use Date::Calc qw&#40;Decode_Language&#41;;
&gt;   use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
&gt;   use Date::Calendar;
&gt;   $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
&gt;   @labels = $cal-&gt;labels&#40;2010,5,13&#41;;
&gt;   print &#34;@labels&#34;,&#34;\n&#34;;
&gt; prints
&gt;   Thursday Christi Himmelfahrt
&gt; 
&gt; But as I now read the manuals carefully I found the solution:
&gt;   use Date::Calc qw&#40;Decode_Language Decode_Day_of_Week
&gt; Day_of_Week_to_Text&#41;;
&gt;   use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
&gt;   use Date::Calendar;
&gt;   $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
&gt;   @labels = $cal-&gt;labels&#40;2010,5,13&#41;;
&gt;   $dow = shift&#40;@labels&#41;;
&gt;   $dow = Decode_Day_of_Week&#40;$dow&#41;;
&gt;   $dow = Day_of_Week_to_Text&#40;$dow,Decode_Language&#40;&#34;deutsch&#34;&#41; &#41;;
&gt;   print &#34;$dow @labels\n&#34;;
&gt; This now prints
&gt;   Donnerstag Christi Himmelfahrt
&gt; 
&gt; So as you said, it&#39;s not a bug, but as this bloats the code a bit:
</div>
Yes, I agree, this solution works but is too clumsy.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Would it be possible to add an optional LANG argument to labels which
&gt; translates the returned day-of-the-week?
</div>
I am putting this on the to do list; you are right, I should have added
this optional parameter to the &#34;labels&#34; method in the first place; this
was an oversight.
Sorry for your troubles!

Cheers,
Steffen
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;07&nbsp;14:32:26&nbsp;2015</span>
    <span class="description">STBEY [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun May 16 09:10:48 2010, STBEY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Fri May 14 09:25:38 2010, prote@fmi.uni-stuttgart.de wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; But I&#39;m still left with one problem:
&gt; &gt; Before the upgrade to Date-Calc-6.3 I used the now deprecated global
&gt; &gt; setting of the language:
&gt; &gt;   Language&#40;Decode_Language&#40;&#34;deutsch&#34;&#41;&#41;;
&gt; &gt; which translated the names of days and months into german &#40;especially
&gt; &gt; the day-of-the-week returned by the labels&#40;&#41; function.
&gt; &gt; 
&gt; &gt; Now I learned from &#34;perldoc Date::Calc&#34;
&gt; &gt;   BEWARE that when using the function &#34;&#34;Language&#40;&#41;&#34;&#34;, the selected
&gt; &gt; language is a
&gt; &gt;   global setting, shared by all threads or modules you might be
&gt; &gt; running concurrently,
&gt; &gt;   thus possibly causing conflicts between them.
&gt; &gt; 
&gt; &gt;   In order to avoid these conflicts, you should NEVER use the function
&gt; &gt; &#34;&#34;Language&#40;&#41;&#34;&#34;,
&gt; &gt;   but should ALWAYS pass a language number &#40;as returned by the
&gt; &gt; function &#34;&#34;Decode_Lan-
&gt; &gt;   guage&#40;&#41;&#34;&#34;&#41; to the functions which are language-dependent, which are:
&gt; &gt; 
&gt; &gt;   &#34;Decode_Month&#40;&#41;&#34;, &#34;Decode_Day_of_Week&#40;&#41;&#34;, &#34;Compressed_to_Text&#40;&#41;&#34;,
&gt; &gt; &#34;Date_to_Text&#40;&#41;&#34;,
&gt; &gt;   &#34;Date_to_Text_Long&#40;&#41;&#34;, &#34;Calendar&#40;&#41;&#34;, &#34;Month_to_Text&#40;&#41;&#34;,
&gt; &gt; &#34;Day_of_Week_to_Text&#40;&#41;&#34;,
&gt; &gt;   &#34;Day_of_Week_Abbreviation&#40;&#41;&#34;, &#34;Decode_Date_EU&#40;&#41;&#34;,
&gt; &gt; &#34;Decode_Date_US&#40;&#41;&#34;,
&gt; &gt;   &#34;Decode_Date_EU2&#40;&#41;&#34;, &#34;Decode_Date_US2&#40;&#41;&#34;, &#34;Parse_Date&#40;&#41;&#34;.
&gt; &gt; But labels&#40;&#41; is not in this list and so this Code
&gt; &gt;   use Date::Calc qw&#40;Decode_Language&#41;;
&gt; &gt;   use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
&gt; &gt;   use Date::Calendar;
&gt; &gt;   $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
&gt; &gt;   @labels = $cal-&gt;labels&#40;2010,5,13&#41;;
&gt; &gt;   print &#34;@labels&#34;,&#34;\n&#34;;
&gt; &gt; prints
&gt; &gt;   Thursday Christi Himmelfahrt
&gt; &gt; 
&gt; &gt; But as I now read the manuals carefully I found the solution:
&gt; &gt;   use Date::Calc qw&#40;Decode_Language Decode_Day_of_Week
&gt; &gt; Day_of_Week_to_Text&#41;;
&gt; &gt;   use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
&gt; &gt;   use Date::Calendar;
&gt; &gt;   $cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
&gt; &gt;   @labels = $cal-&gt;labels&#40;2010,5,13&#41;;
&gt; &gt;   $dow = shift&#40;@labels&#41;;
&gt; &gt;   $dow = Decode_Day_of_Week&#40;$dow&#41;;
&gt; &gt;   $dow = Day_of_Week_to_Text&#40;$dow,Decode_Language&#40;&#34;deutsch&#34;&#41; &#41;;
&gt; &gt;   print &#34;$dow @labels\n&#34;;
&gt; &gt; This now prints
&gt; &gt;   Donnerstag Christi Himmelfahrt
&gt; &gt; 
&gt; &gt; So as you said, it&#39;s not a bug, but as this bloats the code a bit:
</div>&gt; 
&gt; Yes, I agree, this solution works but is too clumsy.
&gt; 
<div class="message-stanza open">&gt; &gt; Would it be possible to add an optional LANG argument to labels which
&gt; &gt; translates the returned day-of-the-week?
</div>&gt; 
&gt; I am putting this on the to do list; you are right, I should have added
&gt; this optional parameter to the &#34;labels&#34; method in the first place; this
&gt; was an oversight.
&gt; Sorry for your troubles!
&gt; 
&gt; Cheers,
&gt; Steffen
</div>

I just had a look at the code.
Adding an optional &#34;lang&#34; parameter to the &#34;labels&#34; method would require profound changes to several modules.
I am afraid that such changes might actually break existing user code out there.
I therefore decided not to do this, however desirable it might be.

The recommended way of doing what you want to do is the following:

use Date::Calc qw&#40;:all&#41;;
use Date::Calendar::Profiles qw&#40;$Profiles&#41;;
use Date::Calendar;
$cal = Date::Calendar::Year-&gt;new&#40; 2010, $Profiles-&gt;{&#39;DE-BW&#39;}&#41;;
@date = &#40;2010,5,13&#41;;
@labels = $cal-&gt;labels&#40;@date&#41;;
print &#34;@labels&#34;,&#34;\n&#34;;
shift&#40;@labels&#41;;
unshift&#40;@labels,Day_of_Week_to_Text&#40;Day_of_Week&#40;@date&#41;,Decode_Language&#40;&#34;deutsch&#34;&#41;&#41;&#41;;
print &#34;@labels&#34;,&#34;\n&#34;;

I hope this helps!
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
