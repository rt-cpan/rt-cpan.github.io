<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #7109 for User: test.pl - chdir&#40;&#41; won&#39;t go $ENV{HOME} on win32</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #7109 for User: test.pl - chdir&#40;&#41; won&#39;t go $ENV{HOME} on win32</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=User">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=User">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=User">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=User">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/User">User CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">7109</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">1 hour (60 min)

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=User">User</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">metaperl [...] gmail.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-34766-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-34767-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=7109">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-108556" href="/Public/Bug/Display.html?id=7109#txn-108556">#</a>      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;26&nbsp;07:41:46&nbsp;2004</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.pl - chdir&#40;&#41; won&#39;t go $ENV{HOME} on win32</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/108556/21085/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/21085">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 110b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">generally on win32 $ENV{HOME} is not set.
You need to set it to $ENV{USERPROFILE} temporarily during the test.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-108557" href="/Public/Bug/Display.html?id=7109#txn-108557">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;16&nbsp;16:44:07&nbsp;2004</span>
    <span class="description">metaperl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/108557/26097/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/26097">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 236b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">[guest - Mon Jul 26 07:41:46 2004]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; generally on win32 $ENV{HOME} is not set.
&gt; You need to set it to $ENV{USERPROFILE} temporarily during the test.
</div>
did the test fail? the method -&gt;Home&#40;&#41; will use USERPROFILE if it cannot
fine HOME
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-108558" href="/Public/Bug/Display.html?id=7109#txn-108558">#</a>      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;16&nbsp;16:45:07&nbsp;2004</span>
    <span class="description">metaperl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/108558/26098/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/26098">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 407b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">[TBONE - Thu Dec 16 16:44:07 2004]:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; [guest - Mon Jul 26 07:41:46 2004]:
&gt; 
<div class="message-stanza open">&gt; &gt; generally on win32 $ENV{HOME} is not set.
&gt; &gt; You need to set it to $ENV{USERPROFILE} temporarily during the test.
</div>&gt; 
&gt; did the test fail? the method -&gt;Home&#40;&#41; will use USERPROFILE if it cannot
&gt; fine HOME
</div>

in fact, the tests passed on 40 different systems, so I think it works...

    <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~tbone/User-1.6/">http://search.cpan.org/~tbone/User-1.6/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-307220" href="/Public/Bug/Display.html?id=7109#txn-307220">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;07&nbsp;13:17:28&nbsp;2007</span>
    <span class="description">m.nooning [...] comcast.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> m.nooning [...] comcast.net</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/307220/139701/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/139701">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; in fact, the tests passed on 40 different systems, so I think it works...
&gt;     <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~tbone/User-1.6/">http://search.cpan.org/~tbone/User-1.6/</a></span>
</div>
How many successes a test has does not negate any failures.

The original ticketer of two years ago is correct.  The fact is, on
Windows XP Home edition at least, chdir&#40;&#41; does not change the directory
unless $ENV{HOME} is set, which it is not by default.  Your test script
therefore will fail by default on Windows XP Home edition machines.

For Windows 2K and above, $ENV{USERPROFILE} is defined by default, so on 
Windows 2K and above, chdir&#40;$ENV{USERPROFILE}&#41; will work, as will
setting $ENV{HOME} prior to the test.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; did the test fail? 
</div>Yes.  However, User.pm clearly works, so I installed it anyway.  It is
only the test that is faulty.

In case there are doubts about this, I will now paste a short test
script, and then paste the results.  Notice the &#34;uninitialized value&#34; in
the results, which of course refer to the first attempt at printing
$ENV{HOME}.

--------------paste script
#!/usr/bin/perl -w

use Cwd qw&#40; getcwd abs_path&#41;;
use strict;

chdir&#40;&#34;C:\\temp\\&#34;&#41;;
my $oldpwd = getcwd;
chdir&#40;&#41;;
my $newpwd = getcwd;

print &#40;&#34;oldpwd is $oldpwd\n&#34;&#41;;
print &#40;&#34;newpwd is $newpwd\n&#34;&#41;;

print &#40;&#34;ENV HOME is &#34;, $ENV{HOME}, &#34;\n&#34;&#41;;
print &#40;&#34;ENV USERPROFILE is &#34;, $ENV{USERPROFILE}, &#34;\n&#34;&#41;;

$ENV{HOME} = $ENV{USERPROFILE} if &#40;$^O eq &#39;MSWin32&#39;&#41;;
chdir&#40;&#41;;
my $lastpwd  = getcwd;
print &#40;&#34;lastpwd is $lastpwd\n&#34;&#41;;
--------------end paste script

----------paste results
C:\temp&gt;perl test.pl
oldpwd is C:/temp
newpwd is C:/temp
Use of uninitialized value in print at test.pl line 14.
ENV HOME is
ENV USERPROFILE is C:\Documents and Settings\malcolm
lastpwd is C:/Documents and Settings/malcolm
----------end paste results

Thanks
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-307221" href="/Public/Bug/Display.html?id=7109#txn-307221">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;07&nbsp;13:17:30&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-307226" href="/Public/Bug/Display.html?id=7109#txn-307226">#</a>      
    </span>
    <span class="date">Sat&nbsp;Apr&nbsp;07&nbsp;14:02:30&nbsp;2007</span>
    <span class="description">metaperl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> TBONE [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/307226/139706/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/139706">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 829b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Apr 07 13:17:28 2007, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; in fact, the tests passed on 40 different systems, so I think it
</div></div>works...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;     <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~tbone/User-1.6/">http://search.cpan.org/~tbone/User-1.6/</a></span>
</div>&gt; 
&gt; How many successes a test has does not negate any failures.
&gt; 
&gt; The original ticketer of two years ago is correct.  The fact is, on
&gt; Windows XP Home edition at least, chdir&#40;&#41; does not change the directory
&gt; unless $ENV{HOME} is set, which it is not by default.  Your test script
&gt; therefore will fail by default on Windows XP Home edition machines.
&gt; 
&gt; For Windows 2K and above, $ENV{USERPROFILE} is defined by default, so on 
&gt; Windows 2K and above, chdir&#40;$ENV{USERPROFILE}&#41; will work, as will
&gt; setting $ENV{HOME} prior to the test.
</div>

Ok, I have access to a Win XP box at work, so I will get to this Monday...

Thanks for the script.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-311233" href="/Public/Bug/Display.html?id=7109#txn-311233">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;15:36:29&nbsp;2007</span>
    <span class="description">metaperl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> TBONE [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/311233/141709/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/141709">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;d like to make sure of the Perl distribution you are using. Is it
ActiveState Perl?

Under Cygwin $ENV{HOME} is in fact defined.


On Sat Apr 07 13:17:28 2007, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; in fact, the tests passed on 40 different systems, so I think it
</div></div>works...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;     <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~tbone/User-1.6/">http://search.cpan.org/~tbone/User-1.6/</a></span>
</div>&gt; 
&gt; How many successes a test has does not negate any failures.
&gt; 
&gt; The original ticketer of two years ago is correct.  The fact is, on
&gt; Windows XP Home edition at least, chdir&#40;&#41; does not change the directory
&gt; unless $ENV{HOME} is set, which it is not by default.  Your test script
&gt; therefore will fail by default on Windows XP Home edition machines.
&gt; 
&gt; For Windows 2K and above, $ENV{USERPROFILE} is defined by default, so on 
&gt; Windows 2K and above, chdir&#40;$ENV{USERPROFILE}&#41; will work, as will
&gt; setting $ENV{HOME} prior to the test.
&gt; 
<div class="message-stanza open">&gt; &gt; did the test fail? 
</div>&gt; Yes.  However, User.pm clearly works, so I installed it anyway.  It is
&gt; only the test that is faulty.
&gt; 
&gt; In case there are doubts about this, I will now paste a short test
&gt; script, and then paste the results.  Notice the &#34;uninitialized value&#34; in
&gt; the results, which of course refer to the first attempt at printing
&gt; $ENV{HOME}.
&gt; 
&gt; --------------paste script
&gt; #!/usr/bin/perl -w
&gt; 
&gt; use Cwd qw&#40; getcwd abs_path&#41;;
&gt; use strict;
&gt; 
&gt; chdir&#40;&#34;C:\\temp\\&#34;&#41;;
&gt; my $oldpwd = getcwd;
&gt; chdir&#40;&#41;;
&gt; my $newpwd = getcwd;
&gt; 
&gt; print &#40;&#34;oldpwd is $oldpwd\n&#34;&#41;;
&gt; print &#40;&#34;newpwd is $newpwd\n&#34;&#41;;
&gt; 
&gt; print &#40;&#34;ENV HOME is &#34;, $ENV{HOME}, &#34;\n&#34;&#41;;
&gt; print &#40;&#34;ENV USERPROFILE is &#34;, $ENV{USERPROFILE}, &#34;\n&#34;&#41;;
&gt; 
&gt; $ENV{HOME} = $ENV{USERPROFILE} if &#40;$^O eq &#39;MSWin32&#39;&#41;;
&gt; chdir&#40;&#41;;
&gt; my $lastpwd  = getcwd;
&gt; print &#40;&#34;lastpwd is $lastpwd\n&#34;&#41;;
&gt; --------------end paste script
&gt; 
&gt; ----------paste results
&gt; C:\temp&gt;perl test.pl
&gt; oldpwd is C:/temp
&gt; newpwd is C:/temp
&gt; Use of uninitialized value in print at test.pl line 14.
&gt; ENV HOME is
&gt; ENV USERPROFILE is C:\Documents and Settings\malcolm
&gt; lastpwd is C:/Documents and Settings/malcolm
&gt; ----------end paste results
&gt; 
&gt; Thanks
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-311234" href="/Public/Bug/Display.html?id=7109#txn-311234">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;15:42:08&nbsp;2007</span>
    <span class="description">metaperl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/311234/141710/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/141710">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 841b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Apr 07 13:17:28 2007, m.nooning@comcast.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; in fact, the tests passed on 40 different systems, so I think it
</div></div>works...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;     <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~tbone/User-1.6/">http://search.cpan.org/~tbone/User-1.6/</a></span>
</div>&gt; 
&gt; How many successes a test has does not negate any failures.
</div>
true!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; The original ticketer of two years ago is correct.  The fact is, on
&gt; Windows XP Home edition at least, chdir&#40;&#41; does not change the directory
&gt; unless $ENV{HOME} is set, which it is not by default.  Your test script
&gt; therefore will fail by default on Windows XP Home edition machines.
&gt; 
&gt; For Windows 2K and above, $ENV{USERPROFILE} is defined by default, so on 
&gt; Windows 2K and above, chdir&#40;$ENV{USERPROFILE}&#41; will work, as will
&gt; setting $ENV{HOME} prior to the test.
</div>
OK, I see: just stick a $ENV{HOME} = $ENV{USERPROFILE} in before the 
chdir&#40;&#41; call so the test passes.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-311235" href="/Public/Bug/Display.html?id=7109#txn-311235">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;16:08:05&nbsp;2007</span>
    <span class="description">metaperl [...] gmail.com -  Correspondence added</span>
    <span class="time-taken">60 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> m.nooning [...] comcast.net</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/311235/141711/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/141711">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 288b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok, I added
  $ENV{HOME} = $ENV{USERPROFILE} if &#40;$^O eq &#39;MSWin32&#39;&#41; ;

just before the chdir&#40;&#41; and it now works on Win XP Media Center edition
when it was failing with your supplied test just before the fix.

Thanks, you are given credit in the AUTHOR section of the 1.8 upload to
CPAN..
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-311237" href="/Public/Bug/Display.html?id=7109#txn-311237">#</a>      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;16:08:08&nbsp;2007</span>
    <span class="description">metaperl [...] gmail.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Give odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-311238" href="/Public/Bug/Display.html?id=7109#txn-311238">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;18&nbsp;16:08:13&nbsp;2007</span>
    <span class="description">metaperl [...] gmail.com -  Given to TBONE</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.335584</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
