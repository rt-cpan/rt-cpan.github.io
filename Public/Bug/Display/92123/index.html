<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #92123 for CPAN-Reporter: cpan-reporter doesn&#39;t load TEST_REQUIRES before running tests</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #92123 for CPAN-Reporter: cpan-reporter doesn&#39;t load TEST_REQUIRES before running tests</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/CPAN-Reporter/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/CPAN-Reporter/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/CPAN-Reporter/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/CPAN-Reporter/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/cpan-testers/CPAN-Reporter/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/CPAN-Reporter">CPAN-Reporter CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">92123</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/CPAN-Reporter/Active/">CPAN-Reporter</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
pause [...] tlinx.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40518-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-40519-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;00:29:30&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> cpan-reporter doesn&#39;t load TEST_REQUIRES before running tests</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have a TEST_REQUIRES section in my Makefile.PL.

Unfortunately, I am getting a fail 
from cpantesters viewable at:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.cpantesters.org/cpan/report/8ef926b5-6c04-1014-ace8-5c489752f052">http://www.cpantesters.org/cpan/report/8ef926b5-6c04-1014-ace8-5c489752f052</a></span>

The distribution is for Xporter-0.10.0.
---
The Makefile.PL is below:
----

use ExtUtils::MakeMaker;
# See lib/ExtUtils/MakeMaker.pm for details of how to influence
# the contents of the Makefile that is written.
WriteMakefile&#40;
    NAME         =&gt; &#39;Xporter&#39;,
    VERSION_FROM =&gt; &#39;lib/Xporter.pm&#39;,
    AUTHOR       =&gt; &#39;LA Walsh &#40;LAWALSH@cpan.org&#41;&#39;,
    ABSTRACT     =&gt; &#34;Alt. exporter w/persistent, dflts &#38; auto ISA&#34;,
    BUILD_REQUIRES=&gt; { &#39;ExtUtils::MakeMaker&#39; =&gt; &#39;6.82&#39;, },
    TEST_REQUIRES =&gt;
                 =&gt; { &#39;Test::Simple&#39; =&gt; &#39;0.44&#39;, mem =&gt; &#39;0.4.5&#39; },
    dist         =&gt; { TAR=&gt; &#39;tar&#39;, TARFLAGS=&gt; &#34;-H v7 -h -cf &#34; },

&#41;;
---------------------


Neither &#39;Test::Simple&#39; nor &#39;mem&#39; show up as &#34;required&#34; for testing so the test runs with a FAIL status.

It seems a report should not be sent if the REQUIRES are not met &#40;such is true for PM/BUILD REQs&#41;...  Is it an oversight that TEST_REQs isn&#39;t checked as well?

Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;07:17:25&nbsp;2014</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi, Linda.

CPAN::Reporter relies on CPAN.pm to determine the list of prerequisites.

CPAN.pm relies on information provided by Makefile.PL.

TEST_REQUIRES is a relatively new field and is only supported by recent versions of ExtUtils::MakeMaker.

You need to make sure that the configure_requires field in META.yml &#40;and the prereqs/configure/requires field in META.json&#41; list a new-enough version of ExtUtils::MakeMaker that supports that field.  Right now, you have &#34;0&#34; as the configure/requires version of ExtUtils::MakeMaker.

Alternatively, you need to have Makefile.PL copy TEST_REQUIRES into PREREQ_PM on older versions.

I&#39;m going to close this ticket as it is not something that CPAN::Reporter can fix.

Regards,
David Golden
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;07:17:25&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;07:17:39&nbsp;2014</span>
    <span class="description">dagolden [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;16:46:23&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 14 07:17:25 2014, DAGOLDEN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; TEST_REQUIRES is a relatively new field and is only supported by
&gt; recent versions of ExtUtils::MakeMaker. 
&gt;
&gt; You need to make sure that the configure_requires field in META.yml
&gt; &#40;and the prereqs/configure/requires field in META.json&#41; list a new-
&gt; enough version of ExtUtils::MakeMaker that supports that field.  Right
&gt; now, you have &#34;0&#34; as the configure/requires version of
&gt; ExtUtils::MakeMaker.
</div>-----

I noted it was a new param in trying to fix another problem and made sure that ExtUtils::MM was in the BUILD_REQUIRES field so that it would be new enough to recognize the TEST field.  

And the error report does say that ExtUtils:MM was 6.86 &#40;I only had a need for 6.82 in my tests&#41;.

I&#39;m not sure where configure comes into building a module, -- usually there is build, test &#38; install.  Install might be considered &#39;configure&#39;, but test comes before install and is often considered part of deciding whether or not the build was successful.



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m going to close this ticket as it is not something that CPAN::Reporter can fix.
</div>----

I understand CPAN::Reporter relies on CPAN -- and an up-to-date ExtUtils:MM.  

But for figuring out why this happened&#40;happens?&#41;, &#34;shouldn&#39;t&#34; the build-req take care of making sure ExtUtils was sufficiently new &#40;not to mention, the version of ExtUtils used was newere than the Buildreqs&#41;.  

It seems there is something missing -- since the same version of Xporter built successfully in 9 other instances of win32/non-cygwin in perls from 5.10.x -&gt; 5.18.x.

From everything you&#39;ve said, the version of Extutils should have been the only thing necessary to process the TEST_REQs, and from the report, it was sufficient as well?  Any ideas?


Linda Walsh
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;17:15:43&nbsp;2014</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The &#34;configure&#34; step means running &#34;Makefile.PL&#34; or &#34;Build.PL&#34;.

CPAN clients look at META.yml or META.json for any prerequisites for that step.  If they find them, they install them.

Then Makefile.PL is run.  Only then are the normal set of prerequisites available for inspection.

Hope that helps,
David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;14&nbsp;18:35:50&nbsp;2014</span>
    <span class="description">pause [...] tlinx.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jan 14 17:15:43 2014, DAGOLDEN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The &#34;configure&#34; step means running &#34;Makefile.PL&#34; or &#34;Build.PL&#34;.
</div>----
But running Makefile.PL isn&#39;t where it failed.

It ran that, since it picked up the the &#34;build_requires&#34; &#40;listed in the report&#41;:

build_requires: 
Module              Need Have
------------------- ---- ----
ExtUtils::MakeMaker 6.82 6.86
 
configure_requires: 
Module              Need Have 
------------------- ---- ---- 
ExtUtils::MakeMaker 0    6.86 


It failed in the subsequent &#39;dmake&#39; test 
that ran out of a &#34;Makefile&#34;
generated by &#34;Makefile.PL&#34;.

I.e. It appears we are already past the &#34;config&#34; case, as it ran Makefile.PL and found the build_requires.  


It seems a bit circular: if I put CONFIGURE_REQUIRES for EU::MM, then running perl Makefile.PL, will copy the config info necessary for running Makefile.PL into the META files?

&#40;FWIW, I&#39;ve always relied on EUMM creating/writing the Meta files from what is in Makefile.PL -- as the documentation said the META files would be created from the Makefile.PL&#41;.






<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; CPAN clients look at META.yml or META.json for any prerequisites for
&gt; that step.  If they find them, they install them.
&gt; 
&gt; Then Makefile.PL is run.  Only then are the normal set of
&gt; prerequisites available for inspection.
</div>

--- The manpage for EUMM claims the config step:
         make config     # to check if         make config     # to check if the Makefile is up-to-date the Makefile is up-to-date

And the general flow is:

   Default Makefile Behaviour
       The generated Makefile enables the user of the extension to invoke

    [1]   perl Makefile.PL # optionally &#34;perl Makefile.PL verbose&#34;
    [2]   make
    [3]   make test        # optionally set TEST_VERBOSE=1
    [4]   make install     # See below

----

In the above, steps 1+2 are done.
with CONFIGURE_REQUIRES stating preconditions for [1], and BUILD_REQUIRES stating preconditions for [2].

Looking at the MM pod/man, it lists no minimum version for TEST_REQ, but it lists min vers of
6.52 for CONFIG and 6.5503 for BUILD.

Regardless -- I can&#39;t see how the test client would have 6.86 and have it NOT process the TEST_REQ.

anyway--- thanks for the hints... this seems alot more complicated than it should be, but I&#39;m sure the flexibility is useful given all the places perl builds...
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
