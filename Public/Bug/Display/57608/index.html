<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #57608 for Curses: field_buffer does not return all data from multi-row fields</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #57608 for Curses: field_buffer does not return all data from multi-row fields</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Curses/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Curses/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Curses/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Curses/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Curses">Curses CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">57608</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Curses/Active/">Curses</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gentoo [...] greatships.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-8784-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.28    </td>
  </tr>
  <tr id="CF-8785-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;18&nbsp;16:45:35&nbsp;2010</span>
    <span class="description">http://www.google.com/profiles/Lloyd.J.McDonald -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> field_buffer does not return all data from multi-row fields</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Curses-1.28
Perl 5.8.8
Gentoo Linux
ncurses ncurses-5.7-r3

The field buffer function does not return all data from multi-row
fields.  The field is displayed properly, can be edited, and the value
can be set using set_field_buffer&#40;$field, 0, $value&#41;.  However, when
data is retrieved, only the first row of the field is returned.

Please see attached simple test case for a 2 row, 13 column field set to
the letters of the alphabet.  The retrieved value is truncated at letter
&#34;m&#34;.

Output of test case:
Set value:       abcdefghijklmnopqrstuvwxyz
Retrieved value: abcdefghijklm
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.pl</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/perl

use strict;
use Curses;

initscr;

my $data = &#34;abcdefghijklmnopqrstuvwxyz&#34;;

my $field = new_field&#40;2, 13, 0, 0, 0, 1&#41;;

set_field_buffer&#40;$field, 0, $data&#41;;
my $result = field_buffer&#40;$field, 0&#41;;
endwin;

print &#34;Set value:       $data\n&#34;;
print &#34;Retrieved value: $result\n&#34;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;16:45:14&nbsp;2010</span>
    <span class="description">GIRAFFED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Works for me.

This is probably due to the same behavior from the C curses library on 
the subject system.  Curses.pm just takes the result of field_buffer&#40;&#41; 
in that library and turns it into a Perl string, so if the C library 
returns only the first line, Curses.pm will as well.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;16:45:17&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;16:45:17&nbsp;2010</span>
    <span class="description">GIRAFFED [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;21:38:27&nbsp;2010</span>
    <span class="description">http://www.google.com/profiles/Lloyd.J.McDonald -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu May 20 16:45:14 2010, GIRAFFED wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Works for me.
&gt; 
&gt; This is probably due to the same behavior from the C curses library on 
&gt; the subject system.  Curses.pm just takes the result of field_buffer&#40;&#41; 
&gt; in that library and turns it into a Perl string, so if the C library 
&gt; returns only the first line, Curses.pm will as well.
</div>
Yes, this was my first thought.  So before opening this bug report, I
created the equivalent C-language test case, which worked fine &#40;as have
all my other C-language curses programs&#41;.  I compiled my test as follows:

# gcc -o test test.c -lform -lcurses

and the output is &#40;correct&#41;:
# ./test
Set value:       abcdefghijklmnopqrstuvwxyz
Retrieved value: abcdefghijklmnopqrstuvwxyz

However, if I look at the Curses.so &#40;built from the Perl Curses package&#41;
on my system:
# ldd /usr/lib64/perl5/vendor_perl/5.8.8/x86_64-linux/auto/Curses/Curses.so
        linux-vdso.so.1 =&gt;  &#40;0x00007fff33fff000&#41;
        libpanelw.so.5 =&gt; /usr/lib/libpanelw.so.5 &#40;0x00007f2ac7d02000&#41;
        libmenuw.so.5 =&gt; /usr/lib/libmenuw.so.5 &#40;0x00007f2ac7afa000&#41;
        libformw.so.5 =&gt; /usr/lib/libformw.so.5 &#40;0x00007f2ac78e9000&#41;
        libncursesw.so.5 =&gt; /lib/libncursesw.so.5 &#40;0x00007f2ac768c000&#41;
        libc.so.6 =&gt; /lib/libc.so.6 &#40;0x00007f2ac7333000&#41;
        libdl.so.2 =&gt; /lib/libdl.so.2 &#40;0x00007f2ac712e000&#41;
        /lib64/ld-linux-x86-64.so.2 &#40;0x00007f2ac8165000&#41;

and compare that to my C test case:
# ldd test
        linux-vdso.so.1 =&gt;  &#40;0x00007fffa98e0000&#41;
        libform.so.5 =&gt; /usr/lib/libform.so.5 &#40;0x00007f065b28b000&#41;
        libncurses.so.5 =&gt; /lib/libncurses.so.5 &#40;0x00007f065b03a000&#41;
        libc.so.6 =&gt; /lib/libc.so.6 &#40;0x00007f065ace1000&#41;
        libdl.so.2 =&gt; /lib/libdl.so.2 &#40;0x00007f065aadd000&#41;
        /lib64/ld-linux-x86-64.so.2 &#40;0x00007f065b49a000&#41;

it seems that Curses and my test case are using different libraries. 
&#40;Note the &#34;w&#34; suffix after each library name, which I presume is the
difference between a 32 and 64 bit version of the ncurses libraries - my
system is AMD64&#41;.  If I force my C test case to use these libraries:
# gcc -o test test.c -lformw -lncursesw
# ./test
Set value:       abcdefghijklmnopqrstuvwxyz
Retrieved value: abcdefghijklm

Now I see the same &#40;incorrect&#41; behavior that happens in Perl, and you
are, of course, correct that it&#39;s a problem with the libraries on my system.

I&#39;m not sure what the &#34;w&#34; versions of the libraries are - again I&#39;m
presuming 64-bit versions of the libraries.  However, both the regular
and &#34;w&#34; versions of the libraries are built from the same ncurses-5.7
package, which is a recent release, and reinstalling does not help.

I&#39;ll try to track down the package maintainers for ncurses and report
the bug there.  I&#39;m documenting here in case someone else has a similar
problem.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> test.c</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">#include &lt;form.h&gt;

/* Compiled with gcc -o test test.c -lcurses -lform */
main&#40;&#41;
{
  initscr&#40;&#41;;

  static char *data = &#34;abcdefghijklmnopqrstuvwxyz&#34;;
  FIELD *field = new_field&#40;2, 13, 0, 0, 0, 1&#41;;

  set_field_buffer&#40;field, 0, data&#41;;
  char *result = field_buffer&#40;field, 0&#41;;
  endwin&#40;&#41;;

  printf&#40;&#34;Set value:       %s\n&#34;, data&#41;;
  printf&#40;&#34;Retrieved value: %s\n&#34;, result&#41;;
}
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;21:38:30&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;21:43:58&nbsp;2010</span>
    <span class="description">http://www.google.com/profiles/Lloyd.J.McDonald -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It seems my additional information has automatically reopened the bug. 
My apologies - the bug should be marked closed/resolved.  Sorry for your
trouble.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;20&nbsp;22:58:54&nbsp;2010</span>
    <span class="description">bryanh [...] giraffe-data.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #57608] field_buffer does not return all data from multi-row fields</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> 21 May 2010 02:47:20 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Curses [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bryanh [...] giraffe-data.com &#40;Bryan Henderson&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The W libraries are ones that understand wide characters &#40;I.e. character
sets with more than 128 characters, which use more than one byte to
represent a character.

The W libraries are fairly recent, and Curses.pm interoperability with them
even newer.  AFAIR, the only changes that have been made to Perl Curses to
work with the W libraries were in the building.

How sure are you that the splitting happens at a line boundary?  What if
there are 3 lines?  I&#39;m wondering if it&#39;s a length problem, e.g. there
are 26 one-byte characters and something thinks there are 2 bytes per
character and thus concludes the string length is 13.

Note that it&#39;s not hard to build Curses.so with the more primitive &#40;and more
tested&#41; non-W versions.  It&#39;s just not what the automatic configurator
prefers.

-- 
Bryan Henderson                                   San Jose, California
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;May&nbsp;21&nbsp;03:28:43&nbsp;2010</span>
    <span class="description">http://www.google.com/profiles/Lloyd.J.McDonald -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu May 20 22:58:54 2010, bryanh@giraffe-data.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The W libraries are ones that understand wide characters &#40;I.e. character
&gt; sets with more than 128 characters, which use more than one byte to
&gt; represent a character.
&gt; 
&gt; The W libraries are fairly recent, and Curses.pm interoperability with
</div>them
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; even newer.  AFAIR, the only changes that have been made to Perl Curses to
&gt; work with the W libraries were in the building.
&gt; 
&gt; How sure are you that the splitting happens at a line boundary?  What if
&gt; there are 3 lines?  I&#39;m wondering if it&#39;s a length problem, e.g. there
&gt; are 26 one-byte characters and something thinks there are 2 bytes per
&gt; character and thus concludes the string length is 13.
&gt; 
&gt; Note that it&#39;s not hard to build Curses.so with the more primitive
</div>&#40;and more
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; tested&#41; non-W versions.  It&#39;s just not what the automatic configurator
&gt; prefers.
&gt; 
</div>Greetings Bryan - thank you also for taking the time to reply.  I know
this is not a Perl Curses issue, and I&#39;m sure you have many other
demands on your time!  It is very kind of you to reply here to help me
and anybody else who may encounter this issue.

Yes, after making my last post, I went off in search of bugs in the
ncurses libraries and did notice in the notes on the distribution that
the W libraries are for the the multi-byte characters.  It now makes
perfect sense why the problem is seen there and not in the original
libraries.  Although there have been other bugs relating to
field_buffer, it seems most of these had to do with &#34;wide&#34; characters,
and I could find none that seemed to have issues with a row boundary. 
So I&#39;ve emailed a report to the ncurses maintainer, and perhaps he may
be able to quickly find the problem.

Once I realized that the libraries were for &#34;wide&#34; characters and had
nothing to do with 32 vs 64-bit, I investigated build options on Gentoo
for the Curses Perl module.  Fortunately, the Gentoo package maintainer
has conveniently included a &#34;unicode&#34; build option.  So I rebuilt the
package without unicode support for this specific module.  On Gentoo
this is easily done as follows:

USE=-unicode emerge ncurses

The above sets environment variable &#34;USE&#34; to no unicode &#40;&#34;-unicode&#34;&#41; and
then rebuild the package &#40;&#34;emerge ncurses&#34;&#41;.  This rebuilds the package
without unicode support - in other words, linking to the &#34;narrow&#34;
libraries, and thus giving me a workaround.

While this is an effective workaround in my specific case this, of
course, will not work for somebody who really needs &#34;wide&#34; character
support.  In that case, it seems there is no other option but to wait
for a bug fix for the ncurses library.

As far as my certainty that this always occurs at a row boundary, I did
fairly extensive &#34;testing&#34; trying to coax a multi-row value out of a
multi-row field.  My application is a database app, and I ran into the
problem when trying to support 255 character database fields by using
4x64 byte &#40;multi-row&#41; fields.  My database was already populated with
data of various sizes, but I also tried various combinations of options
such as changing the number of rows, the number of off-screen rows, the
column width, and then examining the number and type of return values,
and even examining the additional &#40;user defined&#41; buffers in the field. 
The only thing that seems to hold constant is the size of the return
value is always the number of columns &#40;width - it should be width*&#40;rows
+ offscreen rows&#41;&#41;.

As far as my test case, I chose the letters of the alphabet and two 13
character rows just because it conveniently breaks at the halfway point,
and I don&#39;t introduce any questions about parsing trailing spaces as the
cause of the problem.  However, your question points out that a better
test case might be a 3 or 4 row example, so that it is clear that only
the first row of a multi-row field is returned, and that it doesn&#39;t
appear to be a halving or doubling issue associated with multi-byte
characters.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;22&nbsp;12:06:04&nbsp;2010</span>
    <span class="description">GIRAFFED [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
