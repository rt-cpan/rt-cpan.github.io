<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #130866 for WWW-Mechanize-Chrome: Chrome data directory locked</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #130866 for WWW-Mechanize-Chrome: Chrome data directory locked</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/WWW-Mechanize-Chrome/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/WWW-Mechanize-Chrome/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/WWW-Mechanize-Chrome/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/WWW-Mechanize-Chrome/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/WWW-Mechanize-Chrome">WWW-Mechanize-Chrome CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">130866</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/WWW-Mechanize-Chrome/Active/">WWW-Mechanize-Chrome</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Chris.Denley [...] experian.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-268074-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-268075-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;31&nbsp;12:06:22&nbsp;2019</span>
    <span class="description">Chris.Denley [...] experian.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 31 Oct 2019 15:38:31 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Chrome data directory locked</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-WWW-Mechanize-Chrome [...] rt.cpan.org&#34; &lt;bug-WWW-Mechanize-Chrome [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Denley, Chris&#34; &lt;Chris.Denley [...] experian.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I had an issue with WWW::Mechanize::Chrome not working if Chrome was already started. That seems to be resolved with using a different data directory than the already-running instance. I decided to use tempdir as demonstrated in the documentation for the data_directory option to ensure I always use a clean and unique data directory which is always deleted when the script finishes. However, there doesn&#39;t seem to be a good way for ensuring the Chrome process has completed and the temporary directory can be safely cleaned except for waiting a fixed period of time after the WWW::Mechanize::Chrome object is destroyed before allowing the tempdir variable to be destroyed, or waiting until CrashpadMetrics-active.pma can be deleted without error as in my workaround. Perhaps there should be a &#34;close&#34; method available that will return once all Chrome processes have completed and the data_directory can be safely deleted.

Chrome 78 on Windows 10
Strawberry Perl 5.24.4
WWW::Mechanize::Chrome 0.37

Without my workaround, this is the error I get when the temp directory cleanup fails:
cannot unlink file for C:\Users\do382cd\AppData\Local\Temp\1\HjecI5Ixs5\CrashpadMetrics-active.pma: Permission denied at C:/strawberry/perl/lib/File/Temp.pm line 784.
cannot remove directory for C:/Users/do382cd/AppData/Local/Temp/1/HjecI5Ixs5: Directory not empty at C:/strawberry/perl/lib/File/Temp.pm line 784.

Test script:

use strict;
use Log::Log4perl qw&#40;:easy&#41;;
use WWW::Mechanize::Chrome;
use File::Temp &#39;tempdir&#39;;

Log::Log4perl-&gt;easy_init&#40;$ERROR&#41;;  # Set priority of root logger to ERROR
my $tmpdir = tempdir&#40;CLEANUP =&gt; 1 &#41;;
{
    # limit scope of $mech so it is destroyed before $tmpdir
    my $mech = WWW::Mechanize::Chrome-&gt;new&#40;data_directory =&gt; $tmpdir&#41;;
    $mech-&gt;get&#40;&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/WWW::Mechanize::Chrome">https://metacpan.org/pod/WWW::Mechanize::Chrome</a></span>&#34;&#41;;
}
exit&#40;0&#41;; # comment this out for my workaround

# wait for file to be released so $tmpdir will be cleaned
my $path = &#34;$tmpdir/CrashpadMetrics-active.pma&#34;;
for&#40;1..10&#41; {
    last unless&#40;-e $path&#41;;
    unlink&#40;$path&#41; and last;
    sleep&#40;1&#41;;
}
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;02&nbsp;05:42:43&nbsp;2019</span>
    <span class="description">corion [...] corion.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #130866] Chrome data directory locked</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 2 Nov 2019 10:42:32 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Mechanize-Chrome [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Max Maischein &lt;corion [...] corion.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello Chris,

I have just released version 0.38 to CPAN, which now has the &#34;wait_file&#34;
option. You should be able to use it as:

my $mech = WWW::Mechanize::Chrome-&gt;new&#40;
    data_directory =&gt; $tempdir,
    wait_file =&gt; &#34;$tempdir/CrashpadMetrics-active.pma&#34;,
&#41;;

It mostly implements what your code did, waiting for the file to
disappear or become deletable when the objects gets destroyed. Please
let me know if that helps.

Thank you for reporting this bug,
-max

On 31.10.19 17:06, Denley, Chris via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thu Oct 31 12:06:22 2019: Request 130866 was acted upon.
&gt; Transaction: Ticket created by Chris.Denley@experian.com
&gt;        Queue: WWW-Mechanize-Chrome
&gt;      Subject: Chrome data directory locked
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: Nobody
&gt;   Requestors: Chris.Denley@experian.com
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130866">https://rt.cpan.org/Ticket/Display.html?id=130866</a></span> &gt;
&gt; 
&gt; 
&gt; I had an issue with WWW::Mechanize::Chrome not working if Chrome was already started. That seems to be resolved with using a different data directory than the already-running instance. I decided to use tempdir as demonstrated in the documentation for the data_directory option to ensure I always use a clean and unique data directory which is always deleted when the script finishes. However, there doesn&#39;t seem to be a good way for ensuring the Chrome process has completed and the temporary directory can be safely cleaned except for waiting a fixed period of time after the WWW::Mechanize::Chrome object is destroyed before allowing the tempdir variable to be destroyed, or waiting until CrashpadMetrics-active.pma can be deleted without error as in my workaround. Perhaps there should be a &#34;close&#34; method available that will return once all Chrome processes have completed and the data_directory can be safely deleted.
&gt; 
&gt; Chrome 78 on Windows 10
&gt; Strawberry Perl 5.24.4
&gt; WWW::Mechanize::Chrome 0.37
&gt; 
&gt; Without my workaround, this is the error I get when the temp directory cleanup fails:
&gt; cannot unlink file for C:\Users\do382cd\AppData\Local\Temp\1\HjecI5Ixs5\CrashpadMetrics-active.pma: Permission denied at C:/strawberry/perl/lib/File/Temp.pm line 784.
&gt; cannot remove directory for C:/Users/do382cd/AppData/Local/Temp/1/HjecI5Ixs5: Directory not empty at C:/strawberry/perl/lib/File/Temp.pm line 784.
&gt; 
&gt; Test script:
&gt; 
&gt; use strict;
&gt; use Log::Log4perl qw&#40;:easy&#41;;
&gt; use WWW::Mechanize::Chrome;
&gt; use File::Temp &#39;tempdir&#39;;
&gt; 
&gt; Log::Log4perl-&gt;easy_init&#40;$ERROR&#41;;  # Set priority of root logger to ERROR
&gt; my $tmpdir = tempdir&#40;CLEANUP =&gt; 1 &#41;;
&gt; {
&gt;     # limit scope of $mech so it is destroyed before $tmpdir
&gt;     my $mech = WWW::Mechanize::Chrome-&gt;new&#40;data_directory =&gt; $tmpdir&#41;;
&gt;     $mech-&gt;get&#40;&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/WWW::Mechanize::Chrome">https://metacpan.org/pod/WWW::Mechanize::Chrome</a></span>&#34;&#41;;
&gt; }
&gt; exit&#40;0&#41;; # comment this out for my workaround
&gt; 
&gt; # wait for file to be released so $tmpdir will be cleaned
&gt; my $path = &#34;$tmpdir/CrashpadMetrics-active.pma&#34;;
&gt; for&#40;1..10&#41; {
&gt;     last unless&#40;-e $path&#41;;
&gt;     unlink&#40;$path&#41; and last;
&gt;     sleep&#40;1&#41;;
&gt; }
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;02&nbsp;05:42:43&nbsp;2019</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;14&nbsp;17:14:40&nbsp;2019</span>
    <span class="description">Chris.Denley [...] experian.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 14 Nov 2019 20:37:57 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #130866] AutoReply: Chrome data directory locked</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-WWW-Mechanize-Chrome [...] rt.cpan.org&#34; &lt;bug-WWW-Mechanize-Chrome [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Denley, Chris&#34; &lt;Chris.Denley [...] experian.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thank you for the support. The wait_file change does not seem to be working though. Using WWW::Mechanize::Chrome 0.39. It still fails to delete CrashpadMetrics-active.pma when $tmpdir is destroyed. I could just keep my workaround in place though.

use strict;
use Log::Log4perl qw&#40;:easy&#41;;
use WWW::Mechanize::Chrome;
use File::Temp &#39;tempdir&#39;;

Log::Log4perl-&gt;easy_init&#40;$ERROR&#41;;  # Set priority of root logger to ERROR
my $tmpdir = tempdir&#40;CLEANUP =&gt; 1 &#41;;
{
        # limit scope of $mech so it is destroyed before $tmpdir
        my $mech = WWW::Mechanize::Chrome-&gt;new&#40;data_directory =&gt; $tmpdir, wait_file =&gt; &#34;$tmpdir/CrashpadMetrics-active.pma&#34;&#41;;
        $mech-&gt;get&#40;&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/WWW::Mechanize::Chrome">https://metacpan.org/pod/WWW::Mechanize::Chrome</a></span>&#34;&#41;;
        $mech-&gt;close;
        $mech-&gt;DESTROY;
}
exit&#40;0&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">-----Original Message-----
From: Bugs in WWW-Mechanize-Chrome via RT &lt;bug-WWW-Mechanize-Chrome@rt.cpan.org&gt; 
Sent: Thursday, October 31, 2019 11:06 AM
To: Denley, Chris &lt;Chris.Denley@experian.com&gt;
Subject: [rt.cpan.org #130866] AutoReply: Chrome data directory locked


Greetings,

This message has been automatically generated in response to the creation of a trouble ticket regarding:
        &#34;Chrome data directory locked&#34;,
a summary of which appears below.

There is no need to reply to this message right now.  Your ticket has been assigned an ID of [rt.cpan.org #130866].  Your ticket is accessible on the web at:

    <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=130866">https://rt.cpan.org/Ticket/Display.html?id=130866</a></span>

Please include the string:

         [rt.cpan.org #130866]

in the subject line of all future correspondence about this issue. To do so, you may reply to this message.

                        Thank you,
                        bug-WWW-Mechanize-Chrome@rt.cpan.org

-------------------------------------------------------------------------
I had an issue with WWW::Mechanize::Chrome not working if Chrome was already started. That seems to be resolved with using a different data directory than the already-running instance. I decided to use tempdir as demonstrated in the documentation for the data_directory option to ensure I always use a clean and unique data directory which is always deleted when the script finishes. However, there doesn&#39;t seem to be a good way for ensuring the Chrome process has completed and the temporary directory can be safely cleaned except for waiting a fixed period of time after the WWW::Mechanize::Chrome object is destroyed before allowing the tempdir variable to be destroyed, or waiting until CrashpadMetrics-active.pma can be deleted without error as in my workaround. Perhaps there should be a &#34;close&#34; method available that will return once all Chrome processes have completed and the data_directory can be safely deleted.

Chrome 78 on Windows 10
Strawberry Perl 5.24.4
WWW::Mechanize::Chrome 0.37

Without my workaround, this is the error I get when the temp directory cleanup fails:
cannot unlink file for C:\Users\do382cd\AppData\Local\Temp\1\HjecI5Ixs5\CrashpadMetrics-active.pma: Permission denied at C:/strawberry/perl/lib/File/Temp.pm line 784.
cannot remove directory for C:/Users/do382cd/AppData/Local/Temp/1/HjecI5Ixs5: Directory not empty at C:/strawberry/perl/lib/File/Temp.pm line 784.

Test script:

use strict;
use Log::Log4perl qw&#40;:easy&#41;;
use WWW::Mechanize::Chrome;
use File::Temp &#39;tempdir&#39;;

Log::Log4perl-&gt;easy_init&#40;$ERROR&#41;;  # Set priority of root logger to ERROR my $tmpdir = tempdir&#40;CLEANUP =&gt; 1 &#41;; {
    # limit scope of $mech so it is destroyed before $tmpdir
    my $mech = WWW::Mechanize::Chrome-&gt;new&#40;data_directory =&gt; $tmpdir&#41;;
    $mech-&gt;get&#40;&#34;<span class="clickylink"><a target="new" rel="nofollow" href="https://metacpan.org/pod/WWW::Mechanize::Chrome">https://metacpan.org/pod/WWW::Mechanize::Chrome</a></span>&#34;&#41;;
}
exit&#40;0&#41;; # comment this out for my workaround

# wait for file to be released so $tmpdir will be cleaned my $path = &#34;$tmpdir/CrashpadMetrics-active.pma&#34;;
for&#40;1..10&#41; {
    last unless&#40;-e $path&#41;;
    unlink&#40;$path&#41; and last;
    sleep&#40;1&#41;;
}

</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
