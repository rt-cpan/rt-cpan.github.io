<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #100977 for Image-ExifTool: error in moving tiff files</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #100977 for Image-ExifTool: error in moving tiff files</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Image-ExifTool/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Image-ExifTool/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Image-ExifTool/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Image-ExifTool/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Image-ExifTool">Image-ExifTool CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">100977</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">20 min

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Image-ExifTool/Active/">Image-ExifTool</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rgb [...] ellerbach.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-16626-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-16627-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;15:41:40&nbsp;2014</span>
    <span class="description">rgb [...] ellerbach.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> error in moving tiff files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 17 Dec 2014 15:41:01 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Image-ExifTool [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Richard Ball &lt;rgb [...] ellerbach.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Version 9.76 on OSX 10.9.5

This command was used on a bunch of TIFF files:

exiftool &#39;-Directory&lt;DateTimeOriginal&#39; -if&#39;$datetimeoriginal =~ /1984/&#39; -d %Y .

This ended up changing a lot of the metadata and in some cases resulted in a loss of the color information.

I used exiftool -all against an original and a new file &#40;that went from colour to monochrome&#41; and the attached text file is the diff output. The size of the file has gone from 18MB to 9.5MB.
</div></div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza">Version 9.76 on OSX 10.9.5
<div><br></div>
<div>This command was used on a bunch of TIFF files:</div>
<div><br></div>
<div><div>exiftool '-Directory&lt;DateTimeOriginal' -if'$datetimeoriginal =~ /1984/' -d %Y .</div></div>
<div><br></div>
<div>This ended up changing a lot of the metadata and in some cases resulted in a loss of the color information.</div>
<div><br></div>
<div>I used exiftool -all against an original and a new file (that went from colour to monochrome) and the attached text file is the diff output. The size of the file has gone from 18MB to 9.5MB.</div>
<div><br></div>
<div></div>
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza"><div></div>
</div></div>
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;17:53:04&nbsp;2014</span>
    <span class="description">EXIFTOOL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for this report, however I don&#39;t believe that your conclusions are valid for a few reasons:

1&#41; The command in question will not modify the file.  &#40;even with the missing space after between &#34;-if&#34; and its argument&#41;.

2&#41; Even if you did somehow manage to execute an exiftool command to change the files, the byte ordering would never be changed.  ExifTool will not change the byte order of a TIFF file.

3&#41; Even if you did somehow manage to execute an exiftool command to change the files, then exiftool would preserve the originals by adding &#34;_original&#34; to the file name, so you could restore from these files and nothing would be lost.

I suspect you ran some other utility unknowinly.  Microsoft utilities are notorious for changing byte order and running when you don&#39;t realize it.

- Phil
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;17:53:04&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;18:35:33&nbsp;2014</span>
    <span class="description">EXIFTOOL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Looking further down the difference file I see that the image was compressed &#40;which ExifTool can not do&#41;, and also that it was Apple Aperture that is the culprit.

- Phil
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Dec&nbsp;17&nbsp;20:14:18&nbsp;2014</span>
    <span class="description">rgb [...] ellerbach.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100977] error in moving tiff files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 17 Dec 2014 20:13:52 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Image-ExifTool [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Richard Ball &lt;rgb [...] ellerbach.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the reply Phil.

The files were in Aperture and I exported them from there so I can archive them separately from the remainder of the Aperture library. They were originally scanned as PhotoCD images several decades ago and then read off those CDs as tiff images which were what was brought into Aperture.

The command I gave to exiftool, according to the help file, does not create the _original file since it is writing a new  tiff to a new directory so the input file stays intact in the originating directory.

I’ll describe in some more detail what went on, maybe that will help sort out what happened. I have 882 files of these PCD images &#40;~16GB&#41; and I wanted to separate those that had relevant date info from those that didn’t so I could modify the latter manually. The files all have the extension .tif. I ran this command on the directory they are in

exiftool &#39;-Directory&lt;DateTimeOriginal&#39; -if&#39;$datetimeoriginal =~ /1984/&#39; -d %Y .

I get this output to the terminal:

Warning: Tag &#39;if$datetimeoriginal&#39; does not exist
Warning: No writable tags set from ./pcddisk_0649_001.tif
Warning: No writable tags set from ./pcddisk_0649_002.tif
Warning: No writable tags set from ./pcddisk_0649_003.tif
Warning: No writable tags set from ./pcddisk_0649_004.tif
,
. &#40;continues for all the files&#41;
.
    1 directories scanned
    3 directories created
  182 image files updated
  699 image files unchanged

The three directories created are “1984”, “1995” and “2010”. There are some files with datetimeoriginal data of 1984 or 1995. There are none with the date of 2010 that I know of but some do have a Modifydate of that year.

If I run “exiftool -s -all” on the file pcddisk_2045_012.tiff &#40;note the new extension&#41; created by exiftool in the directory 2010 I get the info in the attached file out1.txt. If I run the same command on the original file &#40;taken from a backup directory&#41; I get the minimal info in the attached out2.txt file.

The really odd thing is that if I run that “create_new_directories” command on just the original pcddisk_2045_012.tif file I get the message:

Warning: Tag &#39;if$datetimeoriginal&#39; does not exist
Warning: No writable tags set from pcddisk_2045_012.tif
    0 image files updated
    1 image files unchanged

and no directory is created and no .tiff file written. I’d be happy to run some tests if you have anything to suggest.


—Richard

On Dec 17, 2014, at 18:35, Phil Harvey via RT &lt;bug-Image-ExifTool@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100977">https://rt.cpan.org/Ticket/Display.html?id=100977</a></span> &gt;
&gt; 
&gt; Looking further down the difference file I see that the image was compressed &#40;which ExifTool can not do&#41;, and also that it was Apple Aperture that is the culprit.
&gt; 
&gt; - Phil
</div></div></div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza">Thanks for the reply Phil.
<div><br></div>
<div>The files were in Aperture and I exported them from there so I can archive them separately from the remainder of the Aperture library. They were originally scanned as PhotoCD images several decades ago and then read off those CDs as tiff images which were what was brought into Aperture.</div>
<div><br></div>
<div>The command I gave to exiftool, according to the help file, does not create the _original file since it is writing a new &nbsp;tiff to a new directory so the input file stays intact in the originating directory.</div>
<div><br></div>
<div>I’ll describe in some more detail what went on, maybe that will help sort out what happened. I have 882 files of these PCD images (~16GB) and I wanted to separate those that had relevant date info from those that didn’t so I could modify the latter manually. The files all have the extension .tif. I ran this command on the directory they are in</div>
<div><br></div>
<div><div>exiftool '-Directory&lt;DateTimeOriginal' -if'$datetimeoriginal =~ /1984/' -d %Y .</div><div><br></div><div>I get this output to the terminal:</div><div><br></div><div><div>Warning: Tag 'if$datetimeoriginal' does not exist</div><div>Warning: No writable tags set from ./pcddisk_0649_001.tif</div><div>Warning: No writable tags set from ./pcddisk_0649_002.tif</div><div>Warning: No writable tags set from ./pcddisk_0649_003.tif</div><div>Warning: No writable tags set from ./pcddisk_0649_004.tif</div><div>,</div><div>. (continues for all the files)</div><div>.</div><div><div>&nbsp; &nbsp;&nbsp;1 directories scanned</div><div>&nbsp; &nbsp; 3 directories created</div><div>&nbsp; 182 image files updated</div><div>&nbsp; 699 image files unchanged</div></div><div><br></div><div>The three directories created are “1984”, “1995” and “2010”. There are some files with datetimeoriginal data of 1984 or 1995. There are none with the date of 2010 that I know of but some do have a Modifydate of that year.</div><div><br></div><div>If I run “exiftool -s -all” on the file pcddisk_2045_012.tiff (note the new extension) created by exiftool in the directory 2010 I get the info in the attached file out1.txt. If I run the same command on the original file (taken from a backup directory) I get the minimal info in the attached out2.txt file.</div><div><br></div><div>The really odd thing is that if I run that “create_new_directories” command on just the original pcddisk_2045_012.tif file I get the message:</div><div><br></div><div><div>Warning: Tag 'if$datetimeoriginal' does not exist</div><div>Warning: No writable tags set from pcddisk_2045_012.tif</div><div>&nbsp; &nbsp; 0 image files updated</div><div>&nbsp; &nbsp; 1 image files unchanged</div></div><div><br></div><div>and no directory is created and no .tiff file written. I’d be happy to run some tests if you have anything to suggest.</div><div></div></div></div>
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza"><div><div><div></div></div></div>
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza"><div><div><div></div><div><br></div><div>—Richard</div><div><br></div></div><div><div>On Dec 17, 2014, at 18:35, Phil Harvey via RT &lt;<a href="mailto:bug-Image-ExifTool@rt.cpan.org">bug-Image-ExifTool@rt.cpan.org</a>&gt; wrote:</div><br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><blockquote>
&lt;URL: <a href="https://rt.cpan.org/Ticket/Display.html?id=100977"><span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100977">https://rt.cpan.org/Ticket/Display.html?id=100977</a></span></a> &gt;<br>
<br>
Looking further down the difference file I see that the image was compressed (which ExifTool can not do), and also that it was Apple Aperture that is the culprit.<br>
<br>
- Phil<br>
</blockquote>
</div></div><br></div>
</div></div>
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;07:25:59&nbsp;2014</span>
    <span class="description">EXIFTOOL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">You&#39;re correct about the &#34;_original&#34; file.  It won&#39;t be created if the original file is not touched.

The warning about &#39;if$datetimeoriginal&#39; is because you need a space after the -if option.  So your -if condition was effectively ignored due to this.

However, there is still something else going on.  Also, ExifTool will not change the file extension unless you tell it to.  I suggest you try this:

1&#41; re-copy the PCD images into a fresh &#40;initially empty&#41; directory.  

2&#41; re-run your exiftool command.

3&#41; look at the images in the sub-directories.

If you are only writing the &#34;Directory&#34; tag in exiftool, then the files are only moved, and never actually written.  If you omit the space after &#34;-if&#34;, then all files containing DateTimeOriginal will be moved.  If you add the space, then only files with a DateTimeOriginal containing 1984 will be moved.

- Phil
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;10:47:31&nbsp;2014</span>
    <span class="description">rgb [...] ellerbach.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100977] error in moving tiff files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Dec 2014 10:47:15 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Image-ExifTool [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Richard Ball &lt;rgb [...] ellerbach.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">OK, here is the test I ran &#40;work on the files without 1984 in the DateTimeOriginal&#41;:

ball$ mkdir PCDimages
ball$ cp PCD\ images\ originals/* PCDimages/
ball$ cd PCDimages/
ball$ exiftool &#39;-Directory&lt;DateTimeOriginal&#39; -if &#39;$datetimeoriginal =! /1984/&#39; -d %Y .

Warning: No writable tags set from ./pcddisk_0649_001.tif
Warning: No writable tags set from ./pcddisk_0649_002.tif
Warning: No writable tags set from ./pcddisk_0649_003.tif
.
.
.
    1 directories scanned
    3 directories created
  182 image files updated
  699 image files unchanged

ball$ ls -1 | head -5
1984
1995
2010
pcddisk_0649_001.tif
pcddisk_0649_002.tif

In the two directories 1984 and 1995 the files have their original sizes and the same .tif extension so it appears they are moved without any modification. However the files “moved” into the 2010 directory are modified in the process.

ball$ ls -l 2010 | head
total 599376
-rw-r--r--@ 1 ball  staff  10535374 Dec 18 10:05 pcddisk_0649_040.tiff
-rw-r--r--@ 1 ball  staff  18877126 Dec 18 10:06 pcddisk_0650_048.tiff
-rw-r--r--@ 1 ball  staff   9923805 Dec 18 10:07 pcddisk_2045_012.tiff
-rw-r--r--@ 1 ball  staff  11264423 Dec 18 10:07 pcddisk_2045_013.tiff
-rw-r--r--@ 1 ball  staff   9893265 Dec 18 10:07 pcddisk_2045_017.tiff
-rw-r--r--@ 1 ball  staff   9981043 Dec 18 10:07 pcddisk_2045_018.tiff
-rw-r--r--@ 1 ball  staff   9461657 Dec 18 10:07 pcddisk_2045_019.tiff
-rw-r--r--@ 1 ball  staff  10376917 Dec 18 10:07 pcddisk_2045_022.tiff
-rw-r--r--@ 1 ball  staff  11854743 Dec 18 10:07 pcddisk_2045_024.tiff

For comparison here are the ls results for the same first four files from the 2010 directory from the originals:

-rw-r--r--@ 1 ball  staff  18875756 Feb  3  2010 pcddisk_0649_040.tif
-rw-r--r--@ 1 ball  staff  18875756 Feb  3  2010 pcddisk_0650_048.tif
-rw-r--r--@ 1 ball  staff  18875756 Feb  3  2010 pcddisk_2045_012.tif
-rw-r--r--@ 1 ball  staff  18875756 Feb  3  2010 pcddisk_2045_013.tif

I don’t yet know why exiftool is picking the 29 files it is writing into the 2010 directory

Richard

On Dec 18, 2014, at 7:25, Phil Harvey via RT &lt;bug-Image-ExifTool@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100977">https://rt.cpan.org/Ticket/Display.html?id=100977</a></span> &gt;
&gt; 
&gt; You&#39;re correct about the &#34;_original&#34; file.  It won&#39;t be created if the original file is not touched.
&gt; 
&gt; The warning about &#39;if$datetimeoriginal&#39; is because you need a space after the -if option.  So your -if condition was effectively ignored due to this.
&gt; 
&gt; However, there is still something else going on.  Also, ExifTool will not change the file extension unless you tell it to.  I suggest you try this:
&gt; 
&gt; 1&#41; re-copy the PCD images into a fresh &#40;initially empty&#41; directory.  
&gt; 
&gt; 2&#41; re-run your exiftool command.
&gt; 
&gt; 3&#41; look at the images in the sub-directories.
&gt; 
&gt; If you are only writing the &#34;Directory&#34; tag in exiftool, then the files are only moved, and never actually written.  If you omit the space after &#34;-if&#34;, then all files containing DateTimeOriginal will be moved.  If you add the space, then only files with a DateTimeOriginal containing 1984 will be moved.
&gt; 
&gt; - Phil
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;12:13:55&nbsp;2014</span>
    <span class="description">EXIFTOOL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I know why.  There were a number of edited files with extension &#34;.tiff&#34; in the &#34;originals&#34; directory.

What is the result of this command?:

ls PCD\ images\ originals/*.tiff

- Phil
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;12:23:35&nbsp;2014</span>
    <span class="description">rgb [...] ellerbach.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100977] error in moving tiff files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Dec 2014 12:23:17 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Image-ExifTool [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Richard Ball &lt;rgb [...] ellerbach.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">You are right, there are .tiff files corresponding to each of the .tif files that get put into the 2010 directory.

Thanks!


On Dec 18, 2014, at 12:13, Phil Harvey via RT &lt;bug-Image-ExifTool@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100977">https://rt.cpan.org/Ticket/Display.html?id=100977</a></span> &gt;
&gt; 
&gt; I know why.  There were a number of edited files with extension &#34;.tiff&#34; in the &#34;originals&#34; directory.
&gt; 
&gt; What is the result of this command?:
&gt; 
&gt; ls PCD\ images\ originals/*.tiff
&gt; 
&gt; - Phil
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;12:29:58&nbsp;2014</span>
    <span class="description">EXIFTOOL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken">20 min</span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Great.  Glad to resolve this.

I&#39;m putting this ticket in the rejected pile because it turned out not to be an exiftool bug after all.

- Phil
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;12:29:58&nbsp;2014</span>
    <span class="description">EXIFTOOL [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;18&nbsp;12:37:15&nbsp;2014</span>
    <span class="description">rgb [...] ellerbach.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #100977] error in moving tiff files</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 18 Dec 2014 12:36:39 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Image-ExifTool [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Richard Ball &lt;rgb [...] ellerbach.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yes, user error.

On Dec 18, 2014, at 12:29, Phil Harvey via RT &lt;bug-Image-ExifTool@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=100977">https://rt.cpan.org/Ticket/Display.html?id=100977</a></span> &gt;
&gt; 
&gt; Great.  Glad to resolve this.
&gt; 
&gt; I&#39;m putting this ticket in the rejected pile because it turned out not to be an exiftool bug after all.
&gt; 
&gt; - Phil
</div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
