<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #71171 for Business-OnlinePayment-eSelectPlus: Pre-authorization &#38; Capture/completion</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #71171 for Business-OnlinePayment-eSelectPlus: Pre-authorization &#38; Capture/completion</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Business-OnlinePayment-eSelectPlus/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Business-OnlinePayment-eSelectPlus/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Business-OnlinePayment-eSelectPlus/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Business-OnlinePayment-eSelectPlus/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Business-OnlinePayment-eSelectPlus">Business-OnlinePayment-eSelectPlus CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">71171</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Business-OnlinePayment-eSelectPlus/Active/">Business-OnlinePayment-eSelectPlus</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
DONOR [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-4656-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.03    </td>
  </tr>
  <tr id="CF-4657-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.06    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;22&nbsp;17:33:54&nbsp;2011</span>
    <span class="description">DONOR [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Pre-authorization &#38; Capture/completion</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">We have enhanced Business::OnlinePayment::eSelectPlus for
pre-authorization &#38; capture/completion.  We hope this enhancement can be
incorporated or adapted for BOP::eSelectPlus on CPAN.

0.05  2011-09-20
        - Pre-auth &#38; capture/completion are now supported.
          Backwards-compatibility note: callers who specify the order_id,
          should now specify it with &#39;order_id&#39; in content &#40;not
&#39;order_number&#39;,
          which is now used for eSelectPlus txn_number, for capture&#41;.
          Note: the order_number&#40;&#41; method now returns the &#39;TransID&#39;
          &#40;not &#39;ReferenceNum&#39;&#41; response field from eSelectPlus.
          Note: testing preauth seems to work only with test store #1 &#40;CAD&#41;.
        - by Randall Whitman &lt;www.whizman.com&gt; on contract to
          DonorWare LLC dba donor.com &lt;cpan @ donor . com&gt;.

Developer believes the following entry  is incorrect in Moneris
documentation eSELECTplus_Perl_IG Appendix B. Definitions of Response
Fields &#40;in both US/CA&#41;:
  Txn_number
Per testing, there is never a &#34;Txn_number&#34; response element present, but
rather &#34;TransID&#34;.  Also, in mpgClasses.pl &#40;the gateway-interaction code
on which the doc examples are based&#41;, the getTxnNumber&#40;&#41; method gets the
value from the TransID element in the response.

The eSelectPlus order_id required parameter, can either be passed by the
caller to B:OP, or generated within B:OP eSelectPlus. Examples
respectively: t/capture_ca.t &#38; t/capture_us.t .

As of version 0.05, the content method now uses a gateway-specific
&#39;order_id&#39;
&#40;not &#39;order_num&#39;&#41; parameter for caller-specified eSelectPlus order_id,
and the
&#39;order_number&#39; parameter is now used as the transaction number &#40;eSelectPlus
txn_number, from TransID&#41; for Post Authorization &#40;completion/capture&#41;.  Also
for Post Authorization, the &#39;order_id&#39; parameter must match the order_id
used for the corresponding Authorization Only &#40;pre-authorization&#41;.

Existing &#40;0.03&#41;: 
 - pre-auth &#38; capture/completion not supported
 - for purchase/normal-sale, the eSelectPlus order_id required parameter,
   could be passed in as content{order-number}, else was generated
   inside B:OP eSelectPlus &#40;generate_order_id&#41;.  &#40;eSelectPlus ReceiptId
   response, same value as order_id, not returned by any B:OP accessor.&#41;
 - eSelectPlus ReferenceNum response, returned by B:OP order_number&#40;&#41;.
 - eSelectPlus TransID response, missing from Moneris eSelectPlus docs
   &#40;cf Txn_number - which in fact is never present in the response&#41;,
   not returned by any B:OP accessor.

New:
 - pre-auth/capture is supported
 - for pre-auth as well as for purchase/normal-sale, the eSelectPlus
order_id
   required parameter, can be passed in as content{order_id}, else is
   generated inside B:OP eSelectPlus &#40;generate_order_id&#41;.
   eSelectPlus ReceiptId response, equivalent to passed-in/generated
order_id,
   returned by gateway-specific B:OP accessor order_id&#40;&#41;.
 - eSelectPlus ReferenceNum response, not returned by any B:OP accessor.
 - eSelectPlus TransID response, which is returned by standard B:OP accessor
   order_number&#40;&#41;, is the value needed for capture/completion, as B:OP
   content{order_number}, which is mapped to eSelectPlus txn_number.
   &#40;See t/capture*.t for sample.&#41;

Alternate &#40;not implemented&#41;:
 - map content{order-number} to order-id, as done in B:OP eSelectPlus 0.03,
   so that would be done for capture/pre-auth as well as purchase.
 - pass the B:OP order_number&#40;&#41; [eSelectPlus TransID] &#40;not BOP
authorization&#40;&#41;&#41;
   from pre-auth, as content{authorization} [map to eSelectPlus txn_number]
   &#40;not content{order_number}.
 ~ various other permutations of method and content-key nomenclature.

====

Gateway          Pre-auth &#40;or sale&#41;    Component         Capture/void - B:OP
response         B:OP accessor         originating      
%content{order_number}

AuthorizeNet:
Response index   BOP return/method     Origin/desc       Use for
capture/void
5                authorization         approval code     no
7                order_number          gateway xn id     yes: x_Trans_ID

PayflowPro:
Response key     BOP return/method     Origin/desc       Use for
capture/void
AUTHCODE         authorization         auth code         no
PNREF            order_number                            yes: ORIGID

EXact &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Public/Bug/Display.html?id=70658">https://rt.cpan.org/Public/Bug/Display.html?id=70658</a></span>&gt;:
Response tag      BOP return/method    Origin/desc       Use for
capture/void
Authorization_Num authorization        bank auth #       Yes!:
Authorization_Num
SequenceNo        order_number         gateway xn id     no

eSelectPlus &#40;new/0.05&#41;:
Response tag     BOP return/method     Origin/desc       Use for
capture/void
AuthCode         authorization         auth code         no
TransID          order_number          gateway Txn       yes: txn_number
ReferenceNum     usused &#40;no accessor&#41;  gateway refnum    not usable
ReceiptId        order_id            content{order_id}|  also: order_id
                                     generate_order_id
&#40;n.b. additional gateway-specific order_id, to originate in B:OP or caller&#41;

&#40;existing eSelectPlus 0.03&#41;:
Response tag     BOP return/method     Origin/desc       No capture
AuthCode         authorization         auth code         not usable
TransID          unused &#40;not in doc&#41;   gateway Txn       not supported
ReferenceNum     order_number          gateway refnum    not usable
ReceiptId        none &#40;no accessor&#41; content{order_number}|     needed
                                     generate_order_id
&#40;n.b. additional gateway-specific order_id, to originate in B:OP or caller&#41;

====

The eSelectPlus test server seems to go down intermittently.
When the eSelectPlus test server is up, the B:OP eSelectPlus tests pass.

Attached Business-OnlinePayment-eSelectPlus-0.05.tar.gz contains the new
test
scripts for pre-auth &#38; capture, but also contains customizations
&#40;internally numbered 0.04&#41;.  Attached preauth-capture.patch.gz contains only
changes made for pre-auth &#38; capture, and only changed files, not the new
ones.

% sha1sum Business-OnlinePayment-eSelectPlus-0.05.tar.gz
01a8d8659242f82d412dba319526f69b95173c28 
Business-OnlinePayment-eSelectPlus-0.05.tar.gz
% gzip preauth-capture.patch
% md5sum Business-OnlinePayment-eSelectPlus-0.05.tar.gz
preauth-capture.patch.gz
fc2d941130751da32dd5021428ac381d 
Business-OnlinePayment-eSelectPlus-0.05.tar.gz
101c8812bdbe8170cd59cd4fc127ef88  preauth-capture.patch.gz
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> preauth-capture.patch.gz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Business-OnlinePayment-eSelectPlus-0.05.tar.gz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;22&nbsp;17:58:33&nbsp;2011</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Regarding &#34;order_id&#34;:

It is not acceptable to use gateway-specific fields for pre-auth data
that needs to be sent for capture.  This would require folks using
different gateways to write different code to use them, which very much
defeats the point of Business::OnlinePayment.

From the end of &#34;notes_for_module_writers_v3&#34; in Business::OnlinePayment:

  Gateways will return one or two values from Authorization Only and
  Normal Authorization transactions that must be submitted back with a
  Post Authorization, Void, or Credit transaction.

  If the gateway returns one value, return this as &#34;authorization&#34;

  If the gateway returns two values, return one as &#34;authorization&#34; and
  the other as &#34;order_number&#34;.  Typically &#34;authorization&#34; is the more
  low-level value returned from the underlying processing network while
  &#34;order_number&#34; is a unique tranaction id generated by the gateway.


Finally, if possible, send your changes as a unified diff &#40;or multiple
diffs for different changes&#41; rather than as a tarball of your new
proposed version.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;22&nbsp;17:58:34&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;30&nbsp;15:58:12&nbsp;2011</span>
    <span class="description">DONOR [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for the pointer to the notes_for_module_writers_v3 additions
newer than the version of B:OP that we have deployed.

We are working on a couple other alternatives for Pre- and Post-Auth
with Moneris eSelectPlus.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;30&nbsp;13:13:52&nbsp;2012</span>
    <span class="description">bitcard [...] whizman.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] whizman.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;notes_for_module_writers_v3&gt;
  If the gateway returns one value, return this as &#34;authorization&#34;
  If the gateway returns two values, return one as &#34;authorization&#34; and the
  other as &#34;order_number&#34;.  Typically &#34;authorization&#34; is the more low-level
  value returned from the underlying processing network while &#34;order_number&#34;
  is a unique tranaction id generated by the gateway.
&lt;/notes_for_module_writers_v3&gt;

So, the typical pattern, applied to Moneris eSelectPlus, would be:

Moneris-eSelectPlus key    BOP key/accessor      origin/description
AuthCode                   authorization         bank authorization code
TransID/txn_number         order_number          gateway transaction number

Issue being, for capture, instead of 2 fields from bank &#38; gateway,
the 2 fields required for Moneris eSelectPlus, originate at gateway &#38;
*client-side*.

Moneris-eSelectPlus     origin/description
AuthCode                bank authorization code &#40;not used for capture&#41;
TransID/txn_number      gateway transaction number &#40;required for capture&#41;
ReceiptID/order_id      client-side &#40;required for capture&#41;

The approach toward which eSelectPlus.pm 0.01 was leaning, was to discard
the AuthCode response [1]:

AuthCode  &gt;&gt;&gt; [discard]
TransID   &gt;&gt;&gt; authorization&#40;&#41; &gt;&gt;&gt; content{authorization} &gt;&gt;&gt; txn_number
ReceiptId &gt;&gt;&gt; order_number&#40;&#41;  &gt;&gt;&gt; content{order_number}  &gt;&gt;&gt; order_id

In the scenario of the 2011/09 development work, customer stored the
eSelectPlus AuthCode for reference or audit purposes.  The approach of
discarding the eSelectPlus AuthCode response, would conflict with a
customer requirement to store the bank authorization code.
&#40;3 pigeons in 2 holes&#41;

[1] attached &#40;tests pass when the test server is up&#41;
741ddcf6dd72147992b6125ab3006a1d  eSelectPlus-diff-0.03-0.06.gz
c1015449f1ac7b3b48a601c7beb5f46c  eSelectPlus-new-0.03-0.06.tar.gz
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> eSelectPlus-new-0.03-0.06.tar.gz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> eSelectPlus-diff-0.03-0.06.gz</td>
  </tr>
</table>

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;10&nbsp;16:49:19&nbsp;2012</span>
    <span class="description">ivan [...] freeside.biz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #71171] Pre-authorization &#38; Capture/completion</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 10 Nov 2012 13:49:08 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Randall Whitman via RT &lt;bug-Business-OnlinePayment-eSelectPlus [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Ivan Kohler &lt;ivan [...] freeside.biz&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue, Oct 30, 2012 at 01:13:53PM -0400, Randall Whitman via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; &lt;notes_for_module_writers_v3&gt;
&gt;   If the gateway returns one value, return this as &#34;authorization&#34;
&gt;   If the gateway returns two values, return one as &#34;authorization&#34; and the
&gt;   other as &#34;order_number&#34;.  Typically &#34;authorization&#34; is the more low-level
&gt;   value returned from the underlying processing network while &#34;order_number&#34;
&gt;   is a unique tranaction id generated by the gateway.
&gt; &lt;/notes_for_module_writers_v3&gt;
&gt; 
&gt; So, the typical pattern, applied to Moneris eSelectPlus, would be:
&gt; 
&gt; Moneris-eSelectPlus key    BOP key/accessor      origin/description
&gt; AuthCode                   authorization         bank authorization code
&gt; TransID/txn_number         order_number          gateway transaction number
&gt; 
&gt; Issue being, for capture, instead of 2 fields from bank &#38; gateway,
&gt; the 2 fields required for Moneris eSelectPlus, originate at gateway &#38;
&gt; *client-side*.
</div>
Yes, I guess the implied followup to the &#34;Typically...&#34; sentence from 
the notes above is that most improtant thing is functionality: that 
authorization and order_number are the two fields that the module user 
is expected to store and provide for follow-up transactions 
&#40;capture/void/etc.&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Moneris-eSelectPlus     origin/description
&gt; AuthCode                bank authorization code &#40;not used for capture&#41;
&gt; TransID/txn_number      gateway transaction number &#40;required for capture&#41;
&gt; ReceiptID/order_id      client-side &#40;required for capture&#41;
&gt; 
&gt; The approach toward which eSelectPlus.pm 0.01 was leaning, was to discard
&gt; the AuthCode response [1]:
&gt; 
&gt; AuthCode  &gt;&gt;&gt; [discard]
</div>
I think we should return this as result_code&#40;&#41; or a new field of its own 
instead of discarding it.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; TransID   &gt;&gt;&gt; authorization&#40;&#41; &gt;&gt;&gt; content{authorization} &gt;&gt;&gt; txn_number
&gt; ReceiptId &gt;&gt;&gt; order_number&#40;&#41;  &gt;&gt;&gt; content{order_number}  &gt;&gt;&gt; order_id
</div>
I think this works for me.  What about Voids/Credits?  Are the same two 
fields required?

-- 
_ivan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;10&nbsp;18:10:11&nbsp;2012</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">These changes have been incorproated in our git.

<span class="clickylink"><a target="new" rel="nofollow" href="https://www.freeside.biz/gitweb/?p=Business-OnlinePayment-eSelectPlus.git;a=snapshot;h=HEAD;sf=tgz">https://www.freeside.biz/gitweb/?p=Business-OnlinePayment-eSelectPlus.git;a=snapshot;h=HEAD;sf=tgz</a></span>

We are testing them now; if everything goes well, they will be included
in a 0.05 release.

It might still be useful to map AuthCode somewhere retrievable, but not
of huge importance.

Thanks!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;10&nbsp;18:10:13&nbsp;2012</span>
    <span class="description">ivan-pause [...] 420.am -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;13&nbsp;00:17:31&nbsp;2012</span>
    <span class="description">ivan-pause [...] 420.am -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;13&nbsp;00:17:31&nbsp;2012</span>
    <span class="description">ivan-pause [...] 420.am -  Fixed in 0.06 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
