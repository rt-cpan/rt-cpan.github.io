<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #90315 for Mail-IMAPClient: getacl on a folder that contains percent sign fails</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #90315 for Mail-IMAPClient: getacl on a folder that contains percent sign fails</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Mail-IMAPClient/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mail-IMAPClient">Mail-IMAPClient CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">90315</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Mail-IMAPClient/Active/">Mail-IMAPClient</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">PLOBBES [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
karcher [...] Waisman.Wisc.Edu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19960-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-19961-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
3.35    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;12&nbsp;17:29:24&nbsp;2013</span>
    <span class="description">karcher [...] Waisman.Wisc.Edu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> getacl on a folder that contains percent sign fails</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 12 Nov 2013 16:28:03 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Carl Karcher &lt;karcher [...] Waisman.Wisc.Edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Version info:

karcher@ubuntu:~$ sudo cpan -D Mail::IMAPClient
CPAN: Storable loaded ok &#40;v2.27&#41;
Going to read &#39;/home/karcher/.local/share/.cpan/Metadata&#39;
  Database was generated on Tue, 12 Nov 2013 21:08:16 GMT
Mail::IMAPClient
-------------------------------------------------------------------------
        CPAN: Module::CoreList loaded ok &#40;v2.49_02&#41;
An IMAP Client API
        P/PL/PLOBBES/Mail-IMAPClient-3.34.tar.gz
        /usr/local/share/perl/5.14.2/Mail/IMAPClient.pm
        Installed: 3.34
        CPAN:      3.34  up to date
        Mark Overmeer &#40;MARKOV&#41;
        mark@overmeer.net

karcher@ubuntu:~$  perl -v

This is perl 5, version 14, subversion 2 &#40;v5.14.2&#41; built for
x86_64-linux-gnu-thread-multi

$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 13.04
Release:        13.04
Codename:       raring
karcher@ubuntu:~$

Description:

When calling the getacl method on a selected folder where the folder name
contains a percent sign, getacl fails.

Code:

# While looping through folders...
# select the folder. If we can&#39;t, print a warning and go to next folder

if &#40;$getacl&#41; {
  $imap-&gt;select&#40;$_&#41;
     or warn &#34;Select &#39;$_&#39; failed: &#34;, $imap-&gt;LastError
     and next;

my $acl_hash = $imap-&gt;getacl&#40;&#41;
    or die &#34;Getacl for $_ failed: &#34;, $imap-&gt;LastError, $imap-&gt;Report;

Resulting output when folder name is &#34;Contains % sign&#34;:

INBOX: admin: lrswipcda, testme2: lrswipcda
Archives: admin: lrswipcda, testme2: lrswipcda
Getacl for Contains % sign failed: 8 GETACL Archives* ACL Archives testme2
lrswipcda admin lrswipcda
8 OK Completed
9 SELECT &#34;Contains % sign&#34;* FLAGS &#40;\Answered \Flagged \Draft \Deleted \Seen&#41;
* OK [PERMANENTFLAGS &#40;\Answered \Flagged \Draft \Deleted \Seen \*&#41;]
* 0 EXISTS
* 0 RECENT
* OK [UIDVALIDITY 1384191623]
9 OK [READ-WRITE] Completed
10 GETACL &#34;Contains % sign&#34;* ACLContains % sign testme2 lrswipcda admin lrswipcda
10 OK Completed

Using a telnet session shows OK:

1 OK User logged in
2 getacl &#34;Contains % sign&#34;
* ACL {15}
Contains % sign testme2 lrswipcda admin lrswipcda
2 OK Completed


-- 
-- Carl Karcher, Computing Services, Waisman Center, UW-Madison
-- Web: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.waisman.wisc.edu/computing/">http://www.waisman.wisc.edu/computing/</a></span> phone: 608-263-5896
-- Supervisor: Jody Bleck, bleck@waisman.wisc.edu
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;14&nbsp;21:09:41&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;14&nbsp;21:09:41&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;02:10:06&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Would you be willing to download and try beta code to see if recent changes fix your problem?

If so, you can
1. download:
<span class="clickylink"><a target="new" rel="nofollow" href="http://sourceforge.net/p/mail-imapclient/git/ci/master/tree/lib/Mail/IMAPClient.pm">http://sourceforge.net/p/mail-imapclient/git/ci/master/tree/lib/Mail/IMAPClient.pm</a></span>

2. put the new IMAPClient.pm in place of the original &#40;make a backup/copy of the old version&#41;

3. test

4. report results here

I didn&#39;t test my fix yet on your problem as my test server doesn&#39;t have ACLs enabled at the moment, but I think there&#39;s a chance this covers the problem you saw.  Please let me know if you get a chance to try it out!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;12:10:09&nbsp;2013</span>
    <span class="description">karcher [...] Waisman.Wisc.Edu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #90315] getacl on a folder that contains percent sign fails</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Nov 2013 11:09:13 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-IMAPClient [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Carl Karcher &lt;karcher [...] Waisman.Wisc.Edu&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The new IMAPClient.pm fixed it. Thanks!

After I reported this I learned that % is not valid character in a folder name
per RFC. However, Office 365 does allow it.


On 11/22/2013 1:10 AM, Phil Pearl &#40;Lobbes&#41; via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=90315">https://rt.cpan.org/Ticket/Display.html?id=90315</a></span> &gt;
&gt; 
&gt; Would you be willing to download and try beta code to see if recent changes fix your problem?
&gt; 
&gt; If so, you can
&gt; 1. download:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://sourceforge.net/p/mail-imapclient/git/ci/master/tree/lib/Mail/IMAPClient.pm">http://sourceforge.net/p/mail-imapclient/git/ci/master/tree/lib/Mail/IMAPClient.pm</a></span>
&gt; 
&gt; 2. put the new IMAPClient.pm in place of the original &#40;make a backup/copy of the old version&#41;
&gt; 
&gt; 3. test
&gt; 
&gt; 4. report results here
&gt; 
&gt; I didn&#39;t test my fix yet on your problem as my test server doesn&#39;t have ACLs enabled at the moment, but I think there&#39;s a chance this covers the problem you saw.  Please let me know if you get a chance to try it out!
</div>
-- 
-- Carl Karcher, Computing Services, Waisman Center, UW-Madison
-- Web: <span class="clickylink"><a target="new" rel="nofollow" href="http://www.waisman.wisc.edu/computing/">http://www.waisman.wisc.edu/computing/</a></span> phone: 608-263-5896
-- Supervisor: Jody Bleck, bleck@waisman.wisc.edu
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;14:14:36&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Nov 22 12:10:09 2013, karcher@Waisman.Wisc.Edu wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The new IMAPClient.pm fixed it. Thanks!
&gt; 
&gt; After I reported this I learned that % is not valid character in a
&gt; folder name per RFC. However, Office 365 does allow it.
</div>
Well, looking at <span class="clickylink"><a target="new" rel="nofollow" href="http://tools.ietf.org/html/rfc3501#section-5.1">http://tools.ietf.org/html/rfc3501#section-5.1</a></span> I see:
...
   3&#41;    Although the list-wildcard characters &#40;&#34;%&#34; and &#34;*&#34;&#41; are valid
         in a mailbox name, it is difficult to use such mailbox names
         with the LIST and LSUB commands due to the conflict with
         wildcard interpretation.

So perhaps not invalid, but perhaps somewhat difficult to deal with.

Thanks for filing the bug and testing the fix!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;14:15:21&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;23:10:42&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Fixed in 3.35 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;23:10:42&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mail::IMAPClient 3.35 has been released on CPAN and has the fix for this bug.  Thanks again for taking the time to report the bug and test!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;22&nbsp;23:11:33&nbsp;2013</span>
    <span class="description">PLOBBES [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
