<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #15210 for Business-OnlinePayment-AuthorizeNet: B:OP::AN reports a failure when fields contain the encapsulation character, even when the transaction succeeds</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #15210 for Business-OnlinePayment-AuthorizeNet: B:OP::AN reports a failure when fields contain the encapsulation character, even when the transaction succeeds</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Business-OnlinePayment-AuthorizeNet/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Business-OnlinePayment-AuthorizeNet/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Business-OnlinePayment-AuthorizeNet/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Business-OnlinePayment-AuthorizeNet/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Business-OnlinePayment-AuthorizeNet">Business-OnlinePayment-AuthorizeNet CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">15210</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Business-OnlinePayment-AuthorizeNet/Active/">Business-OnlinePayment-AuthorizeNet</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">ivan-pause [...] 420.am
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
paul [...] booyaka.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
jshirley [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-4626-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
2.01</li>
<li>
3.00</li>
<li>
3.01</li>
<li>
3.10</li>
<li>
3.11</li>
<li>
3.12</li>
<li>
3.13</li>
<li>
3.14</li>
<li>
3.15</li>
<li>
3.16</li>
<li>
3.17</li>
<li>
3.18</li>
<li>
3.19</li>
<li>
3.20</li>
</ul>
    </td>
  </tr>
  <tr id="CF-4627-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
3.21    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;21&nbsp;22:18:55&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> B:OP::AN reports a failure when fields contain the encapsulation
 character, even when the transaction succeeds</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Business::OnlinePayment::AuthorizeNet 3.15 &#40;and all earlier versions&#41;
will incorrectly report a transaction as failed when it actually has
succeeded if the AuthorizeNet gateway response contains double quotes
&#40;&#34;&#41; that are not used for encapsulation.  This could happen if any
user-supplied field &#40;e.g., the &#34;company&#34; field, or the &#34;description&#34;
field&#41; contains the encapsulation character.  For example, the
following company name will trigger this behavior:

    &#34;PerlShop&#34; - for all your Perl needs

When the string is passed back in the response data, the double-quotes
will not be escaped, and Text::CSV_XS::parse will fail.  Since
B::OP::AN does not check parse&#40;&#41;&#39;s return status, the transaction will
be reported as unsuccessful, even if the Authorize.Net backend
succeeded in debiting or crediting the account.  The Perl module returns
an error_message value starting with:

    DEBUG: No x_response_code from server, &#40;HTTPS response: HTTP/1.1 200 OK&#41;


The attached patch fixes this bug.  It will check all of the supplied
user data to ensure that no instances of the encapsulation character
are submitted to Authorize.Net &#40;outside of the x_encap_char field,
that is&#41;.  The transaction will be aborted before Authorize.Net is
ever called.  This is not an ideal solution -- ideally, we&#39;d like
Authorize.Net to escape instances of the encapsulation character in
field data.  However, Authorize.Net does not implement this.

I also considered silently stripping out the encapsulation character
from passed-in user data, but rejected this method on the grounds that
some applications may depend on receiving the same data back that was
originally submitted.

Comments are welcome,


- Paul
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Business::OnlinePayment::AuthorizeNet 3.15 &#40;and all earlier versions&#41;
will incorrectly report a transaction as failed when it actually has
succeeded if the AuthorizeNet gateway response contains double quotes
&#40;&#34;&#41; that are not used for encapsulation.  This could happen if any
user-supplied field &#40;e.g., the &#34;company&#34; field, or the &#34;description&#34;
field&#41; contains the encapsulation character.  For example, the
following company name will trigger this behavior:

    &#34;PerlShop&#34; - for all your Perl needs

When the string is passed back in the response data, the double-quotes
will not be escaped, and Text::CSV_XS::parse will fail.  Since
B::OP::AN does not check parse&#40;&#41;&#39;s return status, the transaction will
be reported as unsuccessful, even if the Authorize.Net backend
succeeded in debiting or crediting the account.  The Perl module returns
an error_message value starting with:
    
    DEBUG: No x_response_code from server, &#40;HTTPS response: HTTP/1.1 200 OK&#41;


The following patch fixes this bug.  It will check all of the supplied
user data to ensure that no instances of the encapsulation character
are submitted to Authorize.Net &#40;outside of the x_encap_char field,
that is&#41;.  The transaction will be aborted before Authorize.Net is
ever called.  This is not an ideal solution -- ideally, we&#39;d like
Authorize.Net to escape instances of the encapsulation character in
field data.  However, Authorize.Net does not implement this.  

I also considered silently stripping out the encapsulation character
from passed-in user data, but rejected this method on the grounds that
some applications may depend on receiving the same data back that was
originally submitted.

Comments are welcome,


- Paul


--- AuthorizeNet.pm.orig	2005-10-21 18:48:03.000000000 -0700
+++ AuthorizeNet.pm	2005-10-21 18:54:48.000000000 -0700
@@ -194,10 +194,33 @@
     $post_data{&#39;x_Test_Request&#39;} = $self-&gt;test_transaction&#40;&#41;?&#34;TRUE&#34;:&#34;FALSE&#34;;
     $post_data{&#39;x_ADC_Delim_Data&#39;} = &#39;TRUE&#39;;
     $post_data{&#39;x_delim_char&#39;} = &#39;,&#39;;
-    $post_data{&#39;x_encap_char&#39;} = &#39;&#34;&#39;;
+    $post_data{&#39;x_encap_char&#39;} = my $encap_char = &#39;&#34;&#39;;
     $post_data{&#39;x_ADC_URL&#39;} = &#39;FALSE&#39;;
     $post_data{&#39;x_Version&#39;} = &#39;3.1&#39;;
 
+    # Abort the transaction if any instances of the encapsulation
+    # character occur in the content parameters that the user passed
+    # in.  This is necessary since Authorize.Net will not properly
+    # escape the encapsulation character if it occurs within field
+    # data when it sends back its response.  This can cause
+    # Text::CSV_XS to fail the response parse, which in turn can cause
+    # the caller to believe that a transaction has failed, when it
+    # actually has succeeded.  
+    #
+    while &#40;my &#40;$k, $v&#41; = each %post_data&#41; { 
+	next if $k eq &#39;x_encap_char&#39;; 
+	
+	if &#40;index &#40;$v, $encap_char&#41; &gt; -1&#41; {
+	    # Fail the request
+	    $self-&gt;is_success&#40;0&#41;;
+	    $self-&gt;error_message&#40;&#34;This transaction cannot be processed, &#34;.
+				 &#34;since the $k field contains at least &#34;.
+				 &#34;one $encap_char character.  Please &#34;.
+				 &#34;remove this character and resubmit.&#34;&#41;;
+	    return;
+	};
+    };
+
     my $pd = make_form&#40;%post_data&#41;;
     my $s = $self-&gt;server&#40;&#41;;
     my $p = $self-&gt;port&#40;&#41;;
@@ -207,7 +230,7 @@
     #escape NULL &#40;binary 0x00&#41; values
     $page =~ s/\x00/\^0/g;
 
-    my $csv = new Text::CSV_XS&#40;{ &#39;binary&#39;=&gt;1 }&#41;;
+    my $csv = new Text::CSV_XS&#40;{ &#39;binary&#39;=&gt;1, &#39;quote_char&#39;=&gt;$encap_char }&#41;;
     $csv-&gt;parse&#40;$page&#41;;
     my @col = $csv-&gt;fields&#40;&#41;;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;06&nbsp;11:10:58&nbsp;2005</span>
    <span class="description">ivan-pause [...] 420.am -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;06&nbsp;11:11:01&nbsp;2005</span>
    <span class="description">ivan-pause [...] 420.am -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;06&nbsp;11:13:02&nbsp;2005</span>
    <span class="description">ivan-pause [...] 420.am -  Severity Critical changed to Important</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Oct&nbsp;21&nbsp;19:06:08&nbsp;2006</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Oct 21 22:18:55 2005, guest wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I also considered silently stripping out the encapsulation character
&gt; from passed-in user data, but rejected this method on the grounds 
</div>that
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; some applications may depend on receiving the same data back that 
</div>was
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; originally submitted.
</div>
Can you tell me more about why you rejected this approach?  I&#39;d be 
inclined to silently strip as the default, perhaps with an option to 
return an error instead like your patch, if an application has that 
need.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Oct&nbsp;31&nbsp;13:00:46&nbsp;2006</span>
    <span class="description">paul [...] booyaka.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #15210] B:OP::AN reports a failure when fields contain the encapsulation character, even when the transaction succeeds </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 31 Oct 2006 10:59:59 -0700 &#40;MST&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> via RT &lt;bug-Business-OnlinePayment-AuthorizeNet [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Paul Walmsley &lt;paul [...] booyaka.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat, 21 Oct 2006,  via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=15210">http://rt.cpan.org/Ticket/Display.html?id=15210</a></span> &gt;
&gt;
&gt; On Fri Oct 21 22:18:55 2005, guest wrote:
&gt;
<div class="message-stanza open">&gt;&gt; I also considered silently stripping out the encapsulation character
&gt;&gt; from passed-in user data, but rejected this method on the grounds
</div>&gt; that
<div class="message-stanza open">&gt;&gt; some applications may depend on receiving the same data back that
</div>&gt; was
<div class="message-stanza open">&gt;&gt; originally submitted.
</div>&gt;
&gt; Can you tell me more about why you rejected this approach?  I&#39;d be
&gt; inclined to silently strip as the default, perhaps with an option to
&gt; return an error instead like your patch, if an application has that
&gt; need.
</div>
I rejected that approach based on two basic principles:

1.  Well-written code must not silently modify or corrupt user data -- 
especially code that handles payment processing.

2.  Code should &#34;fail fast&#34; when something is wrong.

An example of a problem that could be caused by a &#34;silently-strip&#34; 
approach: I&#39;ve got a process that parses the Authorize.Net transaction log 
to reconcile its records with a local database.  Suppose my process 
expects to exactly match the &#34;Company&#34; field in Authorize.Net with what&#39;s 
in the database.  My process will fail if the encapsulation character is 
stripped.

...

In any case, whichever fix you choose, I hope you incorporate it quickly. 
This bug report is over a year old, and it is a critical problem to fix. 
We&#39;ve documented cases where customers&#39; cards were charged, but B::OP::AN 
incorrectly reported to our system that the transaction failed.


regards,

- Paul
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;23&nbsp;20:44:53&nbsp;2007</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m not sure if either the &#34;silently strip&#34; or &#34;throw error&#34; solutions
are really the right thing, and had the time to really think about
what needs to be done here.  If Authorize.Net can accept some sort of
quoting or esacping, that would be ideal, but IIRC that&#39;s not
possible.  :/  Maybe we can check the passed-in data and set the 
delimiter character to something that we *know* won&#39;t be passed in?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;20&nbsp;14:49:13&nbsp;2008</span>
    <span class="description">http://www.chrismasto.com/openid/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I can&#39;t figure out how to use RT, but I&#39;d love to add my support for this problem being fixed.  It&#39;s 
quite serious and it&#39;s crazy how long it&#39;s been broken.  Especially with a patch available, 
although I&#39;d prefer the transaction to go through using the XML API, since that apparently 
doesn&#39;t have this problem.  See <span class="clickylink"><a target="new" rel="nofollow" href="http://www.authorize.net/kb.asp">http://www.authorize.net/kb.asp</a></span>?
page_id=169764&#38;url=/authorize.net/consumer/search.asp

chris@masto.com
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;28&nbsp;12:06:54&nbsp;2008</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ivan-pause [...] 420.am</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 20 14:49:13 2008, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrismasto.com/openid/">http://www.chrismasto.com/openid/</a></span> wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I can&#39;t figure out how to use RT, but I&#39;d love to add my support for
&gt; this problem being fixed.  It&#39;s
&gt; quite serious and it&#39;s crazy how long it&#39;s been broken.
</div>
I agree that it would be desirable to get the bug fixed.  Support is 
great... help implementing a patch is even better.  :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Especially with a patch available,
</div>
I don&#39;t think the initial patch is a good fix for the problem.  Upon 
consideration, I think that the best way to fix the problem is to 
examine the passed-in data and choose an appropriate encapsulation 
character on-the-fly that isn&#39;t included in the passed-in data. Or, as 
you suggest, move to the XML API which does not have this problem.

Help implementing either approach is more than welcome.  I&#39;d be more 
than happy to do a release given a working patch that applied against 
current code...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; although I&#39;d prefer the transaction to go through using the XML API,
&gt; since that apparently
&gt; doesn&#39;t have this problem.  See <span class="clickylink"><a target="new" rel="nofollow" href="http://www.authorize.net/kb.asp">http://www.authorize.net/kb.asp</a></span>?
&gt; page_id=169764&#38;url=/authorize.net/consumer/search.asp
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;28&nbsp;14:45:51&nbsp;2008</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ivan-pause [...] 420.am</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue May 20 14:49:13 2008, <span class="clickylink"><a target="new" rel="nofollow" href="http://www.chrismasto.com/openid/">http://www.chrismasto.com/openid/</a></span> wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It&#39;s too bad Authorize.net&#39;s CSV-like approach doesn&#39;t support any            
&gt; kind of real escaping.  It would be a lot quicker to work around it           
&gt; that way.                                                                     
</div>                                                                                
Sure, if they just supported actual CSV there wouldn&#39;t be a problem in          
the first place.                                                                
                                                                                
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The only other choices, besides rewriting it all to use                       
&gt; XML, would seem to be to throw an error, remove invalid characters,           
</div>                                                                                
We&#39;ve rejected these first two approaches.  Both are unpleasant for             
various reasons.                                                                
                                                                                
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; or scan all the data to try to find a non-conflicting delimeter.              
</div>                                                                                
This is the desired fix.  We should try every possible legal
encapsulation character before throwing an error.  It is the best
that can be done given the limitations of the API &#40;without rewriting
against the XML one&#41;.                                                                   
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;15:04:44&nbsp;2009</span>
    <span class="description">jshirley+cpan [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perhaps the better solution is to update the x_delim_char?

The AIM documents suggest using |, which seems like a much better choice.

If you look at their sample &#40;from
<span class="clickylink"><a target="new" rel="nofollow" href="http://developer.authorize.net/samplecode/&#41;">http://developer.authorize.net/samplecode/&#41;</a></span> you can see they do it this
way.  Testing with quotes in the fields works fine.

Then, the split is a simple split&#40;/\Q|/, $response-&gt;content&#41;; rather
than relying on Text::CSV_XS which seems inappropriate given the
response payload.

Please see the attached patch.  It would be great if this got fixed,
this patch may not be 100% done but it passes tests and adds another
with a quote.  

&#40;Might I suggest putting the source on github or another public repos,
to make it easier for submitting patches against?&#41;

Thanks,
-Jay
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -u -r Business-OnlinePayment-AuthorizeNet-3.20/AuthorizeNet/AIM.pm Business-OnlinePayment-AuthorizeNet-3.20-fix/AuthorizeNet/AIM.pm
--- Business-OnlinePayment-AuthorizeNet-3.20/AuthorizeNet/AIM.pm	2008-02-02 17:35:05.000000000 -0800
+++ Business-OnlinePayment-AuthorizeNet-3.20-fix/AuthorizeNet/AIM.pm	2009-03-24 12:02:10.000000000 -0700
@@ -224,8 +224,9 @@
     }
 
     $post_data{&#39;x_ADC_Delim_Data&#39;} = &#39;TRUE&#39;;
-    $post_data{&#39;x_delim_char&#39;} = &#39;,&#39;;
-    $post_data{&#39;x_encap_char&#39;} = &#39;&#34;&#39;;
+    $post_data{&#39;x_delim_char&#39;} = &#39;|&#39;;
+    #$post_data{&#39;x_encap_char&#39;} = &#39;&#34;&#39;;
+    $post_data{&#39;x_encap_data&#39;} = &#39;TRUE&#39;;
     $post_data{&#39;x_ADC_URL&#39;} = &#39;FALSE&#39;;
     $post_data{&#39;x_Version&#39;} = &#39;3.1&#39;;
 
@@ -241,9 +242,7 @@
     #trim &#39;ip_addr=&#34;1.2.3.4&#34;&#39; added by eProcessingNetwork Authorize.Net compat
     $page =~ s/,ip_addr=&#34;[\d\.]+&#34;$//;
 
-    my $csv = new Text::CSV_XS&#40;{ binary=&gt;1, escape_char=&gt;&#39;&#39; }&#41;;
-    $csv-&gt;parse&#40;$page&#41;;
-    my @col = $csv-&gt;fields&#40;&#41;;
+    my @col = split&#40;/\Q|/, $page&#41;;
 
     $self-&gt;server_response&#40;$page&#41;;
     $self-&gt;avs_code&#40;$col[5]&#41;;
diff -u -r Business-OnlinePayment-AuthorizeNet-3.20/t/credit_card.t Business-OnlinePayment-AuthorizeNet-3.20-fix/t/credit_card.t
--- Business-OnlinePayment-AuthorizeNet-3.20/t/credit_card.t	2006-10-18 16:11:55.000000000 -0700
+++ Business-OnlinePayment-AuthorizeNet-3.20-fix/t/credit_card.t	2009-03-24 12:02:43.000000000 -0700
@@ -4,7 +4,7 @@
 require &#34;t/lib/test_account.pl&#34;;
 
 my&#40;$login, $password&#41; = test_account_or_skip&#40;&#41;;
-plan tests =&gt; 2;
+plan tests =&gt; 3;
   
 use_ok &#39;Business::OnlinePayment&#39;;
 
@@ -32,3 +32,26 @@
 $tx-&gt;submit&#40;&#41;;
 
 ok&#40;$tx-&gt;is_success&#40;&#41;&#41; or diag $tx-&gt;error_message;
+
+$tx-&gt;content&#40;
+    type           =&gt; &#39;VISA&#39;,
+    login          =&gt; $login,
+    password       =&gt; $password,
+    action         =&gt; &#39;Normal Authorization&#39;,
+    description    =&gt; &#39;Business::OnlinePayment visa test for quotes&#39;,
+    amount         =&gt; &#39;59.95&#39;,
+    invoice_number =&gt; &#39;100101&#39;,
+    customer_id    =&gt; &#39;jsk&#39;,
+    first_name     =&gt; &#39;Tofu &#34;Quote&#34;&#39;,
+    last_name      =&gt; &#39;Beast&#39;,
+    address        =&gt; &#39;123 Anystreet&#39;,
+    city           =&gt; &#39;Anywhere&#39;,
+    state          =&gt; &#39;UT&#39;,
+    zip            =&gt; &#39;84058&#39;,
+    card_number    =&gt; &#39;4111111111111111&#39;,
+    expiration     =&gt; expiration_date&#40;&#41;,
+&#41;;
+$tx-&gt;test_transaction&#40;1&#41;; # test, dont really charge
+$tx-&gt;submit&#40;&#41;;
+
+ok&#40;$tx-&gt;is_success&#40;&#41;&#41; or diag $tx-&gt;error_message;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;15:32:05&nbsp;2009</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 24 15:04:44 2009, JSHIRLEY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perhaps the better solution is to update the x_delim_char?
&gt;
&gt; The AIM documents suggest using |, which seems like a much better
&gt; choice.
</div>
Swapping out one character for another does not seem like a useful 
improvement.  We could break existing applications.

The desired fix is:

- Examine the passed-in data and choose an appropriate encapsulation 
character on-the-fly that isn&#39;t included in the passed-in data.

or

- Move to the XML API which does not have this problem.
 
Help implementing either approach is more than welcome. I&#39;d be more 
than happy to do a release given a working patch that applied against 
current code...

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &#40;Might I suggest putting the source on github or another public
&gt; repos, to make it easier for submitting patches against?&#41;
</div>
The code is currently available from our public repository:

export CVSROOT=&#34;:pserver:anonymous@cvs.freeside.biz:/home/cvs/cvsroot&#34;
cvs login
# The password for the user `anonymous&#39; is `anonymous&#39;.
cvs checkout Business-OnlinePayment-AuthorizeNet

or on the web:

<span class="clickylink"><a target="new" rel="nofollow" href="http://freeside.biz/cgi-bin/viewvc.cgi/Business-OnlinePayment-AuthorizeNet/">http://freeside.biz/cgi-bin/viewvc.cgi/Business-OnlinePayment-AuthorizeNet/</a></span>

I&#39;ll add this information to the documentation.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;15:59:06&nbsp;2009</span>
    <span class="description">jshirley+cpan [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 24 15:32:05 2009, IVAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Mar 24 15:04:44 2009, JSHIRLEY wrote:
<div class="message-stanza open">&gt; &gt; Perhaps the better solution is to update the x_delim_char?
&gt; &gt;
&gt; &gt; The AIM documents suggest using |, which seems like a much better
&gt; &gt; choice.
</div>&gt; 
&gt; Swapping out one character for another does not seem like a useful 
&gt; improvement.  We could break existing applications.
&gt; 
</div>
No more than they are broken now, probably less so.  This issue of
encapsulating in quotes is pointless, which is a more important change.
 Changing the delimiter is to just go inline with what Authorize.NET
themselves suggest.  I see no value in using a ,.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The desired fix is:
&gt; 
&gt; - Examine the passed-in data and choose an appropriate encapsulation 
&gt; character on-the-fly that isn&#39;t included in the passed-in data.
&gt; 
&gt; or
&gt; 
&gt; - Move to the XML API which does not have this problem.
&gt;  
</div>
I only see the XML API in terms of ARB, do you have a link to the AIM
implementation?

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Help implementing either approach is more than welcome. I&#39;d be more 
&gt; than happy to do a release given a working patch that applied against 
&gt; current code...
&gt; 
<div class="message-stanza open">&gt; &gt; &#40;Might I suggest putting the source on github or another public
&gt; &gt; repos, to make it easier for submitting patches against?&#41;
</div>&gt; 
&gt; The code is currently available from our public repository:
&gt; 
&gt; export CVSROOT=&#34;:pserver:anonymous@cvs.freeside.biz:/home/cvs/cvsroot&#34;
&gt; cvs login
&gt; # The password for the user `anonymous&#39; is `anonymous&#39;.
&gt; cvs checkout Business-OnlinePayment-AuthorizeNet
&gt; 
&gt; or on the web:
&gt; 
&gt;
</div><span class="clickylink"><a target="new" rel="nofollow" href="http://freeside.biz/cgi-bin/viewvc.cgi/Business-OnlinePayment-AuthorizeNet/">http://freeside.biz/cgi-bin/viewvc.cgi/Business-OnlinePayment-AuthorizeNet/</a></span>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; I&#39;ll add this information to the documentation.
&gt; 
</div>

Thanks.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;16:11:09&nbsp;2009</span>
    <span class="description">jshirley+cpan [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">RT is being a pain in the ass and not letting me watch this ticket.  Can
you add me as a watcher &#40;jshirley@cpan.org&#41;

Thanks.

PS., I&#39;m happy to do the transition to XML, as I need this to work and
not die on quotes.  For now, I&#39;m going to be running my patched version.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;16:30:00&nbsp;2009</span>
    <span class="description">ivan-pause [...] 420.am -  Cc jshirley@cpan.org added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;16:41:07&nbsp;2009</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 24 15:59:06 2009, JSHIRLEY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Mar 24 15:32:05 2009, IVAN wrote:
<div class="message-stanza open">&gt; &gt; On Tue Mar 24 15:04:44 2009, JSHIRLEY wrote:
<div class="message-stanza open">&gt; &gt; &gt; Perhaps the better solution is to update the x_delim_char?
&gt; &gt; &gt;
&gt; &gt; &gt; The AIM documents suggest using |, which seems like a much 
</div></div></div>better
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; choice.
</div>&gt; &gt; 
&gt; &gt; Swapping out one character for another does not seem like a useful 
&gt; &gt; improvement.  We could break existing applications.
&gt; &gt; 
</div>&gt; 
&gt; No more than they are broken now, probably less so.  This issue of
&gt; encapsulating in quotes is pointless, which is a more important
&gt; change.  Changing the delimiter is to just go inline with what
&gt; Authorize.NET themselves suggest.  I see no value in using a ,.
</div>
Yes, it would probably have been a better choice to start with, but as 
I said, swapping out one character for another is not a desirable fix 
at this time.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; The desired fix is:
&gt; &gt; 
&gt; &gt; - Examine the passed-in data and choose an appropriate
&gt; &gt; encapsulation character on-the-fly that isn&#39;t included in the
&gt; &gt; passed-in data.
&gt; &gt; 
&gt; &gt; or
&gt; &gt; 
&gt; &gt; - Move to the XML API which does not have this problem.
</div>&gt; 
&gt; I only see the XML API in terms of ARB, do you have a link to the
&gt; AIM implementation?
</div>
I do not.  It is possible the suggestion was in error and no such API 
is available for AIM.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; RT is being a pain in the ass and not letting me watch this ticket.
&gt; Can you add me as a watcher &#40;jshirley@cpan.org&#41;
</div>
Sure, done.  I find CPAN RT&#39;s setup a bit puzzling too sometimes.  :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;16:45:54&nbsp;2009</span>
    <span class="description">jshirley+cpan [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 24 16:41:07 2009, IVAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Mar 24 15:59:06 2009, JSHIRLEY wrote:
<div class="message-stanza open">&gt; &gt; On Tue Mar 24 15:32:05 2009, IVAN wrote:
<div class="message-stanza open">&gt; &gt; &gt; On Tue Mar 24 15:04:44 2009, JSHIRLEY wrote:
<div class="message-stanza open">&gt; &gt; &gt; &gt; Perhaps the better solution is to update the x_delim_char?
&gt; &gt; &gt; &gt;
&gt; &gt; &gt; &gt; The AIM documents suggest using |, which seems like a much 
</div></div></div>&gt; better
<div class="message-stanza open"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; &gt; choice.
</div>&gt; &gt; &gt; 
&gt; &gt; &gt; Swapping out one character for another does not seem like a useful 
&gt; &gt; &gt; improvement.  We could break existing applications.
&gt; &gt; &gt; 
</div>&gt; &gt; 
&gt; &gt; No more than they are broken now, probably less so.  This issue of
&gt; &gt; encapsulating in quotes is pointless, which is a more important
&gt; &gt; change.  Changing the delimiter is to just go inline with what
&gt; &gt; Authorize.NET themselves suggest.  I see no value in using a ,.
</div>&gt; 
&gt; Yes, it would probably have been a better choice to start with, but as 
&gt; I said, swapping out one character for another is not a desirable fix 
&gt; at this time.
&gt; 
</div>
It isn&#39;t just swapping a character, it&#39;s swapping a character and
removing the unnecessary encapsulation character.

The quote problem goes away if you don&#39;t use the encapsulation, but then
you have to fight with commas.

At this point, to get a version out that will work, can we just have a
configuration set for the x_delim_char, x_encap_data and x_encap_char?

The defaults can maintain what they are now, and then people can simply
enable the | and no encap_char if the have this issue?

I can get that out with a pod patch today.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; The desired fix is:
&gt; &gt; &gt; 
&gt; &gt; &gt; - Examine the passed-in data and choose an appropriate
&gt; &gt; &gt; encapsulation character on-the-fly that isn&#39;t included in the
&gt; &gt; &gt; passed-in data.
&gt; &gt; &gt; 
&gt; &gt; &gt; or
&gt; &gt; &gt; 
&gt; &gt; &gt; - Move to the XML API which does not have this problem.
</div>&gt; &gt; 
&gt; &gt; I only see the XML API in terms of ARB, do you have a link to the
&gt; &gt; AIM implementation?
</div>&gt; 
&gt; I do not.  It is possible the suggestion was in error and no such API 
&gt; is available for AIM.
&gt; 
<div class="message-stanza open">&gt; &gt; RT is being a pain in the ass and not letting me watch this ticket.
&gt; &gt; Can you add me as a watcher &#40;jshirley@cpan.org&#41;
</div>&gt; 
&gt; Sure, done.  I find CPAN RT&#39;s setup a bit puzzling too sometimes.  :&#41;
&gt; 
</div>
It was a permissions problem with me, so thank you :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;24&nbsp;19:29:34&nbsp;2009</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It isn&#39;t just swapping a character, it&#39;s swapping a character and
&gt; removing the unnecessary encapsulation character.
&gt; 
&gt; The quote problem goes away if you don&#39;t use the encapsulation, but
&gt; then you have to fight with commas.
</div>
Right.  It introduces a different set of problems with different 
characters.  This is an unacceptable change for existing applications.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; At this point, to get a version out that will work, can we just have
&gt; a configuration set for the x_delim_char, x_encap_data and
&gt; x_encap_char?
</div>
No.  This is not Business::AuthorizeNet, it is 
Business::OnlinePayment::AuthorizeNet.  Implementing a common, 
gateway-agnostic interface is the whole point.

x_delim_char/x_encap_char are gateway-specific details that should not 
be exposed as part of the public interfaace.  The module should be 
able to auto-select those values without manual configuration, as 
previously indicated.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The defaults can maintain what they are now, and then people can
&gt; simply enable the | and no encap_char if the have this issue?
&gt; 
&gt; I can get that out with a pod patch today.
</div>
As long as you&#39;re interested in contributing, how about just 
implementing the desired fix?  It has the advantage of not requiring 
POD changes and not requiring folks to change anything if they have a 
specific issue...  :&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &gt; &gt; &gt; The desired fix is:
&gt; &gt; &gt; &gt; 
&gt; &gt; &gt; &gt; - Examine the passed-in data and choose an appropriate
&gt; &gt; &gt; &gt; encapsulation character on-the-fly that isn&#39;t included in the
&gt; &gt; &gt; &gt; passed-in data.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;02&nbsp;12:41:49&nbsp;2009</span>
    <span class="description">MSCHOUT [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">For what its worth, we subclassed B::OP::AuthorizeNet and created a
MyAuthorizeNet driver that solves this problem by overloading
get_fields&#40;&#41; to simply replace &#39;&#34;&#39; with &#39;&#34;&#34;&#39; in every field.

This way, the CSV response from authorizenet contains two double quotes
.. e.g.: &#39;foo &#34;test&#34;&#39; becomes &#39;foo &#34;&#34;test&#34;&#34;&#39;.  This seems better than
just failing to run the transaction if quotes are present, or changing
the delimiter character.  With the quotes escaped this way, Text::CSV_XS
is happy and it fixes the problem.

Here is our overloaded get_fields&#40;&#41;:

sub get_fields {
    my $self = shift;
    my %data = $self-&gt;SUPER::get_fields&#40;@_&#41;;

    for my $key &#40;keys %data&#41; {
        my $value = $data{$key};

        next unless defined $value;

        if &#40;$value =~ /&#34;/&#41; {
            $value =~ s/&#34;/&#34;&#34;/g;
            $data{$key} = $value;
        }
    }

    return %data;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;11&nbsp;20:21:56&nbsp;2009</span>
    <span class="description">josh [...] infogears.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Attached is a patch for BOP::AuthorizeNet version 3.20 that fixes this bug.

Fix Method:
As suggested by Ivan, this fix checks for the encapsulating character in
our input. If it exists, we try and grab another encapsulating
character. We have a bunch of various character options, but start with
the ones given by AuthorizeNet in their example of x_encap_char here:

<span class="clickylink"><a target="new" rel="nofollow" href="http://developer.authorize.net/guides/AIM/Transaction_Response/Transaction_Response.htm">http://developer.authorize.net/guides/AIM/Transaction_Response/Transaction_Response.htm</a></span>

If we are unable to get a usable encapsulating character we fail out
gracefully, without ever having hit the Authorize.Net servers.

Cheers,

-- Josh 
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- AIM.pm_3_20	2009-11-11 13:33:02.000000000 -0700
+++ AIM.pm	2009-11-11 13:33:23.000000000 -0700
@@ -223,9 +223,33 @@
       $post_data{&#39;x_Email_Customer&#39;} = &#39;FALSE&#39;;
     }
 
+    my $data_string = join&#40;&#34;&#34;, values %post_data&#41;;
+
+    my $encap_character;
+    # The first set of characters here are recommended by authorize.net in their
+    #   encapsulating character example.
+    # The second set we made up hoping they will work if the first fail.
+    # The third chr&#40;31&#41; is the binary &#39;unit separator&#39; and is our final last
+    #   ditch effort to find something not in the input.
+    foreach my $char&#40; qw&#40; | &#34; &#39; : ; / \ - * &#41;, qw&#40; # ^ + &lt; &gt; [ ] ~&#41;, chr&#40;31&#41; &#41;{
+      if&#40; index&#40;$data_string, $char&#41; == -1 &#41;{ # found one.
+        $encap_character = $char;
+        last;
+      }
+    }
+
+    if&#40;!$encap_character&#41;{
+      $self-&gt;is_success&#40;0&#41;;
+      $self-&gt;error_message&#40;
+			   &#34;DEBUG: Input contains all encapsulating characters.&#34;
+			   . &#34; Please remove | or ^ from your input if possible.&#34;
+			  &#41;;
+      return;
+    }
+
     $post_data{&#39;x_ADC_Delim_Data&#39;} = &#39;TRUE&#39;;
     $post_data{&#39;x_delim_char&#39;} = &#39;,&#39;;
-    $post_data{&#39;x_encap_char&#39;} = &#39;&#34;&#39;;
+    $post_data{&#39;x_encap_char&#39;} = $encap_character;
     $post_data{&#39;x_ADC_URL&#39;} = &#39;FALSE&#39;;
     $post_data{&#39;x_Version&#39;} = &#39;3.1&#39;;
 
@@ -241,7 +265,7 @@
     #trim &#39;ip_addr=&#34;1.2.3.4&#34;&#39; added by eProcessingNetwork Authorize.Net compat
     $page =~ s/,ip_addr=&#34;[\d\.]+&#34;$//;
 
-    my $csv = new Text::CSV_XS&#40;{ binary=&gt;1, escape_char=&gt;&#39;&#39; }&#41;;
+    my $csv = new Text::CSV_XS&#40;{ binary=&gt;1, escape_char=&gt;&#39;&#39;, quote_char =&gt; $encap_character }&#41;;
     $csv-&gt;parse&#40;$page&#41;;
     my @col = $csv-&gt;fields&#40;&#41;;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;13&nbsp;15:08:22&nbsp;2009</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> josh [...] infogears.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Nov 11 20:21:56 2009, josh@infogears.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Attached is a patch for BOP::AuthorizeNet version 3.20 that fixes this
&gt; bug.
</div>
It doesn&#39;t seem like a good idea to join all the data into a giant
string and then search it for each character.

Can you use a hash to store which characters are in the post data
instead?  Then checking is much more straighforward and doesn&#39;t involve
repeatedly sequentially scanning a large string for each possible
encapsulation character.

Also, why is the set of characters to check limited?  Is there a reason
not to try every ASCII character or at least 32-127 ?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;13&nbsp;17:06:01&nbsp;2009</span>
    <span class="description">josh [...] infogears.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Nov 13 15:08:22 2009, IVAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Nov 11 20:21:56 2009, josh@infogears.com wrote:
<div class="message-stanza open">&gt; &gt; Attached is a patch for BOP::AuthorizeNet version 3.20 that fixes this
&gt; &gt; bug.
</div>&gt; 
&gt; It doesn&#39;t seem like a good idea to join all the data into a giant
&gt; string and then search it for each character.
&gt; 
&gt; Can you use a hash to store which characters are in the post data
&gt; instead?  Then checking is much more straighforward and doesn&#39;t involve
&gt; repeatedly sequentially scanning a large string for each possible
&gt; encapsulation character.
&gt; 
&gt; Also, why is the set of characters to check limited?  Is there a reason
&gt; not to try every ASCII character or at least 32-127 ?
</div>
Thanks for the reply Ivan.

My first thought was to actually hash the string as you mentioned.
However, I got to thinking about it more, and I figured the 99.9%
majority use case here is going to be to hit the first encapsulating
character. Because of that, I was thinking that using the hash method
would be an unnecessary slow down for 99.9% of cases. &#40;Since we have the
added construction of a hash then. No matter what, we have to scan the
string once.&#41; For the 0.1% or lower cases that do have to scan the
entire string, it really doesn&#39;t take all that long to do anyway.
&#40;Especially since they should hit one of the first couple of
characters.&#41; If you feel strongly about this, let me know and I can
certainly modify the patch.

Also, yes there is a reason the character check is limited. I initially
thought the same as you there, as well, and thought to scan the entire
range. However, the problem is, we are only scanning our input and the
actual output from authorize.net could contain many things in that
range. &#40;I actually created the code to do this and found out I was wrong
when it busted on me.&#41; That means we can&#39;t just willy-nilly pick any
random item there. The best items to use are the ones Authorize.Net
recommends in their docs, since they might heed those and keep them out
of their output. If we can&#39;t use those, I threw in a few extra that we
can hope also aren&#39;t in the output given they are symbols.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Nov&nbsp;13&nbsp;20:49:31&nbsp;2009</span>
    <span class="description">josh [...] infogears.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Nov 13 15:08:22 2009, IVAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Wed Nov 11 20:21:56 2009, josh@infogears.com wrote:
<div class="message-stanza open">&gt; &gt; Attached is a patch for BOP::AuthorizeNet version 3.20 that fixes this
&gt; &gt; bug.
</div>&gt; 
&gt; It doesn&#39;t seem like a good idea to join all the data into a giant
&gt; string and then search it for each character.
&gt; 
&gt; Can you use a hash to store which characters are in the post data
&gt; instead?  Then checking is much more straighforward and doesn&#39;t involve
&gt; repeatedly sequentially scanning a large string for each possible
&gt; encapsulation character.
</div>
So, I was going to throw a patch in here to prevent some back-and-forth
in case you really wanted this. I decided to do some benchmarks to check
and see what impact this would really have. I was pretty shocked with
what I found. The method I used is actually 10-26.6 times faster than
the hash method on my sample data! &#40;26.6 times faster when using the
first encapsulating character &#39;|&#39; and 10 times faster when using the
second to last &#39;~&#39;.&#41; I tried all sorts of hash routine combinations that
I could think of as well as using an array as a sort of hash based on
the ord&#40;&#41; of the character.

I&#39;m attaching my benchmark file &#40;bench_character_check.pl&#41; for
perusal/running. At the bottom of it you will find some of my timings
from my runs. Maybe someone can see some improvement that can be made or
a possible mistake I made.

I also tested with using larger values of data, but the difference
between the two was still huge. &#40;You can experiment at the bottom of the
%post_data hash in the script. There are some comments there to help
figure out what I mean.&#41;

One thing I did note was that qw&#40;&#41; was complaining here about using the
comment symbol &#39;#&#39; in the qw&#40;&#41;. So I have modified my patch to take that
symbol outside the qw to prevent this kind of warning. It is attached as
patch_15210_fix_qw.diff.

-- Josh
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- AIM.pm_3_20	2009-11-11 13:33:02.000000000 -0700
+++ AIM.pm	2009-11-11 13:33:23.000000000 -0700
@@ -223,9 +223,33 @@
       $post_data{&#39;x_Email_Customer&#39;} = &#39;FALSE&#39;;
     }
 
+    my $data_string = join&#40;&#34;&#34;, values %post_data&#41;;
+
+    my $encap_character;
+    # The first set of characters here are recommended by authorize.net in their
+    #   encapsulating character example.
+    # The second set we made up hoping they will work if the first fail.
+    # The third chr&#40;31&#41; is the binary &#39;unit separator&#39; and is our final last
+    #   ditch effort to find something not in the input.
+    foreach my $char&#40; qw&#40; | &#34; &#39; : ; / \ - * &#41;, &#39;#&#39;, qw&#40; ^ + &lt; &gt; [ ] ~&#41;, chr&#40;31&#41; &#41;{
+      if&#40; index&#40;$data_string, $char&#41; == -1 &#41;{ # found one.
+        $encap_character = $char;
+        last;
+      }
+    }
+
+    if&#40;!$encap_character&#41;{
+      $self-&gt;is_success&#40;0&#41;;
+      $self-&gt;error_message&#40;
+			   &#34;DEBUG: Input contains all encapsulating characters.&#34;
+			   . &#34; Please remove | or ^ from your input if possible.&#34;
+			  &#41;;
+      return;
+    }
+
     $post_data{&#39;x_ADC_Delim_Data&#39;} = &#39;TRUE&#39;;
     $post_data{&#39;x_delim_char&#39;} = &#39;,&#39;;
-    $post_data{&#39;x_encap_char&#39;} = &#39;&#34;&#39;;
+    $post_data{&#39;x_encap_char&#39;} = $encap_character;
     $post_data{&#39;x_ADC_URL&#39;} = &#39;FALSE&#39;;
     $post_data{&#39;x_Version&#39;} = &#39;3.1&#39;;
 
@@ -241,7 +265,7 @@
     #trim &#39;ip_addr=&#34;1.2.3.4&#34;&#39; added by eProcessingNetwork Authorize.Net compat
     $page =~ s/,ip_addr=&#34;[\d\.]+&#34;$//;
 
-    my $csv = new Text::CSV_XS&#40;{ binary=&gt;1, escape_char=&gt;&#39;&#39; }&#41;;
+    my $csv = new Text::CSV_XS&#40;{ binary=&gt;1, escape_char=&gt;&#39;&#39;, quote_char =&gt; $encap_character }&#41;;
     $csv-&gt;parse&#40;$page&#41;;
     my @col = $csv-&gt;fields&#40;&#41;;
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;24&nbsp;12:52:11&nbsp;2009</span>
    <span class="description">ivan-pause [...] 420.am -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> josh [...] infogears.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Josh: Well, goes to show what they say about premature optimization!  I
was sure off-base here.  Glad you&#39;ve considered the issues.  Patch
applied, will be in 3.21.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Fixed in 3.21 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Broken in 3.16 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Broken in 3.17 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Broken in 3.18 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Broken in 3.19 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;07&nbsp;16:24:09&nbsp;2010</span>
    <span class="description">ivan-pause [...] 420.am -  Broken in 3.20 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
