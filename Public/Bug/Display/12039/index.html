<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #12039 for Math-Matlab-Engine: Can&#39;t Compile with Matlab version 7.0.0.19901 &#40;R14&#41; on Linux</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #12039 for Math-Matlab-Engine: Can&#39;t Compile with Matlab version 7.0.0.19901 &#40;R14&#41; on Linux</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Math-Matlab-Engine/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Math-Matlab-Engine/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Math-Matlab-Engine/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Math-Matlab-Engine/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Math-Matlab-Engine">Math-Matlab-Engine CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">12039</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Math-Matlab-Engine/Active/">Math-Matlab-Engine</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
amit.goel [...] intel.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-20786-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-20787-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;28&nbsp;14:39:03&nbsp;2005</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Can&#39;t Compile with Matlab version 7.0.0.19901 &#40;R14&#41; on Linux</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perl version: 5.8.5 on Linux

/usr/intel/pkgs/gcc/3.3/bin/gcc -c  -I/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include -fno-strict-aliasing -pipe -I/usr/intel/00r1/include -I/usr/intel/pkgs/libxml2/2.6.11/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/include/gdbm -O3   -DVERSION=\&#34;0.02\&#34; -DXS_VERSION=\&#34;0.02\&#34; -fpic &#34;-I/usr/intel/pkgs/perl/5.8.5/lib/5.8.5/i686-linux-64int/CORE&#34;   Engine.c
In file included from /nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/matrix.h:200,
                 from /nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/engine.h:43,
                 from Engine.xs:5:
/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/tmwtypes.h:680: warning: useless keyword or type name in empty declaration
/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/tmwtypes.h:680: warning: empty declaration
Engine.c: In function `XS_Math__Matlab__Engine_Close&#39;:
Engine.c:93: warning: cast to pointer from integer of different size
Engine.c: In function `XS_Math__Matlab__Engine_EvalString&#39;:
Engine.c:118: warning: cast to pointer from integer of different size
Engine.c: In function `XS_Math__Matlab__Engine_GetArrayList&#39;:
Engine.c:143: warning: cast to pointer from integer of different size
Engine.xs:89:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes just 0
Engine.xs:89: error: `engGetArray&#39; undeclared &#40;first use in this function&#41;
Engine.xs:89: error: &#40;Each undeclared identifier is reported only once
Engine.xs:89: error: for each function it appears in.&#41;
Engine.xs:96: warning: assignment discards qualifiers from pointer target type
Engine.c: In function `XS_Math__Matlab__Engine_GetArrayListRef&#39;:
Engine.c:191: warning: cast to pointer from integer of different size
Engine.xs:124:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes just 0
Engine.xs:124: error: `engGetArray&#39; undeclared &#40;first use in this function&#41;
..
Engine.xs:419: error: `engGetArray&#39; undeclared &#40;first use in this function&#41;
Engine.xs:428: warning: assignment discards qualifiers from pointer target type
make: *** [Engine.o] Error 1 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;05:52:31&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Hafen McCormick</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 28 14:39:03 2005, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perl version: 5.8.5 on Linux
&gt; 
&gt; /usr/intel/pkgs/gcc/3.3/bin/gcc -c
&gt;    -I/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include
&gt;    -fno-strict-aliasing -pipe -I/usr/intel/00r1/include
&gt;    -I/usr/intel/pkgs/libxml2/2.6.11/include -D_LARGEFILE_SOURCE
&gt;    -D_FILE_OFFSET_BITS=64 -I/usr/include/gdbm -O3   -DVERSION=\&#34;0.02\&#34;
&gt;    -DXS_VERSION=\&#34;0.02\&#34; -fpic &#34;-
&gt;    I/usr/intel/pkgs/perl/5.8.5/lib/5.8.5/i686-linux-64int/CORE&#34;
&gt;    Engine.c
&gt; In file included from
&gt;   
</div>/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/matrix.h:200,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                  from
&gt;   
</div>/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/engine.h:43,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                  from Engine.xs:5:
&gt;
</div>/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/tmwtypes.h:680:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    warning: useless keyword or type name in empty declaration
&gt;
</div>/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include/tmwtypes.h:680:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    warning: empty declaration
&gt; Engine.c: In function `XS_Math__Matlab__Engine_Close&#39;:
&gt; Engine.c:93: warning: cast to pointer from integer of different size
&gt; Engine.c: In function `XS_Math__Matlab__Engine_EvalString&#39;:
&gt; Engine.c:118: warning: cast to pointer from integer of different size
&gt; Engine.c: In function `XS_Math__Matlab__Engine_GetArrayList&#39;:
&gt; Engine.c:143: warning: cast to pointer from integer of different size
&gt; Engine.xs:89:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes
&gt;    just 0
&gt; Engine.xs:89: error: `engGetArray&#39; undeclared &#40;first use in this
&gt;    function&#41;
&gt; Engine.xs:89: error: &#40;Each undeclared identifier is reported only once
&gt; Engine.xs:89: error: for each function it appears in.&#41;
&gt; Engine.xs:96: warning: assignment discards qualifiers from pointer
&gt;    target type
&gt; Engine.c: In function `XS_Math__Matlab__Engine_GetArrayListRef&#39;:
&gt; Engine.c:191: warning: cast to pointer from integer of different size
&gt; Engine.xs:124:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes
&gt;    just 0
&gt; Engine.xs:124: error: `engGetArray&#39; undeclared &#40;first use in this
&gt;    function&#41;
&gt; ..
&gt; Engine.xs:419: error: `engGetArray&#39; undeclared &#40;first use in this
&gt;    function&#41;
&gt; Engine.xs:428: warning: assignment discards qualifiers from pointer
&gt;    target type
&gt; make: *** [Engine.o] Error 1
</div>

I had the same difficulty.  The simple fix is to edit Engine.xs
and add the line

#define V5_COMPAT

so that it exists before this line

#include &#34;engine.h&#34;


Good luck.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;17&nbsp;05:52:32&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;27&nbsp;19:06:23&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 28 14:39:03 2005, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perl version: 5.8.5 on Linux
&gt; 
&gt; /usr/intel/pkgs/gcc/3.3/bin/gcc -c
&gt;    -
</div>I/nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    -fno-strict-aliasing -pipe -I/usr/intel/00r1/include
&gt;    -I/usr/intel/pkgs/libxml2/2.6.11/include -D_LARGEFILE_SOURCE
&gt;    -D_FILE_OFFSET_BITS=64 -I/usr/include/gdbm -O3   -DVERSION=\&#34;0.02
</div>\&#34;
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    -DXS_VERSION=\&#34;0.02\&#34; -fpic &#34;-
&gt;    I/usr/intel/pkgs/perl/5.8.5/lib/5.8.5/i686-linux-64int/CORE&#34;
&gt;    Engine.c
&gt; In file included from
&gt;    /nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/incl
</div>ude/matrix.h:200,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                  from
&gt;    /nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/incl
</div>ude/engine.h:43,
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;                  from Engine.xs:5:
&gt; /nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include
</div>/tmwtypes.h:680:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    warning: useless keyword or type name in empty declaration
&gt; /nfs/site/eda/data/disk0001/mathworks/matlab/14/common/extern/include
</div>/tmwtypes.h:680:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;    warning: empty declaration
&gt; Engine.c: In function `XS_Math__Matlab__Engine_Close&#39;:
&gt; Engine.c:93: warning: cast to pointer from integer of different size
&gt; Engine.c: In function `XS_Math__Matlab__Engine_EvalString&#39;:
&gt; Engine.c:118: warning: cast to pointer from integer of different size
&gt; Engine.c: In function `XS_Math__Matlab__Engine_GetArrayList&#39;:
&gt; Engine.c:143: warning: cast to pointer from integer of different size
&gt; Engine.xs:89:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes
&gt;    just 0
&gt; Engine.xs:89: error: `engGetArray&#39; undeclared &#40;first use in this
&gt;    function&#41;
&gt; Engine.xs:89: error: &#40;Each undeclared identifier is reported only 
</div>once
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Engine.xs:89: error: for each function it appears in.&#41;
&gt; Engine.xs:96: warning: assignment discards qualifiers from pointer
&gt;    target type
&gt; Engine.c: In function `XS_Math__Matlab__Engine_GetArrayListRef&#39;:
&gt; Engine.c:191: warning: cast to pointer from integer of different size
&gt; Engine.xs:124:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes
&gt;    just 0
&gt; Engine.xs:124: error: `engGetArray&#39; undeclared &#40;first use in this
&gt;    function&#41;
&gt; ..
&gt; Engine.xs:419: error: `engGetArray&#39; undeclared &#40;first use in this
&gt;    function&#41;
&gt; Engine.xs:428: warning: assignment discards qualifiers from pointer
&gt;    target type
&gt; make: *** [Engine.o] Error 1
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Nov&nbsp;15&nbsp;13:37:58&nbsp;2006</span>
    <span class="description">PBERLIN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> cpan_reply [...] yesbutno.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 17 05:52:31 2006, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Mar 28 14:39:03 2005, guest wrote:
<div class="message-stanza open">&gt; &gt; Perl version: 5.8.5 on Linux
</div></div>[snip]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Engine.xs:124:38: macro &#34;engGetArray&#34; passed 2 arguments, but takes
&gt; &gt;    just 0
</div></div>[snip]
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; make: *** [Engine.o] Error 1
</div>&gt; 
&gt; 
&gt; I had the same difficulty.  The simple fix is to edit Engine.xs
&gt; and add the line
&gt; 
&gt; #define V5_COMPAT
&gt; 
&gt; so that it exists before this line
&gt; 
&gt; #include &#34;engine.h&#34;
</div>
I had a similar problem. It seems lile the module is using methods in the matlab engine that 
are deprecated. I&#39;ve included a patch which fixes this, and also updates the StringEval 
method.

Text output from MATLAB commands, are now returned from EvalString instead of 1 or 0, 
and undef is returned in case of error.

Hope that helps,
Pete
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Math-Matlab-Engine-0.02/Engine.xs	2003-11-26 22:16:08.000000000 +0100
+++ Math-Matlab-Engine/Engine.xs	2006-11-15 19:21:49.000000000 +0100
@@ -3,7 +3,7 @@
 #include &#34;XSUB.h&#34;
 
 #include &#34;engine.h&#34;
-#define BUFSIZE 256
+#define BUFSIZE 1024*256
 
 static int
 not_here&#40;char *s&#41;
@@ -19,8 +19,13 @@
     return 0;
 }
 
-MODULE = Math::Matlab::Engine		PACKAGE = Math::Matlab::Engine	PREFIX = eng
+typedef struct {
+	Engine * ep;
+	char * EvalBuf;
+} EngineIface;
 
+MODULE = Math::Matlab::Engine		PACKAGE = Math::Matlab::Engine	PREFIX = eng
+PROTOTYPES: ENABLE
 
 double
 constant&#40;sv,arg&#41;
@@ -37,81 +42,112 @@
 
 
 
-Engine *
+EngineIface *
 new&#40;CLASS&#41;
 	char *		CLASS
     CODE:
     {
-	Engine *ep;
+	EngineIface *eng;
 
-	if &#40;!&#40;ep = engOpen&#40;&#34;\0&#34;&#41;&#41;&#41; {
-		croak &#40;&#34;Can&#39;t start MATLAB engine&#34;&#41;;
-	}
+	if &#40;NULL == &#40;eng = malloc&#40;sizeof&#40;EngineIface&#41;&#41;&#41;&#41;
+		croak &#40;&#34;Cannot allocate engine object&#34;&#41;;
+
+	if &#40;!&#40;eng-&gt;ep = engOpen&#40;&#34;&#34;&#41; &#41;&#41; 
+		croak &#40;&#34;Failed to start MATLAB engine&#34;&#41;;
+	
+	// Alloc the buffer for the output of evals
+	if &#40;NULL == &#40;eng-&gt;EvalBuf = malloc&#40;BUFSIZE&#41;&#41;&#41;
+		croak &#40;&#34;Failed to allocate eval output buffer&#34;&#41;;
+	
+	engOutputBuffer&#40;eng-&gt;ep, eng-&gt;EvalBuf, BUFSIZE&#41;;
+	
 
-	RETVAL = ep;
+	RETVAL = eng;
     }
     OUTPUT:
 	RETVAL
 
+
+
 int
-engClose&#40;ep&#41;
-	Engine *	ep
+engClose&#40;eng&#41;
+	EngineIface *	eng
     CODE:
     {
-	RETVAL = 1 - engClose&#40;ep&#41;;
+	RETVAL = 1 - engClose&#40;eng-&gt;ep&#41;;
     }
     OUTPUT:
 	RETVAL
 
-int
-engEvalString&#40;ep, string&#41;
-	Engine *	ep
+void
+engDESTROY&#40;eng&#41;
+	EngineIface * eng
+	CODE:
+	{
+	engClose&#40;eng-&gt;ep&#41;;
+	free&#40;eng-&gt;EvalBuf&#41;;
+	free&#40;eng&#41;;
+	}
+
+SV*
+engEvalString&#40;eng, string&#41;
+	EngineIface *	eng
 	const char *	string
     CODE:
     {
-	RETVAL = &#40;engEvalString&#40;ep, string&#41; == 0&#41;;
+	if &#40;engEvalString&#40;eng-&gt;ep, string&#41; == 0&#41; {
+#		fprintf&#40;stderr, &#34;DEBUG: String frmo eval=%s$\n&#34;,eng-&gt;EvalBuf&#41;;
+#		fprintf&#40;stderr, &#34;DEBUG: EvalString on MATLAB engine %x\n&#34;,eng-&gt;ep&#41;;
+		RETVAL = newSVpv&#40;eng-&gt;EvalBuf,0&#41;;
+	} else {
+		// We couldnt talk to the matlab engine. 
+		// return undef
+#		fprintf&#40;stderr, &#34;ERROR: Could not talk to MATLAB engine: %x\n&#34;,eng-&gt;ep&#41;;
+        XSRETURN_UNDEF;
+	}
     }
     OUTPUT:
 	RETVAL
 
 
 AV *
-engGetArrayList&#40;ep, name&#41;
-	Engine *	ep
+engGetArrayList&#40;eng, name&#41;
+	EngineIface *	eng
 	const char *	name
 
     PPCODE:
     {
 	mxArray *matrix;
-	int nrdim, *dims, i, nelem;
+	int *dims, i, nelem;
+	int nrdim;
 	double *vals;
 
-	matrix = engGetArray&#40;ep, name&#41;;
+	matrix = engGetVariable&#40;eng-&gt;ep, name&#41;;
 	if &#40;matrix == NULL&#41;
 		XSRETURN_UNDEF;
 
-	nrdim = mxGetNumberOfDimensions&#40;matrix&#41;;
-	printf&#40;&#34;%d dimensions\n&#34;,nrdim&#41;;
+	nrdim = &#40;int&#41; mxGetNumberOfDimensions&#40;matrix&#41;;
+//	printf&#40;&#34;%d dimensions\n&#34;,nrdim&#41;;
 
-	dims = mxGetDimensions&#40;matrix&#41;;
+	dims = &#40;int*&#41; mxGetDimensions&#40;matrix&#41;;
 	nelem = 1;
 	for&#40;i=0;i&lt;nrdim;i++&#41; {
-		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
+//		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
 		nelem *= *&#40;dims+i&#41;;
 	}
 	vals = mxGetPr&#40;matrix&#41;;
 	for&#40;i=0;i&lt;nelem;i++&#41; {
 		XPUSHs&#40;sv_2mortal&#40;newSVnv&#40;*&#40;vals+i&#41;&#41;&#41;&#41;;
-		printf&#40;&#34;%6.4f,&#34;,*&#40;vals+i&#41;&#41;;
+//		printf&#40;&#34;%6.4f,&#34;,*&#40;vals+i&#41;&#41;;
 	}
-	printf&#40;&#34;\n&#34;&#41;;
+//	printf&#40;&#34;\n&#34;&#41;;
 
 		
     }
 
 SV *
-engGetArrayListRef&#40;ep, name&#41;
-	Engine *	ep
+engGetArrayListRef&#40;eng, name&#41;
+	EngineIface *	eng
 	const char *	name
 
     CODE:
@@ -121,26 +157,26 @@
 	double *vals;
 	AV *arr;
 
-	matrix = engGetArray&#40;ep, name&#41;;
+	matrix = engGetVariable&#40;eng-&gt;ep, name&#41;;
 	if &#40;matrix == NULL&#41;
 		XSRETURN_UNDEF;
 
 	nrdim = mxGetNumberOfDimensions&#40;matrix&#41;;
-	printf&#40;&#34;%d dimensions\n&#34;,nrdim&#41;;
+#	printf&#40;&#34;%d dimensions\n&#34;,nrdim&#41;;
 
-	dims = mxGetDimensions&#40;matrix&#41;;
+	dims = &#40;int*&#41; mxGetDimensions&#40;matrix&#41;;
 	nelem = 1;
 	for&#40;i=0;i&lt;nrdim;i++&#41; {
-		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
+#		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
 		nelem *= *&#40;dims+i&#41;;
 	}
 	vals = mxGetPr&#40;matrix&#41;;
 	arr = newAV&#40;&#41;;
 	for&#40;i=0;i&lt;nelem;i++&#41; {
 		av_push&#40;arr, newSVnv&#40;*&#40;vals+i&#41;&#41;&#41;;
-		printf&#40;&#34;%6.4f,&#34;,*&#40;vals+i&#41;&#41;;
+#		printf&#40;&#34;%6.4f,&#34;,*&#40;vals+i&#41;&#41;;
 	}
-	printf&#40;&#34;\n&#34;&#41;;	
+#	printf&#40;&#34;\n&#34;&#41;;	
 
 	RETVAL = newRV_inc&#40;&#40;SV *&#41; arr&#41;;
     }
@@ -148,8 +184,8 @@
 	RETVAL
 
 SV *
-engGetArray2dim&#40;ep, name&#41;
-	Engine *	ep
+engGetArray2dim&#40;eng, name&#41;
+	EngineIface *	eng
 	const char *	name
 
     CODE:
@@ -159,20 +195,20 @@
 	double *vals;
 	AV *arr, *mat;
 
-	matrix = engGetArray&#40;ep, name&#41;;
+	matrix = engGetVariable&#40;eng-&gt;ep, name&#41;;
 	if &#40;matrix == NULL&#41;
 		XSRETURN_UNDEF;
 
 	nrdim = mxGetNumberOfDimensions&#40;matrix&#41;;
-	printf&#40;&#34;%d dimensions\n&#34;,nrdim&#41;;
+#	printf&#40;&#34;%d dimensions\n&#34;,nrdim&#41;;
 
 	if &#40;nrdim != 2&#41;
 		XSRETURN_UNDEF;
 
-	dims = mxGetDimensions&#40;matrix&#41;;
+	dims = &#40;int*&#41; mxGetDimensions&#40;matrix&#41;;
 	nelem = 1;
 	for&#40;i=0;i&lt;nrdim;i++&#41; {
-		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
+#		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
 		nelem *= *&#40;dims+i&#41;;
 	}
 	vals = mxGetPr&#40;matrix&#41;;
@@ -180,12 +216,12 @@
 	for&#40;i=0;i&lt;*&#40;dims+1&#41;;i++&#41; {
 		arr = newAV&#40;&#41;;
 		for&#40;j=0;j&lt;*dims;j++&#41; {
-			printf&#40;&#34;%6.4f,&#34;,*vals&#41;;
+#			printf&#40;&#34;%6.4f,&#34;,*vals&#41;;
 			av_push&#40;arr, newSVnv&#40;*&#40;vals++&#41;&#41;&#41;;
 		}
 		av_push&#40;mat, newRV_inc&#40;&#40;SV *&#41; arr&#41;&#41;;
 	}
-	printf&#40;&#34;\n&#34;&#41;;	
+#	printf&#40;&#34;\n&#34;&#41;;	
 
 	RETVAL = newRV_inc&#40;&#40;SV *&#41; mat&#41;;
     }
@@ -193,8 +229,8 @@
 	RETVAL
 
 SV *
-engGetArray&#40;ep, name&#41;
-	Engine *	ep
+engGetArray&#40;eng, name&#41;
+	EngineIface *	eng
 	const char *	name
 
     CODE:
@@ -204,14 +240,14 @@
 	double *data;
 	AV **arrays;
 
-	matrix = engGetArray&#40;ep, name&#41;;
+	matrix = engGetVariable&#40;eng-&gt;ep, name&#41;;
 	if &#40;matrix == NULL&#41;
 		XSRETURN_UNDEF;
 
 	dim = mxGetNumberOfDimensions&#40;matrix&#41;;
 
 # 30.10.02: reverse order of d
-	dtmp = mxGetDimensions&#40;matrix&#41;;
+	dtmp = &#40;int*&#41; mxGetDimensions&#40;matrix&#41;;
 	d = &#40;int *&#41; calloc&#40;dim + 1, sizeof&#40;int&#41;&#41;;
 	for&#40;i=0;i&lt;dim;i++&#41;
 		*&#40;d+dim-1-i&#41; = *&#40;dtmp+i&#41;;
@@ -256,8 +292,8 @@
 	RETVAL
 
 int
-engPutArray&#40;ep, name, dims, data&#41;
-	Engine *	ep
+engPutArray&#40;eng, name, dims, data&#41;
+	EngineIface *	eng
 	const char *	name
 	SV *		dims
 	SV *		data
@@ -277,8 +313,9 @@
 #	printf&#40;&#34;found %d dimensions\n&#34;, ndim + 1&#41;;
 	d = &#40;int *&#41; calloc&#40;ndim + 1, sizeof&#40;int&#41;&#41;;
 # 30.10.02: reverse order of creation of d
-#	for&#40;i=0;i&lt;=ndim;i++&#41; {
-	for&#40;i=ndim;i&gt;=0;i--&#41; {
+# 08.11.06: Reset this back to original order. Now is consistent wtih PutMatrix
+	for&#40;i=0;i&lt;=ndim;i++&#41; {
+#	for&#40;i=ndim;i&gt;=0;i--&#41; {
 		sv = av_shift&#40;dimarr&#41;;
 		if &#40;SvIOK&#40;sv&#41;&#41; {
 #			printf&#40;&#34;Integer value: %d\n&#34;, SvIV&#40;sv&#41;&#41;;
@@ -294,7 +331,7 @@
 #			printf&#40;&#34;Don&#39;t know what it is!\n&#34;&#41;;
 			*&#40;d+i&#41; = 1;
 		}
-#		d[i] = &#40;int&#41; SvIV&#40;sv&#41;;
+		d[i] = &#40;int&#41; SvIV&#40;sv&#41;;
 #		printf&#40;&#34;dimension %d: %d\n&#34;, i, d[i]&#41;;
 	}
 
@@ -303,7 +340,8 @@
 
 #	printf&#40;&#34;Array has %d elements\n&#34;, nelem&#41;;
 
-	mat = mxCreateDoubleMatrix&#40;1, nelem + 1, mxREAL&#41;;
+	mat = mxCreateNumericArray&#40; ndim+1, &#40;size_t*&#41; d,  mxDOUBLE_CLASS, mxREAL&#41;;
+	#mat = mxCreateDoubleMatrix&#40;1, nelem + 1, mxREAL&#41;;
 	values = mxGetPr&#40;mat&#41;;
 	
 #	printf&#40;&#34;array has %d elements\n&#34;, nelem + 1&#41;;
@@ -329,17 +367,22 @@
 #		printf&#40;&#34;value nr. %d is %f\n&#34;, i + 1, *&#40;values+i&#41;&#41;;
 	}
 
-	mxSetName&#40;mat, name&#41;;
-	mxSetDimensions&#40;mat, d, ndim + 1&#41;;
+	// This is now obsolete. Not needed.
+	//mxSetName&#40;mat, name&#41;;
 
-	RETVAL = 1 - engPutArray&#40;ep, mat&#41;;
+	// We now set the dims when we create the array	
+	//mxSetDimensions&#40;mat, &#40;mwSize*&#41; d, ndim + 1&#41;;
+
+
+	RETVAL = 1 - engPutVariable&#40;eng-&gt;ep, name, mat&#41;;
+#	RETVAL = 1;
     }
     OUTPUT:
 	RETVAL
 	
 int
-engPutMatrix&#40;ep, name, rows, cols, data&#41;
-	Engine *	ep
+engPutMatrix&#40;eng, name, rows, cols, data&#41;
+	EngineIface *	eng
 	const char *	name
 	SV *		rows
 	SV *		cols
@@ -396,17 +439,17 @@
 		if &#40;j &gt; nelem&#41; j-=nelem;
 	}
 
+	// Obsolete. Now not needed
+	// mxSetName&#40;mat, name&#41;;
 
-	mxSetName&#40;mat, name&#41;;
-
-	RETVAL = 1 - engPutArray&#40;ep, mat&#41;;
+	RETVAL = 1 - engPutVariable&#40;eng-&gt;ep, name, mat&#41;;
     }
     OUTPUT:
 	RETVAL
 
 SV *
-engGetMatrix&#40;ep, name&#41;
-	Engine *	ep
+engGetMatrix&#40;eng, name&#41;
+	EngineIface *	eng
 	const char *	name
 
     CODE:
@@ -416,7 +459,7 @@
 	double *vals;
 	AV *arr, *mat;
 
-	matrix = engGetArray&#40;ep, name&#41;;
+	matrix = engGetVariable&#40;eng-&gt;ep, name&#41;;
 	if &#40;matrix == NULL&#41;
 		XSRETURN_UNDEF;
 
@@ -426,7 +469,7 @@
 	if &#40;nrdim != 2&#41;
 		XSRETURN_UNDEF;
 
-	dims = mxGetDimensions&#40;matrix&#41;;
+	dims = &#40;int*&#41; mxGetDimensions&#40;matrix&#41;;
 	nelem = 1;
 	for&#40;i=0;i&lt;nrdim;i++&#41; {
 #		printf&#40;&#34;\t%d\n&#34;,*&#40;dims+i&#41;&#41;;
--- Math-Matlab-Engine-0.02/typemap	2003-11-26 22:16:08.000000000 +0100
+++ Math-Matlab-Engine/typemap	2006-11-15 18:31:15.000000000 +0100
@@ -1,13 +1,13 @@
 TYPEMAP
-Engine *			ENG_OBJ
+EngineIface *			ENG_OBJ
 const char *			T_PV
 double *			T_PV
 
 INPUT
 ENG_OBJ
-	{
 	$var = &#40;$type&#41; SvIV&#40;&#40;SV*&#41;SvRV&#40;$arg&#41;&#41;;
-	}
+ENG_REF
+	$var = &#40;$type&#41; SvIV&#40;&#40;SV*&#41;SvRV&#40;$arg&#41;&#41;;
 
 OUTPUT
 ENG_OBJ
--- Math-Matlab-Engine-0.02/t/matrix.t	2003-11-26 22:16:08.000000000 +0100
+++ Math-Matlab-Engine/t/matrix.t	2006-11-15 18:36:49.000000000 +0100
@@ -6,11 +6,15 @@
 ok&#40;1&#41;;
 
 $ep = Math::Matlab::Engine-&gt;new;
-ok&#40;$ep-&gt;PutArray&#40;&#39;N&#39;,[3,2],[1,2,3,4,5,6]&#41;&#41;;
+ok&#40;$ep-&gt;PutArray&#40;&#39;N&#39;,[2,3],[1,4,2,5,3,6]&#41;&#41;;
 
-ok&#40;$ep-&gt;PutArray&#40;&#39;E1&#39;,[1,3],[1,0,0]&#41;&#41;;
-ok&#40;$ep-&gt;PutArray&#40;&#39;E2&#39;,[1,3],[0,1,0]&#41;&#41;;
-ok&#40;$ep-&gt;PutArray&#40;&#39;E3&#39;,[1,3],[0,0,1]&#41;&#41;;
+ok&#40;$ep-&gt;PutArray&#40;&#39;E1&#39;,[3,1],[1,0,0]&#41;&#41;;
+ok&#40;$ep-&gt;PutArray&#40;&#39;E2&#39;,[3,1],[0,1,0]&#41;&#41;;
+ok&#40;$ep-&gt;PutArray&#40;&#39;E3&#39;,[3,1],[0,0,1]&#41;&#41;;
+
+#$ep-&gt;PutMatrix&#40;&#39;Ntest&#39;,2,3,[1,2,3,4,5,6]&#41;;
+#$ep-&gt;EvalString&#40;&#34;desktop&#34;&#41;;
+#sleep 30;
 
 ok&#40;$ep-&gt;EvalString&#40;&#34;N1=N*E1&#34;&#41;&#41;;
 ok&#40;$ep-&gt;EvalString&#40;&#34;N2=N*E2&#34;&#41;&#41;;
@@ -20,3 +24,5 @@
 ok&#40;$n1-&gt;[0]-&gt;[0],1&#41;;
 ok&#40;!defined&#40;$n1-&gt;[0]-&gt;[1]&#41;&#41;;
 ok&#40;$n1-&gt;[1]-&gt;[0],4&#41;;
+
+$ep-&gt;Close;
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
