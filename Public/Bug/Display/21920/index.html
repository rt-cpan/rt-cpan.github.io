<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21920 for DBD-Oracle: Bug with Oracle DBD for Mac OS X Instant Client</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21920 for DBD-Oracle: Bug with Oracle DBD for Mac OS X Instant Client</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-Oracle">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-Oracle">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-Oracle">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-Oracle">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/pythian/DBD-Oracle/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-Oracle">DBD-Oracle CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21920</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-Oracle">DBD-Oracle</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">champoux [...] pythian.com
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
gareth [...] curtis-home.co.uk

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10192-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.22    </td>
  </tr>
  <tr id="CF-10193-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
1.23    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




dbdimp-mac.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/415968/203113/dbdimp-mac.patch">
Thu Jan 31 15:01:23 2008 (1009b) by bitcard [...] filter.paco.to
</a>
</font></li>
</ul>


dbdimp.diff<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/526860/263613/dbdimp.diff">
Fri Oct 31 00:19:05 2008 (418b) by boingolover [...] yahoo.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=21920">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-247569" href="/Public/Bug/Display.html?id=21920#txn-247569">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;05&nbsp;14:41:47&nbsp;2006</span>
    <span class="description">gareth [...] curtis-home.co.uk -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug with Oracle DBD for Mac OS X Instant Client</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 5 Oct 2006 19:41:17 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-DBD-Oracle [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Gareth Curtis &lt;gareth [...] curtis-home.co.uk&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/247569/105961/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/105961">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 26.5k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275287" href="/Public/Bug/Display.html?id=21920#txn-275287">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;11:30:31&nbsp;2006</span>
    <span class="description">champoux [...] pythian.com -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Take odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275288" href="/Public/Bug/Display.html?id=21920#txn-275288">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;11:30:37&nbsp;2006</span>
    <span class="description">champoux [...] pythian.com -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275289" href="/Public/Bug/Display.html?id=21920#txn-275289">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;11:36:39&nbsp;2006</span>
    <span class="description">champoux [...] pythian.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/275289/122906/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/122906">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 365b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Seems this may be related tot he type of Instant client you are using.

Oracle only has an instant client for PowerPCs and not an Intel or 
Universal version

Here is a link to a blog that sort of solves it.

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.macosxhints.com/article.php?story=20061021211559813">http://www.macosxhints.com/article.php?story=20061021211559813</a></span>

I will put this as stalled for now until Oracle comes up with a new 
instant client.

cheers
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275292" href="/Public/Bug/Display.html?id=21920#txn-275292">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;11:36:42&nbsp;2006</span>
    <span class="description">champoux [...] pythian.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275297" href="/Public/Bug/Display.html?id=21920#txn-275297">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;11:37:25&nbsp;2006</span>
    <span class="description">champoux [...] pythian.com -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-275298" href="/Public/Bug/Display.html?id=21920#txn-275298">#</a>      
    </span>
    <span class="date">Mon&nbsp;Dec&nbsp;11&nbsp;11:37:41&nbsp;2006</span>
    <span class="description">champoux [...] pythian.com -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-415968" href="/Public/Bug/Display.html?id=21920#txn-415968">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;31&nbsp;15:01:23&nbsp;2008</span>
    <span class="description">bitcard [...] filter.paco.to -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Load-time issues with DBD Oracle on MacOS &#40;with patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> bitcard [...] filter.paco.to</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/415968/203110/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/203110">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 864b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Dec 11 11:36:39 2006, PYTHIAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Here is a link to a blog that sort of solves it.
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.macosxhints.com/article.php?story=20061021211559813">http://www.macosxhints.com/article.php?story=20061021211559813</a></span>
</div>
Even when someone follows those instructions, it still doesn&#39;t work. You
can see my comment on that story, but here&#39;s the summary. The function
dump_env_to_trace&#40;&#41; in dbdimp.c makes direct access to the *environ data
structure. Apparently that doesn&#39;t work in MacOS X since version 10.4
&#40;Leopard, the latest, is 10.5&#41;. So, even following those instructions,
DBD::Oracle will fail to load because, at load time, the _environ symbol
cannot be resolved.

Attached is my solution, which is probably not your favorite solution.
It removes that function and the 2 references to it. Perhaps an #ifndef
DARWIN &#40;or whatever the right preprocessor define is&#41; around this
function would be a better solution.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/415968/203113/dbdimp-mac.patch">Download dbdimp-mac.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1009b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- dbdimp.c.orig	2007-12-21 11:03:55.000000000 -0500
+++ dbdimp.c	2008-01-31 14:19:37.000000000 -0500
@@ -56,7 +56,6 @@
 static sql_fbh_t ora2sql_type _&#40;&#40;imp_fbh_t* fbh&#41;&#41;;
 
 void ora_free_phs_contents _&#40;&#40;phs_t *phs&#41;&#41;;
-static void dump_env_to_trace&#40;&#41;;
 
 static sb4
 oci_error_get&#40;OCIError *errhp, sword status, char *what, SV *errstr, int debug&#41;
@@ -383,9 +382,6 @@
 
     imp_dbh-&gt;get_oci_handle = oci_db_handle;
 
-    if &#40;DBIS-&gt;debug &gt;= 6 &#41;
-	dump_env_to_trace&#40;&#41;;
-
     if &#40;&#40;svp=DBD_ATTRIB_GET_SVP&#40;attr, &#34;ora_envhp&#34;, 9&#41;&#41; &#38;&#38; SvOK&#40;*svp&#41;&#41; {
 	if &#40;!SvTRUE&#40;*svp&#41;&#41; {
 	    imp_dbh-&gt;envhp = NULL; /* force new environment */
@@ -3503,20 +3499,3 @@
     }
     return sql_fbh;
 }
-
-static void
-dump_env_to_trace&#40;&#41; {
-	dTHX;
-    PerlIO *fp = DBILOGFP;
-    int i = 0;
-    char *p;
-#ifndef __BORLANDC__
-    extern char **environ;
-#endif
-    PerlIO_printf&#40;fp, &#34;Environment variables:\n&#34;&#41;;
-    do {
-	p = &#40;char*&#41;environ[i++];
-	PerlIO_printf&#40;fp,&#34;\t%s\n&#34;,p&#41;;
-    } while &#40;&#40;char*&#41;environ[i] != &#39;\0&#39;&#41;;
-}
-
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-415969" href="/Public/Bug/Display.html?id=21920#txn-415969">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jan&nbsp;31&nbsp;15:01:25&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-418927" href="/Public/Bug/Display.html?id=21920#txn-418927">#</a>      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;08&nbsp;17:34:54&nbsp;2008</span>
    <span class="description">Tim.Bunce [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21920] Load-time issues with DBD Oracle on MacOS &#40;with patch&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 8 Feb 2008 22:34:27 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Paco Hope via RT &lt;bug-DBD-Oracle [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tim Bunce &lt;Tim.Bunce [...] pobox.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/418927/204641/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/204641">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">John, change it to do whatever perl does on access the environment on OS X.
Or else use
    HV *env_hv = GvHVn&#40;PL_envgv&#41;
    while ... hv_iternextsv ... { ... }

Tim.

On Thu, Jan 31, 2008 at 03:01:26PM -0500, Paco Hope via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt;        Queue: DBD-Oracle
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=21920">http://rt.cpan.org/Ticket/Display.html?id=21920</a></span> &gt;
&gt; 
&gt; On Mon Dec 11 11:36:39 2006, PYTHIAN wrote:
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; Here is a link to a blog that sort of solves it.
&gt; &gt; 
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://www.macosxhints.com/article.php?story=20061021211559813">http://www.macosxhints.com/article.php?story=20061021211559813</a></span>
</div>&gt; 
&gt; Even when someone follows those instructions, it still doesn&#39;t work. You
&gt; can see my comment on that story, but here&#39;s the summary. The function
&gt; dump_env_to_trace&#40;&#41; in dbdimp.c makes direct access to the *environ data
&gt; structure. Apparently that doesn&#39;t work in MacOS X since version 10.4
&gt; &#40;Leopard, the latest, is 10.5&#41;. So, even following those instructions,
&gt; DBD::Oracle will fail to load because, at load time, the _environ symbol
&gt; cannot be resolved.
&gt; 
&gt; Attached is my solution, which is probably not your favorite solution.
&gt; It removes that function and the 2 references to it. Perhaps an #ifndef
&gt; DARWIN &#40;or whatever the right preprocessor define is&#41; around this
&gt; function would be a better solution.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-526860" href="/Public/Bug/Display.html?id=21920#txn-526860">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;00:19:05&nbsp;2008</span>
    <span class="description">boingolover [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> boingolover [...] yahoo.com</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/526860/263610/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/263610">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 828b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here is a diff that I have tested oh RHEL 5.2 x86_64 stock perl &#40;v5.8.8
built for x86_64-linux-thread-multi&#41; and the stock perl on Mac OSX
10.5.5 Intel and it works.  I found a note on the old fink site porting
notes &#40;had to find it on archive.org&#41; that mentioned how to deal with
the _environ missing symbol.
Here is a relevant excerpt:

The _environ symbol

The missing _environ symbol is a common problem when porting to OS X.
Here&#39;s the standard patch used in several fink packages:

+#ifdef __APPLE__
+#include &lt;crt_externs.h&gt;
+#define environ &#40;*_NSGetEnviron&#40;&#41;&#41;
+#else
 extern char **environ;
+#endif

I basically shoehorned this bit into the dbdimp.c , I&#39;m not 100% sure
this is the cleanest way to handle the issue but it&#39;s better than
commenting it out entirely - assuming it works for everyone.  It works
for me, YMMV.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/526860/263613/dbdimp.diff">Download dbdimp.diff</a><br />
<span class="downloadcontenttype">text/x-diff 418b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- dbdimp.c.orig	2008-10-30 22:11:11.000000000 -0500
+++ dbdimp.c	2008-10-30 22:21:47.000000000 -0500
@@ -3852,7 +3852,11 @@
     PerlIO *fp = DBILOGFP;
     int i = 0;
     char *p;
-#ifndef __BORLANDC__
+#if defined &#40;__APPLE__&#41;
+#include &lt;crt_externs.h&gt;
+#define environ &#40;*_NSGetEnviron&#40;&#41;&#41;
+#elif defined &#40;__BORLANDC__&#41;
+#else
     extern char **environ;
 #endif
     PerlIO_printf&#40;fp, &#34;Environment variables:\n&#34;&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-526984" href="/Public/Bug/Display.html?id=21920#txn-526984">#</a>      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;31&nbsp;12:09:27&nbsp;2008</span>
    <span class="description">boingolover [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> boingolover [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/526984/263690/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/263690">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 64b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I forgot to mention, this patch against the latest release, 1.22
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-529680" href="/Public/Bug/Display.html?id=21920#txn-529680">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;06&nbsp;10:44:34&nbsp;2008</span>
    <span class="description">champoux [...] pythian.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/529680/265213/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/265213">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 166b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ok the patch was applied and can be found at

<span class="clickylink"><a target="new" rel="nofollow" href="http://svn.perl.org/modules/dbd-oracle/trunk">http://svn.perl.org/modules/dbd-oracle/trunk</a></span>

the code works with windows and linux but I have not testedt it on mac 
OS
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-529683" href="/Public/Bug/Display.html?id=21920#txn-529683">#</a>      
    </span>
    <span class="date">Thu&nbsp;Nov&nbsp;06&nbsp;10:44:38&nbsp;2008</span>
    <span class="description">champoux [...] pythian.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-872010" href="/Public/Bug/Display.html?id=21920#txn-872010">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;21&nbsp;18:47:42&nbsp;2010</span>
    <span class="description">champoux [...] pythian.com -  Broken in 1.22 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-872011" href="/Public/Bug/Display.html?id=21920#txn-872011">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;21&nbsp;18:47:42&nbsp;2010</span>
    <span class="description">champoux [...] pythian.com -  Fixed in 1.23 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.653956</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
