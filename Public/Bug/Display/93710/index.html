<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93710 for DBD-mysql: Error in DBD:mysql retrieving FLOATs when  the flag &#39;mysql_server_prepare=1&#39; is set</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93710 for DBD-mysql: Error in DBD:mysql retrieving FLOATs when  the flag &#39;mysql_server_prepare=1&#39; is set</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=DBD-mysql">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=DBD-mysql">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=DBD-mysql">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=DBD-mysql">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/DBD-mysql">DBD-mysql CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93710</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=DBD-mysql">DBD-mysql</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Doug.Hershberger [...] algenol.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
pali [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10170-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-10171-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




F5F56FC5-6EEF-459D-A431-F12F14552D2C.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1336436/709120/F5F56FC5-6EEF-459D-A431-F12F14552D2C.png">
Mon Mar 10 12:19:55 2014 (8.7k) by Doug.Hershberger [...] algenol.com
</a>
</font></li>
</ul>


preparedTest.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1336436/709121/preparedTest.pl">
Mon Mar 10 12:19:55 2014 (1.3k) by Doug.Hershberger [...] algenol.com
</a>
</font></li>
</ul>


test-file.sql<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1336436/709122/test-file.sql">
Mon Mar 10 12:19:55 2014 (1.8k) by Doug.Hershberger [...] algenol.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=93710">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1336436" href="/Public/Bug/Display.html?id=93710#txn-1336436">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;12:19:55&nbsp;2014</span>
    <span class="description">Doug.Hershberger [...] algenol.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Error in DBD:mysql retrieving FLOATs when  the flag &#39;mysql_server_prepare=1&#39; is set</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 10 Mar 2014 16:19:43 +0000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-DBD-mysql [...] rt.cpan.org&#34; &lt;bug-DBD-mysql [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Doug Hershberger &lt;Doug.Hershberger [...] algenol.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messageattachments">
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1336436/709118/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/709118">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 6.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have encountered what I believe to be an error in DBD::mysql.

This error only seems to occur when the flag &#39;mysql_server_prepare=1&#39; is set. If this is true, then FLOATs returned from the database will have slightly different values than when the flag is not set. I suppose it would be fairly straightforward to just round off the values of all FLOATs, but since this rather unexpected bug arises from a change which would seem to have no relevance, it is a bit disconcerting. It would be nice to know if this bug is on the roadmap to be fixed any time soon.

Thanks again for any help or insight that you can provide.

Doug Hershberger

Below I give instructions for reproducing this error. All commands and output where generated on computers running Red Hat Enterprise Linux r6.4. This was tested on 64 bit physical boxes as well as computers running as 64 bit virtual machines hosted on a Hyper-V server. This was tested with DBD::mysql v4.013, v4.020 and v4.026; DBI c1.609 and v1.631; mySQL v5.5.17-log and v5.1.71 although not all combinations of those were tried.


#Setting up the database for the test case
mysql -uroot -p

CREATE USER &#39;chester&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;myTestPW&#39;;
GRANT ALL ON test.* TO &#39;chester&#39;@&#39;localhost&#39;;
use test;
CREATE TABLE preparedTest &#40;name VARCHAR&#40;20&#41;, floatVar FLOAT, doubVar DOUBLE&#41;;
INSERT INTO preparedTest &#40;name, floatVar, doubVar&#41; VALUES &#40;&#34;example&#34;, .96, .96&#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; select * from preparedTest;
</div>#Output which shows the table structure
+---------+----------+---------+
| name    | floatVar | doubVar |
+---------+----------+---------+
| example |     0.96 |    0.96 |
+---------+----------+---------+

#A dump of this data is attached and provided below so that you can recreate the database
#Put the dump into test-file.sql

#load the database into mySQL
mysql test -uchester -pmyTestPW &lt; test-file.sql

#Perl code to test this error is attached and provided below.
#put that code in the file preparedTest.pl

perl preparedTest.pl

#returns the following results
1..6
DBI::VERSION: 1.609
DBD::mysql::VERSION: 4.026

Running tests with no prepared statements.
Name:example
ok 1 - Got the right row with no prepared statements.
0.96
ok 2 - Float values work with no prepared statements.
0.96
ok 3 - Double values work with no prepared statements.


Running tests with prepared statements.
Name:example
ok 4 - Got the right row with prepared statements.
0.959999978542328
not ok 5 - Float values work with prepared statements.
#   Failed test &#39;Float values work with prepared statements.&#39;
#   at ./preparedTest.pl line 31.
0.96
ok 6 - Double values work with prepared statements.


# Looks like you failed 1 test of 6.


###########
#Here is a dump of the data you can put this in a file called test-file.sql:
###########

use test;

-- MySQL dump 10.13  Distrib 5.1.73, for redhat-linux-gnu &#40;x86_64&#41;
--
-- Host: localhost    Database: test
-- ------------------------------------------------------
-- Server version  5.1.73

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;NO_AUTO_VALUE_ON_ZERO&#39; */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `preparedTest`
--

DROP TABLE IF EXISTS `preparedTest`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `preparedTest` &#40;
  `name` varchar&#40;20&#41; DEFAULT NULL,
  `floatVar` float DEFAULT NULL,
  `doubVar` double DEFAULT NULL
&#41; ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `preparedTest`
--

LOCK TABLES `preparedTest` WRITE;
/*!40000 ALTER TABLE `preparedTest` DISABLE KEYS */;
INSERT INTO `preparedTest` VALUES &#40;&#39;example&#39;,0.96,0.96&#41;;
/*!40000 ALTER TABLE `preparedTest` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

###########
#END of SQL data dump test-file.sql
###########


###########
#Enter this code into preparedTest.pl
###########

#!/usr/bin/perl

use strict;
use DBI; # load DBI database interaction routines
print &#34;DBI::VERSION: $DBI::VERSION\n&#34;;
use DBD::mysql;
use Test::Simple tests =&gt; 6;
print &#34;DBD::mysql::VERSION: &#34; . $DBD::mysql::VERSION . &#34;\n\n&#34;;

#First without the prepare statement
my $dbh=DBI-&gt;connect&#40;&#39;DBI:mysql:database=test;host=localhost&#39;, &#39;chester&#39;, &#39;myTestPW&#39;, {&#39;RaiseError&#39; =&gt; 1}&#41; or die &#34;ConnectionEror: $DBI::errstr\n&#34;;
testIt&#40;$dbh, &#34;no prepared statements&#34;&#41;;

#Now with the prepare statement
$dbh=DBI-&gt;connect&#40;&#39;DBI:mysql:database=test;host=localhost;mysql_server_prepare=1&#39;, &#39;chester&#39;, &#39;myTestPW&#39;, {&#39;RaiseError&#39; =&gt; 1}&#41; or die &#34;ConnectionEror: $DBI::errstr\n&#34;;
testIt&#40;$dbh, &#34;prepared statements&#34;&#41;;

sub testIt {
my $dbh = shift;
my $condition = shift;
my $sth = $dbh-&gt;prepare&#40;&#34;SELECT * FROM preparedTest;&#34;&#41;;
$sth-&gt;execute or die &#34;SQL Error: $DBI::errstr\n&#34;;
my @rows = $sth-&gt;fetchrow_array&#40;&#41;;
my $name = $rows[0];
print &#34;Running tests with &#34; . $condition . &#34;.\n&#34;;
print &#34;Name:&#34;;
print $name . &#34;\n&#34;;
ok&#40;$name eq &#34;example&#34;, &#34;Got the right row with &#34; . $condition . &#34;.&#34;&#41;;
my $floater = $rows[1];
print $floater . &#34;\n&#34;;
#I&#39;m a bit surprised this comparison works for any case because I thought that you
# can&#39;t get correct results using == with FLOATs due to internal limitations. But I
# guess this is just another thing that Perl automagically does for you
ok&#40;$floater == .96, &#34;Float values work with &#34; . $condition . &#34;.&#34;&#41;;
my $double = $rows[2];
print $double . &#34;\n&#34;;
ok&#40;$double == .96, &#34;Double values work with &#34; . $condition . &#34;.&#34;&#41;;
print &#34;\n\n&#34;;
$sth-&gt;finish&#40;&#41;;
$dbh-&gt;disconnect&#40;&#41;;
}

###########
#END code for preparedTest.pl
###########


Thanks
--
Doug Hershberger
Associate Director, Bioinformatics

[cid:663C72F1-22F0-47E4-825A-1E4FB7E35B7C]
16121 Lee Road
Ft. Myers, FL 33912
P 239.284.1115
C 650.898.7819
F 239.284.1199
Skype doug.hershberger.algenol
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1336436/709119/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/709119">with headers</a>
<br />
<span class="downloadcontenttype">text/html 19.4k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1336436/709120/F5F56FC5-6EEF-459D-A431-F12F14552D2C.png">Download F5F56FC5-6EEF-459D-A431-F12F14552D2C.png</a><br />
<span class="downloadcontenttype">image/png 8.7k</span>
</div>
<div class="messagebody">
<img alt="F5F56FC5-6EEF-459D-A431-F12F14552D2C.png" title="F5F56FC5-6EEF-459D-A431-F12F14552D2C.png" src="/Ticket/Attachment/1336436/709120/" /></div>
</div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1336436/709121/preparedTest.pl">Download preparedTest.pl</a><br />
<span class="downloadcontenttype">text/x-perl 1.3k</span>
</div>
<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1336436/709122/test-file.sql">Download test-file.sql</a><br />
<span class="downloadcontenttype">application/octet-stream 1.8k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1670519" href="/Public/Bug/Display.html?id=93710#txn-1670519">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;19&nbsp;15:35:35&nbsp;2016</span>
    <span class="description">MICHIELB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">RT-Send-CC:</td>
    <td class="message-header-value"> pali [...] cpan.org</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1670519/896532/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/896532">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 82b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">@Pali: is this more or less related to the work you contributed earlier this week?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1670520" href="/Public/Bug/Display.html?id=93710#txn-1670520">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;19&nbsp;15:35:35&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1670539" href="/Public/Bug/Display.html?id=93710#txn-1670539">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;19&nbsp;15:53:20&nbsp;2016</span>
    <span class="description">pali [...] cpan.org -  Cc PALI added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1670548" href="/Public/Bug/Display.html?id=93710#txn-1670548">#</a>      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;19&nbsp;16:07:32&nbsp;2016</span>
    <span class="description">pali [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1670548/896547/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/896547">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Pon Sep 19 15:35:35 2016, MICHIELB wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; @Pali: is this more or less related to the work you contributed
&gt; earlier this week?
</div>
No. But behaviour written in this ticket is expected. Reason is very simple:

You cannot store exact decimal value 0.96 into float or double &#40;according to IEEE 754 with base 2&#41;. So rounding errors are expected.

More, as you can see in DBD mysql source code, there are two different protocols for communication with mysql server. First one is text orientated where all values are send and retrieved as strings &#40;also floating point numbers&#41; and second is binary &#40;where numbers are in their native format, not ASCII strings&#41;. First protocol is used when mysql_server_prepare is not set and second when mysql_server_prepare=1. So rounding and casting differences can be there based on mysql_server_prepare value.

But this is related to mysql server and protocol itself, not DBD mysql driver which just implement mysql protocol support.

Anyway, comparing two floating point values on equality does not work at all. I would say it is very suspicious that values are really equal when mysql_server_prepare is not used :-&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1684481" href="/Public/Bug/Display.html?id=93710#txn-1684481">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;19&nbsp;15:30:01&nbsp;2016</span>
    <span class="description">pali [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1684481/904375/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/904375">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Pon Sep 19 16:07:32 2016, PALI wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Pon Sep 19 15:35:35 2016, MICHIELB wrote:
<div class="message-stanza open">&gt; &gt; @Pali: is this more or less related to the work you contributed
&gt; &gt; earlier this week?
</div>&gt; 
&gt; No. But behaviour written in this ticket is expected. Reason is very
&gt; simple:
&gt; 
&gt; You cannot store exact decimal value 0.96 into float or double
&gt; &#40;according to IEEE 754 with base 2&#41;. So rounding errors are expected.
&gt; 
&gt; More, as you can see in DBD mysql source code, there are two different
&gt; protocols for communication with mysql server. First one is text
&gt; orientated where all values are send and retrieved as strings &#40;also
&gt; floating point numbers&#41; and second is binary &#40;where numbers are in
&gt; their native format, not ASCII strings&#41;. First protocol is used when
&gt; mysql_server_prepare is not set and second when
&gt; mysql_server_prepare=1. So rounding and casting differences can be
&gt; there based on mysql_server_prepare value.
&gt; 
&gt; But this is related to mysql server and protocol itself, not DBD mysql
&gt; driver which just implement mysql protocol support.
&gt; 
&gt; Anyway, comparing two floating point values on equality does not work
&gt; at all. I would say it is very suspicious that values are really equal
&gt; when mysql_server_prepare is not used :-&#41;
</div>
Based on above description I would close this ticket as NOT A BUG, but I do not have rights for that.
It is not possible to store value 0.96 as float.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1684554" href="/Public/Bug/Display.html?id=93710#txn-1684554">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;20&nbsp;04:21:29&nbsp;2016</span>
    <span class="description">MICHIELB [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1684554/904417/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/904417">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 18b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">+1 what Pali says!
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1684557" href="/Public/Bug/Display.html?id=93710#txn-1684557">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;20&nbsp;04:21:34&nbsp;2016</span>
    <span class="description">MICHIELB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.521908</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
