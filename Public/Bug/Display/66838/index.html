<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #66838 for libwww-perl: Ease the https upgrade from LWP 5 to 6</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #66838 for libwww-perl: Ease the https upgrade from LWP 5 to 6</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/libwww-perl/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/libwww-perl/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/libwww-perl">libwww-perl CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">66838</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/libwww-perl/Active/">libwww-perl</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
mschwern [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
nine [...] detonation.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-18330-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
6.00    </td>
  </tr>
  <tr id="CF-18331-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;01:17:32&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Ease the https upgrade from LWP 5 to 6</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I upgraded all my CPAN modules recently and started getting a mysterious
&#34;Can&#39;t verify SSL peers without knowning which Certificate Authorities
to trust&#34; error from Metabase::Client::Simple.
<span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=66835&#38;results=9e0fd349dbb5faeefa02f44fb1ad332f">https://rt.cpan.org/Ticket/Display.html?id=66835&#38;results=9e0fd349dbb5faeefa02f44fb1ad332f</a></span>

I&#39;ve tracked it down to that it appears LWP now seems to require
Mozilla::CA to do https.  Somehow the explanatory text got swallowed and
I just saw the first line.

I&#39;m concerned that if you have a working LWP 5 setup with all the
necessary modules for https, but not Mozilla::CA, that an upgrade to LWP
6 will break https.  The error message is informative, but it still
means an upgrade breaks stuff which can cause an outage.

Is there any way to ease that transition?  Can the Makefile.PL do some
heuristics to see if A&#41; you have LWP 5 installed and B&#41; https works,
maybe even just check for Crypt::SSLeay?  If both are true, maybe it
automatically installs the new https support modules.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;06:34:04&nbsp;2011</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m not sure what to do about it.  One option is to not state the SSL dependencies as 
recommended modules, but as PREREQ_PM directly.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;06:34:06&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;08:22:06&nbsp;2011</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Mar 24 06:34:04 2011, GAAS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not sure what to do about it.  One option is to not state the SSL
&gt; dependencies as
&gt; recommended modules, but as PREREQ_PM directly.
</div>
At a minimum, you need to update README.SSL to mention Mozilla::CA.

Schwern&#39;s suggestion is &#40;I think&#41; to add SSL dependencies to PREREQ_PM
only if you detect they are already installed.  That would ensure that
upgrading LWP &#40;on a machine that already has SSL support&#41; doesn&#39;t
&#34;break&#34;, without burdening a new LWP user with the full SSL dependency
chain.

-- David
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;15:54:21&nbsp;2011</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I don&#39;t like to make the dependencies be dynamic based on stuff available on the system where 
the Makefile.PL runs.  This might not be the same system where the module ends up installed.  
This is for instance the case for ppm in ActivePerl.

Mozilla::CA can be added as a PREREQ_PM dependency for libwww-perl without much pain.  
That module will always build and it does not have any other dependencies by itself.  That way it 
should always be available when/if IO::Socket::SSL is installed.

Problem then is systems where Crypt::SSLeay is installed but not IO::Socket::SSL.  These will start 
failing unless proper overrides are provided.  Crypt::SSLeay can use the certificates from 
Mozilla::CA but it can&#39;t do full verification of hostnames.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;24&nbsp;21:18:57&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #66838] Ease the https upgrade from LWP 5 to 6</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 25 Mar 2011 12:18:41 +1100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwww-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here&#39;s a solution to solve not the 5 -&gt; 6 transition, but eliminate the
problem going forward: make the https dependency explicit.

That means moving LWP::Protocol::https into its own distribution that depends
on LWP.  LWP::Protocol::https depends on whatever encryption stuff it needs.
Then if one *explicitly* wants LWP with https support they can depend on LWP
and LWP::Protocol::https.  No more guessing which encryption modules to depend on.


On 2011.3.25 6:54 AM, Gisle_Aas via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m not sure what to do about it.  One option is to not state the SSL dependencies as 
&gt; recommended modules, but as PREREQ_PM directly.
</div>
That would be the best solution, I&#39;m all for encryption being as easy as
possible, but I understand if you&#39;re hesitant to do that because of the track
record of the encryption modules.

The problem is LWP is so critical that it has to work and the encryption
modules aren&#39;t quite up to snuff.

I see you own the whole https chain now, so maybe one solution is to firm up
the encryption modules and go with it.  I think this is the best solution, but
you might not want to carry that load.

Another option is to split out LWP::Protocol::HTTPS, as above, and the rest of
the code goes into LWP-HTTP or something.  Then LWP depends on LWP-HTTP and
LWP::Protocol::https.  So when one installs LWP they get http and https
support, but if necessary one can install just LWP-HTTP for just HTTP support.

The problem there is if someone requires LWP::UserAgent they might expect
HTTPS support as well.  I don&#39;t have a solution for that.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I don&#39;t like to make the dependencies be dynamic based on stuff available on the system where 
&gt; the Makefile.PL runs.  This might not be the same system where the module ends up installed.  
&gt; This is for instance the case for ppm in ActivePerl.
</div>
I understand that concern.  IMO vendors have the infrastructure and scale to
deal with special cases like this.  Provide a --with-ssl flag to the
Makefile.PL.  They can set explicitly and then they&#39;ll add that to their build
system.

Individual users are not set up to handle special cases.  Each one will expect
that just installing from the CPAN shell will work.

For example, MakeMaker ships with a bunch of bundled modules in inc/.  Vendors
have to know to delete inc, or have those bundled modules already installed,
before packaging MakeMaker.  I&#39;m ok with that because inc lets CPAN shell
installs work.

In short, I&#39;m happy to make life a bit more difficult for vendors if it makes
life simpler for individual CPAN users.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Mozilla::CA can be added as a PREREQ_PM dependency for libwww-perl without much pain.  
&gt; That module will always build and it does not have any other dependencies by itself.  That way it 
&gt; should always be available when/if IO::Socket::SSL is installed.
</div>
That sounds like an ok solution if it works.


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Problem then is systems where Crypt::SSLeay is installed but not IO::Socket::SSL.  These 
&gt; will start failing unless proper overrides are provided.  Crypt::SSLeay can
</div>use the
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; certificates from Mozilla::CA but it can&#39;t do full verification of hostnames.
</div>
So if I get that straight, if the user has just Crypt::SSLeay and Mozilla::CA
there&#39;s additional fiddling with LWP flags that has to go on before it will
work?  Could those flags be the default for Crypt::SSLeay?

Is there enough benefit supporting two SSL chains in the code?


-- 
91. I am not authorized to initiate Jihad.
    -- The 213 Things Skippy Is No Longer Allowed To Do In The U.S. Army
           <span class="clickylink"><a target="new" rel="nofollow" href="http://skippyslist.com/list/">http://skippyslist.com/list/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;26&nbsp;06:48:01&nbsp;2011</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I like the solution of splitting out LWP::Protocol::https into it&#39;s own separate distribution with hard dependencies on the required SSL modules best.  It try that.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;28&nbsp;09:05:11&nbsp;2011</span>
    <span class="description">ludwig.nussel [...] suse.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ludwig.nussel [...] suse.de</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">What&#39;s the reason to use Mozilla::CA anways? Linux distributions have a
set of system certificates in /etc/ssl/certs so no need use your own CA
bundle.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;28&nbsp;10:14:04&nbsp;2011</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 28 09:05:11 2011, ludwig.nussel@suse.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What&#39;s the reason to use Mozilla::CA anways? Linux distributions have a
&gt; set of system certificates in /etc/ssl/certs so no need use your own CA
&gt; bundle.
</div>
This may come as a shock to you, but people use things other than Linux
or even Unix!

Even if they use Unix, are SSL certs installed?  Are they up to date? 
Are they in a format we understand?  Is /etc/ssl/certs where they put it?

It might be possible to look around and see if there&#39;s something useful
on the filesystem if Mozilla::CA isn&#39;t there.  That would probably make
vendor packaging easier.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;28&nbsp;15:47:56&nbsp;2011</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 28 09:05:11 2011, ludwig.nussel@suse.de wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; What&#39;s the reason to use Mozilla::CA anways? Linux distributions have a
&gt; set of system certificates in /etc/ssl/certs so no need use your own CA
&gt; bundle.
</div>
The plan is in fact to introduce some module that use heuristics to determine
if we can use OS-provided certs and then only fall back on Mozilla::CA when
that fails.  That module has not been written yet, but I want to plug it in
eventually.  The plan was to start out with something that we know will
work regardless of platform and then iterate from there.

... and even if we find some cert files under /etc/ssl/certs it might not be
the best source if they are less up-to-date than the certs of Mozilla::CA.

BTW, on my Linux system I find the OS provided certs under
/etc/pki/tls/cert.pem.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;28&nbsp;15:51:42&nbsp;2011</span>
    <span class="description">GAAS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;ve now created the LWP-Protocol-https distribution and unbundled the file from libwww-perl-
6.02.  Let&#39;s see to what degree this confuses people.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;30&nbsp;07:43:17&nbsp;2011</span>
    <span class="description">ludwig.nussel [...] suse.de -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> ludwig.nussel [...] suse.de</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Am Mo 28. Mär 2011, 15:47:56, GAAS schrieb:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Mar 28 09:05:11 2011, ludwig.nussel@suse.de wrote:
<div class="message-stanza open">&gt; &gt; What&#39;s the reason to use Mozilla::CA anways? Linux distributions
</div>&gt; have a
<div class="message-stanza open">&gt; &gt; set of system certificates in /etc/ssl/certs so no need use your own
</div>&gt; CA
<div class="message-stanza open">&gt; &gt; bundle.
</div>&gt; 
&gt; The plan is in fact to introduce some module that use heuristics to
</div>determine
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; if we can use OS-provided certs and then only fall back on Mozilla::CA
</div>when
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; that fails.  That module has not been written yet, but I want to plug
</div>it in
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; eventually.  The plan was to start out with something that we know
</div>will work
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; regardless of platform and then iterate from there.
</div>
The best fix would be to export SSL_CTX_set_default_verify_paths&#40;&#41;
which just uses the openssl compiled in defaults in Net::SSLeay IMO.
IO::Socket::SSL could call that already so higher level module don&#39;t
need to implement workarounds.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;09&nbsp;08:05:43&nbsp;2011</span>
    <span class="description">nine [...] detonation.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Mar 28 10:14:04 2011, MSCHWERN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Even if they use Unix, are SSL certs installed?  Are they up to date? 
&gt; Are they in a format we understand?  Is /etc/ssl/certs where they put it?
</div>
When someone is concerned enough about security to use SSL, chances 
are, that this person also installs security updates for his system, so 
those certificates ought to be up to date. More up to date than some 
random Perl module that gets installed as dependency once and never 
touched again till Perl itself gets updated to a new version and the 
installing of dependencies starts again.

And in contrast to some obscure file somewhere in /usr/lib/perl5/... there 
are documented ways to add CAs to /etc/ssl. Ways that are used in 
practice. So a simple install of dependencies of a Perl module led to 
updating LWP breaking a lot of Perl based tools that suddenly don&#39;t want 
to talk to our servers anymore because they cannot verify certificates 
despite CA certificates being installed in the correct location for the 
system. Great.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;09&nbsp;08:06:41&nbsp;2011</span>
    <span class="description">nine [...] detonation.org -  Cc NINE added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;May&nbsp;09&nbsp;20:51:56&nbsp;2011</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #66838] Ease the https upgrade from LWP 5 to 6</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 10 May 2011 10:51:43 +1000</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-libwww-perl [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 2011.5.9 10:05 PM, Stefan Seifert via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Mar 28 10:14:04 2011, MSCHWERN wrote:
<div class="message-stanza open">&gt;&gt; Even if they use Unix, are SSL certs installed?  Are they up to date? 
&gt;&gt; Are they in a format we understand?  Is /etc/ssl/certs where they put it?
</div>&gt; 
&gt; When someone is concerned enough about security to use SSL, chances 
&gt; are, that this person also installs security updates for his system, so 
&gt; those certificates ought to be up to date. More up to date than some 
&gt; random Perl module that gets installed as dependency once and never 
&gt; touched again till Perl itself gets updated to a new version and the 
&gt; installing of dependencies starts again.
</div>
This may be true of someone running an HTTPS *server* [1], but certainly not
to a client simply linking to an https URL.  That&#39;s *minimal* security, often
simply used because its the URL they were given, and probably not running on
the same machine it was written on.  For example, a Twitter client.

No, I&#39;ll wager your average user of http links has no idea what the state of
the security of their system is.

Even then, the up-to-date-ness of the files is only one consideration, and not
even the major one.  Do we know where they&#39;re installed?  Are they in a format
we can read?  Are the ones we found the ones that are kept up to date or are
they some old duplicates we happened to find grovelling around the filesystem?
 This is essentially the same argument as to whether DateTime should ship its
own time zone files or use the system ones.

I think the integration of certs is best left to the vendors.  If an OS vendor
wants to ship a copy of the module that links to their own cert system, ok.  I
think that&#39;s how Debian resolved it.  The CPAN module doesn&#39;t now what
environment it lives in and should be independent.

Now, it *could* make an effort to try out likely locations of system certs,
perhaps ignore them if they&#39;re out of date, but I don&#39;t know if that&#39;s
possible.  That would be a place to put effort.


[1] Even then I&#39;d argue it isn&#39;t, but less strongly.


-- 
52. Not allowed to yell &#34;Take that Cobra&#34; at the rifle range.
    -- The 213 Things Skippy Is No Longer Allowed To Do In The U.S. Army
           <span class="clickylink"><a target="new" rel="nofollow" href="http://skippyslist.com/list/">http://skippyslist.com/list/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;31&nbsp;15:03:22&nbsp;2017</span>
    <span class="description">olaf [...] wundersolutions.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ticket migrated to github as <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/libwww-perl/libwww-perl/issues/225">https://github.com/libwww-perl/libwww-perl/issues/225</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;31&nbsp;15:03:33&nbsp;2017</span>
    <span class="description">olaf [...] wundersolutions.com -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
