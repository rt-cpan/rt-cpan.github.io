<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #127013 for ExtUtils-MakeMaker: ld: warning: object file &#40;test.o&#41; was built for newer OSX version &#40;10.13&#41; than being linked &#40;10.5&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #127013 for ExtUtils-MakeMaker: ld: warning: object file &#40;test.o&#41; was built for newer OSX version &#40;10.13&#41; than being linked &#40;10.5&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/ExtUtils-MakeMaker/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/ExtUtils-MakeMaker">ExtUtils-MakeMaker CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">127013</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/ExtUtils-MakeMaker/Active/">ExtUtils-MakeMaker</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jeff.holt [...] method-r.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-12494-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-12495-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Aug&nbsp;31&nbsp;17:06:19&nbsp;2018</span>
    <span class="description">jeff.holt [...] method-r.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> ld: warning: object file &#40;test.o&#41; was built for newer OSX version &#40;10.13&#41; than being linked &#40;10.5&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 31 Aug 2018 16:05:44 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-ExtUtils-MakeMaker [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jeff Holt &lt;jeff.holt [...] method-r.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">SUMMARY

It looks like ExtUtils::MakeMaker version 7.34 is not completely
interrogating the perl Config to determine all of the proper options to add
to gcc.

The resulting default make is building for the current OS version. Instead,
what it should be doing, when the compiler has the feature that allows it
to build for a particular version of the OS, then it should abide according
to how the perl was configured. In my case, my perl was compiled for macOS
10.5 compatibility.

I should be able to distribute a module built for this perl on any macOS
system that is 10.5 or newer and with which the perl can be installed.

If I were to bundle my built module with the perl and give it to someone on
10.9, then they could &#40;will?&#41; have a problem.

Specifically, what should be happening is that the following option should
be given to all the gcc commands executed in the make:

-mmacosx-version-min=10.5&#39;

but the ld command is the only command that gets that option.

DETAILS

Below is the output of the following script, with some whitespace added
between command executions.

perl -MExtUtils::MakeMaker -e &#39;print $ExtUtils::MakeMaker::VERSION&#39;;
cat Makefile.PL
cat test.xs
perl Makefile.PL
make
perl -v
uname -a
gcc --version
perl -V




$ perl -MExtUtils::MakeMaker -e &#39;print $ExtUtils::MakeMaker::VERSION&#39;;
7.34




$ cat Makefile.PL
use ExtUtils::MakeMaker;
WriteMakefile&#40;NAME=&gt;&#39;test&#39;, VERSION=&gt;&#39;0.15&#39;&#41;;




$ cat test.xs
#include &#34;EXTERN.h&#34;
#include &#34;perl.h&#34;
#include &#34;XSUB.h&#34;

MODULE = test PACKAGE = test

void
testf&#40;&#41;
PROTOTYPE: DISABLE
PREINIT:
int something = 0;
CODE:
        something = 1;





$ perl Makefile.PL
Generating a Unix-style Makefile
Writing Makefile for test
Writing MYMETA.yml and MYMETA.json





$ make
Running Mkbootstrap for test &#40;&#41;
chmod 644 &#34;test.bs&#34;
&#34;/usr/local/ActivePerl-5.20/bin/perl-dynamic&#34; -MExtUtils::Command::MM -e
&#39;cp_nonempty&#39; -- test.bs blib/arch/auto/test/test.bs 644
&#34;/usr/local/ActivePerl-5.20/bin/perl-dynamic&#34;
&#34;/usr/local/ActivePerl-5.20/lib/ExtUtils/xsubpp&#34;  -typemap
&#39;/usr/local/ActivePerl-5.20/lib/ExtUtils/typemap&#39;  test.xs &gt; test.xsc
mv test.xsc test.c
/Applications/Xcode.app/Contents/Developer/usr/bin/gcc -c   -fno-common
-DPERL_DARWIN -no-cpp-precomp -arch x86_64 -DUSE_SITECUSTOMIZE
-DPERL_RELOCATABLE_INCPUSH -fno-strict-aliasing -pipe -fstack-protector
-O3   -DVERSION=\&#34;0.15\&#34; -DXS_VERSION=\&#34;0.15\&#34;
&#34;-I/usr/local/ActivePerl-5.20/lib/CORE&#34;   test.c
In file included from test.xs:2:
In file included from /usr/local/ActivePerl-5.20/lib/CORE/perl.h:5199:
/usr/local/ActivePerl-5.20/lib/CORE/inline.h:311:9: warning: nonnull
parameter &#39;pv&#39; will evaluate to &#39;true&#39; on first encounter
[-Wpointer-bool-conversion]
    if &#40;pv &#38;&#38; len &gt; 1&#41; {
        ^~ ~~
/usr/local/ActivePerl-5.20/lib/CORE/proto.h:1792:4: note: declared
&#39;nonnull&#39; here
                        __attribute__nonnull__&#40;pTHX_1&#41;
                        ^
/usr/local/ActivePerl-5.20/lib/CORE/perl.h:3100:60: note: expanded from
macro &#39;__attribute__nonnull__&#39;
#  define __attribute__nonnull__&#40;a&#41;         __attribute__&#40;&#40;nonnull&#40;a&#41;&#41;&#41;
                                                           ^
1 warning generated.
rm -f blib/arch/auto/test/test.bundle
gcc -mmacosx-version-min=10.5  -bundle -undefined dynamic_lookup
-Wl,-search_paths_first -arch x86_64 -fstack-protector  test.o  -o
blib/arch/auto/test/test.bundle  \
      \

ld: warning: object file &#40;test.o&#41; was built for newer OSX version &#40;10.13&#41;
than being linked &#40;10.5&#41;
chmod 755 blib/arch/auto/test/test.bundle





$ perl -v

This is perl 5, version 20, subversion 2 &#40;v5.20.2&#41; built for
darwin-thread-multi-2level
&#40;with 1 registered patch, see perl -V for more detail&#41;

Copyright 1987-2015, Larry Wall

Binary build 2001 [298913] provided by ActiveState
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.ActiveState.com">http://www.ActiveState.com</a></span>
Built Mar 19 2015 15:36:06

Perl may be copied only under the terms of either the Artistic License or
the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using &#34;man perl&#34; or &#34;perldoc perl&#34;.  If you have access to the
Internet, point your browser at <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perl.org/">http://www.perl.org/</a></span>, the Perl Home Page.



$ uname -a
Darwin MacBook-Pro 17.7.0 Darwin Kernel Version 17.7.0: Fri Jul  6 19:54:51
PDT 2018; root:xnu-4570.71.3~2/RELEASE_X86_64 x86_64



$ gcc --version
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr
--with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 9.1.0 &#40;clang-902.0.39.2&#41;
Target: x86_64-apple-darwin17.7.0
Thread model: posix
InstalledDir:
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin


$ perl -V
Summary of my perl5 &#40;revision 5 version 20 subversion 2&#41; configuration:

  Platform:
    osname=darwin, osvers=10.8.0, archname=darwin-thread-multi-2level
    uname=&#39;darwin neko 10.8.0 darwin kernel version 10.8.0: tue jun 7
16:33:36 pdt 2011; root:xnu-1504.15.3~1release_i386 i386 &#39;
    config_args=&#39;-ders -Dcc=gcc -Dusethreads -Duseithreads
-Uinstallusrbinperl -Ulocincpth= -Uloclibpth= -Duse64bitint -Ud_poll
-Ui_poll -Ui_libutil -Aldflags=-Wl,-search_paths_first
-Alddlflags=-Wl,-search_paths_first -Accflags=-arch x86_64 -Aldflags=-arch
x86_64 -Alddlflags=-arch x86_64 -Accflags=-DUSE_SITECUSTOMIZE
-Duselargefiles -Accflags=-DPERL_RELOCATABLE_INCPUSH
-Accflags=-fno-merge-constants -Dprefix=/usr/local/ActivePerl-5.20
-Dprivlib=/usr/local/ActivePerl-5.20/lib
-Darchlib=/usr/local/ActivePerl-5.20/lib
-Dsiteprefix=/usr/local/ActivePerl-5.20/site
-Dsitelib=/usr/local/ActivePerl-5.20/site/lib
-Dsitearch=/usr/local/ActivePerl-5.20/site/lib -Dsed=/usr/bin/sed
-Duseshrplib -Dcf_by=ActiveState -Dcf_email=support@ActiveState.com&#39;
    hint=recommended, useposix=true, d_sigaction=define
    useithreads=define, usemultiplicity=define
    use64bitint=define, use64bitall=define, uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc=&#39;/Applications/Xcode.app/Contents/Developer/usr/bin/gcc&#39;, ccflags
=&#39;-fno-common -DPERL_DARWIN -no-cpp-precomp -arch x86_64
-DUSE_SITECUSTOMIZE -DPERL_RELOCATABLE_INCPUSH -fno-strict-aliasing -pipe
-fstack-protector&#39;,
    optimize=&#39;-O3&#39;,
    cppflags=&#39;-no-cpp-precomp -fno-common -DPERL_DARWIN -no-cpp-precomp
-arch x86_64 -DUSE_SITECUSTOMIZE -DPERL_RELOCATABLE_INCPUSH
-fno-merge-constants -fno-strict-aliasing -pipe -fstack-protector&#39;
    ccversion=&#39;&#39;, gccversion=&#39;Apple LLVM version 9.1.0 &#40;clang-902.0.39.2&#41;&#39;,
gccosandvers=&#39;&#39;
    intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
    ivtype=&#39;long&#39;, ivsize=8, nvtype=&#39;double&#39;, nvsize=8, Off_t=&#39;off_t&#39;,
lseeksize=8
    alignbytes=8, prototype=define
  Linker and Libraries:
    ld=&#39;gcc -mmacosx-version-min=10.5&#39;, ldflags =&#39; -Wl,-search_paths_first
-arch x86_64 -fstack-protector&#39;
    libpth=/usr/lib
    libs=-ldbm -ldl -lm -lutil -lc
    perllibs=-ldl -lm -lutil -lc
    libc=, so=dylib, useshrplib=true, libperl=libperl.dylib
    gnulibc_version=&#39;&#39;
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=bundle, d_dlsymun=undef, ccdlflags=&#39; &#39;
    cccdlflags=&#39; &#39;, lddlflags=&#39; -bundle -undefined dynamic_lookup
-Wl,-search_paths_first -arch x86_64 -fstack-protector&#39;


Characteristics of this binary &#40;from libperl&#41;:
  Compile-time options: HAS_TIMES MULTIPLICITY PERLIO_LAYERS
                        PERL_DONT_CREATE_GVSV
                        PERL_HASH_FUNC_ONE_AT_A_TIME_HARD
                        PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
                        PERL_NEW_COPY_ON_WRITE PERL_PRESERVE_IVUV
                        PERL_RELOCATABLE_INCPUSH USE_64_BIT_ALL
                        USE_64_BIT_INT USE_ITHREADS USE_LARGE_FILES
                        USE_LOCALE USE_LOCALE_COLLATE USE_LOCALE_CTYPE
                        USE_LOCALE_NUMERIC USE_PERLIO USE_PERL_ATOF
                        USE_REENTRANT_API USE_SITECUSTOMIZE
  Locally applied patches:
ActivePerl Build 2001 [298913]
  Built under darwin
  Compiled at Mar 19 2015 15:36:06
  %ENV:

PERL5LIB=&#34;/Users/jholt/Source/mrprof/src/perlmods:/Users/jholt/Source/mrprof/src&#34;
    PERL_HOME=&#34;/usr/local/ActivePerl-5.20&#34;
  @INC:
    /Users/jholt/Source/mrprof/src/perlmods
    /Users/jholt/Source/mrprof/src
    /Users/jholt/Library/ActivePerl-5.20/lib
    /usr/local/ActivePerl-5.20/site/lib
    /usr/local/ActivePerl-5.20/lib
    .
</div></div>

<div class="messagebody">
<p>Message body is not shown because it is too large.</p></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
