<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #113922 for Bio-Pipeline-Comparison: Issue reading VCF files with PERL library Vcf.pm after complex filtering</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #113922 for Bio-Pipeline-Comparison: Issue reading VCF files with PERL library Vcf.pm after complex filtering</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Bio-Pipeline-Comparison/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Bio-Pipeline-Comparison/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Bio-Pipeline-Comparison/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Bio-Pipeline-Comparison/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Bio-Pipeline-Comparison">Bio-Pipeline-Comparison CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">113922</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Bio-Pipeline-Comparison/Active/">Bio-Pipeline-Comparison</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
francescomusacchia [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-246492-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-246493-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;22&nbsp;07:10:09&nbsp;2016</span>
    <span class="description">francescomusacchia [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Issue reading VCF files with PERL library Vcf.pm after complex filtering</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Apr 2016 13:09:54 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bio-Pipeline-Comparison [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Francesco Musacchia &lt;francescomusacchia [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi there,

I want to report this in issue in reading the VCF output format after
GATK-VariantFiltration task.

I was trying to use Vcf.pm to read the output VCF file from that program
but an error came out when parsing the header.

I was just trying the follwoing example code at
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm">http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm</a></span>
with my VCF file:

    my $vcf = Vcf-&gt;new&#40;file=&gt;&#39;example.vcf.gz&#39;,region=&gt;&#39;1:1000-2000&#39;&#41;;
    $vcf-&gt;parse_header&#40;&#41;;

    # Do some simple parsing. Most thorough but slowest way how to get the data.
    while &#40;my $x=$vcf-&gt;next_data_hash&#40;&#41;&#41;
    {
        for my $gt &#40;keys %{$$x{gtypes}}&#41;
        {
            my &#40;$al1,$sep,$al2&#41; = $vcf-&gt;parse_alleles&#40;$x,$gt&#41;;
            print &#34;\t$gt: $al1$sep$al2\n&#34;;
        }
        print &#34;\n&#34;;
    }


Specifically, I found this is related with the string related to filters
used. The following are the filters as reported in my VCF:

*##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt;
40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;&#34;&gt;
##FILTER=&lt;ID=LowQual,Description=&#34;&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&#34;&gt;*

The double quotes are repeated, as you can see in all the three filters and
this is causing Vcf.pm perl library to fail with:

Could not parse header line: FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt;
2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
-8.0&#34;&#34;&gt;
Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
ReadPosRankSum &lt; -8.0&#34;&#34;].

When I go to remove the repeated double-quotes than I solved this. Infact
with ##FILTER=&lt;ID=LowQual,Description=&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&gt; the
error is not there.

Moreover, one more error comes out because of VariantFiltration. Few lines
later the Command line printed has all the parameters given to
VariantFiltration and this filter again:

*##GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625,Date=&#34;Sat
Apr 16 12:01:58 CEST 2016&#34;,Epoch=1460800918456,CommandLineOptions=.. .. ..
..... filterExpression=[&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt;
-12.5 || ReadPosRankSum &lt; -8.0&#34;, &#34;QUAL &lt; 30.0&#34;, &#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt;
100.0&#34;] filterName=[HARD_TO_VALIDATE, VeryLowQual, LowQual]
genotypeFilterExpression=[] genotypeFilterName=[] . .. .... &gt;*

And Vcf.pm stops with:

Could not parse header line:
GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625
.....

I solved in a similar way removing the quotes from the filter elements:

*filterExpression=[QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5
|| ReadPosRankSum &lt; -8.0, QUAL &lt; 30.0, QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0]*

I do not know if it is a problem in the Vcf.pm library or the VCF format is
not respected in VariantFiltration.

Hope this will be useful

Regards,

Francesco Musacchia

-- 
Francesco Musacchia - Ph.D.
Computational Biology - Bioinformatics Core
Telethon Institute of Genetics and Medicine
Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
Tel. +39 081 19230692
Mobile: +39 349 6396351
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;22&nbsp;07:15:35&nbsp;2016</span>
    <span class="description">andrewjpage [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113922] Issue reading VCF files with PERL library Vcf.pm after complex filtering</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 22 Apr 2016 12:15:23 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bio-Pipeline-Comparison [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andrew Page &lt;andrewjpage [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
The latest version of this module is in vcftools, so this might solve your
issues:
<span class="clickylink"><a target="new" rel="nofollow" href="https://vcftools.github.io">https://vcftools.github.io</a></span>
Regards,
Andrew
On 22 Apr 2016 12:10, &#34;Francesco Musacchia via RT&#34; &lt;
bug-Bio-Pipeline-Comparison@rt.cpan.org&gt; wrote:

Fri Apr 22 07:10:09 2016: Request 113922 was acted upon.
Transaction: Ticket created by francescomusacchia@gmail.com
       Queue: Bio-Pipeline-Comparison
     Subject: Issue reading VCF files with PERL library Vcf.pm after
complex filtering
   Broken in: &#40;no value&#41;
    Severity: &#40;no value&#41;
       Owner: Nobody
  Requestors: francescomusacchia@gmail.com
      Status: new
 Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;


Hi there,

I want to report this in issue in reading the VCF output format after
GATK-VariantFiltration task.

I was trying to use Vcf.pm to read the output VCF file from that program
but an error came out when parsing the header.

I was just trying the follwoing example code at
<span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm">http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm</a></span>
with my VCF file:

    my $vcf = Vcf-&gt;new&#40;file=&gt;&#39;example.vcf.gz&#39;,region=&gt;&#39;1:1000-2000&#39;&#41;;
    $vcf-&gt;parse_header&#40;&#41;;

    # Do some simple parsing. Most thorough but slowest way how to get the
data.
    while &#40;my $x=$vcf-&gt;next_data_hash&#40;&#41;&#41;
    {
        for my $gt &#40;keys %{$$x{gtypes}}&#41;
        {
            my &#40;$al1,$sep,$al2&#41; = $vcf-&gt;parse_alleles&#40;$x,$gt&#41;;
            print &#34;\t$gt: $al1$sep$al2\n&#34;;
        }
        print &#34;\n&#34;;
    }


Specifically, I found this is related with the string related to filters
used. The following are the filters as reported in my VCF:

*##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt;
40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;&#34;&gt;
##FILTER=&lt;ID=LowQual,Description=&#34;&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&#34;&gt;*

The double quotes are repeated, as you can see in all the three filters and
this is causing Vcf.pm perl library to fail with:

Could not parse header line: FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt;
2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
-8.0&#34;&#34;&gt;
Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
ReadPosRankSum &lt; -8.0&#34;&#34;].

When I go to remove the repeated double-quotes than I solved this. Infact
with ##FILTER=&lt;ID=LowQual,Description=&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&gt; the
error is not there.

Moreover, one more error comes out because of VariantFiltration. Few lines
later the Command line printed has all the parameters given to
VariantFiltration and this filter again:

*##GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625,Date=&#34;Sat
Apr 16 12:01:58 CEST 2016&#34;,Epoch=1460800918456,CommandLineOptions=.. .. ..
..... filterExpression=[&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt;
-12.5 || ReadPosRankSum &lt; -8.0&#34;, &#34;QUAL &lt; 30.0&#34;, &#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt;
100.0&#34;] filterName=[HARD_TO_VALIDATE, VeryLowQual, LowQual]
genotypeFilterExpression=[] genotypeFilterName=[] . .. .... &gt;*

And Vcf.pm stops with:

Could not parse header line:
GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625
.....

I solved in a similar way removing the quotes from the filter elements:

*filterExpression=[QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5
|| ReadPosRankSum &lt; -8.0, QUAL &lt; 30.0, QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0]*

I do not know if it is a problem in the Vcf.pm library or the VCF format is
not respected in VariantFiltration.

Hope this will be useful

Regards,

Francesco Musacchia

--
Francesco Musacchia - Ph.D.
Computational Biology - Bioinformatics Core
Telethon Institute of Genetics and Medicine
Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
Tel. +39 081 19230692
Mobile: +39 349 6396351
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;22&nbsp;07:15:36&nbsp;2016</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;27&nbsp;03:40:29&nbsp;2016</span>
    <span class="description">francescomusacchia [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113922] Issue reading VCF files with PERL library Vcf.pm after complex filtering</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Apr 2016 09:40:17 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bio-Pipeline-Comparison [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Francesco Musacchia &lt;francescomusacchia [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Dear Andrew,

I just downloaded and used the latest version of vcftools &#40;0.1.14&#41; but this
issue is still there:

*Use of uninitialized value $attr_value in pattern match &#40;m//&#41; at
/cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
line 2989, &lt;$__ANONIO__&gt; line 3.*
*Use of uninitialized value $attr_value in pattern match &#40;m//&#41; at
/cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
line 2989, &lt;$__ANONIO__&gt; line 3.*
*Could not parse header line: FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD
&lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
-8.0&#34;&#34;&gt;*
*Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
ReadPosRankSum &lt; -8.0&#34;&#34;].*

* at
/cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
line 172*
* Vcf::throw&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;, &#39;Could not parse header line:
FILTER=&lt;ID=HARD_TO_VALIDATE,Desc...&#39;&#41; called at
/cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
line 2981*
* Vcf4_0::parse_header_line&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;,
&#39;##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; ...&#39;&#41; called
at /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
line 625*
* VcfReader::_next_header_line&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;&#41; called at
/cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
line 598*
* VcfReader::parse_header&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;&#41; called at parse_vcf.pl
&lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://parse">http://parse</a></span>_vcf.pl&gt; line 10*

I asked also at GATK forum and they say their output is VCF compliant.

<span class="clickylink"><a target="new" rel="nofollow" href="http://gatkforums.broadinstitute.org/gatk/discussion/7518/issue-reading-vcf-files-with-perl-library-vcf-pm-after-complex-filtering">http://gatkforums.broadinstitute.org/gatk/discussion/7518/issue-reading-vcf-files-with-perl-library-vcf-pm-after-complex-filtering</a></span>

Regards,

Francesco


2016-04-22 13:15 GMT+02:00 Andrew Page via RT &lt;
bug-Bio-Pipeline-Comparison@rt.cpan.org&gt;:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt;
&gt; Hi,
&gt; The latest version of this module is in vcftools, so this might solve your
&gt; issues:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://vcftools.github.io">https://vcftools.github.io</a></span>
&gt; Regards,
&gt; Andrew
&gt; On 22 Apr 2016 12:10, &#34;Francesco Musacchia via RT&#34; &lt;
&gt; bug-Bio-Pipeline-Comparison@rt.cpan.org&gt; wrote:
&gt;
&gt; Fri Apr 22 07:10:09 2016: Request 113922 was acted upon.
&gt; Transaction: Ticket created by francescomusacchia@gmail.com
&gt;        Queue: Bio-Pipeline-Comparison
&gt;      Subject: Issue reading VCF files with PERL library Vcf.pm after
&gt; complex filtering
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: Nobody
&gt;   Requestors: francescomusacchia@gmail.com
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt;
&gt;
&gt; Hi there,
&gt;
&gt; I want to report this in issue in reading the VCF output format after
&gt; GATK-VariantFiltration task.
&gt;
&gt; I was trying to use Vcf.pm to read the output VCF file from that program
&gt; but an error came out when parsing the header.
&gt;
&gt; I was just trying the follwoing example code at
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm">http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm</a></span>
&gt; with my VCF file:
&gt;
&gt;     my $vcf = Vcf-&gt;new&#40;file=&gt;&#39;example.vcf.gz&#39;,region=&gt;&#39;1:1000-2000&#39;&#41;;
&gt;     $vcf-&gt;parse_header&#40;&#41;;
&gt;
&gt;     # Do some simple parsing. Most thorough but slowest way how to get the
&gt; data.
&gt;     while &#40;my $x=$vcf-&gt;next_data_hash&#40;&#41;&#41;
&gt;     {
&gt;         for my $gt &#40;keys %{$$x{gtypes}}&#41;
&gt;         {
&gt;             my &#40;$al1,$sep,$al2&#41; = $vcf-&gt;parse_alleles&#40;$x,$gt&#41;;
&gt;             print &#34;\t$gt: $al1$sep$al2\n&#34;;
&gt;         }
&gt;         print &#34;\n&#34;;
&gt;     }
&gt;
&gt;
&gt; Specifically, I found this is related with the string related to filters
&gt; used. The following are the filters as reported in my VCF:
&gt;
&gt; *##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt;
&gt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;&#34;&gt;
&gt; ##FILTER=&lt;ID=LowQual,Description=&#34;&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&#34;&gt;*
&gt;
&gt; The double quotes are repeated, as you can see in all the three filters and
&gt; this is causing Vcf.pm perl library to fail with:
&gt;
&gt; Could not parse header line: FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt;
&gt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
&gt; -8.0&#34;&#34;&gt;
&gt; Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
&gt; ReadPosRankSum &lt; -8.0&#34;&#34;].
&gt;
&gt; When I go to remove the repeated double-quotes than I solved this. Infact
&gt; with ##FILTER=&lt;ID=LowQual,Description=&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&gt; the
&gt; error is not there.
&gt;
&gt; Moreover, one more error comes out because of VariantFiltration. Few lines
&gt; later the Command line printed has all the parameters given to
&gt; VariantFiltration and this filter again:
&gt;
&gt;
&gt; *##GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625,Date=&#34;Sat
&gt; Apr 16 12:01:58 CEST 2016&#34;,Epoch=1460800918456,CommandLineOptions=.. .. ..
&gt; ..... filterExpression=[&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt;
&gt; -12.5 || ReadPosRankSum &lt; -8.0&#34;, &#34;QUAL &lt; 30.0&#34;, &#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt;
&gt; 100.0&#34;] filterName=[HARD_TO_VALIDATE, VeryLowQual, LowQual]
&gt; genotypeFilterExpression=[] genotypeFilterName=[] . .. .... &gt;*
&gt;
&gt; And Vcf.pm stops with:
&gt;
&gt; Could not parse header line:
&gt;
&gt; GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625
&gt; .....
&gt;
&gt; I solved in a similar way removing the quotes from the filter elements:
&gt;
&gt; *filterExpression=[QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5
&gt; || ReadPosRankSum &lt; -8.0, QUAL &lt; 30.0, QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0]*
&gt;
&gt; I do not know if it is a problem in the Vcf.pm library or the VCF format is
&gt; not respected in VariantFiltration.
&gt;
&gt; Hope this will be useful
&gt;
&gt; Regards,
&gt;
&gt; Francesco Musacchia
&gt;
&gt; --
&gt; Francesco Musacchia - Ph.D.
&gt; Computational Biology - Bioinformatics Core
&gt; Telethon Institute of Genetics and Medicine
&gt; Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
&gt; Tel. +39 081 19230692
&gt; Mobile: +39 349 6396351
&gt;
&gt;
</div>

-- 
Francesco Musacchia - Ph.D.
Computational Biology - Bioinformatics Core
Telethon Institute of Genetics and Medicine
Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
Tel. +39 081 19230692
Mobile: +39 349 6396351
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;27&nbsp;03:48:34&nbsp;2016</span>
    <span class="description">andrewjpage [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113922] Issue reading VCF files with PERL library Vcf.pm after complex filtering</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Apr 2016 08:48:03 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bio-Pipeline-Comparison [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Andrew Page &lt;andrewjpage [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Francesco,
The developers of this module have a mailing list for help:
vcftools-help@lists.sourceforge.net
and also use Github issues for bug tracking:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/vcftools/vcftools/issues">https://github.com/vcftools/vcftools/issues</a></span>
so they might be able to get to the bottom of your issue.
Regards,
Andrew



On 27 April 2016 at 08:40, Francesco Musacchia via RT &lt;
bug-Bio-Pipeline-Comparison@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: Bio-Pipeline-Comparison
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt;
&gt; Dear Andrew,
&gt;
&gt; I just downloaded and used the latest version of vcftools &#40;0.1.14&#41; but this
&gt; issue is still there:
&gt;
&gt; *Use of uninitialized value $attr_value in pattern match &#40;m//&#41; at
&gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; line 2989, &lt;$__ANONIO__&gt; line 3.*
&gt; *Use of uninitialized value $attr_value in pattern match &#40;m//&#41; at
&gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; line 2989, &lt;$__ANONIO__&gt; line 3.*
&gt; *Could not parse header line: FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD
&gt; &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
&gt; -8.0&#34;&#34;&gt;*
&gt; *Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
&gt; ReadPosRankSum &lt; -8.0&#34;&#34;].*
&gt;
&gt; * at
&gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; line 172*
&gt; * Vcf::throw&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;, &#39;Could not parse header line:
&gt; FILTER=&lt;ID=HARD_TO_VALIDATE,Desc...&#39;&#41; called at
&gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; line 2981*
&gt; * Vcf4_0::parse_header_line&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;,
&gt; &#39;##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; ...&#39;&#41; called
&gt; at /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; line 625*
&gt; * VcfReader::_next_header_line&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;&#41; called at
&gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; line 598*
&gt; * VcfReader::parse_header&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;&#41; called at parse_vcf.pl
&gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://parse">http://parse</a></span>_vcf.pl&gt; line 10*
&gt;
&gt; I asked also at GATK forum and they say their output is VCF compliant.
&gt;
&gt;
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://gatkforums.broadinstitute.org/gatk/discussion/7518/issue-reading-vcf-files-with-perl-library-vcf-pm-after-complex-filtering">http://gatkforums.broadinstitute.org/gatk/discussion/7518/issue-reading-vcf-files-with-perl-library-vcf-pm-after-complex-filtering</a></span>
&gt;
&gt; Regards,
&gt;
&gt; Francesco
&gt;
&gt;
&gt; 2016-04-22 13:15 GMT+02:00 Andrew Page via RT &lt;
&gt; bug-Bio-Pipeline-Comparison@rt.cpan.org&gt;:
&gt;
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt; &gt;
&gt; &gt; Hi,
&gt; &gt; The latest version of this module is in vcftools, so this might solve
</div>&gt; your
<div class="message-stanza open">&gt; &gt; issues:
&gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://vcftools.github.io">https://vcftools.github.io</a></span>
&gt; &gt; Regards,
&gt; &gt; Andrew
&gt; &gt; On 22 Apr 2016 12:10, &#34;Francesco Musacchia via RT&#34; &lt;
&gt; &gt; bug-Bio-Pipeline-Comparison@rt.cpan.org&gt; wrote:
&gt; &gt;
&gt; &gt; Fri Apr 22 07:10:09 2016: Request 113922 was acted upon.
&gt; &gt; Transaction: Ticket created by francescomusacchia@gmail.com
&gt; &gt;        Queue: Bio-Pipeline-Comparison
&gt; &gt;      Subject: Issue reading VCF files with PERL library Vcf.pm after
&gt; &gt; complex filtering
&gt; &gt;    Broken in: &#40;no value&#41;
&gt; &gt;     Severity: &#40;no value&#41;
&gt; &gt;        Owner: Nobody
&gt; &gt;   Requestors: francescomusacchia@gmail.com
&gt; &gt;       Status: new
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; Hi there,
&gt; &gt;
&gt; &gt; I want to report this in issue in reading the VCF output format after
&gt; &gt; GATK-VariantFiltration task.
&gt; &gt;
&gt; &gt; I was trying to use Vcf.pm to read the output VCF file from that program
&gt; &gt; but an error came out when parsing the header.
&gt; &gt;
&gt; &gt; I was just trying the follwoing example code at
&gt; &gt;
</div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm">http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm</a></span>
<div class="message-stanza open">&gt; &gt; with my VCF file:
&gt; &gt;
&gt; &gt;     my $vcf = Vcf-&gt;new&#40;file=&gt;&#39;example.vcf.gz&#39;,region=&gt;&#39;1:1000-2000&#39;&#41;;
&gt; &gt;     $vcf-&gt;parse_header&#40;&#41;;
&gt; &gt;
&gt; &gt;     # Do some simple parsing. Most thorough but slowest way how to get
</div>&gt; the
<div class="message-stanza open">&gt; &gt; data.
&gt; &gt;     while &#40;my $x=$vcf-&gt;next_data_hash&#40;&#41;&#41;
&gt; &gt;     {
&gt; &gt;         for my $gt &#40;keys %{$$x{gtypes}}&#41;
&gt; &gt;         {
&gt; &gt;             my &#40;$al1,$sep,$al2&#41; = $vcf-&gt;parse_alleles&#40;$x,$gt&#41;;
&gt; &gt;             print &#34;\t$gt: $al1$sep$al2\n&#34;;
&gt; &gt;         }
&gt; &gt;         print &#34;\n&#34;;
&gt; &gt;     }
&gt; &gt;
&gt; &gt;
&gt; &gt; Specifically, I found this is related with the string related to filters
&gt; &gt; used. The following are the filters as reported in my VCF:
&gt; &gt;
&gt; &gt; *##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ
</div>&gt; &lt;
<div class="message-stanza open">&gt; &gt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;&#34;&gt;
&gt; &gt; ##FILTER=&lt;ID=LowQual,Description=&#34;&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&#34;&gt;*
&gt; &gt;
&gt; &gt; The double quotes are repeated, as you can see in all the three filters
</div>&gt; and
<div class="message-stanza open">&gt; &gt; this is causing Vcf.pm perl library to fail with:
&gt; &gt;
&gt; &gt; Could not parse header line:
</div>&gt; FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt;
<div class="message-stanza open">&gt; &gt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
&gt; &gt; -8.0&#34;&#34;&gt;
&gt; &gt; Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
&gt; &gt; ReadPosRankSum &lt; -8.0&#34;&#34;].
&gt; &gt;
&gt; &gt; When I go to remove the repeated double-quotes than I solved this. Infact
&gt; &gt; with ##FILTER=&lt;ID=LowQual,Description=&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&gt; the
&gt; &gt; error is not there.
&gt; &gt;
&gt; &gt; Moreover, one more error comes out because of VariantFiltration. Few
</div>&gt; lines
<div class="message-stanza open">&gt; &gt; later the Command line printed has all the parameters given to
&gt; &gt; VariantFiltration and this filter again:
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div>&gt; *##GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625,Date=&#34;Sat
<div class="message-stanza open">&gt; &gt; Apr 16 12:01:58 CEST 2016&#34;,Epoch=1460800918456,CommandLineOptions=.. ..
</div>&gt; ..
<div class="message-stanza open">&gt; &gt; ..... filterExpression=[&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum
</div>&gt; &lt;
<div class="message-stanza open">&gt; &gt; -12.5 || ReadPosRankSum &lt; -8.0&#34;, &#34;QUAL &lt; 30.0&#34;, &#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt;
&gt; &gt; 100.0&#34;] filterName=[HARD_TO_VALIDATE, VeryLowQual, LowQual]
&gt; &gt; genotypeFilterExpression=[] genotypeFilterName=[] . .. .... &gt;*
&gt; &gt;
&gt; &gt; And Vcf.pm stops with:
&gt; &gt;
&gt; &gt; Could not parse header line:
&gt; &gt;
&gt; &gt;
</div>&gt; GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625
<div class="message-stanza open">&gt; &gt; .....
&gt; &gt;
&gt; &gt; I solved in a similar way removing the quotes from the filter elements:
&gt; &gt;
&gt; &gt; *filterExpression=[QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt;
</div>&gt; -12.5
<div class="message-stanza open">&gt; &gt; || ReadPosRankSum &lt; -8.0, QUAL &lt; 30.0, QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0]*
&gt; &gt;
&gt; &gt; I do not know if it is a problem in the Vcf.pm library or the VCF format
</div>&gt; is
<div class="message-stanza open">&gt; &gt; not respected in VariantFiltration.
&gt; &gt;
&gt; &gt; Hope this will be useful
&gt; &gt;
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt; Francesco Musacchia
&gt; &gt;
&gt; &gt; --
&gt; &gt; Francesco Musacchia - Ph.D.
&gt; &gt; Computational Biology - Bioinformatics Core
&gt; &gt; Telethon Institute of Genetics and Medicine
&gt; &gt; Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
&gt; &gt; Tel. +39 081 19230692
&gt; &gt; Mobile: +39 349 6396351
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
&gt; --
&gt; Francesco Musacchia - Ph.D.
&gt; Computational Biology - Bioinformatics Core
&gt; Telethon Institute of Genetics and Medicine
&gt; Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
&gt; Tel. +39 081 19230692
&gt; Mobile: +39 349 6396351
&gt;
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;27&nbsp;04:42:36&nbsp;2016</span>
    <span class="description">francescomusacchia [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #113922] Issue reading VCF files with PERL library Vcf.pm after complex filtering</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Apr 2016 10:42:21 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Bio-Pipeline-Comparison [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Francesco Musacchia &lt;francescomusacchia [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ok. thanks. I submitted the question there.

Regards,

Francesco

2016-04-27 9:48 GMT+02:00 Andrew Page via RT &lt;
bug-Bio-Pipeline-Comparison@rt.cpan.org&gt;:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt;
&gt; Hi Francesco,
&gt; The developers of this module have a mailing list for help:
&gt; vcftools-help@lists.sourceforge.net
&gt; and also use Github issues for bug tracking:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/vcftools/vcftools/issues">https://github.com/vcftools/vcftools/issues</a></span>
&gt; so they might be able to get to the bottom of your issue.
&gt; Regards,
&gt; Andrew
&gt;
&gt;
&gt;
&gt; On 27 April 2016 at 08:40, Francesco Musacchia via RT &lt;
&gt; bug-Bio-Pipeline-Comparison@rt.cpan.org&gt; wrote:
&gt;
<div class="message-stanza open">&gt; &gt;        Queue: Bio-Pipeline-Comparison
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt; &gt;
&gt; &gt; Dear Andrew,
&gt; &gt;
&gt; &gt; I just downloaded and used the latest version of vcftools &#40;0.1.14&#41; but
</div>&gt; this
<div class="message-stanza open">&gt; &gt; issue is still there:
&gt; &gt;
&gt; &gt; *Use of uninitialized value $attr_value in pattern match &#40;m//&#41; at
&gt; &gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; &gt; line 2989, &lt;$__ANONIO__&gt; line 3.*
&gt; &gt; *Use of uninitialized value $attr_value in pattern match &#40;m//&#41; at
&gt; &gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; &gt; line 2989, &lt;$__ANONIO__&gt; line 3.*
&gt; &gt; *Could not parse header line:
</div>&gt; FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD
<div class="message-stanza open">&gt; &gt; &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
&gt; &gt; -8.0&#34;&#34;&gt;*
&gt; &gt; *Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
&gt; &gt; ReadPosRankSum &lt; -8.0&#34;&#34;].*
&gt; &gt;
&gt; &gt; * at
&gt; &gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; &gt; line 172*
&gt; &gt; * Vcf::throw&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;, &#39;Could not parse header line:
&gt; &gt; FILTER=&lt;ID=HARD_TO_VALIDATE,Desc...&#39;&#41; called at
&gt; &gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; &gt; line 2981*
&gt; &gt; * Vcf4_0::parse_header_line&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;,
&gt; &gt; &#39;##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; ...&#39;&#41;
</div>&gt; called
<div class="message-stanza open">&gt; &gt; at
</div>&gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
<div class="message-stanza open">&gt; &gt; line 625*
&gt; &gt; * VcfReader::_next_header_line&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;&#41; called at
&gt; &gt; /cineca/prod/applications/vcftools/0.1.14/gnu--4.8.3/share/perl5/Vcf.pm
&gt; &gt; line 598*
&gt; &gt; * VcfReader::parse_header&#40;&#39;Vcf4_1=HASH&#40;0x1ab4f40&#41;&#39;&#41; called at
</div>&gt; parse_vcf.pl
<div class="message-stanza open">&gt; &gt; &lt;<span class="clickylink"><a target="new" rel="nofollow" href="http://parse">http://parse</a></span>_vcf.pl&gt; line 10*
&gt; &gt;
&gt; &gt; I asked also at GATK forum and they say their output is VCF compliant.
&gt; &gt;
&gt; &gt;
&gt; &gt;
</div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://gatkforums.broadinstitute.org/gatk/discussion/7518/issue-reading-vcf-files-with-perl-library-vcf-pm-after-complex-filtering">http://gatkforums.broadinstitute.org/gatk/discussion/7518/issue-reading-vcf-files-with-perl-library-vcf-pm-after-complex-filtering</a></span>
<div class="message-stanza open">&gt; &gt;
&gt; &gt; Regards,
&gt; &gt;
&gt; &gt; Francesco
&gt; &gt;
&gt; &gt;
&gt; &gt; 2016-04-22 13:15 GMT+02:00 Andrew Page via RT &lt;
&gt; &gt; bug-Bio-Pipeline-Comparison@rt.cpan.org&gt;:
&gt; &gt;
<div class="message-stanza open">&gt; &gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Hi,
&gt; &gt; &gt; The latest version of this module is in vcftools, so this might solve
</div>&gt; &gt; your
<div class="message-stanza open">&gt; &gt; &gt; issues:
&gt; &gt; &gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://vcftools.github.io">https://vcftools.github.io</a></span>
&gt; &gt; &gt; Regards,
&gt; &gt; &gt; Andrew
&gt; &gt; &gt; On 22 Apr 2016 12:10, &#34;Francesco Musacchia via RT&#34; &lt;
&gt; &gt; &gt; bug-Bio-Pipeline-Comparison@rt.cpan.org&gt; wrote:
&gt; &gt; &gt;
&gt; &gt; &gt; Fri Apr 22 07:10:09 2016: Request 113922 was acted upon.
&gt; &gt; &gt; Transaction: Ticket created by francescomusacchia@gmail.com
&gt; &gt; &gt;        Queue: Bio-Pipeline-Comparison
&gt; &gt; &gt;      Subject: Issue reading VCF files with PERL library Vcf.pm after
&gt; &gt; &gt; complex filtering
&gt; &gt; &gt;    Broken in: &#40;no value&#41;
&gt; &gt; &gt;     Severity: &#40;no value&#41;
&gt; &gt; &gt;        Owner: Nobody
&gt; &gt; &gt;   Requestors: francescomusacchia@gmail.com
&gt; &gt; &gt;       Status: new
&gt; &gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=113922">https://rt.cpan.org/Ticket/Display.html?id=113922</a></span> &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Hi there,
&gt; &gt; &gt;
&gt; &gt; &gt; I want to report this in issue in reading the VCF output format after
&gt; &gt; &gt; GATK-VariantFiltration task.
&gt; &gt; &gt;
&gt; &gt; &gt; I was trying to use Vcf.pm to read the output VCF file from that
</div></div>&gt; program
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; but an error came out when parsing the header.
&gt; &gt; &gt;
&gt; &gt; &gt; I was just trying the follwoing example code at
&gt; &gt; &gt;
</div>&gt; &gt;
</div>&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm">http://search.cpan.org/~ajpage/Bio-Pipeline-Comparison-1.123050/lib/Vcf.pm</a></span>
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; with my VCF file:
&gt; &gt; &gt;
&gt; &gt; &gt;     my $vcf = Vcf-&gt;new&#40;file=&gt;&#39;example.vcf.gz&#39;,region=&gt;&#39;1:1000-2000&#39;&#41;;
&gt; &gt; &gt;     $vcf-&gt;parse_header&#40;&#41;;
&gt; &gt; &gt;
&gt; &gt; &gt;     # Do some simple parsing. Most thorough but slowest way how to get
</div>&gt; &gt; the
<div class="message-stanza open">&gt; &gt; &gt; data.
&gt; &gt; &gt;     while &#40;my $x=$vcf-&gt;next_data_hash&#40;&#41;&#41;
&gt; &gt; &gt;     {
&gt; &gt; &gt;         for my $gt &#40;keys %{$$x{gtypes}}&#41;
&gt; &gt; &gt;         {
&gt; &gt; &gt;             my &#40;$al1,$sep,$al2&#41; = $vcf-&gt;parse_alleles&#40;$x,$gt&#41;;
&gt; &gt; &gt;             print &#34;\t$gt: $al1$sep$al2\n&#34;;
&gt; &gt; &gt;         }
&gt; &gt; &gt;         print &#34;\n&#34;;
&gt; &gt; &gt;     }
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; Specifically, I found this is related with the string related to
</div></div>&gt; filters
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; used. The following are the filters as reported in my VCF:
&gt; &gt; &gt;
&gt; &gt; &gt; *##FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt; 2.0 || FS &gt; 60.0 ||
</div></div>&gt; MQ
<div class="message-stanza open">&gt; &gt; &lt;
<div class="message-stanza open">&gt; &gt; &gt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;&#34;&gt;
&gt; &gt; &gt; ##FILTER=&lt;ID=LowQual,Description=&#34;&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&#34;&gt;*
&gt; &gt; &gt;
&gt; &gt; &gt; The double quotes are repeated, as you can see in all the three filters
</div>&gt; &gt; and
<div class="message-stanza open">&gt; &gt; &gt; this is causing Vcf.pm perl library to fail with:
&gt; &gt; &gt;
&gt; &gt; &gt; Could not parse header line:
</div>&gt; &gt; FILTER=&lt;ID=HARD_TO_VALIDATE,Description=&#34;&#34;QD &lt;
<div class="message-stanza open">&gt; &gt; &gt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt;
&gt; &gt; &gt; -8.0&#34;&#34;&gt;
&gt; &gt; &gt; Stopped at [QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 ||
&gt; &gt; &gt; ReadPosRankSum &lt; -8.0&#34;&#34;].
&gt; &gt; &gt;
&gt; &gt; &gt; When I go to remove the repeated double-quotes than I solved this.
</div></div>&gt; Infact
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; with ##FILTER=&lt;ID=LowQual,Description=&#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0&#34;&gt;
</div></div>&gt; the
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; error is not there.
&gt; &gt; &gt;
&gt; &gt; &gt; Moreover, one more error comes out because of VariantFiltration. Few
</div>&gt; &gt; lines
<div class="message-stanza open">&gt; &gt; &gt; later the Command line printed has all the parameters given to
&gt; &gt; &gt; VariantFiltration and this filter again:
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt;
</div>&gt; &gt;
</div>&gt; *##GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625,Date=&#34;Sat
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; Apr 16 12:01:58 CEST 2016&#34;,Epoch=1460800918456,CommandLineOptions=.. ..
</div>&gt; &gt; ..
<div class="message-stanza open">&gt; &gt; &gt; ..... filterExpression=[&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 ||
</div></div>&gt; MQRankSum
<div class="message-stanza open">&gt; &gt; &lt;
<div class="message-stanza open">&gt; &gt; &gt; -12.5 || ReadPosRankSum &lt; -8.0&#34;, &#34;QUAL &lt; 30.0&#34;, &#34;QUAL &gt; 30.0 &#38;&#38; QUAL &lt;
&gt; &gt; &gt; 100.0&#34;] filterName=[HARD_TO_VALIDATE, VeryLowQual, LowQual]
&gt; &gt; &gt; genotypeFilterExpression=[] genotypeFilterName=[] . .. .... &gt;*
&gt; &gt; &gt;
&gt; &gt; &gt; And Vcf.pm stops with:
&gt; &gt; &gt;
&gt; &gt; &gt; Could not parse header line:
&gt; &gt; &gt;
&gt; &gt; &gt;
</div>&gt; &gt;
</div>&gt; GATKCommandLine.VariantFiltration=&lt;ID=VariantFiltration,Version=3.4-46-gbc02625
<div class="message-stanza open"><div class="message-stanza open">&gt; &gt; &gt; .....
&gt; &gt; &gt;
&gt; &gt; &gt; I solved in a similar way removing the quotes from the filter elements:
&gt; &gt; &gt;
&gt; &gt; &gt; *filterExpression=[QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt;
</div>&gt; &gt; -12.5
<div class="message-stanza open">&gt; &gt; &gt; || ReadPosRankSum &lt; -8.0, QUAL &lt; 30.0, QUAL &gt; 30.0 &#38;&#38; QUAL &lt; 100.0]*
&gt; &gt; &gt;
&gt; &gt; &gt; I do not know if it is a problem in the Vcf.pm library or the VCF
</div></div>&gt; format
<div class="message-stanza open">&gt; &gt; is
<div class="message-stanza open">&gt; &gt; &gt; not respected in VariantFiltration.
&gt; &gt; &gt;
&gt; &gt; &gt; Hope this will be useful
&gt; &gt; &gt;
&gt; &gt; &gt; Regards,
&gt; &gt; &gt;
&gt; &gt; &gt; Francesco Musacchia
&gt; &gt; &gt;
&gt; &gt; &gt; --
&gt; &gt; &gt; Francesco Musacchia - Ph.D.
&gt; &gt; &gt; Computational Biology - Bioinformatics Core
&gt; &gt; &gt; Telethon Institute of Genetics and Medicine
&gt; &gt; &gt; Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
&gt; &gt; &gt; Tel. +39 081 19230692
&gt; &gt; &gt; Mobile: +39 349 6396351
&gt; &gt; &gt;
&gt; &gt; &gt;
</div>&gt; &gt;
&gt; &gt;
&gt; &gt; --
&gt; &gt; Francesco Musacchia - Ph.D.
&gt; &gt; Computational Biology - Bioinformatics Core
&gt; &gt; Telethon Institute of Genetics and Medicine
&gt; &gt; Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
&gt; &gt; Tel. +39 081 19230692
&gt; &gt; Mobile: +39 349 6396351
&gt; &gt;
&gt; &gt;
</div>&gt;
&gt;
</div>

-- 
Francesco Musacchia - Ph.D.
Computational Biology - Bioinformatics Core
Telethon Institute of Genetics and Medicine
Via Campi Flegrei 34, 80078 Pozzuoli &#40;NA&#41;, Italy.
Tel. +39 081 19230692
Mobile: +39 349 6396351
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
