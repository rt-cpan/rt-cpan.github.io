<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #70827 for PathTools: [FeatureRequest] Optimise Unix::canonpath</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #70827 for PathTools: [FeatureRequest] Optimise Unix::canonpath</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=PathTools">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=PathTools">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=PathTools">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=PathTools">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PathTools">PathTools CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">70827</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=PathTools">PathTools</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jkeenan [...] cpan.org

<br />
KENTNL [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-24906-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-24907-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




bench_results.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1292725/684945/bench_results.txt">
Sun Nov 24 00:48:00 2013 (5k) by KENTNL [...] cpan.org
</a>
</font></li>
</ul>


benchmark.pl<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/975675/507784/benchmark.pl">
Fri Sep 09 03:33:53 2011 (862b) by KENTNL [...] cpan.org
</a>
</font></li>
</ul>


benchmark_5.19.txt<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1292762/684971/benchmark_5.19.txt">
Sun Nov 24 04:44:32 2013 (3.5k) by KENTNL [...] cpan.org
</a>
</font></li>
</ul>


blurrr1.png<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/975556/507706/blurrr1.png">
Thu Sep 08 21:33:59 2011 (148.2k) by KENTNL [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=70827">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975556" href="/Public/Bug/Display.html?id=70827#txn-975556">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;08&nbsp;21:33:59&nbsp;2011</span>
    <span class="description">KENTNL [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [FeatureRequest] Optimise Unix::canonpath</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/975556/507705/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507705">with headers</a>
<br />
<span class="downloadcontenttype">text/html 696b</span>
</div>
<div class="messagebody">
<div class="message-stanza">XDG/DAGOLDEN Noted last year that File::Spec::Unix::canonpath is a bit of a hotspot, <br>

<br>

indeed, simply doing a directory traversal via File::Next, results in this one method accounting for 30%&nbsp;of the processor time.<br>

<br>

In my test sample, 100,000 files , for which each and every file name needs canonicalizing.
<p>And this effectively results in 600,000 regular expression substitutions being performed.</p>

<p>I would like to see this performance hump Ironed out, even if it means to get the performance I&nbsp;have to load some external XS&nbsp;module.</p>

<p>Attached:&nbsp;Image showing NYTProf -&gt;&nbsp;kcachegrind showing the hotspot and relevant hot lines. </p>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> blurrr1.png</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/975556/507706/blurrr1.png">Download blurrr1.png</a><br />
<span class="downloadcontenttype">image/png 148.2k</span>
</div>
<div class="messagebody">
<img alt="blurrr1.png" title="blurrr1.png" src="/Ticket/Attachment/975556/507706/" /></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975576" href="/Public/Bug/Display.html?id=70827#txn-975576">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;08&nbsp;22:58:05&nbsp;2011</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/975576/507719/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507719">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 543b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I agree that it would be nice to optimize that spot.  But I actually wouldn&#39;t expect it to help as 
much as you predict.  I imagine that when traversing 100K files, almost all the time is spent 
doing system calls, rather than as CPU time in the program.

Additionally, none of those regexes are particularly bad, because 4 of them are anchored, none 
of them capture, and none backtrack &#40;at least not much&#41;.

As a test, perhaps you could replace canonpath&#40;&#41; with a no-op and see how wallclock time is 
affected in your File::Next test.

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975579" href="/Public/Bug/Display.html?id=70827#txn-975579">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;08&nbsp;22:58:07&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975601" href="/Public/Bug/Display.html?id=70827#txn-975601">#</a>      
    </span>
    <span class="date">Thu&nbsp;Sep&nbsp;08&nbsp;23:59:37&nbsp;2011</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/975601/507732/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507732">with headers</a>
<br />
<span class="downloadcontenttype">text/html 3.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza"><p>A&nbsp;proper no-op doesn't prove to be helpful for diagnosing this problem, at least not under File::Next, because if you no-op, file::next never does any traversal.</p>

<p>sub File::Spec::Unix::canonpath {<br>

&nbsp;&nbsp;&nbsp; return &quot;&quot;;<br>

} </p>

<p>for i in $(seq 0 10 ); do time perl newer_depends_than.pl ; done&nbsp; 2&gt;&amp;1 | grep real</p>

<p>real&nbsp;&nbsp;&nbsp; 0m0.344s<br>

real&nbsp;&nbsp;&nbsp; 0m0.340s<br>

real&nbsp;&nbsp;&nbsp; 0m0.338s<br>

real&nbsp;&nbsp;&nbsp; 0m0.337s<br>

real&nbsp;&nbsp;&nbsp; 0m0.341s<br>

real&nbsp;&nbsp;&nbsp; 0m0.341s<br>

real&nbsp;&nbsp;&nbsp; 0m0.336s<br>

real&nbsp;&nbsp;&nbsp; 0m0.341s<br>

real&nbsp;&nbsp;&nbsp; 0m0.340s<br>

real&nbsp;&nbsp;&nbsp; 0m0.341s<br>

real&nbsp;&nbsp;&nbsp; 0m0.341s<br>

&nbsp;</p>

<p>Closest I&nbsp;can get to a usable no-op is:</p>

<p>sub File::Spec::Unix::canonpath {<br>

&nbsp;&nbsp;&nbsp; return $_[1];<br>

}</p>

<p>for i in $(seq 0 10 ); do time perl newer_depends_than.pl ; done&nbsp; 2&gt;&amp;1 | grep real<br>

real&nbsp;&nbsp;&nbsp; 0m1.595s<br>

real&nbsp;&nbsp;&nbsp; 0m1.593s<br>

real&nbsp;&nbsp;&nbsp; 0m1.594s<br>

real&nbsp;&nbsp;&nbsp; 0m1.600s<br>

real&nbsp;&nbsp;&nbsp; 0m1.629s<br>

real&nbsp;&nbsp;&nbsp; 0m1.592s<br>

real&nbsp;&nbsp;&nbsp; 0m1.644s<br>

real&nbsp;&nbsp;&nbsp; 0m1.603s<br>

real&nbsp;&nbsp;&nbsp; 0m1.678s<br>

real&nbsp;&nbsp;&nbsp; 0m1.620s<br>

real&nbsp;&nbsp;&nbsp; 0m1.597s<br>

&nbsp;</p>

<p>And compare vs the stock ::canonpath</p>

<p>&nbsp;</p>

&nbsp;for i in $(seq 0 10 ); do time perl newer_depends_than.pl ; done&nbsp; 2&gt;&amp;1 | grep real<br>

real&nbsp;&nbsp;&nbsp; 0m2.857s<br>

real&nbsp;&nbsp;&nbsp; 0m2.812s<br>

real&nbsp;&nbsp;&nbsp; 0m2.943s<br>

real&nbsp;&nbsp;&nbsp; 0m2.825s<br>

real&nbsp;&nbsp;&nbsp; 0m2.846s<br>

real&nbsp;&nbsp;&nbsp; 0m2.836s<br>

real&nbsp;&nbsp;&nbsp; 0m2.856s<br>

real&nbsp;&nbsp;&nbsp; 0m2.832s<br>

real&nbsp;&nbsp;&nbsp; 0m2.847s<br>

real&nbsp;&nbsp;&nbsp; 0m2.817s<br>

real&nbsp;&nbsp;&nbsp; 0m2.838s
<p>That to me looks strongly like there is a significant amount of performance to be made.</p>

<p>&nbsp;</p>

<p>For a comparison, I&nbsp;did a very basic replacement of canonpath with just the minimal amount of canonicalisation I&nbsp;thought would be needed, </p>

<p>&nbsp; sub File::Spec::Unix::canonpath {<br>

&nbsp;&nbsp;&nbsp; return unless defined $_[1];<br>

&nbsp;&nbsp;&nbsp; return q{/} if $_[1] eq q{/};</p>

<p>&nbsp; #&nbsp;marginally the fastest of <br>

&nbsp;&nbsp;#&nbsp; $path =~ /\/\z//&nbsp; , substr(&nbsp;$path, -1, 1, '' )&nbsp;and $path = substr(&nbsp;$path , .... )<br>

&nbsp;&nbsp;#&nbsp;but this is likely to be perl specific <br>

&nbsp;&nbsp;&nbsp; return substr( $_[1], 0, -1 ) if substr( $_[1], -1, 1 ) eq q{/} ;<br>

&nbsp;&nbsp;&nbsp; return $_[1];<br>

&nbsp; } </p>

<p>for i in $(seq 0 10 ); do time perl newer_depends_than.pl ; done&nbsp; 2&gt;&amp;1 | grep 'real'<br>

real&nbsp;&nbsp;&nbsp; 0m2.401s<br>

real&nbsp;&nbsp;&nbsp; 0m2.384s<br>

real&nbsp;&nbsp;&nbsp; 0m2.507s<br>

real&nbsp;&nbsp;&nbsp; 0m2.472s<br>

real&nbsp;&nbsp;&nbsp; 0m2.388s<br>

real&nbsp;&nbsp;&nbsp; 0m2.369s<br>

real&nbsp;&nbsp;&nbsp; 0m2.378s<br>

real&nbsp;&nbsp;&nbsp; 0m2.392s<br>

real&nbsp;&nbsp;&nbsp; 0m2.389s<br>

real&nbsp;&nbsp;&nbsp; 0m2.379s<br>

real&nbsp;&nbsp;&nbsp; 0m2.398s</p>

<p>&nbsp;</p>

<p>So thats roughly an improvement of&nbsp; 14% over the current implementation, but still 50% slower than&nbsp; a &quot;no-op&quot;. </p>

<p>&nbsp;</p>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975618" href="/Public/Bug/Display.html?id=70827#txn-975618">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;09&nbsp;00:16:25&nbsp;2011</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/975618/507743/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507743">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 326b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Perhaps a better solution would be for File::Next to stop calling canonpath&#40;&#41; every time it gets a 
filename.  Why does it need to?  Shouldn&#39;t it just call canonpath&#40;&#41; on the starting point, and then 
avoid it on all the rest?  It&#39;s in control of the strings it&#39;s creating, it knows it&#39;s not inserting any 
&#34;././&#34; funny stuff.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975641" href="/Public/Bug/Display.html?id=70827#txn-975641">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;09&nbsp;02:38:58&nbsp;2011</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/975641/507757/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507757">with headers</a>
<br />
<span class="downloadcontenttype">text/html 901b</span>
</div>
<div class="messagebody">
<div class="message-stanza">On 2011-09-09 16:16:25, KWILLIAMS wrote: <br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perhaps a better solution would be for File::Next to stop calling <br>

&gt; canonpath() every time it gets a <br>

&gt; filename.  Why does it need to?  Shouldn't it just call canonpath() on <br>

&gt; the starting point, and then <br>

&gt; avoid it on all the rest?  It's in control of the strings it's <br>

&gt; creating, it knows it's not inserting any <br>

&gt; &quot;././&quot; funny stuff. <br>
</div><br>

Ah you see, this is a problem , becuse its not actually calling canonpath()&nbsp;directly, its' calling &quot;catdir&quot;, which is an incredibly common way that most people use to ensure filesystem portable path handling.<br>

<br>

<p>And catdir in turn calls canonpath.</p>

<p>So the only alternative is for File::Next to implement file path concatenation entirely itself, and that to me seems like the wrong approach.</p>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975644" href="/Public/Bug/Display.html?id=70827#txn-975644">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;09&nbsp;03:11:09&nbsp;2011</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/975644/507760/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507760">with headers</a>
<br />
<span class="downloadcontenttype">text/html 956b</span>
</div>
<div class="messagebody">
<div class="message-stanza">By simply replacing catdir with the following:<br>

<br>

sub File::Spec::Unix::catdir {<br>

&nbsp;&nbsp;&nbsp; shift;<br>

&nbsp;&nbsp;&nbsp; return ( join q{/}, @_, '' );<br>

<p>}</p>

<p>&nbsp;</p>

<p>Unsurprisingly, I&nbsp;get the fastest times yet:</p>

<p>for i in $(seq 0 10 ); do time perl newer_depends_than.pl ; done&nbsp; 2&gt;&amp;1&nbsp; | grep 'real'<br>

real&nbsp;&nbsp;&nbsp; 0m1.517s<br>

real&nbsp;&nbsp;&nbsp; 0m1.499s<br>

real&nbsp;&nbsp;&nbsp; 0m1.503s<br>

real&nbsp;&nbsp;&nbsp; 0m1.525s<br>

real&nbsp;&nbsp;&nbsp; 0m1.509s<br>

real&nbsp;&nbsp;&nbsp; 0m1.512s<br>

real&nbsp;&nbsp;&nbsp; 0m1.524s<br>

real&nbsp;&nbsp;&nbsp; 0m1.494s<br>

real&nbsp;&nbsp;&nbsp; 0m1.503s<br>

real&nbsp;&nbsp;&nbsp; 0m1.513s<br>

real&nbsp;&nbsp;&nbsp; 0m1.503s</p>

<p>&nbsp;</p>

<p>Though that solution is hardly portable and will let bad paths exist. *(&nbsp;Its fine for my current usecase, but obviously not fine for all )</p>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975654" href="/Public/Bug/Display.html?id=70827#txn-975654">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;09&nbsp;03:18:25&nbsp;2011</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/975654/507766/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507766">with headers</a>
<br />
<span class="downloadcontenttype">text/html 534b</span>
</div>
<div class="messagebody">
<div class="message-stanza">On 2011-09-09 19:11:09, KENTNL wrote: <br>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; By simply replacing catdir with the following: <br>

&gt;  <br>

&gt; sub File::Spec::Unix::catdir { <br>

&gt; shift; <br>

&gt; return ( join q{/}, @_, '' ); <br>

&gt;  <br>

&gt; } <br>
</div><p>&nbsp;</p>

<p>Gah. My mistake. Its not fine. I&nbsp;just thought it was but didn't check output.<br>

&nbsp;</p>

<p>Needs to be return (&nbsp;join q{/}, @_&nbsp;)&nbsp;&nbsp; to work. </p>

<p>I really need to go and write a proper benchmark testcase for this now :(<br>

&nbsp;</p>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-975675" href="/Public/Bug/Display.html?id=70827#txn-975675">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;09&nbsp;03:33:53&nbsp;2011</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/975675/507783/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/507783">with headers</a>
<br />
<span class="downloadcontenttype">text/html 1.8k</span>
</div>
<div class="messagebody">
<div class="message-stanza">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Rate&nbsp;&nbsp; catdir canonpath hand_catdir hand_canonpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nop<br>

catdir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 157893/s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -35%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -82%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -86%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -95%<br>

canonpath&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 243439/s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 54%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -72%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -79%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -92%<br>

hand_catdir&nbsp;&nbsp;&nbsp;&nbsp; 858907/s&nbsp;&nbsp;&nbsp;&nbsp; 444%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 253%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -25%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -70%<br>

hand_canonpath 1148337/s&nbsp;&nbsp;&nbsp;&nbsp; 627%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 372%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 34%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -60%<br>

nop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2872841/s&nbsp;&nbsp;&nbsp; 1719%&nbsp;&nbsp;&nbsp;&nbsp; 1080%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 234%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 150%&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --<br>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>There we go, some concrete numbers we can rely on. </p>

<p>(&nbsp;I&nbsp;didn't realise this so much earlier, but the validity of results affected how much other work File::Next was doing , argh )</p>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> benchmark.pl</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/975675/507784/benchmark.pl">Download benchmark.pl</a><br />
<span class="downloadcontenttype">text/x-perl 862b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">#!/usr/bin/env perl 

use strict;
use warnings;
# FILENAME: benchmark.pl
# CREATED: 09/09/11 19:18:45 by Kent Fredric &#40;kentnl&#41; &lt;kentfredric@gmail.com&gt;
# ABSTRACT: benchmark file::spec functions

use File::Spec;

sub _do_catdir {
  File::Spec-&gt;catdir&#40;&#39;x&#39;, &#39;y&#39;&#41;;
}
sub _do_canonpath {
  File::Spec-&gt;canonpath&#40;&#39;x/y&#39;&#41;;
}
sub _handrolled_catdir {
  shift;
  join q{/}, @_ ; 
}
sub _handrolled_canonpath {
  return $_[1];
}
sub _do_handrolled_catdir {
  __PACKAGE__-&gt;_handrolled_catdir&#40;&#39;x&#39;, &#39;y&#39; &#41;;
}
sub _do_handrolled_canonpath {
  __PACKAGE__-&gt;_handrolled_canonpath&#40;&#39;x/y&#39;&#41;;
}
sub _do_nop {

}

use Benchmark qw&#40; :all :hireswallclock &#41;;

cmpthese&#40; -2 , {
    nop =&gt; sub { _do_nop },
    catdir =&gt; sub { _do_catdir },
    canonpath =&gt; sub { _do_canonpath },
    hand_catdir =&gt; sub { _do_handrolled_catdir },
    hand_canonpath =&gt; sub { _do_handrolled_canonpath },
}&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1292711" href="/Public/Bug/Display.html?id=70827#txn-1292711">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;00:09:27&nbsp;2013</span>
    <span class="description">jkeenan [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1292711/684933/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/684933">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 663b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Sep 09 03:33:53 2011, KENTNL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Rate catdir canonpath hand_catdir hand_canonpath nop
&gt; catdir 157893/s -- -35% -82% -86% -95%
&gt; canonpath 243439/s 54% -- -72% -79% -92%
&gt; hand_catdir 858907/s 444% 253% -- -25% -70%
&gt; hand_canonpath 1148337/s 627% 372% 34% -- -60%
&gt; nop 2872841/s 1719% 1080% 234% 150% --
&gt; 
&gt; There we go, some concrete numbers we can rely on.
&gt; 
&gt; &#40; I didn&#39;t realise this so much earlier, but the validity of results
&gt; affected
&gt; how much other work File::Next was doing , argh &#41;
</div>

Is there still a case to be made for optimization of File::Spec::Unix::canonpath&#40;&#41;?

If not, is this ticket closable?

Thank you very much.
Jim Keenan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1292725" href="/Public/Bug/Display.html?id=70827#txn-1292725">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;00:48:00&nbsp;2013</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1292725/684944/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/684944">with headers</a>
<br />
<span class="downloadcontenttype">text/html 992b</span>
</div>
<div class="messagebody">
<div class="message-stanza"><p>
	Seems the performance is much better these days.</p>

<p>
	&nbsp;</p>

<p>
	Did a test bench from 5.8.9 all the way through to 5.19.6</p>

<p>
	&nbsp;</p>

<p>
	catdir hovered around 300k calls per second<br>

	canonpath hovered around 500k calls per second all the way up to 5.19.0</p>

<p>
	&nbsp;</p>

<p>
	But somewhere after the 5.19.0 , the performance grows substantailly:</p>

<p>
	&nbsp;</p>

<p>
	5.19.5 and 5.19.6:</p>

<p>
	catdir 750k calls/sec</p>

<p>
	canonpath :&nbsp; 2.1 Million calls/sec</p>

<p>
	The exact place I&#39;m not sure, but my suspicions are COW is to blame for the performance boost ( I only didn&#39;t test anything between 5.19.5 and 5.19.0 because I didn&#39;t have those targets ready built ).</p>

<p>
	&nbsp;</p>

<p>
	There&#39;s still room for improvement, but the room is much narrower:</p>

<p>
	hand-written catdir only 129% of catdir&nbsp; ( was ~400% )</p>

<p>
	hand-written canon path only ~5-20% faster than canonpath ( was ~400% )</p>

<p>
	&nbsp;</p>


</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bench_results.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1292725/684945/bench_results.txt">Download bench_results.txt</a><br />
<span class="downloadcontenttype">text/plain 5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">5.10.0-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          301591/s       --      -35%        -81%           -87%      -95%
canonpath       463494/s      54%        --        -71%           -80%      -92%
hand_catdir    1584500/s     425%      242%          --           -31%      -74%
hand_canonpath 2307768/s     665%      398%         46%             --      -63%
nop            6174903/s    1947%     1232%        290%           168%        --


5.10.1-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          306376/s       --      -47%        -79%           -89%      -95%
canonpath       579231/s      89%        --        -60%           -79%      -91%
hand_catdir    1456068/s     375%      151%          --           -46%      -77%
hand_canonpath 2717946/s     787%      369%         87%             --      -57%
nop            6273530/s    1948%      983%        331%           131%        --


5.12.5-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          322531/s       --      -42%        -81%           -86%      -96%
canonpath       555013/s      72%        --        -68%           -76%      -93%
hand_catdir    1739107/s     439%      213%          --           -24%      -78%
hand_canonpath 2279513/s     607%      311%         31%             --      -71%
nop            7837304/s    2330%     1312%        351%           244%        --


5.14.4-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          311909/s       --      -38%        -82%           -88%      -95%
canonpath       504123/s      62%        --        -71%           -80%      -91%
hand_catdir    1756235/s     463%      248%          --           -32%      -70%
hand_canonpath 2579576/s     727%      412%         47%             --      -55%
nop            5761168/s    1747%     1043%        228%           123%        --


5.16.3-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          241434/s       --      -39%        -78%           -84%      -97%
canonpath       393214/s      63%        --        -64%           -74%      -95%
hand_catdir    1095264/s     354%      179%          --           -28%      -85%
hand_canonpath 1522138/s     530%      287%         39%             --      -79%
nop            7159443/s    2865%     1721%        554%           370%        --


5.18.0-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          340172/s       --      -34%        -79%           -86%      -94%
canonpath       519248/s      53%        --        -68%           -79%      -91%
hand_catdir    1602636/s     371%      209%          --           -36%      -71%
hand_canonpath 2493232/s     633%      380%         56%             --      -56%
nop            5605114/s    1548%      979%        250%           125%        --


5.19.0-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          305077/s       --      -36%        -80%           -87%      -95%
canonpath       477293/s      56%        --        -69%           -80%      -91%
hand_catdir    1516860/s     397%      218%          --           -36%      -73%
hand_canonpath 2384597/s     682%      400%         57%             --      -57%
nop            5557740/s    1722%     1064%        266%           133%        --


5.19.5-pristine
==========
                    Rate   catdir hand_catdir canonpath hand_canonpath       nop
catdir          740250/s       --        -52%      -65%           -71%      -88%
hand_catdir    1550545/s     109%          --      -27%           -40%      -75%
canonpath      2130975/s     188%         37%        --           -17%      -66%
hand_canonpath 2565655/s     247%         65%       20%             --      -59%
nop            6201842/s     738%        300%      191%           142%        --


5.19.6-pristine
==========
                    Rate   catdir hand_catdir canonpath hand_canonpath       nop
catdir          751539/s       --        -56%      -67%           -68%      -88%
hand_catdir    1720728/s     129%          --      -25%           -27%      -73%
canonpath      2296673/s     206%         33%        --            -2%      -64%
hand_canonpath 2347248/s     212%         36%        2%             --      -63%
nop            6347759/s     745%        269%      176%           170%        --


5.8.9-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          323371/s       --      -30%        -79%           -84%      -94%
canonpath       463698/s      43%        --        -71%           -77%      -91%
hand_catdir    1571944/s     386%      239%          --           -20%      -71%
hand_canonpath 1976612/s     511%      326%         26%             --      -63%
nop            5400609/s    1570%     1065%        244%           173%        --
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1292759" href="/Public/Bug/Display.html?id=70827#txn-1292759">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;04:43:52&nbsp;2013</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1292759/684966/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/684966">with headers</a>
<br />
<span class="downloadcontenttype">text/html 405b</span>
</div>
<div class="messagebody">
<div class="message-stanza"><p>
	Further benching shows the tipping point is 5.19.3.</p>

<p>
	So not COW, but its been improved =)</p>

<p>
	&nbsp;</p>

<p>
	5019003delta :</p>

<p>
	+=item *<br>

	+<br>

	+L&lt;File::Spec&gt; has been upgraded from 3.41 to 3.44.<br>

	+<br>

	+The module is now partly implemented in XS, for performance.<br>

	+<br>

	&nbsp;</p>

<p>
	So looking forward to seeing those changes hit CPAN =).</p>


</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1292762" href="/Public/Bug/Display.html?id=70827#txn-1292762">#</a>      
    </span>
    <span class="date">Sun&nbsp;Nov&nbsp;24&nbsp;04:44:32&nbsp;2013</span>
    <span class="description">KENTNL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="messagebody">
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> benchmark_5.19.txt</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1292762/684971/benchmark_5.19.txt">Download benchmark_5.19.txt</a><br />
<span class="downloadcontenttype">text/plain 3.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">5.19.0-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          337317/s       --      -37%        -81%           -85%      -95%
canonpath       538842/s      60%        --        -70%           -76%      -92%
hand_catdir    1804526/s     435%      235%          --           -21%      -74%
hand_canonpath 2285684/s     578%      324%         27%             --      -67%
nop            6830032/s    1925%     1168%        278%           199%        --


5.19.1-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          275581/s       --      -50%        -85%           -90%      -96%
canonpath       548746/s      99%        --        -70%           -80%      -93%
hand_catdir    1816513/s     559%      231%          --           -34%      -75%
hand_canonpath 2735414/s     893%      398%         51%             --      -63%
nop            7395070/s    2583%     1248%        307%           170%        --


5.19.2-pristine
==========
                    Rate   catdir canonpath hand_catdir hand_canonpath       nop
catdir          273763/s       --      -49%        -85%           -89%      -96%
canonpath       536996/s      96%        --        -71%           -79%      -92%
hand_catdir    1852370/s     577%      245%          --           -29%      -73%
hand_canonpath 2596848/s     849%      384%         40%             --      -62%
nop            6816368/s    2390%     1169%        268%           162%        --


5.19.3-pristine
==========
                    Rate   catdir hand_catdir canonpath hand_canonpath       nop
catdir          775271/s       --        -55%      -63%           -69%      -87%
hand_catdir    1708119/s     120%          --      -19%           -32%      -72%
canonpath      2118067/s     173%         24%        --           -16%      -65%
hand_canonpath 2520615/s     225%         48%       19%             --      -59%
nop            6120335/s     689%        258%      189%           143%        --


5.19.4-pristine
==========
                    Rate   catdir hand_catdir canonpath hand_canonpath       nop
catdir          794299/s       --        -52%      -63%           -67%      -88%
hand_catdir    1641139/s     107%          --      -24%           -32%      -76%
canonpath      2155368/s     171%         31%        --           -11%      -69%
hand_canonpath 2424831/s     205%         48%       13%             --      -65%
nop            6893590/s     768%        320%      220%           184%        --


5.19.5-pristine
==========
                    Rate   catdir hand_catdir canonpath hand_canonpath       nop
catdir          780198/s       --        -47%      -66%           -70%      -88%
hand_catdir    1486080/s      90%          --      -36%           -42%      -77%
canonpath      2325129/s     198%         56%        --           -10%      -63%
hand_canonpath 2582699/s     231%         74%       11%             --      -59%
nop            6351948/s     714%        327%      173%           146%        --


5.19.6-pristine
==========
                    Rate   catdir hand_catdir canonpath hand_canonpath       nop
catdir          805940/s       --        -54%      -63%           -72%      -89%
hand_catdir    1767778/s     119%          --      -19%           -38%      -76%
canonpath      2185156/s     171%         24%        --           -23%      -71%
hand_canonpath 2848126/s     253%         61%       30%             --      -62%
nop            7487591/s     829%        324%      243%           163%        --
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1294209" href="/Public/Bug/Display.html?id=70827#txn-1294209">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Tue&nbsp;Nov&nbsp;26&nbsp;18:39:10&nbsp;2013</span>
    <span class="description">jkeenan [...] cpan.org -  Requestor JKEENAN added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.686099</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
