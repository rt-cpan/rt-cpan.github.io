<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #22365 for POE-Filter-XML: Empty subroutine prototypes</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #22365 for POE-Filter-XML: Empty subroutine prototypes</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/POE-Filter-XML/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/POE-Filter-XML/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/POE-Filter-XML/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/POE-Filter-XML/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/POE-Filter-XML">POE-Filter-XML CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">22365</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/POE-Filter-XML/Active/">POE-Filter-XML</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">nperez [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
ewaters [...] uarc.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-26738-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-26739-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;11:59:14&nbsp;2006</span>
    <span class="description">ewaters [...] uarc.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Empty subroutine prototypes</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 20 Oct 2006 09:58:25 -0600</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> via RT &lt;bug-POE-Filter-XML [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Eric Waters &lt;ewaters [...] uarc.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Before I report another bug I&#39;d like to say that I appreciate the work you&#39;ve done on this software.  I use this and a heavily modified POE::Component::Jabber &#40;I&#39;ll show you the modifications at a later date&#41; in an app I&#39;ve been working on for the last few months.

This bug applies to almost all the code you write.  It appears that a style decision that you made &#40;probably a long time ago&#41; now causes compile-time errors in Perl v5.8.8 &#40;and earlier versions, not sure how far back&#41;.

It&#39;s also possible that this is a deliberate choice of yours.

The problem is that every subroutine you write has an empty prototype:

    sub get_id&#40;&#41;
    {
        my $self = shift;

        return $self-&gt;[+id];
    }

Normally this isn&#39;t an issue, as you call your subroutines as methods &#40;$node-&gt;get_id&#40;&#41;&#41;, and according to perlsub, method calls are not influenced by prototypes.  But if you called it as a subroutine &#40;so prototypes can be checked at compile time&#41;, you&#39;d get a compiletime error:
 
    #!/usr/bin/perl

    use strict;
    use warnings;

    sub increment&#40;&#41;
    {
        my $x = shift;

        return $x + 1;
    }

    my $number = increment&#40;5&#41;;
    print &#34;Have number $number\n&#34;;

Results in:

    Too many arguments for main::increment at ./prototype_test.pl line 13, near &#34;5&#41;&#34;
    Execution of ./prototype_test.pl aborted due to compilation errors.

If the only way you ever called these subroutines was as class methods, then this would never come up &#40;the empty prototype would never be evaluated&#41;.  You seem to have avoided this in the example of POE::Filter::XML::Node.pm by declaring data&#40;&#41; &#40;which calls _encode&#40;&#41; and _decode&#40;&#41;&#41; before _encode&#40;&#41; and _decode&#40;&#41; &#40;since the subroutines occur after their usage, they can&#39;t be checked at compile time&#41;, this means that no function below _decode&#40;&#41; can use _decode&#40;$value&#41; as such would result in compile time error.

Maybe this was all deliberate.  This could be a means to enforce privitization of class methods from public usage &#40;POE::Filter::XML::Node::_encode&#40;$data&#41; can never succeed&#41;, but it feels very klunky.  Seems like other Perl techniques would be better suited for private class methods.

Nevertheless, in my opinion it is a flaw in the code that&#39;s trival to fix and would make the code more usable.

Eric
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/253236/109147/">Download &#40;untitled&#41;</a><br />
<span class="downloadcontenttype">application/pgp-signature 189b</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;15:26:50&nbsp;2006</span>
    <span class="description">nperez [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">PCJ itself will probably also get touched this weekend to expose more 
of its guts during the whole negotiation/setup process including events 
that get fired when certain things happen. It has been a short coming 
that I have wanted to address for awhile now. Punjab &#40;XMLRPC-to-Jabber&#41; 
makes use of PCJ and a couple of ajax-y webapps make use of Punjab, and 
there really is no way to get current connection state information from 
PCJ to Punjab to webapp so you can&#39;t even have a progress bar. PCJ also 
is a very complex monolithic monster. All of the Client classes need to 
be refactored into a single class and various methods and pieces should 
be pushed out into subclasses to cut down the amount of copy paste 
&#40;sigh&#41; that needs to be done when there are changes. POE doesn&#39;t make 
subclassing very easy, and the whole object states thing feels ugly. 
Ideally, I would like to rewrite PCJ. I would love to see your 
modifications and see how they fit into my idea on how things should 
look.

Anyhow, addressing your empty prototype comments, yes, it was a means 
of privitization and deliberate. Klunky is certainly one way of 
describing it, but at the time, it just worked &#40;and still does ;&#41;. And 
yes, encode/decode were positioned so it would work internally, heh. 
There are a plethora of techniques for putting locks on the kitchen 
doors including inside out objects and what not, but they still don&#39;t 
really solve the problem, but add a layer of complexity. If you really 
really still wanted to invade the kitchen space of an inside out 
object, you still can. Could you go in and remove all of those empty 
prototypes? Sure. Then you could pass around the object and arguments 
into the subs and things would still work. But if the intention was to 
have an OO developed class to have subs executed in an OO method 
context, why allow that kind of usage? It is a little hack, I will give 
you that. And to be honest with you too, some of that code in there has 
seen its share of bitrot. Originally the _encode&#40;&#41;/_decode&#40;&#41; mechanism 
came from DJ Adams Jabber code. It really should be done with an eye 
more toward XML compliance rather than &#34;what is the minimum I need to 
do to make sure XML parsers don&#39;t barf.&#34; That is something I intend to 
explore this weekend some. 

As for more usable, it might make sense to revisit the Utils package 
and move the _encode&#40;&#41;/_decode&#40;&#41; out there. There are probably some 
more little things like that should populate that package, too.


On Fri Oct 20 11:59:14 2006, ewaters@uarc.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Before I report another bug I&#39;d like to say that I appreciate the work
&gt;    you&#39;ve done on this software.  I use this and a heavily modified
&gt;    POE::Component::Jabber &#40;I&#39;ll show you the modifications at a later
&gt;    date&#41; in an app I&#39;ve been working on for the last few months.
&gt; 
&gt; This bug applies to almost all the code you write.  It appears that a
&gt;    style decision that you made &#40;probably a long time ago&#41; now causes
&gt;    compile-time errors in Perl v5.8.8 &#40;and earlier versions, not sure
&gt;    how far back&#41;.
&gt; 
&gt; It&#39;s also possible that this is a deliberate choice of yours.
&gt; 
&gt; The problem is that every subroutine you write has an empty prototype:
&gt; 
&gt;     sub get_id&#40;&#41;
&gt;     {
&gt;         my $self = shift;
&gt; 
&gt;         return $self-&gt;[+id];
&gt;     }
&gt; 
&gt; Normally this isn&#39;t an issue, as you call your subroutines as methods
&gt;    &#40;$node-&gt;get_id&#40;&#41;&#41;, and according to perlsub, method calls are not
&gt;    influenced by prototypes.  But if you called it as a subroutine &#40;so
&gt;    prototypes can be checked at compile time&#41;, you&#39;d get a compiletime
&gt;    error:
&gt; 
&gt;     #!/usr/bin/perl
&gt; 
&gt;     use strict;
&gt;     use warnings;
&gt; 
&gt;     sub increment&#40;&#41;
&gt;     {
&gt;         my $x = shift;
&gt; 
&gt;         return $x + 1;
&gt;     }
&gt; 
&gt;     my $number = increment&#40;5&#41;;
&gt;     print &#34;Have number $number\n&#34;;
&gt; 
&gt; Results in:
&gt; 
&gt;     Too many arguments for main::increment at ./prototype_test.pl line
&gt;    13, near &#34;5&#41;&#34;
&gt;     Execution of ./prototype_test.pl aborted due to compilation
&gt;    errors.
&gt; 
&gt; If the only way you ever called these subroutines was as class
&gt;    methods, then this would never come up &#40;the empty prototype would
&gt;    never be evaluated&#41;.  You seem to have avoided this in the example
&gt;    of POE::Filter::XML::Node.pm by declaring data&#40;&#41; &#40;which calls
&gt;    _encode&#40;&#41; and _decode&#40;&#41;&#41; before _encode&#40;&#41; and _decode&#40;&#41; &#40;since the
&gt;    subroutines occur after their usage, they can&#39;t be checked at
&gt;    compile time&#41;, this means that no function below _decode&#40;&#41; can use
&gt;    _decode&#40;$value&#41; as such would result in compile time error.
&gt; 
&gt; Maybe this was all deliberate.  This could be a means to enforce
&gt;    privitization of class methods from public usage
&gt;    &#40;POE::Filter::XML::Node::_encode&#40;$data&#41; can never succeed&#41;, but it
&gt;    feels very klunky.  Seems like other Perl techniques would be
&gt;    better suited for private class methods.
&gt; 
&gt; Nevertheless, in my opinion it is a flaw in the code that&#39;s trival to
&gt;    fix and would make the code more usable.
&gt; 
&gt; Eric
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;20&nbsp;15:26:52&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;26&nbsp;23:51:27&nbsp;2006</span>
    <span class="description">nperez [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Oct&nbsp;27&nbsp;10:15:02&nbsp;2006</span>
    <span class="description">nperez [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
