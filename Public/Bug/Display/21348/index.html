<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21348 for Win32-Exe: Cannot found Win32::Exe::PE::Header::PE32Plus in win2003 R2 &#40;X64&#41; + CYGWIN</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21348 for Win32-Exe: Cannot found Win32::Exe::PE::Header::PE32Plus in win2003 R2 &#40;X64&#41; + CYGWIN</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Win32-Exe/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Win32-Exe/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Win32-Exe/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Win32-Exe/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-Exe">Win32-Exe CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21348</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Win32-Exe/Active/">Win32-Exe</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
john.xu [...] dothill.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35514-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-35515-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;06&nbsp;06:43:50&nbsp;2006</span>
    <span class="description">john.xu [...] dothill.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Cannot found Win32::Exe::PE::Header::PE32Plus in win2003 R2 &#40;X64&#41; + CYGWIN</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 06 Sep 2006 18:49:17 +0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-Exe [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;john.xu&#34; &lt;john.xu [...] dothill.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>

<div class="messagebody">
<img alt="pe32plus.gif" title="pe32plus.gif" src="/Ticket/Attachment/238461/100656/" /></div>
</div>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I am using the Win32::Exe module to get one exe file information. but I
encount below problem.

Here is the error message.
Can&#39;t locate object method &#34;load&#34; via package
&#34;Win32::Exe::PE::Header::PE32Plus&#34; at
/usr/lib/perl5/site_perl/5.8.0/Parse/Binary.pm line 484.

All I know information about the test:

my machine is win2k3 R2, and cpu is AMD64. I attached an snapshot of my
system info. I also attached the diskraid.exe file, but I renamed it to
diskraid.e_.

The Win32::Exe module version is: Win32-Exe-0.09.tar.gz, I download it
from CPAN.

$ uname -a
CYGWIN_NT-5.2 x64-w2k3-john 1.5.5&#40;0.94/3/2&#41; 2003-09-20 16:31 i686
unknown unknown Cygwin

root@x64-w2k3-john /cygdrive/f/workspace/si/vds_tester
$ perl -v

This is perl, v5.8.0 built for cygwin-multi-64int

Copyright 1987-2002, Larry Wall

Perl may be copied only under the terms of either the Artistic License
or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using `man perl&#39; or `perldoc perl&#39;. If you have access to the
Internet, point your browser at <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perl.com/">http://www.perl.com/</a></span>, the Perl Home Page.

$ set
!D:=&#39;D:\cygwin\bin&#39;
!EXITCODE=00000000
ALLUSERSPROFILE=&#39;D:\Documents and Settings\All Users&#39;
APPDATA=&#39;D:\Documents and Settings\Administrator\Application Data&#39;
BASH=/usr/bin/bash
BASH_VERSINFO=&#40;[0]=&#34;2&#34; [1]=&#34;05b&#34; [2]=&#34;0&#34; [3]=&#34;1&#34; [4]=&#34;release&#34;
[5]=&#34;i686-pc-cygwin&#34;&#41;
BASH_VERSION=&#39;2.05b.0&#40;1&#41;-release&#39;
CLUSTERLOG=&#39;D:\WINDOWS\Cluster\cluster.log&#39;
COLUMNS=95
COMMONPROGRAMFILES=&#39;D:\Program Files &#40;x86&#41;\Common Files&#39;
COMMONPROGRAMFILES&#40;X86&#41;=&#39;D:\Program Files &#40;x86&#41;\Common Files&#39;
COMMONPROGRAMW6432=&#39;D:\Program Files\Common Files&#39;
COMPUTERNAME=X64-W2K3-JOHN
COMSPEC=&#39;D:\WINDOWS\system32\cmd.exe&#39;
CVS_RSH=/bin/ssh
DIRSTACK=&#40;&#41;
EUID=500
FP_NO_HOST_CHECK=NO
GROUPS=&#40;&#41;
HISTFILE=/home/Administrator/.bash_history
HISTFILESIZE=500
HISTSIZE=500
HOME=/home/Administrator
HOMEDRIVE=D:
HOMEPATH=&#39;\Documents and Settings\Administrator&#39;
HOSTNAME=x64-w2k3-john
HOSTTYPE=i686
IFS=$&#39; \t\n&#39;
INFOPATH=/usr/local/info:/usr/info:/usr/share/info:/usr/autotool/devel/info:/usr/autotool/stable/inf
o:
JAVA_HOME=&#39;F:\j2sdk1.4.2&#39;
LINES=33
LOGONSERVER=&#39;\\X64-W2K3-JOHN&#39;
MACHTYPE=i686-pc-cygwin
MAILCHECK=60
MAKE_MODE=unix
MANPATH=/usr/local/man:/usr/man:/usr/share/man:/usr/autotool/devel/man::/usr/X11R6/man:/usr/ssl/man
NUMBER_OF_PROCESSORS=2
OLDPWD=/home/Administrator
OPTERR=1
OPTIND=1
OS=Windows_NT
OSTYPE=cygwin
PATH=&#39;/usr/local/bin:/usr/bin:/bin:/usr/X11R6/bin:/cygdrive/d/WINDOWS/system32:/cygdrive/d/WINDOWS:/
cygdrive/d/WINDOWS/System32/Wbem:/cygdrive/d/Program Files
&#40;x86&#41;/Microsoft Visual Studio 8/Common7/I
DE/:/cygdrive/f/j2sdk1.4.2/bin&#39;
PATHEXT=&#39;.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH&#39;
PIPESTATUS=&#40;[0]=&#34;0&#34;&#41;
PKG_CONFIG_PATH=:/usr/X11R6/lib/pkgconfig
PPID=1
PRINTER=&#39;\\ROSE-TAN\hp LaserJet 1320 PCL 6&#39;
PROCESSOR_ARCHITECTURE=x86
PROCESSOR_ARCHITEW6432=AMD64
PROCESSOR_IDENTIFIER=&#39;AMD64 Family 15 Model 35 Stepping 2, AuthenticAMD&#39;
PROCESSOR_LEVEL=15
PROCESSOR_REVISION=2302
PROGRAMFILES=&#39;D:\Program Files &#40;x86&#41;&#39;
PROGRAMFILES&#40;X86&#41;=&#39;D:\Program Files &#40;x86&#41;&#39;
PROGRAMW6432=&#39;D:\Program Files&#39;
PROMPT=&#39;$P$G&#39;
PS1=$&#39;\\[\\033]0;\\w\\007\n\\033[32m\\]\\u@\\h
\\[\\033[33m\\w\\033[0m\\]\n$ &#39;
PS2=&#39;&gt; &#39;
PS4=&#39;+ &#39;
PWD=/cygdrive/f/workspace/si/vds_tester
SESSIONNAME=Console
SHELL=/bin/bash
SHELLOPTS=braceexpand:emacs:hashall:histexpand:history:interactive-comments:monitor
SHLVL=1
SYSTEMDRIVE=D:
SYSTEMROOT=&#39;D:\WINDOWS&#39;
TEMP=/cygdrive/d/DOCUME~1/ADMINI~1/LOCALS~1/Temp
TERM=cygwin
TEXMF=&#39;{/usr/share/lilypond/2.0.1,/usr/share/texmf}&#39;
TMP=/cygdrive/d/DOCUME~1/ADMINI~1/LOCALS~1/Temp
UID=500
USER=root
USERDOMAIN=X64-W2K3-JOHN
USERNAME=Administrator
USERPROFILE=&#39;D:\Documents and Settings\Administrator&#39;
VS80COMNTOOLS=&#39;D:\Program Files &#40;x86&#41;\Microsoft Visual Studio
8\Common7\Tools\&#39;
WINDIR=&#39;D:\WINDOWS&#39;
X11PATH=/usr/X11R6/bin
_=-v
datadir=/usr/share/lilypond/2.0.1
f=


May perl code is:
use Win32::Exe
my $diskraid_exe =
Win32::Exe-&gt;new&#40;&#34;/cygdrive/f/j2sdk1.4.2/bin/diskraid.exe&#34;&#41;;
my $currVer = $diskraid_exe-&gt;version_info-&gt;get&#40;&#39;FileVersion&#39;&#41;;


And I found here no PE32Plus.pm file exist, here only PE32.pm exist.

Thanks,
John
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;09&nbsp;13:23:41&nbsp;2010</span>
    <span class="description">csjewell [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It turns out that PE32Plus is the format for 64-bit executables.

And unfortunately, the ability to handle it is still not included in
Win32::Exe. That module could be added by another distribution if need
be, I think.

&#40;I&#39;m looking at Win32::Exe 0.11&#41;

Let me see if I can find some documentation on the format and get back
to everybody involved - maybe with a .pm file ready to plug in.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;09&nbsp;13:23:44&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;25&nbsp;05:03:54&nbsp;2010</span>
    <span class="description">kmx [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza"><pre>
Hi Curtis,

I have successfully patched Win32::Exe - please find enclosed
PE32Plus.pm and copy it into:
Win32-Exe-0.11\lib\Win32\Exe\PE\Header\PE32Plus.pm

In the end it was quite easy - very simple customising &quot;constant
SUBFORMAT&quot; according PE+ specification.

I have tested just very briefly but it seems to work well.

--
kmx
</pre>
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> PE32Plus.pm</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">package Win32::Exe::PE::Header::PE32Plus;

use strict;
use base &#39;Win32::Exe::PE::Header&#39;;
use constant SUBFORMAT =&gt; &#40;
    ImageBase		=&gt; &#39;a8&#39;,
    SectionAlign	=&gt; &#39;V&#39;,
    FileAlign		=&gt; &#39;V&#39;,
    OSMajor		=&gt; &#39;v&#39;,
    OSMinor		=&gt; &#39;v&#39;,
    UserMajor		=&gt; &#39;v&#39;,
    UserMinor		=&gt; &#39;v&#39;,
    SubsysMajor		=&gt; &#39;v&#39;,
    SubsysMinor		=&gt; &#39;v&#39;,
    _			=&gt; &#39;a4&#39;,
    ImageSize		=&gt; &#39;V&#39;,
    HeaderSize		=&gt; &#39;V&#39;,
    FileChecksum	=&gt; &#39;V&#39;,
    SubsystemTypeId	=&gt; &#39;v&#39;,
    DLLFlags		=&gt; &#39;v&#39;,
    StackReserve	=&gt; &#39;a8&#39;,
    StackCommit		=&gt; &#39;a8&#39;,
    HeapReserve		=&gt; &#39;a8&#39;,
    HeapCommit		=&gt; &#39;a8&#39;,
    LoaderFlags		=&gt; &#39;V&#39;,
    NumDataDirs		=&gt; &#39;V&#39;,
    &#39;DataDirectory&#39;	=&gt; [
	&#39;a8&#39;, &#39;{$NumDataDirs}&#39;, 1
    ],
    &#39;Section&#39;		=&gt; [
	&#39;a40&#39;, &#39;{$NumSections}&#39;, 1
    ],
    Data		=&gt; &#39;a*&#39;,
&#41;;

#######
#Constant					Value	Description
#IMAGE_SUBSYSTEM_UNKNOWN			0	An unknown subsystem
#IMAGE_SUBSYSTEM_NATIVE	  			1	Device drivers and native Windows processes
#IMAGE_SUBSYSTEM_WINDOWS_GUI			2	The Windows graphical user interface &#40;GUI&#41; subsystem
#IMAGE_SUBSYSTEM_WINDOWS_CUI			3	The Windows character subsystem
#IMAGE_SUBSYSTEM_POSIX_CUI			7	The Posix character subsystem
#IMAGE_SUBSYSTEM_WINDOWS_CE_GUI	  		9	Windows CE
#IMAGE_SUBSYSTEM_EFI_APPLICATION		10	An Extensible Firmware Interface &#40;EFI&#41; application
#IMAGE_SUBSYSTEM_EFI_BOOT_ SERVICE_DRIVER	11	An EFI driver with boot services
#IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER		12	An EFI driver with run-time services
#IMAGE_SUBSYSTEM_EFI_ROM			13	An EFI ROM image
#IMAGE_SUBSYSTEM_XBOX				14	XBOX
use constant SUBSYSTEM_TYPES =&gt; [qw&#40;
    _	    native	windows	    console	_
    _	    _		posix	    _		windowsce
&#41;];

use constant ST_TO_ID =&gt; {
    map { &#40;SUBSYSTEM_TYPES-&gt;[$_] =&gt; $_&#41; } &#40;0 .. $#{+SUBSYSTEM_TYPES}&#41;
};
use constant ID_TO_ST =&gt; { reverse %{+ST_TO_ID} };

sub st_to_id {
    my &#40;$self, $name&#41; = @_;
    return $name unless $name =~ /\D/;
    return&#40;+ST_TO_ID-&gt;{lc&#40;$name&#41;} || die &#34;No such type: $name&#34;&#41;;
}

sub id_to_st {
    my &#40;$self, $id&#41; = @_;
    return&#40;+ID_TO_ST-&gt;{$id} || $id&#41;;
}

sub Subsystem {
    my &#40;$self&#41; = @_;
    return $self-&gt;id_to_st&#40;$self-&gt;SubsystemTypeId&#41;;
}

sub SetSubsystem {
    my &#40;$self, $type&#41; = @_;
    $self-&gt;SetSubsystemTypeId&#40;$self-&gt;st_to_id&#40;$type&#41;&#41;;
}

1;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;25&nbsp;16:15:12&nbsp;2010</span>
    <span class="description">csjewell [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Mar 25 05:03:54 2010, KMX wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Curtis,
&gt; 
&gt; I have successfully patched Win32::Exe - please find enclosed
&gt; PE32Plus.pm and copy it into:
&gt; Win32-Exe-0.11\lib\Win32\Exe\PE\Header\PE32Plus.pm
&gt; 
&gt; In the end it was quite easy - very simple customising &#34;constant
&gt; SUBFORMAT&#34; according PE+ specification.
&gt; 
&gt; I have tested just very briefly but it seems to work well.
</div>
This file is now in the svn for this &#40;which is at
svn.ali.as/cpan/trunk/Win32-Exe&#41; and I just want to write a test that
uses this before I make a release.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;23&nbsp;08:41:53&nbsp;2010</span>
    <span class="description">mdootson [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

I asked on the PAR list if anyone was working on Win32::Exe. For some 
reason which now seems a bit stupid, I didn&#39;t think to look on the 
Win32::Exe bug list until after I&#39;d completed a chunk of work.

Anyhow, having done much the same work as KMX with regard to PE+, there 
is a developer release on CPAN - 0.12_01

The difference between the two implementations is that I have used quads 
in the pack / unpack format instead of &#39;a8&#39;. This means that my 
implementation will only parse PE+ images on a 64 bit Perl.

I&#39;d like to be able to parse PE+ files on a 32 bit Perl - and I think 
all the quads are just file offsets so the significant part would not 
overflow in 32 bit Perl. The offsets change, of course, every time you 
write out a PE+ file. I know as far as pack is concerned a8 will be the 
same as a quad. It&#39;s using and recalculating the quad value in a 32 bit 
Perl that concerns me.

So, I&#39;ve gone for the easy solution - only parse PE+ images on 64 bit 
Perl.

The major part of the release is work on manifest handling - which was 
broken. As KMX pointed out, PE+ is straightforward once you find the 
spec.


Mark

On Thu Mar 25 16:15:12 2010, CSJEWELL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Mar 25 05:03:54 2010, KMX wrote:
<div class="message-stanza open">&gt; &gt; Hi Curtis,
&gt; &gt; 
&gt; &gt; I have successfully patched Win32::Exe - please find enclosed
&gt; &gt; PE32Plus.pm and copy it into:
&gt; &gt; Win32-Exe-0.11\lib\Win32\Exe\PE\Header\PE32Plus.pm
&gt; &gt; 
&gt; &gt; In the end it was quite easy - very simple customising &#34;constant
&gt; &gt; SUBFORMAT&#34; according PE+ specification.
&gt; &gt; 
&gt; &gt; I have tested just very briefly but it seems to work well.
</div>&gt; 
&gt; This file is now in the svn for this &#40;which is at
&gt; svn.ali.as/cpan/trunk/Win32-Exe&#41; and I just want to write a test that
&gt; uses this before I make a release.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Apr&nbsp;23&nbsp;12:14:32&nbsp;2010</span>
    <span class="description">mdootson [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

Just a note re my previous info regarding Quads.

The five elements that use Quads in the PE+ structure will never be 
changed by Parse binary - and therefore never used in calculation. I was 
wrong to assume they were address offsets.

Which means - &#39;a8&#39; as a pack format will be fine - I&#39;ll use it in any 
actual release.

On Thu Mar 25 16:15:12 2010, CSJEWELL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Mar 25 05:03:54 2010, KMX wrote:
<div class="message-stanza open">&gt; &gt; Hi Curtis,
&gt; &gt; 
&gt; &gt; I have successfully patched Win32::Exe - please find enclosed
&gt; &gt; PE32Plus.pm and copy it into:
&gt; &gt; Win32-Exe-0.11\lib\Win32\Exe\PE\Header\PE32Plus.pm
&gt; &gt; 
&gt; &gt; In the end it was quite easy - very simple customising &#34;constant
&gt; &gt; SUBFORMAT&#34; according PE+ specification.
&gt; &gt; 
&gt; &gt; I have tested just very briefly but it seems to work well.
</div>&gt; 
&gt; This file is now in the svn for this &#40;which is at
&gt; svn.ali.as/cpan/trunk/Win32-Exe&#41; and I just want to write a test that
&gt; uses this before I make a release.
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;28&nbsp;11:47:22&nbsp;2010</span>
    <span class="description">mdootson [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Fixed in version 0.13. Used kmx&#39;s pack template &#40;a8&#41; for quads.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Apr&nbsp;28&nbsp;11:47:23&nbsp;2010</span>
    <span class="description">mdootson [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
