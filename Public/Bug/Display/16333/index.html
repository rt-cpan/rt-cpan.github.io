<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #16333 for XML-LibXML: Won&#39;t compile with Libxml that doesn&#39;t have HTML parser. htmlDocPtr undefined</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #16333 for XML-LibXML: Won&#39;t compile with Libxml that doesn&#39;t have HTML parser. htmlDocPtr undefined</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=XML-LibXML">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=XML-LibXML">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=XML-LibXML">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=XML-LibXML">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-LibXML">XML-LibXML CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">16333</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=XML-LibXML">XML-LibXML</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
bryanh [...] giraffe-data.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-37350-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
1.58    </td>
  </tr>
  <tr id="CF-37351-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




nohtml.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/150701/45318/nohtml.patch">
Tue Dec 06 22:55:26 2005 (2.5k) by 
</a>
</font></li>
</ul>


nothml-2.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/212790/83925/nothml-2.patch">
Sat Jun 24 15:02:24 2006 (3k) by GIRAFFED [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=16333">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-150701" href="/Public/Bug/Display.html?id=16333#txn-150701">#</a>      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;06&nbsp;22:55:26&nbsp;2005</span>
    <span class="description">GIRAFFED [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Won&#39;t compile with Libxml that doesn&#39;t have HTML parser.
 htmlDocPtr undefined</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/150701/45317/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/45317">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 194b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">One of the possible configuration of Libxml2 is without the HTML parser.  Libxml.xs doesn&#39;t tolerate this.

The attached patch removes the 3 HTML parse functions when Libxml2 doesn&#39;t have them.
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/150701/45318/nohtml.patch">Download nohtml.patch</a><br />
<span class="downloadcontenttype">text/x-diff 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --unif --rec XML-LibXML-1.58/LibXML.xs XML-LibXML/LibXML.xs
--- XML-LibXML-1.58/LibXML.xs	2004-03-24 23:06:14.000000000 +0000
+++ XML-LibXML/LibXML.xs	2005-12-06 07:24:19.000000000 +0000
@@ -1346,19 +1346,26 @@
         SV * self
         SV * string
     PREINIT:
+#ifdef LIBXML_HTML_ENABLED
         STRLEN len;
         char * ptr;
         SV * saved_error;
         HV * real_obj;
         htmlDocPtr real_doc;
         int recover = 0;
+#endif
     INIT:
+#ifdef LIBXML_HTML_ENABLED
         ptr = SvPV&#40;string, len&#41;;
         if &#40;len &lt;= 0&#41; {
             croak&#40;&#34;Empty string&#34;&#41;;
             XSRETURN_UNDEF;
         }
+#else
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
     CODE:
+#ifdef LIBXML_HTML_ENABLED
         RETVAL = &#38;PL_sv_undef;
         LibXML_init_error&#40;&#38;saved_error&#41;;
         real_obj = LibXML_init_parser&#40;self&#41;;
@@ -1381,6 +1388,7 @@
         LibXML_cleanup_callbacks&#40;&#41;;
         LibXML_cleanup_parser&#40;&#41;;
         LibXML_report_error&#40;saved_error, recover&#41;;
+#endif
     OUTPUT:
         RETVAL
 
@@ -1389,12 +1397,19 @@
         SV * self
         SV * fh
     PREINIT:
+#ifdef LIBXML_HTML_ENABLED
         SV * saved_error;
         HV * real_obj;
         htmlDocPtr real_doc;
         int well_formed;
         int recover = 0;
+#endif
+    INIT:
+#ifndef LIBXML_HTML_ENABLED
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
     CODE:
+#ifdef LIBXML_HTML_ENABLED
         RETVAL = &#38;PL_sv_undef;
         LibXML_init_error&#40;&#38;saved_error&#41;;
         real_obj = LibXML_init_parser&#40;self&#41;;
@@ -1457,6 +1472,7 @@
         LibXML_cleanup_callbacks&#40;&#41;;
         LibXML_cleanup_parser&#40;&#41;;
         LibXML_report_error&#40;saved_error, recover&#41;;
+#endif
     OUTPUT:
         RETVAL
 
@@ -1465,19 +1481,26 @@
         SV * self
         SV * filename_sv
     PREINIT:
+#ifdef LIBXML_HTML_ENABLED
         STRLEN len;
         char * filename;
         SV * saved_error;
         HV * real_obj;
         htmlDocPtr real_doc;
         int recover = 0;
+#endif
     INIT:
+#ifdef LIBXML_HTML_ENABLED
         filename = SvPV&#40;filename_sv, len&#41;;
         if &#40;len &lt;= 0&#41; {
             croak&#40;&#34;Empty filename&#34;&#41;;
             XSRETURN_UNDEF;
         }
+#else
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
     CODE:
+#ifdef LIBXML_HTML_ENABLED
         RETVAL = &#38;PL_sv_undef;
         LibXML_init_error&#40;&#38;saved_error&#41;;
         real_obj = LibXML_init_parser&#40;self&#41;;
@@ -1495,6 +1518,7 @@
         LibXML_cleanup_callbacks&#40;&#41;;
         LibXML_cleanup_parser&#40;&#41;;
         LibXML_report_error&#40;saved_error, recover&#41;;
+#endif
     OUTPUT:
         RETVAL
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-211865" href="/Public/Bug/Display.html?id=16333#txn-211865">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;22&nbsp;05:23:14&nbsp;2006</span>
    <span class="description">pajas [...] matfyz.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/211865/83202/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/83202">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 478b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On út 06.pro.2005 22:55:26, GIRAFFED wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; One of the possible configuration of Libxml2 is without the HTML
&gt; parser.  Libxml.xs doesn&#39;t tolerate this.
&gt; 
&gt; The attached patch removes the 3 HTML parse functions when Libxml2
&gt; doesn&#39;t have them.
</div>
I&#39;m really reluctant to apply such a patch. Currently, on most places, 
XML-LibXML expects the default set of features of libxml2 to be 
enabled. And we don&#39;t have enough maintainer power ATM to test all 
possible combinations.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-211866" href="/Public/Bug/Display.html?id=16333#txn-211866">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;22&nbsp;05:23:14&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-211869" href="/Public/Bug/Display.html?id=16333#txn-211869">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;22&nbsp;05:23:15&nbsp;2006</span>
    <span class="description">pajas [...] matfyz.cz -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-211983" href="/Public/Bug/Display.html?id=16333#txn-211983">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;22&nbsp;11:38:20&nbsp;2006</span>
    <span class="description">GIRAFFED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/211983/83276/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/83276">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 771b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Jun 22 05:23:14 2006, PAJAS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; we don&#39;t have enough maintainer power ATM to test all 
&gt; possible combinations.
</div>
To my mind, that&#39;s an argument in favor of accepting patches like this 
from the community.  Those of us on the fringes, no matter how few, test 
the fringe combinations as we try to use the package.  Accomodating no-
HTML libxml2 in the code doesn&#39;t mean the maintainers sign up to ensure 
it works with no-HTML libxml2.

This kind of patch has virtually no chance of screwing up the normal 
combinations, since every bit of code is under ifdef of a macro that is 
the same for all the normal combinations.  Also, I wouldn&#39;t have 
bothered to suggest it except for the fact that there are ifdefs for a 
few other libxml2 options in there today.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-211984" href="/Public/Bug/Display.html?id=16333#txn-211984">#</a>      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;22&nbsp;11:38:21&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-212264" href="/Public/Bug/Display.html?id=16333#txn-212264">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;23&nbsp;06:39:45&nbsp;2006</span>
    <span class="description">pajas [...] matfyz.cz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/212264/83470/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/83470">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On čt 22.čen.2006 11:38:20, GIRAFFED wrote: 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Thu Jun 22 05:23:14 2006, PAJAS wrote: 
<div class="message-stanza open">&gt; &gt; we don&#39;t have enough maintainer power ATM to test all  
&gt; &gt; possible combinations. 
</div>&gt;  
&gt; To my mind, that&#39;s an argument in favor of accepting patches like 
</div>this  
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; from the community.  Those of us on the fringes, no matter how few, 
</div>test  
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; the fringe combinations as we try to use the package.  Accomodating 
</div>no- 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; HTML libxml2 in the code doesn&#39;t mean the maintainers sign up to 
</div>ensure  
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; it works with no-HTML libxml2. 
&gt;  
&gt; This kind of patch has virtually no chance of screwing up the normal  
&gt; combinations, since every bit of code is under ifdef of a macro that 
</div>is  
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; the same for all the normal combinations.  Also, I wouldn&#39;t have  
&gt; bothered to suggest it except for the fact that there are ifdefs for 
</div>a  
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; few other libxml2 options in there today. 
</div> 
ok, I see your point. Please update your patch so that it applies 
cleanly to current CVS snapshot, test that XML-LibXML compiles with it 
against a no-HTML libxml2 and passes all tests. 
Then I be willing to commit it. Checkout with 
 
cvs -d:pserver:anonymous@cvs.axkit.org:/home/cvs -z3 co XML-LibXML 
 
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-212790" href="/Public/Bug/Display.html?id=16333#txn-212790">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;24&nbsp;15:02:22&nbsp;2006</span>
    <span class="description">GIRAFFED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/212790/83922/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/83922">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 314b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Here&#39;s a patch for current CVS &#40;nohtml-2.patch&#41;

It passes all the &#39;make test&#39; tests except for the HTML ones, where it 
displays the appropriate error message.

I couldn&#39;t run the threads test because I don&#39;t have threads.pm, and 
some of the callbacks tests, apparently because I don&#39;t have 
/etc/xml/catalog:1.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>
<div class="downloadattachment">
<a href="/Ticket/Attachment/212790/83925/nothml-2.patch">Download nothml-2.patch</a><br />
<span class="downloadcontenttype">text/x-diff 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: LibXML.xs
===================================================================
RCS file: /home/cvs/XML-LibXML/LibXML.xs,v
retrieving revision 1.194
diff -u -r1.194 LibXML.xs
--- LibXML.xs	23 Jun 2006 10:19:33 -0000	1.194
+++ LibXML.xs	24 Jun 2006 18:51:24 -0000
@@ -1227,19 +1227,26 @@
         SV * self
         SV * string
     PREINIT:
+#ifdef LIBXML_HTML_ENABLED
         STRLEN len;
         char * ptr;
         SV * saved_error = sv_2mortal&#40;newSVpv&#40;&#34;&#34;,0&#41;&#41;;
         HV * real_obj;
         htmlDocPtr real_doc;
         int recover = 0;
+#endif
     INIT:
+#ifdef LIBXML_HTML_ENABLED
         ptr = SvPV&#40;string, len&#41;;
         if &#40;len &lt;= 0&#41; {
             croak&#40;&#34;Empty string&#34;&#41;;
             XSRETURN_UNDEF;
         }
+#else
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
     CODE:
+#ifdef LIBXML_HTML_ENABLED
         RETVAL = &#38;PL_sv_undef;
         LibXML_init_error_ctx&#40;saved_error&#41;;
         real_obj = LibXML_init_parser&#40;self&#41;;
@@ -1261,6 +1268,7 @@
 
         LibXML_cleanup_parser&#40;&#41;;
         LibXML_report_error_ctx&#40;saved_error, recover&#41;;
+#endif
     OUTPUT:
         RETVAL
 
@@ -1269,12 +1277,19 @@
         SV * self
         SV * fh
     PREINIT:
+#ifdef LIBXML_HTML_ENABLED
         SV * saved_error = sv_2mortal&#40;newSVpv&#40;&#34;&#34;,0&#41;&#41;;
         HV * real_obj;
         htmlDocPtr real_doc;
         int well_formed;
         int recover = 0;
+#endif
+    INIT:
+#ifndef LIBXML_HTML_ENABLED
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
     CODE:
+#ifdef LIBXML_HTML_ENABLED
         RETVAL = &#38;PL_sv_undef;
         LibXML_init_error_ctx&#40;saved_error&#41;;
         real_obj = LibXML_init_parser&#40;self&#41;;
@@ -1336,6 +1351,7 @@
 
         LibXML_cleanup_parser&#40;&#41;;
         LibXML_report_error_ctx&#40;saved_error, recover&#41;;
+#endif
     OUTPUT:
         RETVAL
 
@@ -1344,19 +1360,26 @@
         SV * self
         SV * filename_sv
     PREINIT:
+#ifdef LIBXML_HTML_ENABLED
         STRLEN len;
         char * filename;
         SV * saved_error = sv_2mortal&#40;newSVpv&#40;&#34;&#34;,0&#41;&#41;;
         HV * real_obj;
         htmlDocPtr real_doc;
         int recover = 0;
+#endif
     INIT:
+#ifdef LIBXML_HTML_ENABLED
         filename = SvPV&#40;filename_sv, len&#41;;
         if &#40;len &lt;= 0&#41; {
             croak&#40;&#34;Empty filename&#34;&#41;;
             XSRETURN_UNDEF;
         }
+#else
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
     CODE:
+#ifdef LIBXML_HTML_ENABLED
         RETVAL = &#38;PL_sv_undef;
         LibXML_init_error_ctx&#40;saved_error&#41;;
         real_obj = LibXML_init_parser&#40;self&#41;;
@@ -1373,6 +1396,7 @@
 
         LibXML_cleanup_parser&#40;&#41;;
         LibXML_report_error_ctx&#40;saved_error, recover&#41;;
+#endif
     OUTPUT:
         RETVAL
 
@@ -2024,8 +2048,11 @@
     CODE:
         xs_warn&#40; &#34;use no formated toString!&#34; &#41;;
         LibXML_init_error_ctx&#40;saved_error&#41;;
+#ifdef LIBXML_HTML_ENABLED
         htmlDocDumpMemory&#40;self, &#38;result, &#40;int*&#41;&#38;len&#41;;
-
+#else
+        croak&#40;&#34;HTML parser not implemented in this XML::LibXML&#34;&#41;;
+#endif
         LibXML_report_error_ctx&#40;saved_error, 0&#41;;
 
         if &#40;result == NULL&#41; {
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-212803" href="/Public/Bug/Display.html?id=16333#txn-212803">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;24&nbsp;15:42:19&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/212803/83934/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/83934">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 963b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On so 24.čen.2006 15:02:22, GIRAFFED wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Here&#39;s a patch for current CVS &#40;nohtml-2.patch&#41;
&gt; 
&gt; It passes all the &#39;make test&#39; tests except for the HTML ones, where 
</div>it 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; displays the appropriate error message.
&gt; 
&gt; I couldn&#39;t run the threads test because I don&#39;t have threads.pm, and 
&gt; some of the callbacks tests, apparently because I don&#39;t have 
&gt; /etc/xml/catalog:1.
</div>
Thanks, applied cleanly, so I&#39;ll commit it just as it is. About the 
failed tests:

1&#41; 30threads.t is supposed to be skipped if threads are not compiled 
in, so I wonder why it wasn&#39;t on your system. Anyway, can you check if 
it is skipped if you change
if&#40; $Config{useithreads} &#41;
to
if &#40; $Config{useithreads} &#38;&#38; eval { require threads } &#41; {
in that file?

2&#41; if I remove /etc/xml/catalog from my system, I still can&#39;t make any 
test fail. Can you post the output of the tests that fail &#40;except for 
html and treads&#41; when running them as

perl -Mblib t/NNwhatevertest.t

Thanks,
-- Petr
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-212827" href="/Public/Bug/Display.html?id=16333#txn-212827">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;24&nbsp;16:22:05&nbsp;2006</span>
    <span class="description">GIRAFFED [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/212827/83946/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/83946">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 84b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I opened some new tickets for the test issues, with the information you 
asked for.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-212831" href="/Public/Bug/Display.html?id=16333#txn-212831">#</a>      
    </span>
    <span class="date">Sat&nbsp;Jun&nbsp;24&nbsp;16:25:51&nbsp;2006</span>
    <span class="description">pajas [...] matfyz.cz -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.564873</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
