<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #48240 for PAR: MODULE object version 1.YYY does not match $MODULE::VERSION 1.XXX at /usr/lib/perl/5.10/DynaLoader.pm</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #48240 for PAR: MODULE object version 1.YYY does not match $MODULE::VERSION 1.XXX at /usr/lib/perl/5.10/DynaLoader.pm</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/PAR/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/PAR/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/PAR/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/PAR/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PAR">PAR CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">48240</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/PAR/Active/">PAR</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
wfelipe [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-24530-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.994    </td>
  </tr>
  <tr id="CF-24531-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;27&nbsp;10:33:43&nbsp;2009</span>
    <span class="description">wfelipe [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> MODULE object version 1.YYY does not match $MODULE::VERSION 1.XXX
 at /usr/lib/perl/5.10/DynaLoader.pm</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m using Catalyst Framework to generate the PAR package, and I tried to
find in other forums, but I couldn&#39;t find a final solution.

I&#39;m generating the package with the core modules and all additional
modules that I need, including DBI.pm &#40;my first problem&#41;. Once the
package is generated, it&#39;s copied to another system &#40;the same perl and
operating system version&#41;, which also has a DBI.pm, but an older version.

When I run the par package, it stops ate the following error:
===============
Couldn&#39;t instantiate component &#34;MyApp::Model::MyApp&#34;,
&#34;DBIx::Class::Schema::connection&#40;&#41;: No arguments to load_classes and
couldn&#39;t load DBIx::Class::Storage::DBI &#40;DBI object version 1.605 does
not match $DBI::VERSION 1.607 at /usr/lib/perl/5.10/DynaLoader.pm line 219.
BEGIN failed--compilation aborted at DBI.pm line 263.
Compilation failed in require at DBIx/Class/Storage/DBI.pm line 8.
BEGIN failed--compilation aborted at DBIx/Class/Storage/DBI.pm line 8.
&#41; at Catalyst/Model/DBIC/Schema.pm line 318&#34; at
./script/kickstart_server.pl line 58
===============

My guess is that it loads the DBI.pm from the par package, but it
prioritize the DBI.so installed in the system, which is an older
version. In the par package there are some .so libraries, and one of
them was the DBI.so installed in the system which the package was generated.

some useful information:
- Operating System: Debian Lenny 5.0.2
- perl -v: This is perl, v5.10.0 built for x86_64-linux-gnu-thread-multi

if you need any information, feel free to ask me
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;27&nbsp;11:31:06&nbsp;2009</span>
    <span class="description">wfelipe [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jul 27 10:33:43 2009, wfelipe wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m using Catalyst Framework to generate the PAR package, and I tried to
&gt; find in other forums, but I couldn&#39;t find a final solution.
&gt; 
&gt; I&#39;m generating the package with the core modules and all additional
&gt; modules that I need, including DBI.pm &#40;my first problem&#41;. Once the
&gt; package is generated, it&#39;s copied to another system &#40;the same perl and
&gt; operating system version&#41;, which also has a DBI.pm, but an older version.
&gt; 
&gt; When I run the par package, it stops ate the following error:
&gt; ===============
&gt; Couldn&#39;t instantiate component &#34;MyApp::Model::MyApp&#34;,
&gt; &#34;DBIx::Class::Schema::connection&#40;&#41;: No arguments to load_classes and
&gt; couldn&#39;t load DBIx::Class::Storage::DBI &#40;DBI object version 1.605 does
&gt; not match $DBI::VERSION 1.607 at /usr/lib/perl/5.10/DynaLoader.pm line
</div>219.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; BEGIN failed--compilation aborted at DBI.pm line 263.
&gt; Compilation failed in require at DBIx/Class/Storage/DBI.pm line 8.
&gt; BEGIN failed--compilation aborted at DBIx/Class/Storage/DBI.pm line 8.
&gt; &#41; at Catalyst/Model/DBIC/Schema.pm line 318&#34; at
&gt; ./script/kickstart_server.pl line 58
&gt; ===============
&gt; 
&gt; My guess is that it loads the DBI.pm from the par package, but it
&gt; prioritize the DBI.so installed in the system, which is an older
&gt; version. In the par package there are some .so libraries, and one of
&gt; them was the DBI.so installed in the system which the package was
</div>generated.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; some useful information:
&gt; - Operating System: Debian Lenny 5.0.2
&gt; - perl -v: This is perl, v5.10.0 built for x86_64-linux-gnu-thread-multi
&gt; 
&gt; if you need any information, feel free to ask me
</div>
another information which may be the behavior that I saw above: in the
par package, the *.so files are at lib/auto/&lt;PATH&gt;/MODULE.so, but when I
run the application, it&#39;s uncompressed at
/tmp/par-USER/cache-hash/hash.so, and the DynaLoader loads based on the
module name, which overload the original one.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jul&nbsp;27&nbsp;11:31:09&nbsp;2009</span>
    <span class="description">wfelipe [...] gmail.com -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;28&nbsp;06:35:36&nbsp;2009</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Does the simple example

pp -p testdbi -e &#39;use DBI; print &#34;OK&#34;&#39;

&#40;when moved to the machine with a different version of DBI&#41;
show the same problem?

BTW, it&#39;s OK that shared libs are packed with their real name
into the .par &#40;or executable&#41;, but have mangled hash.so names
when extracted into the cache area. PAR patches DynaLoader
to make it look for the mangled name.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;28&nbsp;07:18:28&nbsp;2009</span>
    <span class="description">wfelipe [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Jul 28 06:35:36 2009, RSCHUPP wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Does the simple example
&gt; 
&gt; pp -p testdbi -e &#39;use DBI; print &#34;OK&#34;&#39;
&gt; 
&gt; &#40;when moved to the machine with a different version of DBI&#41;
&gt; show the same problem?
&gt; 
&gt; BTW, it&#39;s OK that shared libs are packed with their real name
&gt; into the .par &#40;or executable&#41;, but have mangled hash.so names
&gt; when extracted into the cache area. PAR patches DynaLoader
&gt; to make it look for the mangled name.
</div>
The example runs with no problems. Looking deep into the problem, I
realized two things:
- using strace to read the syscalls to get the stat and open, it always
stat the hash.so, and then stat DBI.so installed in the operating system
&#40;outside par package&#41;, and then open and read DBI.so from the operating
system
- the module PAR::Heavy, there is a routine override in DynaLoader:
*{&#39;DynaLoader::dl_findfile&#39;}    = \&#38;_dl_findfile;
that override doesn&#39;t seem to work, because it&#39;s never called
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jul&nbsp;28&nbsp;08:13:40&nbsp;2009</span>
    <span class="description">RSCHUPP [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yeah, seems that &#34;trick DynaLoader into loading the .so
with the mangled name from PAR&#39;s cache&#34; doesn&#39;t work.

There was a potentially relevant change in PAR 0.994.
Could you downgrade to PAR 0.992 and check whether your
problem persists &#40;you&#39;ll have to re-pack your executable
after downgrading&#41;?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;26&nbsp;09:39:58&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Severity Important changed to Critical</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction links AddLink even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Aug&nbsp;26&nbsp;10:26:24&nbsp;2009</span>
    <span class="description">smueller [...] cpan.org -  Membership in ticket #42986 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
