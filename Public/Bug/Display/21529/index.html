<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #21529 for Module-Build: Add META.yml to MANIFEST in dist dir, not in root</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #21529 for Module-Build: Add META.yml to MANIFEST in dist dir, not in root</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Module-Build/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Module-Build/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Module-Build/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Module-Build/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Module-Build">Module-Build CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">21529</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Module-Build/Active/">Module-Build</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rjray [...] blackperl.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Wishlist    </td>
  </tr>
  <tr id="CF-21558-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.2805    </td>
  </tr>
  <tr id="CF-21559-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Sep&nbsp;16&nbsp;20:58:53&nbsp;2006</span>
    <span class="description">rjray [...] blackperl.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Adding META.yml to MANIFEST should happing in dist dir, not in root</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">When &#34;Build dist&#34; is run, if META.yml is not already in MANIFEST, it is
added. However, it is added to the &#34;real&#34; MANIFEST, in the project root
dir, not the MANIFEST that is in the distribution dir. This can make
MANIFEST appear modified to source-control systems.

Compare this to the way SIGNATURE is created and added to MANIFEST when
signing is enabled. It is added to the MANIFEST file after it is copied
into the Name-X.XX dist dir, not to the actual MANIFEST file. If M::B
must add META.yml, it should be in a way that does not interfere with
source control.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;01&nbsp;05:31:29&nbsp;2007</span>
    <span class="description">EWILHELM [...] cpan.org -  Subject changed from &#39;Adding META.yml to MANIFEST should happing in dist dir, not in root&#39; to &#39;Add META.yml to MANIFEST in dist dir, not in root&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;01&nbsp;05:31:37&nbsp;2007</span>
    <span class="description">EWILHELM [...] cpan.org -  Severity Important changed to Wishlist</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;01&nbsp;05:38:53&nbsp;2007</span>
    <span class="description">EWILHELM [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sat Sep 16 20:58:53 2006, RJRAY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; When &#34;Build dist&#34; is run, if META.yml is not already in MANIFEST,
&gt; it is added. However, it is added to the &#34;real&#34; MANIFEST, in the
&gt; project root dir, not the MANIFEST that is in the distribution dir.
&gt; This can make MANIFEST appear modified to source-control systems.
</div>
Yes, and some users just checkin the resultant manifest.  Some even 
checkin the META.yml.

This has been downgraded to wishlist.  It can be done, but the 
behavior has to be optional.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;01&nbsp;05:38:57&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;01&nbsp;16:51:05&nbsp;2007</span>
    <span class="description">rjray [...] blackperl.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> rjray [...] blackperl.com</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 01 05:38:53 2007, EWILHELM wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Yes, and some users just checkin the resultant manifest.  Some even 
&gt; checkin the META.yml.
&gt; 
&gt; This has been downgraded to wishlist.  It can be done, but the 
&gt; behavior has to be optional.
</div>
I disagree with the thought here. META.yml is a generated component, not
an actual artifact of the project &#40;unless you choose it to be, I
suppose&#41;. I would no more want to version-control it than I would .o
files &#40;or even the .c files generated from the processing of .xs files&#41;.
If the user chooses to put META.yml in their MANIFEST file, M::B already
does the right thing... it *doesn&#39;t* add it a second time. I&#39;m just
suggesting that if it *does* need to add META.yml to MANIFEST, that it
does so in the dist dir &#40;which is removed during cleanup&#41;. If the user
chooses to keep META.yml in MANIFEST, and version-control every
iteration of META.yml, they make that choice. As it currently stands,
every time I do &#34;Build dist&#34;, I have to then &#34;svn revert MANIFEST&#34;
afterwards.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;01&nbsp;20:04:48&nbsp;2007</span>
    <span class="description">mschwern [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Oct 01 16:51:05 2007, RJRAY wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Mon Oct 01 05:38:53 2007, EWILHELM wrote:
<div class="message-stanza open">&gt; &gt; Yes, and some users just checkin the resultant manifest.  Some even 
&gt; &gt; checkin the META.yml.
&gt; &gt; 
&gt; &gt; This has been downgraded to wishlist.  It can be done, but the 
&gt; &gt; behavior has to be optional.
</div>&gt; 
&gt; I disagree with the thought here. META.yml is a generated component, not
&gt; an actual artifact of the project &#40;unless you choose it to be, I
&gt; suppose&#41;. I would no more want to version-control it than I would .o
&gt; files &#40;or even the .c files generated from the processing of .xs files&#41;.
</div>
That&#39;s a false analogy since the .c and .o files are generated by the
user and change from machine to machine.  The META.yml is designed to be
static.
 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; If the user chooses to put META.yml in their MANIFEST file, M::B already
&gt; does the right thing... it *doesn&#39;t* add it a second time. I&#39;m just
&gt; suggesting that if it *does* need to add META.yml to MANIFEST, that it
&gt; does so in the dist dir &#40;which is removed during cleanup&#41;. If the user
&gt; chooses to keep META.yml in MANIFEST, and version-control every
&gt; iteration of META.yml, they make that choice. As it currently stands,
&gt; every time I do &#34;Build dist&#34;, I have to then &#34;svn revert MANIFEST&#34;
&gt; afterwards.
</div>
There&#39;s arguments on both sides for this.  MakeMaker takes the &#34;it&#39;s
generated stuff&#34; and puts META.yml and SIGNATURE into the dist dir. 
Others want the complete distribution checked into their repository so
the full distribution can be checked in and run from the checkout.  It
also makes it easier to see and check the generated files before
distributing.

To highlight the argument, there are some C projects which don&#39;t check
in their configure or Makefiles and only ship configure.in and
Makefile.in.  You have to first run autoconf before you can build the
thing from source.  This is annoying, even though, technically, it&#39;s a
&#34;generated&#34; file.

To be honest, MakeMaker puts META.yml into the dist dir to make it
completely transparent in order to sneak META.yml onto everyone&#39;s CPAN
modules without anyone having to lift a finger.

SIGNATURE is a special case.  It should go into the dist dir since it&#39;s
signing a very particular snapshot of the code.  If it went into the
source directory it would fall out of date as soon as anything is edited.

MANIFEST is also generated, but a special case.  You can&#39;t build the
dist dir without it.

What about other generated files like README?  Where do they go?

I&#39;m in the &#34;just check it in and be done with it&#34; camp myself.  I like
seeing what I ship before I ship it.  Why fight the tool?  Add an &#34;svn
commit META.yml -m &#39;META.yml update&#39;&#34; to your release script.

If it were to be optional it should be an explicit option and not some
magic based on the contents of MANIFEST.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;07&nbsp;01:23:04&nbsp;2008</span>
    <span class="description">rjray [...] blackperl.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; SIGNATURE is a special case.  It should go into the dist dir since it&#39;s
&gt; signing a very particular snapshot of the code.  If it went into the
&gt; source directory it would fall out of date as soon as anything is edited.
</div>
You could say the same about META.yml. Since at the very least the
&#34;version:&#34; key differs from one build to the next, you could say that
META.yml falls out of date as soon as you&#39;re preparing your next release.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; MANIFEST is also generated, but a special case.  You can&#39;t build the
&gt; dist dir without it.
&gt; 
&gt; What about other generated files like README?  Where do they go?
</div>
Depends: are they generated during the general build, or during the dist
target? If the former, I would thing they would be somewhere under 
blib/, as that is where everything else &#40;even scripts&#41; ends up during
that phase. If during the dist phase, I would expect it to go under the
release directory. I admit that I don&#39;t rely on generated MANIFEST or
README files, so I haven&#39;t run into that before.

Take your example of projects that distribute Makefile.in and
configure.in instead of Makefile and/or configure. We already do that--
we distribute Makefile.PL and/or Build.PL, rather than Makefile and/or
Build. Anyone installing a CPAN module has to start out by creating the
build-file &#40;or let CPAN/CPANPLUS do it for them&#41;.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I&#39;m in the &#34;just check it in and be done with it&#34; camp myself.  I like
&gt; seeing what I ship before I ship it.  Why fight the tool?  Add an &#34;svn
&gt; commit META.yml -m &#39;META.yml update&#39;&#34; to your release script.
&gt; 
&gt; If it were to be optional it should be an explicit option and not some
&gt; magic based on the contents of MANIFEST.
</div>
I guess it just seems to me that it already is-- if META.yml is in
MANIFEST, it doesn&#39;t get added a second time. And even if I already have
a pre-existing META.yml file in the project directory, &#34;./Build dist&#34;
will delete it and re-generate it.

I suppose it comes down to this: I don&#39;t have an overly-complicated
release process. Mine comes down to these steps:

* Make sure everything I want in the release is committed &#40;CVS or svn&#41;
* Tag it
* If there are uncommitted changes I&#39;ve chosen to not deliver, use the
tag to co a clean copy somewhere else. Go there and create Build from
Build.PL.
* &#34;./Build dist&#34;
* &#34;cpan-upload &lt;distfile&gt;&#34;
* &#34;./Build realclean&#34;

At the end of that last step, a &#34;svn stat&#34; shouldn&#39;t show me any
modified files &#40;if I had uncommitted changes at the outset, then I&#39;m in
a fresh area created by co&#39;ing a tag&#41;. If META.yml is changed, then it
represents something different than is in the tagged branch of the repo
tree. If I somehow generate it before &#34;Build dist&#34; and commit it, the
dist step is still going to delete and re-generate it.

It just seems to me that a sequence of &#34;perl Build.PL; ./Build dist;
./Build realclean&#34; should leave a working-directory in the same state as
when you started &#40;provided you&#39;ve properly configured your clean-up
actions with $build-&gt;add_to_cleanup&#40;&#41;&#41;.

Randy
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;01&nbsp;11:22:30&nbsp;2009</span>
    <span class="description">dolmen [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Le Lun. Avr. 07 01:23:04 2008, RJRAY a écrit :
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I guess it just seems to me that it already is-- if META.yml is in
&gt; MANIFEST, it doesn&#39;t get added a second time. And even if I already have
&gt; a pre-existing META.yml file in the project directory, &#34;./Build dist&#34;
&gt; will delete it and re-generate it.
</div>
M::B knows how to generate the MANIFEST. So use this feature and ignore
both MANIFEST and META.yml in your SCM.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I suppose it comes down to this: I don&#39;t have an overly-complicated
&gt; release process. Mine comes down to these steps:
&gt; 
&gt; * Make sure everything I want in the release is committed &#40;CVS or svn&#41;
&gt; * Tag it
&gt; * If there are uncommitted changes I&#39;ve chosen to not deliver, use the
&gt; tag to co a clean copy somewhere else. Go there and create Build from
&gt; Build.PL.
&gt; * &#34;./Build dist&#34;
&gt; * &#34;cpan-upload &lt;distfile&gt;&#34;
&gt; * &#34;./Build realclean&#34;
</div>
Add &#34;./Build manifest&#34; as a first step.
Add &#34;./Build disttest&#34; before cpan-upload.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; At the end of that last step, a &#34;svn stat&#34; shouldn&#39;t show me any
&gt; modified files &#40;if I had uncommitted changes at the outset, then I&#39;m in
&gt; a fresh area created by co&#39;ing a tag&#41;. If META.yml is changed, then it
&gt; represents something different than is in the tagged branch of the repo
&gt; tree. If I somehow generate it before &#34;Build dist&#34; and commit it, the
&gt; dist step is still going to delete and re-generate it.
</div>
So the problem comes from your SCM usage.
Use the svn:ignore property to ignore MANIFEST and META.yml from your
Subversion repository:

  rm MANIFEST META.yml
  svn propedit svn:ignore .
  svn commit MANIFEST META.yml .

Here is my own list:
Makefile.PL
*.bak
*.old
*.tmp
MANIFEST
META.yml
_build
blib
cover_db
Build
Build.bat
*.tar.gz


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; It just seems to me that a sequence of &#34;perl Build.PL; ./Build dist;
&gt; ./Build realclean&#34; should leave a working-directory in the same state as
&gt; when you started &#40;provided you&#39;ve properly configured your clean-up
&gt; actions with $build-&gt;add_to_cleanup&#40;&#41;&#41;.
</div>
I agree so I would delete MANIFEST too, but it may not be what you want.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;01&nbsp;13:54:48&nbsp;2009</span>
    <span class="description">rjray [...] blackperl.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I have recently started doing this &#40;and slowly converting my older
projects to this model&#41;, so this is no longer an issue for me. But my
initial point still stands-- if M::B is going to change a file *that
already exists* in-place, it makes more sense to do it in the dist/
directory, since the change is part of the &#34;Build dist&#34; command anyway.
Having &#34;Build dist&#34; alter things outside of dist/ seems
counter-intuitive. But as I said, it&#39;s not an issue for me anymore.

-- 
&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;
Randy J. Ray                 Silicon Valley Scale Modelers:
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.svsm.org">http://www.svsm.org</a></span>
rjray@blackperl.com
randy.j.ray@gmail.com
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jul&nbsp;01&nbsp;14:01:46&nbsp;2009</span>
    <span class="description">dagolden [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #21529] Add META.yml to MANIFEST in dist dir, not in  root</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 1 Jul 2009 14:01:00 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> David Golden &lt;dagolden [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed, Jul 1, 2009 at 1:54 PM, Randy J Ray via
RT&lt;bug-Module-Build@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Having &#34;Build dist&#34; alter things outside of dist/ seems
&gt; counter-intuitive. But as I said, it&#39;s not an issue for me anymore.
</div>
I think if I were to change this, I would add a &#34;meta&#34; action to
complement &#34;distmeta&#34; and have the first act on the top directory and
the second on dist.  Then distdir can depend on distmeta, but people
can also run the dist action directly to see what it would look like
if that&#39;s how they choose to do it.

I suppose it might be possible to do something similar with manifest
if a MANIFEST file doesn&#39;t exist.

-- David
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
