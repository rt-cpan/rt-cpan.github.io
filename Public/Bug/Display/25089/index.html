<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #25089 for Data-Phrasebook: Cannot change the default delimiter &#40;Generic.pm&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #25089 for Data-Phrasebook: Cannot change the default delimiter &#40;Generic.pm&#41;</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Data-Phrasebook/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Data-Phrasebook/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Data-Phrasebook/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Data-Phrasebook/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Data-Phrasebook">Data-Phrasebook CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">25089</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Data-Phrasebook/Active/">Data-Phrasebook</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
JGONZALEZ [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-9226-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.26    </td>
  </tr>
  <tr id="CF-9227-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;23&nbsp;01:08:14&nbsp;2007</span>
    <span class="description">JGONZALEZ [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Cannot change the default delimiter &#40;Generic.pm&#41;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Data:Phrasebook::Generic-0.26
I will attach the patch at a later date as I don&#39;t currently have it in
front of me; however, the bug exists in Generic.pm. I found it version
0.26 recently while trying to set a date format using the
TO_CHAR&#40;&lt;date&gt;, &lt;format&gt;&#41; function. 

SQL:
select TO_CHAR&#40;sysdate, &#39;yyyy-mm-dd hh:mi:ss&#39;&#41;

Description:
The above SQL will cause Phrasebook to think that mi and ss are
parameters that need to be passed in. I then tried to change the default
delimiter to something less useful in SQL. I set the delimiter by doing
$self-&gt;delimiter&#40;regexp&#41;. This did not work because the default
delimiter is then being overwritten with the value from Generic.pm

Fix:
The default delimiter is being set after the foreach loop. This resets
the delimiter to a : instead of the chosen delimiter. The fix is simply
to put this statement before the loop begins to iterate. This will cause
the default to be used when no other delimiter is selected.

sub new {
    my $class = shift;
    my %hash = @_;
        $hash{loader} ||= &#39;Text&#39;;

    if&#40;$class-&gt;debug&#41; {
                $class-&gt;store&#40;3,&#34;$class-&gt;new IN&#34;&#41;;
                $class-&gt;store&#40;4,&#34;$class-&gt;new            
                       args=[&#34;.$class-&gt;dumper&#40;\%hash&#41;.&#34;]&#34;&#41;;
        }

        my $self = bless {}, $class;
    $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x;
    foreach &#40;keys %hash&#41; {
        $self-&gt;$_&#40;$hash{$_}&#41;;
    }
#   $self-&gt;{delimiters} = qr{ \[% \s* &#40;\w+&#41; \s* %\] }x;
#   $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x; moved this single line above to
#        set the default delimiter before any custom delimiter requests.
 
   return $self;
}
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;23&nbsp;08:58:15&nbsp;2007</span>
    <span class="description">JGONZALEZ [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> jgonz0010 [...] gmail.com</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Fri Feb 23 01:08:14 2007, jgonzalez wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Data:Phrasebook::Generic-0.26
&gt; I will attach the patch at a later date as I don&#39;t currently have it in
&gt; front of me; however, the bug exists in Generic.pm. I found it version
&gt; 0.26 recently while trying to set a date format using the
&gt; TO_CHAR&#40;&lt;date&gt;, &lt;format&gt;&#41; function. 
&gt; 
&gt; SQL:
&gt; select TO_CHAR&#40;sysdate, &#39;yyyy-mm-dd hh:mi:ss&#39;&#41;
&gt; 
&gt; Description:
&gt; The above SQL will cause Phrasebook to think that mi and ss are
&gt; parameters that need to be passed in. I then tried to change the default
&gt; delimiter to something less useful in SQL. I set the delimiter by doing
&gt; $self-&gt;delimiter&#40;regexp&#41;. This did not work because the default
&gt; delimiter is then being overwritten with the value from Generic.pm
&gt; 
&gt; Fix:
&gt; The default delimiter is being set after the foreach loop. This resets
&gt; the delimiter to a : instead of the chosen delimiter. The fix is simply
&gt; to put this statement before the loop begins to iterate. This will cause
&gt; the default to be used when no other delimiter is selected.
&gt; 
&gt; sub new {
&gt;     my $class = shift;
&gt;     my %hash = @_;
&gt;       $hash{loader} ||= &#39;Text&#39;;
&gt; 
&gt;     if&#40;$class-&gt;debug&#41; {
&gt;               $class-&gt;store&#40;3,&#34;$class-&gt;new IN&#34;&#41;;
&gt;               $class-&gt;store&#40;4,&#34;$class-&gt;new            
&gt;                        args=[&#34;.$class-&gt;dumper&#40;\%hash&#41;.&#34;]&#34;&#41;;
&gt;       }
&gt; 
&gt;       my $self = bless {}, $class;
&gt;     $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x;
&gt;     foreach &#40;keys %hash&#41; {
&gt;         $self-&gt;$_&#40;$hash{$_}&#41;;
&gt;     }
&gt; #   $self-&gt;{delimiters} = qr{ \[% \s* &#40;\w+&#41; \s* %\] }x;
&gt; #   $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x; moved this single line above to
&gt; #        set the default delimiter before any custom delimiter requests.
&gt;  
&gt;    return $self;
&gt; }
</div>
Sorry for the delay, here is the diff as promissed.
</div></div>
</div>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: lib/Data/Phrasebook/Generic.pm
===================================================================
--- lib/Data/Phrasebook/Generic.pm	&#40;revision 175740&#41;
+++ lib/Data/Phrasebook/Generic.pm	&#40;working copy&#41;
@@ -52,11 +52,14 @@
 
     $class-&gt;store&#40;4,&#34;$class-&gt;new args=[&#34;.$class-&gt;dumper&#40;\%hash&#41;.&#34;]&#34;&#41;;
     my $self = bless {}, $class;
+    $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x; moved above the loop  in
     foreach &#40;keys %hash&#41; {
         $self-&gt;$_&#40;$hash{$_}&#41;;
     }
 #   $self-&gt;{delimiters} = qr{ \[% \s* &#40;\w+&#41; \s* %\] }x;
-    $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x;
+#   $self-&gt;{delimiters} = qr{ :&#40;\w+&#41; }x; moved above the loop  in
+#  		 order to be able to set a delimiter when desired. This was
+#   		overwriting any delimieters with the default.
 
     return $self;
 }
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;02&nbsp;08:21:16&nbsp;2007</span>
    <span class="description">BARBIE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks for spotting my faux pas :&#41;

Fixed in 0.29
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;02&nbsp;08:21:27&nbsp;2007</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;02&nbsp;08:21:41&nbsp;2007</span>
    <span class="description">BARBIE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
