<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #46334 for Mail-SPF: SPF Issue with local submissions &#40;loopback address sourced&#41;</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #46334 for Mail-SPF: SPF Issue with local submissions &#40;loopback address sourced&#41;</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Mail-SPF">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Mail-SPF">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Mail-SPF">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Mail-SPF">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Mail-SPF">Mail-SPF CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">46334</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Mail-SPF">Mail-SPF</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">JMEHNLE [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
d.stussy [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-20120-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-20121-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
v2.007    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=46334">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-609523" href="/Public/Bug/Display.html?id=46334#txn-609523">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;24&nbsp;17:19:17&nbsp;2009</span>
    <span class="description">d.stussy [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> julian [...] mehnle.net</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> SPF Issue with local submissions &#40;loopback address sourced&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 24 May 2009 14:18:49 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-SPF [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> - &lt;d.stussy [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/609523/309067/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/309067">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Package:  Mail-SPF-v2.006 - 17 Aug 2008
Perl Version:  5.10.0
OS:  Linux Kernel 2.6.29.4

Perhaps a bug; perhaps not, but at minimum definently an issue that needs a special note:

Messages which originate locally appear to be checked &#40;in some cases&#41; by some perl-based milters, including MimeDefang.  I noted an actual rejection in the code of my filter_sender&#40;&#41; routine, caused by passing the localhost&#39;s loopback address &#40;&#34;127.0.0.1&#34; or &#34;::1&#34;&#41; to the Mail::SPF routines &#40;Server, Request, then &#40;request&#41;-&gt;process&#41;.

I noted this when I saw in my logs:

<span class="clickylink"><a target="new" rel="nofollow" href="http://www.openspf.org/Why?s=mfrom;id=....;ip=127.0.0.1;r=localhost">http://www.openspf.org/Why?s=mfrom;id=....;ip=127.0.0.1;r=localhost</a></span>
&#40;Mechanism &#39;-all&#39; matched&#41;

Technically, this is a correct answer as there was no mechanism in the SPF string that authorized a loopback address as a valid sender.

The LOOPBACK addresses are not exempt and if not listed on the SPF record, they will result in the default answer &#40;which may be &#34;&#40;hard&#41;fail&#34; if &#34;-all&#34; is used.  Other implementations of SPF checking libraries I have seen exempt the two loopback addresses.  Since this implementation does not, it should either be changed to exempt these addresses, or a warning should be added to direct the user that the addresses are not specifically exempt, and that his code should bypass SPF checks when they are used.

It may have been unforseen that an SPF check might be performed on locally originated mail &#40;as it really applies to mail coming in from outside the host&#41;.  However, as it has happened, it is a case that should be accounted for.

For reference, here is my &#40;unmodified&#41; version of MimeDefang&#39;s filter_sender&#40;&#41; routine.  I have since changed it to bypass the SPF check for loopback addresses.  My routine:
--------------------------------------------------------------------
sub filter_sender {
    my &#40;$sender, $ip, $hostname, $helo&#41; = @_;
    if &#40;$sender =~ /@&#40;[^&gt;]+&#41;/&#41; {
        my $domain = $1;
        my @bogushosts = md_get_bogus_mx_hosts&#40;$domain&#41;;
        my $i = scalar&#40;@bogushosts&#41;;
        return&#40;&#39;REJECT&#39;,&#34;Domain $domain has $i bogus MX record&#34; .
            &#40;&#40;$i &lt; 2&#41;? &#39;&#39; : &#39;s&#39;&#41; .&#39;: &#39;. join&#40;&#39; &#39;,@bogushosts&#41;,&#39;550&#39;,&#39;5.4.4&#39;&#41;
            if &#40;$i&#41;;
    } else {
        $sender = &#34;&lt;postmaster\@$helo&gt;&#34; unless &#40;$sender =~ /[^&lt;&gt;]+/&#41;;
    }
    read_commands_file&#40;&#41;;
    return&#40;&#39;CONTINUE&#39;,&#39;OK - SASL Authorized&#39;,&#39;235&#39;,&#39;2.7.0&#39;&#41;
        if &#40;$SendmailMacros{&#39;auth_authen&#39;}&#41;;
    my $id = &#40;$sender =~ /&lt;&#40;.+&#41;&gt;/&#41; ? $1 : $sender;
    my $spfserver = Mail::SPF::Server-&gt;new&#40;max_void_dns_lookups =&gt; undef,
        hostname =&gt; $SendmailMacros{&#39;if_name&#39;} &#41;;
    my $spfrequest = Mail::SPF::Request-&gt;new&#40;versions =&gt; [1], scope =&gt; &#39;mfrom&#39;,
        identity =&gt; $id, ip_address =&gt; $ip, helo_identity =&gt; $helo&#41;;
    my $r = $spfserver-&gt;process&#40;$spfrequest&#41;;
    my $spfrec = $spfrequest-&gt;record;
    my $result = $r-&gt;code;
    my $text   = $r-&gt;text;
    my $local  = $r-&gt;local_explanation;
    my $auth   = &#40;$result eq &#39;fail&#39;&#41; ? $r-&gt;authority_explanation : &#39;&#39;;
    my $label  = &#40;$sender eq &#34;&lt;&gt;&#34;&#41; ? &#39;helo&#39; : &#39;mailfrom&#39;;
    md_syslog&#40;&#39;info&#39;,&#34;$QueueID: SPF=$result From=&lt;$id&gt; &#40;$text&#41;&#34;&#41;;
    action_insert_header&#40;&#39;Authentication-Results&#39;, $SendmailMacros{&#39;if_name&#39;} .
         &#34;; SPF=$result smtp.$label=$1&#34;, 0&#41; if &#40;$id =~ /@&#40;[^&gt;]+&#41;/&#41;;
    return&#40;&#39;REJECT&#39;, &#34;SPF Forgery: $local. &#40;$auth&#41;&#34;,&#39;550&#39;,&#39;5.7.7&#39;&#41;
        if &#40;$result =~ /^&#40;hard&#41;?fail$/&#41;;
    return&#40;&#39;REJECT&#39;, &#34;SPF Error: $local &#40;\&#34;$spfrec\&#34;&#41;&#34;,&#39;550&#39;,&#39;5.7.4&#39;&#41;
        if &#40;$result eq &#39;permerror&#39;&#41;;
    return&#40;&#39;TEMPFAIL&#39;,&#34;SPF Temp-Error: $local&#34;,&#39;451&#39;,&#39;4.4.3&#39;&#41;
        if &#40;$result eq &#39;temperror&#39;&#41;;
    return&#40;&#39;REJECT&#39;, &#34;SPF Failure: $local&#34;,&#39;550&#39;,&#39;5.7.1&#39;&#41;
        if &#40;$result eq &#39;softfail&#39;&#41;;
    return&#40;&#39;CONTINUE&#39;,&#34;OK - SPF=$result &#40;$local&#41;&#34;&#41;;
}
--------------------------------------------------------------------
Note also that the sender&#39;s identity passed in for MimeDefang includes &#39;&lt;&#39; and &#39;&gt;&#39; while Mail::SPF::Request requires that they be stripped before the call.  This is another &#34;gotcha&#34; that&#39;s easy to miss.

I am also aware that the milter interface doesn&#39;t support 2xx codes nor a DSN code of 2.X.Y, but I include it because this could change in the future and the MimeDefang perl module does pass this information on to its milter interface program.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-609530" href="/Public/Bug/Display.html?id=46334#txn-609530">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;24&nbsp;18:56:23&nbsp;2009</span>
    <span class="description">JMEHNLE [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-609531" href="/Public/Bug/Display.html?id=46334#txn-609531">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;24&nbsp;19:13:48&nbsp;2009</span>
    <span class="description">JMEHNLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/609531/309070/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/309070">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun May 24 17:19:17 2009, d.stussy@yahoo.com wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Perhaps a bug; perhaps not, but at minimum definently an issue that
&gt; needs a special note:
</div>
I consider this a documentation omission.  Read on for why.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The LOOPBACK addresses are not exempt and if not listed on the SPF
&gt; record, they will result in the default answer &#40;which may be
&gt; &#34;&#40;hard&#41;fail&#34; if &#34;-all&#34; is used.
</div>
This was a conscious design choice.  The rationale is that the set of
addresses to exempt is anything but clearly defined.  {127.0.0.1,::1}
may seem like the obvious set of, but there&#39;s nothing stopping anyone
from setting up, e.g., an additional 127.0.0.2 loopback address on their
machine.  Furthermore, there are usually more addresses &#40;not loopback
ones&#41; that need to be exempted but are known only to the owner of the
MTA running Mail::SPF, such as secondary MXes and other trusted forwarders.

Thus it is always the responsibility of the administrator to explicitly
configure exemptions for all of those.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Other implementations of SPF checking libraries I have seen exempt
&gt; the two loopback addresses.
</div>
True.  They also usually exhibit far too magical behavior in various
aspects, intending to provide convenience but in the end causing
confusion.  Mail::SPF::Query is a prime example.  Mail::SPF goes the
other route, providing only the pure SPF logic per the specification,
and leaving all the whitelisting to the caller.

This is what should be documented in the Mail::SPF man pages.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; For reference, here is my &#40;unmodified&#41; version of MimeDefang&#39;s
&gt; filter_sender&#40;&#41; routine.  I have since changed it to bypass the SPF
&gt; check for loopback addresses.
</div>
This seems like the best approach to me.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Note also that the sender&#39;s identity passed in for MimeDefang includes
&gt; &#39;&lt;&#39; and &#39;&gt;&#39; while Mail::SPF::Request requires that they be stripped
&gt; before the call.  This is another &#34;gotcha&#34; that&#39;s easy to miss.
</div>
Well, I think the Mail::SPF::Request man page makes it pretty clear that
this is either a domain name or an e-mail address.  &#34;&lt;x@y.com&gt;&#34; is
neither.  Have you reported this as a bug to the MimeDefang authors?

-Julian
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-609532" href="/Public/Bug/Display.html?id=46334#txn-609532">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;24&nbsp;19:13:48&nbsp;2009</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-609536" href="/Public/Bug/Display.html?id=46334#txn-609536">#</a>      
    </span>
    <span class="date">Sun&nbsp;May&nbsp;24&nbsp;20:03:03&nbsp;2009</span>
    <span class="description">d.stussy [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #46334] SPF Issue with local submissions &#40;loopback address sourced&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 24 May 2009 17:02:40 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Mail-SPF [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> - &lt;d.stussy [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/609536/309073/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/309073">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
--- On Sun, 5/24/09, Julian Mehnle via RT &lt;bug-Mail-SPF@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=46334">https://rt.cpan.org/Ticket/Display.html?id=46334</a></span> &gt;
&gt; 
&gt; On Sun May 24 17:19:17 2009, d.stussy@yahoo.com wrote:
&gt; 
<div class="message-stanza open">&gt; &gt; Perhaps a bug; perhaps not, but at minimum definently an issue that
&gt; &gt; needs a special note:
</div>&gt; 
&gt; I consider this a documentation omission.  Read on for why.
</div>
I don&#39;t have a problem with that as long as it&#39;s &#34;a big warning&#34; section, perhaps:

&#34;Unlike other implementations of SPF, this version does not exempt the loopback addresses &#39;127.0.0.1&#39; or &#39;::1&#39; by assuming they are authorized.  Locally generated messages should generally bypass SPF checking.&#34;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Note also that the sender&#39;s identity passed in for MimeDefang includes
&gt; &gt; &#39;&lt;&#39; and &#39;&gt;&#39; while Mail::SPF::Request requires that they be stripped
&gt; &gt; before the call.  This is another &#34;gotcha&#34; that&#39;s easy to miss.
</div>&gt; 
&gt; Well, I think the Mail::SPF::Request man page makes it pretty clear that
&gt; this is either a domain name or an e-mail address. &#34;&lt;x@y.com&gt;&#34; is
&gt; neither.  Have you reported this as a bug to the MimeDefang authors?
</div>
I don&#39;t believe that it is a bug as far as MimeDefang is concerned, as it literally is the parameter specified on the &#34;MAIL FROM:&#34; command &#40;even in RFC 5321&#41;.  It is needed to distinguish &#34;&lt;&gt;&#34; from no parameter at all.  Perhaps another warning &#40;or &#34;user note&#34;&#41; is in order?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685113" href="/Public/Bug/Display.html?id=46334#txn-685113">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;19:34:39&nbsp;2009</span>
    <span class="description">JMEHNLE [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/685113/352720/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/352720">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 70b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Mail::SPF&#39;s stance has been documented in the README file as of 2.007.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685116" href="/Public/Bug/Display.html?id=46334#txn-685116">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;19:34:42&nbsp;2009</span>
    <span class="description">JMEHNLE [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685118" href="/Public/Bug/Display.html?id=46334#txn-685118">#</a>      
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;19:35:26&nbsp;2009</span>
    <span class="description">JMEHNLE [...] cpan.org -  Severity Normal added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-685119" href="/Public/Bug/Display.html?id=46334#txn-685119">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Nov&nbsp;02&nbsp;19:35:26&nbsp;2009</span>
    <span class="description">JMEHNLE [...] cpan.org -  Fixed in v2.007 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.405751</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
