<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #65052 for Win32-OLE: Cannot create ADODB.Connection object under Cygwin</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #65052 for Win32-OLE: Cannot create ADODB.Connection object under Cygwin</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Win32-OLE/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Win32-OLE/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Win32-OLE/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Win32-OLE/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Win32-OLE">Win32-OLE CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">65052</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Win32-OLE/Active/">Win32-OLE</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rkitover@cpan.org
(no email address)

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-35672-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.1709    </td>
  </tr>
  <tr id="CF-35673-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;23&nbsp;16:40:46&nbsp;2011</span>
    <span class="description">rkitover [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Cannot create ADODB.Connection object under Cygwin</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">This is on 64bit Windows 7.

On Cygwin:

$ perl -Mblib -MData::Dumper -MWin32::OLE -le &#39;print Dumper&#40;Win32::OLE-
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#41;&#39;
</div>$VAR1 = undef;

On ActiveState Perl 32 bit:

$ perl -MData::Dumper -MWin32::OLE -le &#39;print Dumper&#40;Win32::OLE-&gt;new
&#40;&#34;ADODB.Connection&#34;&#41;&#41;&#39;
$VAR1 = bless&#40; {
                 &#39;Properties&#39; =&gt; bless&#40; {
                                          &#39;Count&#39; =&gt; 14,
                                          &#39;Item&#39; =&gt; undef
                                        }, &#39;Win32::OLE&#39; &#41;,
                 &#39;ConnectionString&#39; =&gt; &#39;Provider=MSDASQL.1&#39;,
                 &#39;CommandTimeout&#39; =&gt; 30,
                 &#39;ConnectionTimeout&#39; =&gt; 15,
                 &#39;Version&#39; =&gt; &#39;6.1&#39;,
                 &#39;Errors&#39; =&gt; bless&#40; {
                                      &#39;Count&#39; =&gt; 0,
                                      &#39;Item&#39; =&gt; undef
                                    }, &#39;Win32::OLE&#39; &#41;,
                 &#39;DefaultDatabase&#39; =&gt; undef,
                 &#39;IsolationLevel&#39; =&gt; 4096,
                 &#39;Attributes&#39; =&gt; 0,
                 &#39;CursorLocation&#39; =&gt; 2,
                 &#39;Mode&#39; =&gt; 0,
                 &#39;Provider&#39; =&gt; &#39;MSDASQL.1&#39;,
                 &#39;State&#39; =&gt; 0
               }, &#39;Win32::OLE&#39; &#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;23&nbsp;16:48:05&nbsp;2011</span>
    <span class="description">rurban [...] x-ray.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> libwin32 [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65052] Cannot create ADODB.Connection object under Cygwin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 23 Jan 2011 22:47:56 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-OLE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Reini Urban &lt;rurban [...] x-ray.at&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">2011/1/23 Rafael Kitover via RT &lt;bug-Win32-OLE@rt.cpan.org&gt;:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is on 64bit Windows 7.
&gt;
&gt; On Cygwin:
&gt;
&gt; $ perl -Mblib -MData::Dumper -MWin32::OLE -le &#39;print Dumper&#40;Win32::OLE-
<div class="message-stanza open">&gt;&gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#41;&#39;
</div>&gt; $VAR1 = undef;
</div>
On 32-bit Windows XP also.

All tests pass, but:
$ perl -Mblib -MData::Dumper -MWin32::OLE -le &#39;print
Dumper&#40;Win32::OLE-&gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#41;&#39;
$VAR1 = undef;

-- 
Reini Urban
<span class="clickylink"><a target="new" rel="nofollow" href="http://phpwiki.org/">http://phpwiki.org/</a></span>           <span class="clickylink"><a target="new" rel="nofollow" href="http://murbreak.at/">http://murbreak.at/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jan&nbsp;23&nbsp;16:48:06&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;24&nbsp;13:59:39&nbsp;2011</span>
    <span class="description">jand [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #65052] Cannot create ADODB.Connection object under Cygwin </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 24 Jan 2011 10:59:30 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-OLE [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jan Dubois&#34; &lt;jand [...] activestate.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; This is on 64bit Windows 7.
&gt; 
&gt; On Cygwin:
&gt; 
&gt; $ perl -Mblib -MData::Dumper -MWin32::OLE -le &#39;print Dumper&#40;Win32::OLE-
<div class="message-stanza open">&gt; &gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#41;&#39;
</div>&gt; $VAR1 = undef;
</div>
Can you please run with warnings enabled?  Win32::OLE will print
additional diagnostics on OLE calls when warnings are on.
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On ActiveState Perl 32 bit:
</div>
Is this just 32-bit ActivePerl on the same machine, or on a different
one?

Also, which Cygwin version are you using?  Your example works fine
with my &#40;obsolete&#41; Cygwin 1.5 install.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;24&nbsp;15:38:51&nbsp;2011</span>
    <span class="description">rurban [...] x-ray.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> libwin32 [...] perl.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65052] Cannot create ADODB.Connection object under Cygwin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 24 Jan 2011 21:38:40 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-OLE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Reini Urban &lt;rurban [...] x-ray.at&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; This is on 64bit Windows 7.
&gt;&gt;
&gt;&gt; On Cygwin:
&gt;&gt;
&gt;&gt; $ perl -Mblib -MData::Dumper -MWin32::OLE -le &#39;print Dumper&#40;Win32::OLE-
<div class="message-stanza open">&gt;&gt; &gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#41;&#39;
</div>&gt;&gt; $VAR1 = undef;
</div>&gt;
&gt; Can you please run with warnings enabled?  Win32::OLE will print
&gt; additional diagnostics on OLE calls when warnings are on.
</div>
$ perl -MWin32::OLE -wle &#39;print Win32::OLE-&gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#39;
Win32::OLE&#40;0.1709&#41; error 0x8007007e: &#34;The specified module could not be
found&#34; at -e line 1
        eval {...} called at -e line 1
Use of uninitialized value in print at -e line 1.

With a debugging OLE lib and perl:

$ perl5.13.8d-nt -Mblib -we&#39;use Win32::OLE;
Win32::OLE-&gt;new&#40;q&#40;ADODB.Connection&#41;&#41;&#39;
Win32::OLE&#40;0.1709&#41; error 0x8007007e: &#34;The specified module could not be
found&#34; at -e line 1
        eval {...} called at -e line 1

$ gdb perl5.13.8d-nt
&#40;gdb&#41; run -Mblib -we&#39;use Win32::OLE; print Win32::OLE-&gt;new&#40;q&#40;ADODB.Connection&#41;&#41;&#39;
Starting program: /usr/local/bin/perl5.13.8d-nt -Mblib -we&#39;use
Win32::OLE; print Win32::OLE-&gt;new&#40;q&#40;ADODB.Connection&#41;&#41;&#39;
[New thread 8308.0xa88]
[New thread 8308.0xb10]
[New thread 8308.0x2380]
[New thread 8308.0x1ccc]
[New thread 8308.0xd8c]
[New thread 8308.0x22d8]
[New thread 8308.0x125c]
Win32::OLE=HASH&#40;0xb56348&#41;

This needs now printf debugging, oh my.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt;&gt; On ActiveState Perl 32 bit:
</div>&gt;
&gt; Is this just 32-bit ActivePerl on the same machine, or on a different
&gt; one?
</div>
I crosschecked with strawberry on the same machine, where
ADODB.Connection is registered.
c:\strawberry&gt; perl -MData::Dumper -MWin32::OLE -le &#34;print
Dumper&#40;Win32::OLE-&gt;new&#40;q&#40;ADODB.Connection&#41;&#41;&#41;&#34;
$VAR1 = bless&#40; {
                 &#39;Properties&#39; =&gt; bless&#40; {
                                          &#39;Count&#39; =&gt; 14,
                                          &#39;Item&#39; =&gt; undef
                                        }, &#39;Win32::OLE&#39; &#41;,
                 &#39;ConnectionString&#39; =&gt; &#39;Provider=MSDASQL.1&#39;,
                 &#39;CommandTimeout&#39; =&gt; 30,
                 &#39;ConnectionTimeout&#39; =&gt; 15,
                 &#39;Version&#39; =&gt; &#39;6.1&#39;,
                 &#39;Errors&#39; =&gt; bless&#40; {
                                      &#39;Count&#39; =&gt; 0,
                                      &#39;Item&#39; =&gt; undef
                                    }, &#39;Win32::OLE&#39; &#41;,
                 &#39;DefaultDatabase&#39; =&gt; undef,
                 &#39;IsolationLevel&#39; =&gt; 4096,
                 &#39;Attributes&#39; =&gt; 0,
                 &#39;CursorLocation&#39; =&gt; 2,
                 &#39;Mode&#39; =&gt; 0,
                 &#39;Provider&#39; =&gt; &#39;MSDASQL.1&#39;,
                 &#39;State&#39; =&gt; 0
               }, &#39;Win32::OLE&#39; &#41;;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Also, which Cygwin version are you using?  Your example works fine
&gt; with my &#40;obsolete&#41; Cygwin 1.5 install.
</div>
Latest 1.7.8 with my official perl
-- 
Reini Urban
<span class="clickylink"><a target="new" rel="nofollow" href="http://phpwiki.org/">http://phpwiki.org/</a></span>           <span class="clickylink"><a target="new" rel="nofollow" href="http://murbreak.at/">http://murbreak.at/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;24&nbsp;15:59:12&nbsp;2011</span>
    <span class="description">jand [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #65052] Cannot create ADODB.Connection object under Cygwin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 24 Jan 2011 12:59:02 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-OLE [...] rt.cpan.org&gt;, &#34;&#39;undisclosed-recipients:&#39;&#34; [...] bestpractical.com</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jan Dubois&#34; &lt;jand [...] activestate.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 24 Jan 2011, Reini Urban via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Can you please run with warnings enabled?  Win32::OLE will print
&gt; &gt; additional diagnostics on OLE calls when warnings are on.
</div>&gt; 
&gt; $ perl -MWin32::OLE -wle &#39;print Win32::OLE-&gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#39;
&gt; Win32::OLE&#40;0.1709&#41; error 0x8007007e: &#34;The specified module could not be
&gt; found&#34; at -e line 1
&gt;         eval {...} called at -e line 1
&gt; Use of uninitialized value in print at -e line 1.
</div>
[...]
 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Is this just 32-bit ActivePerl on the same machine, or on a different
&gt; &gt; one?
</div>&gt; 
&gt; I crosschecked with strawberry on the same machine, where
&gt; ADODB.Connection is registered.
&gt; c:\strawberry&gt; perl -MData::Dumper -MWin32::OLE -le &#34;print
&gt; Dumper&#40;Win32::OLE-&gt;new&#40;q&#40;ADODB.Connection&#41;&#41;&#41;&#34;
&gt; $VAR1 = bless&#40; {
&gt;                  &#39;Properties&#39; =&gt; bless&#40; {
</div>
[...]

Could you try running Cygwin Perl from cmd.exe instead of bash?  I&#39;ve
found several references  with Google that certain COM components &#40;WMI,
ADODB&#41; cannot be instantiated when the program is started from bash,
but work fine when started from cmd.exe.

If that is the case, start looking into differences in those environments,
especially settings of PATH and maybe COMSPEC, and try to copy setting
from cmd.exe to bash until it starts working.

Cheers,
-Jan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;24&nbsp;17:05:57&nbsp;2011</span>
    <span class="description">rkitover@cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #65052] Cannot create ADODB.Connection object under Cygwin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 24 Jan 2011 17:05:00 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Win32-OLE [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rafael Kitover &lt;rkitover [...] cpan.org&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 1/24/2011 3:59 PM, jand@ActiveState.com via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=65052">https://rt.cpan.org/Ticket/Display.html?id=65052</a></span>&gt;
&gt;
&gt; On Mon, 24 Jan 2011, Reini Urban via RT wrote:
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;&gt; Can you please run with warnings enabled?  Win32::OLE will print
&gt;&gt;&gt; additional diagnostics on OLE calls when warnings are on.
</div>&gt;&gt;
&gt;&gt; $ perl -MWin32::OLE -wle &#39;print Win32::OLE-&gt;new&#40;&#34;ADODB.Connection&#34;&#41;&#39;
&gt;&gt; Win32::OLE&#40;0.1709&#41; error 0x8007007e: &#34;The specified module could not be
&gt;&gt; found&#34; at -e line 1
&gt;&gt;          eval {...} called at -e line 1
&gt;&gt; Use of uninitialized value in print at -e line 1.
</div>&gt;
&gt; [...]
&gt;
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;&gt; Is this just 32-bit ActivePerl on the same machine, or on a different
&gt;&gt;&gt; one?
</div>&gt;&gt;
&gt;&gt; I crosschecked with strawberry on the same machine, where
&gt;&gt; ADODB.Connection is registered.
&gt;&gt; c:\strawberry&gt;  perl -MData::Dumper -MWin32::OLE -le &#34;print
&gt;&gt; Dumper&#40;Win32::OLE-&gt;new&#40;q&#40;ADODB.Connection&#41;&#41;&#41;&#34;
&gt;&gt; $VAR1 = bless&#40; {
&gt;&gt;                   &#39;Properties&#39; =&gt;  bless&#40; {
</div>&gt;
&gt; [...]
&gt;
&gt; Could you try running Cygwin Perl from cmd.exe instead of bash?  I&#39;ve
&gt; found several references  with Google that certain COM components &#40;WMI,
&gt; ADODB&#41; cannot be instantiated when the program is started from bash,
&gt; but work fine when started from cmd.exe.
&gt;
&gt; If that is the case, start looking into differences in those environments,
&gt; especially settings of PATH and maybe COMSPEC, and try to copy setting
&gt; from cmd.exe to bash until it starts working.
&gt;
&gt; Cheers,
&gt; -Jan
</div>
That is indeed the case.

There are a whole bunch of warnings, but the object is returned:

c:\users\rkitover&gt;\cygwin\bin\perl -MWin32::OLE -MData::Dumper -wle 
&#34;print Dumper&#40;Win32::OLE-&gt;new&#40;&#39;ADODB.Connection&#39;&#41;&#41;&#34;
Win32::OLE&#40;0.1709&#41; error 0x8002000e: &#34;Invalid number of parameters&#34;
     in METHOD/PROPERTYGET &#34;Item&#34; at 
/usr/lib/perl5/5.10/i686-cygwin/Data/Dumper.pm line 190
Win32::OLE&#40;0.1709&#41; error 0x8002000e: &#34;Invalid number of parameters&#34;
     in METHOD/PROPERTYGET &#34;Item&#34; at 
/usr/lib/perl5/5.10/i686-cygwin/Data/Dumper.pm line 190
OLE exception from &#34;ADODB.Connection&#34;:

Operation is not allowed when the object is closed.

Win32::OLE&#40;0.1709&#41; error 0x80020009: &#34;Exception occurred&#34;
     in METHOD/PROPERTYGET &#34;DefaultDatabase&#34; at 
/usr/lib/perl5/5.10/i686-cygwin/Data/Dumper.pm line 190
$VAR1 = bless&#40; {
                  &#39;Properties&#39; =&gt; bless&#40; {
                                           &#39;Count&#39; =&gt; 14,
                                           &#39;Item&#39; =&gt; undef
                                         }, &#39;Win32::OLE&#39; &#41;,
                  &#39;ConnectionString&#39; =&gt; &#39;Provider=MSDASQL.1&#39;,
                  &#39;CommandTimeout&#39; =&gt; 30,
                  &#39;ConnectionTimeout&#39; =&gt; 15,
                  &#39;Version&#39; =&gt; &#39;6.1&#39;,
                  &#39;Errors&#39; =&gt; bless&#40; {
                                       &#39;Count&#39; =&gt; 0,
                                       &#39;Item&#39; =&gt; undef
                                     }, &#39;Win32::OLE&#39; &#41;,
                  &#39;DefaultDatabase&#39; =&gt; undef,
                  &#39;IsolationLevel&#39; =&gt; 4096,
                  &#39;Attributes&#39; =&gt; 0,
                  &#39;CursorLocation&#39; =&gt; 2,
                  &#39;Mode&#39; =&gt; 0,
                  &#39;Provider&#39; =&gt; &#39;MSDASQL.1&#39;,
                  &#39;State&#39; =&gt; 0
                }, &#39;Win32::OLE&#39; &#41;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;24&nbsp;18:18:29&nbsp;2011</span>
    <span class="description">jand [...] ActiveState.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> RE: [rt.cpan.org #65052] Cannot create ADODB.Connection object under Cygwin</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 24 Jan 2011 15:18:18 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &lt;bug-Win32-OLE [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Jan Dubois&#34; &lt;jand [...] activestate.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, 24 Jan 2011, rkitover@cpan.org via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 1/24/2011 3:59 PM, jand@ActiveState.com via RT wrote:
<div class="message-stanza open">&gt; &gt; Could you try running Cygwin Perl from cmd.exe instead of bash?  I&#39;ve
&gt; &gt; found several references  with Google that certain COM components &#40;WMI,
&gt; &gt; ADODB&#41; cannot be instantiated when the program is started from bash,
&gt; &gt; but work fine when started from cmd.exe.
</div></div>
[...] 

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; That is indeed the case.
&gt; 
&gt; There are a whole bunch of warnings, but the object is returned:
</div>
Those warnings are normal.  Dumping the whole connection object will
try to fetch several properties that aren&#39;t initialized in the closed
state of the object.  You get the same warnings with regular Perl.

I&#39;m going to close this bug, as it seems to be neither an issue with
Perl nor with Win32::OLE but just with the way the Cygwin bash shell
sets up the environment, and therefore should be fixed there.

Cheers,
-Jan
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;24&nbsp;18:19:07&nbsp;2011</span>
    <span class="description">JDB [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;08&nbsp;12:56:59&nbsp;2012</span>
    <span class="description">RURBAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Second patch attached, for the preferred version to copy the whole ENV 
when someones requests use Win32.
We don&#39;t want the full ENV in pure cygwin, only on use Win32.

-- 
Reini Urban
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> 0001-initialize-cygwin-on-use-Win32-with-full-ENV-for-ADO.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">From 043609d47bfadc9ff3000f77df24d4dc891739d6 Mon Sep 17 00:00:00 2001
From: Reini Urban &lt;rurban@x-ray.at&gt;
Date: Wed, 8 Feb 2012 11:49:09 -0600
Subject: [PATCH] initialize cygwin on use Win32 with full ENV for ADODB

---
 cpan/Win32/Win32.pm |    4 ++++
 1 files changed, 4 insertions&#40;+&#41;, 0 deletions&#40;-&#41;

diff --git a/cpan/Win32/Win32.pm b/cpan/Win32/Win32.pm
index d37352a..c6c6121 100644
--- a/cpan/Win32/Win32.pm
+++ b/cpan/Win32/Win32.pm
@@ -560,6 +560,10 @@ sub _GetOSName {
 local $^W = 0;
 bootstrap Win32;
 
+# On cygwin copy the whole ENV for certain win32 programs, 
+# e.g. ADODB needs %COMMONPROGRAMFILES%
+Win32::SyncCygwinWin32Env&#40;&#41; if $^O eq &#39;cygwin&#39;;
+
 1;
 
 __END__
-- 
1.7.5.4

</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;08&nbsp;12:57:00&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
