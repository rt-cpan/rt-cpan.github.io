<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #106168 for Net-IP-LPM: Does not load on some architectures</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #106168 for Net-IP-LPM: Does not load on some architectures</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-IP-LPM/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-IP-LPM/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-IP-LPM/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-IP-LPM/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-IP-LPM">Net-IP-LPM CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">106168</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-IP-LPM/Active/">Net-IP-LPM</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">TPODER [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jmaslak [...] antelope.net

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-247796-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-247797-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;31&nbsp;00:39:27&nbsp;2015</span>
    <span class="description">jmaslak [...] antelope.net -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Does not load on some architectures</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">First, I want to thank you for doing this module with a good algorithm and with the C code!  There are so many bad ways people have done this.  I&#39;ve found it very useful.  This is a long message - the short summary is that I want you to do a s/CCFLAGS/OPTIMIZE/g inside Makefile.PL - only one line needs to change and your module will work on a lot more platforms, and possibly compile more like you expect it to.

Long details:

The CCFLAGS =&gt; &#39;-O3&#39; line in Makefile.PL is causing this to not compile on some architectures.

It works fine on ordinary Linux x64 architectures, but on other systems, overwriting the CCFLAGS is bad and breaks the module.

For example, on my Debian ARM-based system, if I comment out the line in Makefile.PL where you overwrite CCFLAGS, the tests succeed.  But if I leave Makefile.PL the way it was in the distribution, it fails during tests with a handshake failure error.  I&#39;ve included an example of the failure at the end of this comment.  It also fails on Solaris.  You&#39;ll probably see some of these at <span class="clickylink"><a target="new" rel="nofollow" href="http://matrix.cpantesters.org/?dist=Net-IP-LPM+1.09">http://matrix.cpantesters.org/?dist=Net-IP-LPM+1.09</a></span> within 24 hours or so &#40;you&#39;ll see the red at the top under Solaris, and also at least some red on Perl 5.22.0 on Linux, after the cpantesters.org system gets a chance to process my test results&#41;.

Here&#39;s what one of the compiles looks like when I remove your CCFLAGS override &#40;this builds a file that can be dynamically loaded - it works&#41;:

=======
cc -c  -I. -D_REENTRANT -D_GNU_SOURCE -fPIC -fwrapv -fno-strict-aliasing -pipe -fstack-protector-strong -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-thread-multi/CORE&#34;   LPM.c
=======

Here&#39;s one that fails &#40;as the module is delivered, with the override of CCFLAGS&#41;:
=======
cc -c  -I. -O3 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-thread-multi/CORE&#34;   LPM.c
=======

As you can see, several -D defines from the Perl build are missing when the CCFLAGS variable they are in is overwritten with &#34;-O3&#34;, causing critical structures to be mismatched.  Also, there still is an -O2 present following your -O3 - it may not do what you think it is doing.

I then changed the &#34;CCFLAGS =&gt; &#39;-O3&#39;&#34; line in Makefile.PL to &#34;OPTIMIZE =&gt; &#39;-O3&#39;&#34;.  This, I believe does what you want - the important defines like -D_FILE_OFFSET_BITS remain, and the old -O2 is gone:

======
cc -c  -I. -D_REENTRANT -D_GNU_SOURCE -fPIC -fwrapv -fno-strict-aliasing -pipe -fstack-protector-strong -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -O3   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-thread-multi/CORE&#34;   LPM.c
======

I&#39;ve attached a patch &#40;but it really is just s/CCFLAGS/OPTIMIZE/g in Makefile.PL.  FWIW, -O3 vs. -O2 doesn&#39;t seem to be noticeably different on my systems for performance with this module.

Example failure:

root@armperl:~/Net-IP-LPM-1.09# make test                                                                                                                                                                                                                               [17/316]
cp lib/Net/IP/LPM.pm blib/lib/Net/IP/LPM.pm
Running Mkbootstrap for Net::IP::LPM &#40;&#41;
chmod 644 &#34;LPM.bs&#34;
&#34;/usr/local/perlbrew/perls/5.22.0.thread/bin/perl&#34; &#34;/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/ExtUtils/xsubpp&#34;  -typemap &#34;/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/ExtUtils/typemap&#34;  LPM.xs &gt; LPM.xsc &#38;&#38; mv LPM.xsc LPM.c
Please specify prototyping behavior for LPM.xs &#40;see perlxs manual&#41;
cc -c  -I. -O3 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-thread-multi/CORE&#34;   LPM.c
cc -c  -I. -O3 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-thread-multi/CORE&#34;   lpm_lib.c
rm -f blib/arch/auto/Net/IP/LPM/LPM.so
cc  -shared -O2 -L/usr/local/lib -fstack-protector-strong LPM.o lpm_lib.o  -o blib/arch/auto/Net/IP/LPM/LPM.so        \
        \

chmod 755 blib/arch/auto/Net/IP/LPM/LPM.so
&#34;/usr/local/perlbrew/perls/5.22.0.thread/bin/perl&#34; -MExtUtils::Command::MM -e &#39;cp_nonempty&#39; -- LPM.bs blib/arch/auto/Net/IP/LPM/LPM.bs 644
PERL_DL_NONLAZY=1 &#34;/usr/local/perlbrew/perls/5.22.0.thread/bin/perl&#34; &#34;-MExtUtils::Command::MM&#34; &#34;-MTest::Harness&#34; &#34;-e&#34; &#34;undef *Test::Harness::Switches; test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34; t/*.t
t/01-Net-IP-LPM.t ... LPM.c: loadable library and perl binaries are mismatched &#40;got handshake key 0x8d80080, needed 0x8f80080&#41;
t/01-Net-IP-LPM.t ... Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 13/13 subtests
t/02-performance.t .. LPM.c: loadable library and perl binaries are mismatched &#40;got handshake key 0x8d80080, needed 0x8f80080&#41;
t/02-performance.t .. Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
Failed 2/2 subtests

Test Summary Report
-------------------
t/01-Net-IP-LPM.t &#40;Wstat: 256 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 1
  Parse errors: Bad plan.  You planned 13 tests but ran 0.
t/02-performance.t &#40;Wstat: 256 Tests: 0 Failed: 0&#41;
  Non-zero exit status: 1
  Parse errors: Bad plan.  You planned 2 tests but ran 0.
Files=2, Tests=0,  1 wallclock secs &#40; 0.14 usr  0.02 sys +  0.43 cusr  0.04 csys =  0.63 CPU&#41;
Result: FAIL
Failed 2/2 test programs. 0/0 subtests failed.
Makefile:1013: recipe for target &#39;test_dynamic&#39; failed
make: *** [test_dynamic] Error 1
root@armperl:~/Net-IP-LPM-1.09# vi Makefile.PL
root@armperl:~/Net-IP-LPM-1.09# perl Makefile.PL
Generating a Unix-style Makefile
Writing Makefile for Net::IP::LPM
Writing MYMETA.yml and MYMETA.json
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> net-ip-lpm-jcm.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff --git a/Makefile.PL b/Makefile.PL
index 0bee1d3..21b60f0 100644
--- a/Makefile.PL
+++ b/Makefile.PL
@@ -20,8 +20,8 @@ WriteMakefile&#40;
     #OBJECT            =&gt; &#39;lpm_lib.o&#39;, # link all the C files too
     #MYEXTLIB          =&gt; &#39;libnf/libnf$&#40;LIB_EXT&#41;&#39;,
     NORECURS          =&gt; 0,
-    #CCFLAGS                     =&gt; &#39;-std=c99 -Wall -pedantic -O3&#39;
-    CCFLAGS                      =&gt; &#39;-O3&#39;
+    #OPTIMIZE                    =&gt; &#39;-std=c99 -Wall -pedantic -O3&#39;
+    OPTIMIZE                     =&gt; &#39;-O3&#39;
 &#41;;
 if  &#40;eval {require ExtUtils::Constant; 1}&#41; {
   # If you edit these definitions to change the constants used by this module,
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;03:54:26&nbsp;2015</span>
    <span class="description">TPODER [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;04:52:26&nbsp;2015</span>
    <span class="description">TPODER [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,
 

   thank for doing good work with processing and reporting the issue. The new 1.10 &#40;uploaded while minutes ago&#41; module solves the problem &#40;also solves some less important bugs/issues&#41;. 

Thanks a lot. 


On Fri Jul 31 00:39:27 2015, JMASLAK wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; First, I want to thank you for doing this module with a good algorithm
&gt; and with the C code!  There are so many bad ways people have done
&gt; this.  I&#39;ve found it very useful.  This is a long message - the short
&gt; summary is that I want you to do a s/CCFLAGS/OPTIMIZE/g inside
&gt; Makefile.PL - only one line needs to change and your module will work
&gt; on a lot more platforms, and possibly compile more like you expect it
&gt; to.
&gt; 
&gt; Long details:
&gt; 
&gt; The CCFLAGS =&gt; &#39;-O3&#39; line in Makefile.PL is causing this to not
&gt; compile on some architectures.
&gt; 
&gt; It works fine on ordinary Linux x64 architectures, but on other
&gt; systems, overwriting the CCFLAGS is bad and breaks the module.
&gt; 
&gt; For example, on my Debian ARM-based system, if I comment out the line
&gt; in Makefile.PL where you overwrite CCFLAGS, the tests succeed.  But if
&gt; I leave Makefile.PL the way it was in the distribution, it fails
&gt; during tests with a handshake failure error.  I&#39;ve included an example
&gt; of the failure at the end of this comment.  It also fails on Solaris.
&gt; You&#39;ll probably see some of these at
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://matrix.cpantesters.org/?dist=Net-IP-LPM+1.09">http://matrix.cpantesters.org/?dist=Net-IP-LPM+1.09</a></span> within 24 hours or
&gt; so &#40;you&#39;ll see the red at the top under Solaris, and also at least
&gt; some red on Perl 5.22.0 on Linux, after the cpantesters.org system
&gt; gets a chance to process my test results&#41;.
&gt; 
&gt; Here&#39;s what one of the compiles looks like when I remove your CCFLAGS
&gt; override &#40;this builds a file that can be dynamically loaded - it
&gt; works&#41;:
&gt; 
&gt; =======
&gt; cc -c  -I. -D_REENTRANT -D_GNU_SOURCE -fPIC -fwrapv -fno-strict-
&gt; aliasing -pipe -fstack-protector-strong -I/usr/local/include
&gt; -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -O2
&gt; -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-
&gt; I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-
&gt; thread-multi/CORE&#34;   LPM.c
&gt; =======
&gt; 
&gt; Here&#39;s one that fails &#40;as the module is delivered, with the override
&gt; of CCFLAGS&#41;:
&gt; =======
&gt; cc -c  -I. -O3 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-
&gt; I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-
&gt; thread-multi/CORE&#34;   LPM.c
&gt; =======
&gt; 
&gt; As you can see, several -D defines from the Perl build are missing
&gt; when the CCFLAGS variable they are in is overwritten with &#34;-O3&#34;,
&gt; causing critical structures to be mismatched.  Also, there still is an
&gt; -O2 present following your -O3 - it may not do what you think it is
&gt; doing.
&gt; 
&gt; I then changed the &#34;CCFLAGS =&gt; &#39;-O3&#39;&#34; line in Makefile.PL to &#34;OPTIMIZE
&gt; =&gt; &#39;-O3&#39;&#34;.  This, I believe does what you want - the important defines
&gt; like -D_FILE_OFFSET_BITS remain, and the old -O2 is gone:
&gt; 
&gt; ======
&gt; cc -c  -I. -D_REENTRANT -D_GNU_SOURCE -fPIC -fwrapv -fno-strict-
&gt; aliasing -pipe -fstack-protector-strong -I/usr/local/include
&gt; -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -D_FORTIFY_SOURCE=2 -O3
&gt; -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-
&gt; I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-
&gt; thread-multi/CORE&#34;   LPM.c
&gt; ======
&gt; 
&gt; I&#39;ve attached a patch &#40;but it really is just s/CCFLAGS/OPTIMIZE/g in
&gt; Makefile.PL.  FWIW, -O3 vs. -O2 doesn&#39;t seem to be noticeably
&gt; different on my systems for performance with this module.
&gt; 
&gt; Example failure:
&gt; 
&gt; root@armperl:~/Net-IP-LPM-1.09# make test
&gt; [17/316]
&gt; cp lib/Net/IP/LPM.pm blib/lib/Net/IP/LPM.pm
&gt; Running Mkbootstrap for Net::IP::LPM &#40;&#41;
&gt; chmod 644 &#34;LPM.bs&#34;
&gt; &#34;/usr/local/perlbrew/perls/5.22.0.thread/bin/perl&#34;
&gt; &#34;/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/ExtUtils/xsubpp&#34;
&gt; -typemap
&gt; &#34;/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/ExtUtils/typemap&#34;
&gt; LPM.xs &gt; LPM.xsc &#38;&#38; mv LPM.xsc LPM.c
&gt; Please specify prototyping behavior for LPM.xs &#40;see perlxs manual&#41;
&gt; cc -c  -I. -O3 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-
&gt; I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-
&gt; thread-multi/CORE&#34;   LPM.c
&gt; cc -c  -I. -O3 -O2   -DVERSION=\&#34;1.09\&#34; -DXS_VERSION=\&#34;1.09\&#34; -fPIC &#34;-
&gt; I/usr/local/perlbrew/perls/5.22.0.thread/lib/5.22.0/armv7l-linux-
&gt; thread-multi/CORE&#34;   lpm_lib.c
&gt; rm -f blib/arch/auto/Net/IP/LPM/LPM.so
&gt; cc  -shared -O2 -L/usr/local/lib -fstack-protector-strong LPM.o
&gt; lpm_lib.o  -o blib/arch/auto/Net/IP/LPM/LPM.so        \
&gt;         \
&gt; 
&gt; chmod 755 blib/arch/auto/Net/IP/LPM/LPM.so
&gt; &#34;/usr/local/perlbrew/perls/5.22.0.thread/bin/perl&#34;
&gt; -MExtUtils::Command::MM -e &#39;cp_nonempty&#39; -- LPM.bs
&gt; blib/arch/auto/Net/IP/LPM/LPM.bs 644
&gt; PERL_DL_NONLAZY=1 &#34;/usr/local/perlbrew/perls/5.22.0.thread/bin/perl&#34;
&gt; &#34;-MExtUtils::Command::MM&#34; &#34;-MTest::Harness&#34; &#34;-e&#34; &#34;undef
&gt; *Test::Harness::Switches; test_harness&#40;0, &#39;blib/lib&#39;, &#39;blib/arch&#39;&#41;&#34;
&gt; t/*.t
&gt; t/01-Net-IP-LPM.t ... LPM.c: loadable library and perl binaries are
&gt; mismatched &#40;got handshake key 0x8d80080, needed 0x8f80080&#41;
&gt; t/01-Net-IP-LPM.t ... Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
&gt; Failed 13/13 subtests
&gt; t/02-performance.t .. LPM.c: loadable library and perl binaries are
&gt; mismatched &#40;got handshake key 0x8d80080, needed 0x8f80080&#41;
&gt; t/02-performance.t .. Dubious, test returned 1 &#40;wstat 256, 0x100&#41;
&gt; Failed 2/2 subtests
&gt; 
&gt; Test Summary Report
&gt; -------------------
&gt; t/01-Net-IP-LPM.t &#40;Wstat: 256 Tests: 0 Failed: 0&#41;
&gt;   Non-zero exit status: 1
&gt;   Parse errors: Bad plan.  You planned 13 tests but ran 0.
&gt; t/02-performance.t &#40;Wstat: 256 Tests: 0 Failed: 0&#41;
&gt;   Non-zero exit status: 1
&gt;   Parse errors: Bad plan.  You planned 2 tests but ran 0.
&gt; Files=2, Tests=0,  1 wallclock secs &#40; 0.14 usr  0.02 sys +  0.43 cusr
&gt; 0.04 csys =  0.63 CPU&#41;
&gt; Result: FAIL
&gt; Failed 2/2 test programs. 0/0 subtests failed.
&gt; Makefile:1013: recipe for target &#39;test_dynamic&#39; failed
&gt; make: *** [test_dynamic] Error 1
&gt; root@armperl:~/Net-IP-LPM-1.09# vi Makefile.PL
&gt; root@armperl:~/Net-IP-LPM-1.09# perl Makefile.PL
&gt; Generating a Unix-style Makefile
&gt; Writing Makefile for Net::IP::LPM
&gt; Writing MYMETA.yml and MYMETA.json
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;04:52:29&nbsp;2015</span>
    <span class="description">TPODER [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction people Set odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Aug&nbsp;03&nbsp;04:52:30&nbsp;2015</span>
    <span class="description">TPODER [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
