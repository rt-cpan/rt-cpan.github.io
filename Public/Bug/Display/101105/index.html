<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #101105 for Algorithm-Diff: [PATCH] 2x faster LCS</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #101105 for Algorithm-Diff: [PATCH] 2x faster LCS</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Algorithm-Diff/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Algorithm-Diff/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Algorithm-Diff/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Algorithm-Diff/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Algorithm-Diff">Algorithm-Diff CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">101105</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Algorithm-Diff/Active/">Algorithm-Diff</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
XENU [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-844-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-845-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;23&nbsp;15:41:34&nbsp;2014</span>
    <span class="description">XENU [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] 2x faster LCS</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hello,

I have optimized LCS function, so now it runs 96% faster when $keyGen is undef, the only change is removal of unnecessary calls of keygen functions. Looks like subroutine calls are really expensive in Perl.

Unfortunately my patch has one downside, when $keyGen is actually defined, LCS is 4% slower than it was without my changes. I don&#39;t think it&#39;s a problem, because typically LCS is used without $keyGen.

Patch is attached.

Cheers,
Tomasz

Test script:

use strict;
use warnings;

use Algorithm::Diff;
use Algorithm::OldDiff;
use Benchmark qw/:all/;
use Digest::MD5 qw/md5_hex/;

my @aa = &#40;&#40;&#39;z&#39;&#41; x 100, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#40;&#39;dupa&#39;&#41;x70000, &#39;d&#39;, &#39;kupa&#39;&#41;;
my @bb = &#40;&#40;&#39;z&#39;&#41; x 100, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#40;&#39;dupz&#39;&#41;x70000, &#39;f&#39;, &#39;kupa&#39;&#41;;

my $hash = sub { md5_hex&#40;shift&#41; };

cmpthese&#40;50, {
    &#39;my patch&#39; =&gt; sub { Algorithm::Diff::LCS&#40;\@aa, \@bb&#41; },
    &#39;orginal&#39; =&gt; sub { Algorithm::OldDiff::LCS&#40;\@aa, \@bb&#41; },
}&#41;;

cmpthese&#40;50, {
    &#39;my patch&#39; =&gt; sub { Algorithm::Diff::LCS&#40;\@aa, \@bb, $hash&#41; },
    &#39;original&#39; =&gt; sub { Algorithm::OldDiff::LCS&#40;\@aa, \@bb, $hash&#41; },
}&#41;;

Results:

PS E:\Dokumenty\difftest&gt; perl .\lcs.pl
           Rate  orginal my patch
orginal  2.41/s       --     -49%
my patch 4.72/s      96%       --
           Rate my patch original
my patch 1.39/s       --      -3%
original 1.44/s       4%       --
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> faster_lcs.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">ÿþ- - -   D i f f . p m . o l d 	 2 0 1 4 - 1 1 - 2 6   0 6 : 4 1 : 5 4 . 0 0 0 0 0 0 0 0 0   + 0 1 0 0 
 + + +   D i f f . p m 	 2 0 1 4 - 1 2 - 2 3   2 1 : 0 3 : 5 1 . 0 0 0 0 0 0 0 0 0   + 0 1 0 0 
 @ @   - 4 2 , 7   + 4 2 , 7   @ @ 
           f o r   &#40;   $ i n d e x   =   $ s t a r t   ;   $ i n d e x   &lt; =   $ e n d   ;   $ i n d e x + +   &#41; 
           { 
                   m y   $ e l e m e n t   =   $ a C o l l e c t i o n - &gt; [ $ i n d e x ] ; 
 -                 m y   $ k e y   =   &#38; $ k e y G e n &#40;   $ e l e m e n t ,   @ _   &#41; ; 
 +                 m y   $ k e y   =   $ k e y G e n   ?   &#38; $ k e y G e n &#40;   $ e l e m e n t ,   @ _   &#41;   :   $ e l e m e n t ; 
                   i f   &#40;   e x i s t s &#40;   $ d { $ k e y }   &#41;   &#41; 
                   { 
                           u n s h i f t   &#40;   @ {   $ d { $ k e y }   } ,   $ i n d e x   &#41; ; 
 @ @   - 1 4 7 , 1 2   + 1 4 7 , 7   @ @ 
   
           #   s e t   u p   c o d e   r e f s 
           #   N o t e   t h a t   t h e s e   a r e   o p t i m i z e d . 
 -         i f   &#40;   ! d e f i n e d &#40; $ k e y G e n &#41;   &#41;         #   o p t i m i z e   f o r   s t r i n g s 
 -         { 
 -                 $ k e y G e n   =   s u b   {   $ _ [ 0 ]   } ; 
 -                 $ c o m p a r e   =   s u b   {   m y   &#40;   $ a ,   $ b   &#41;   =   @ _ ;   $ a   e q   $ b   } ; 
 -         } 
 -         e l s e 
 +         i f   &#40;   $ k e y G e n   &#41;         #   o p t i m i z e   f o r   s t r i n g s 
           { 
                   $ c o m p a r e   =   s u b   { 
                           m y   $ a   =   s h i f t ; 
 @ @   - 1 7 5 , 7   + 1 7 0 , 8   @ @ 
                   #   F i r s t   w e   p r u n e   o f f   a n y   c o m m o n   e l e m e n t s   a t   t h e   b e g i n n i n g 
                   w h i l e   &#40;   $ a S t a r t   &lt; =   $ a F i n i s h 
                           a n d   $ b S t a r t   &lt; =   $ b F i n i s h 
 -                         a n d   &#38; $ c o m p a r e &#40;   $ a - &gt; [ $ a S t a r t ] ,   $ b - &gt; [ $ b S t a r t ] ,   @ _   &#41;   &#41; 
 +                         a n d   &#40;   $ k e y G e n   ?   &#38; $ c o m p a r e &#40;   $ a - &gt; [ $ a S t a r t ] ,   $ b - &gt; [ $ b S t a r t ] ,   @ _   &#41; 
 +                                                     :   &#40;   $ a - &gt; [ $ a S t a r t ]   e q   $ b - &gt; [ $ b S t a r t ]   &#41;   &#41;   &#41; 
                   { 
                           $ m a t c h V e c t o r - &gt; [   $ a S t a r t + +   ]   =   $ b S t a r t + + ; 
                           $ p r u n e d C o u n t + + ; 
 @ @   - 1 8 4 , 7   + 1 8 0 , 8   @ @ 
                   #   n o w   t h e   e n d 
                   w h i l e   &#40;   $ a S t a r t   &lt; =   $ a F i n i s h 
                           a n d   $ b S t a r t   &lt; =   $ b F i n i s h 
 -                         a n d   &#38; $ c o m p a r e &#40;   $ a - &gt; [ $ a F i n i s h ] ,   $ b - &gt; [ $ b F i n i s h ] ,   @ _   &#41;   &#41; 
 +                         a n d   &#40;   $ k e y G e n   ?   &#38; $ c o m p a r e &#40;   $ a - &gt; [ $ a F i n i s h ] ,   $ b - &gt; [ $ b F i n i s h ] ,   @ _   &#41; 
 +                                                     :   &#40;   $ a - &gt; [ $ a F i n i s h ]   e q   $ b - &gt; [ $ b F i n i s h ]   &#41;   &#41;   &#41; 
                   { 
                           $ m a t c h V e c t o r - &gt; [   $ a F i n i s h - -   ]   =   $ b F i n i s h - - ; 
                           $ p r u n e d C o u n t + + ; 
 @ @   - 2 0 0 , 7   + 1 9 7 , 7   @ @ 
           m y   &#40;   $ i ,   $ a i ,   $ j ,   $ k   &#41; ; 
           f o r   &#40;   $ i   =   $ a S t a r t   ;   $ i   &lt; =   $ a F i n i s h   ;   $ i + +   &#41; 
           { 
 -                 $ a i   =   &#38; $ k e y G e n &#40;   $ a - &gt; [ $ i ] ,   @ _   &#41; ; 
 +                 $ a i   =   $ k e y G e n   ?   &#38; $ k e y G e n &#40;   $ a - &gt; [ $ i ] ,   @ _   &#41;   :   $ a - &gt; [ $ i ] ; 
                   i f   &#40;   e x i s t s &#40;   $ b M a t c h e s - &gt; { $ a i }   &#41;   &#41; 
                   { 
                           $ k   =   0 ; 
 </div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Dec&nbsp;23&nbsp;17:42:47&nbsp;2014</span>
    <span class="description">XENU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Oops, just noticed that patch file contains BOM, sorry for that, I&#39;m attaching corrected version.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> faster_lcs.patch</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- Diff.pm.old	2014-11-26 06:41:54.000000000 +0100
+++ Diff.pm	2014-12-23 21:03:51.000000000 +0100
@@ -42,7 +42,7 @@
     for &#40; $index = $start ; $index &lt;= $end ; $index++ &#41;
     {
         my $element = $aCollection-&gt;[$index];
-        my $key = &#38;$keyGen&#40; $element, @_ &#41;;
+        my $key = $keyGen ? &#38;$keyGen&#40; $element, @_ &#41; : $element;
         if &#40; exists&#40; $d{$key} &#41; &#41;
         {
             unshift &#40; @{ $d{$key} }, $index &#41;;
@@ -147,12 +147,7 @@
 
     # set up code refs
     # Note that these are optimized.
-    if &#40; !defined&#40;$keyGen&#41; &#41;    # optimize for strings
-    {
-        $keyGen = sub { $_[0] };
-        $compare = sub { my &#40; $a, $b &#41; = @_; $a eq $b };
-    }
-    else
+    if &#40; $keyGen &#41;    # optimize for strings
     {
         $compare = sub {
             my $a = shift;
@@ -175,7 +170,8 @@
         # First we prune off any common elements at the beginning
         while &#40; $aStart &lt;= $aFinish
             and $bStart &lt;= $bFinish
-            and &#38;$compare&#40; $a-&gt;[$aStart], $b-&gt;[$bStart], @_ &#41; &#41;
+            and &#40; $keyGen ? &#38;$compare&#40; $a-&gt;[$aStart], $b-&gt;[$bStart], @_ &#41;
+                          : &#40; $a-&gt;[$aStart] eq $b-&gt;[$bStart] &#41; &#41; &#41;
         {
             $matchVector-&gt;[ $aStart++ ] = $bStart++;
             $prunedCount++;
@@ -184,7 +180,8 @@
         # now the end
         while &#40; $aStart &lt;= $aFinish
             and $bStart &lt;= $bFinish
-            and &#38;$compare&#40; $a-&gt;[$aFinish], $b-&gt;[$bFinish], @_ &#41; &#41;
+            and &#40; $keyGen ? &#38;$compare&#40; $a-&gt;[$aFinish], $b-&gt;[$bFinish], @_ &#41;
+                          : &#40; $a-&gt;[$aFinish] eq $b-&gt;[$bFinish] &#41; &#41; &#41;
         {
             $matchVector-&gt;[ $aFinish-- ] = $bFinish--;
             $prunedCount++;
@@ -200,7 +197,7 @@
     my &#40; $i, $ai, $j, $k &#41;;
     for &#40; $i = $aStart ; $i &lt;= $aFinish ; $i++ &#41;
     {
-        $ai = &#38;$keyGen&#40; $a-&gt;[$i], @_ &#41;;
+        $ai = $keyGen ? &#38;$keyGen&#40; $a-&gt;[$i], @_ &#41; : $a-&gt;[$i];
         if &#40; exists&#40; $bMatches-&gt;{$ai} &#41; &#41;
         {
             $k = 0;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;25&nbsp;23:03:39&nbsp;2014</span>
    <span class="description">tyemq [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #101105] [PATCH] 2x faster LCS</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 25 Dec 2014 20:03:28 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Algorithm-Diff [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Tye McQueen &lt;tyemq [...] cpan.org&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks!

I&#39;ll apply the patch and let you know.

Tye

On Tue, Dec 23, 2014 at 12:41 PM, Tomasz Konojacki via RT &lt;
bug-Algorithm-Diff@rt.cpan.org&gt; wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Tue Dec 23 15:41:34 2014: Request 101105 was acted upon.
&gt; Transaction: Ticket created by XENU
&gt;        Queue: Algorithm-Diff
&gt;      Subject: [PATCH] 2x faster LCS
&gt;    Broken in: &#40;no value&#41;
&gt;     Severity: &#40;no value&#41;
&gt;        Owner: Nobody
&gt;   Requestors: XENU@cpan.org
&gt;       Status: new
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=101105">https://rt.cpan.org/Ticket/Display.html?id=101105</a></span> &gt;
&gt;
&gt;
&gt; Hello,
&gt;
&gt; I have optimized LCS function, so now it runs 96% faster when $keyGen is
&gt; undef, the only change is removal of unnecessary calls of keygen functions.
&gt; Looks like subroutine calls are really expensive in Perl.
&gt;
&gt; Unfortunately my patch has one downside, when $keyGen is actually defined,
&gt; LCS is 4% slower than it was without my changes. I don&#39;t think it&#39;s a
&gt; problem, because typically LCS is used without $keyGen.
&gt;
&gt; Patch is attached.
&gt;
&gt; Cheers,
&gt; Tomasz
&gt;
&gt; Test script:
&gt;
&gt; use strict;
&gt; use warnings;
&gt;
&gt; use Algorithm::Diff;
&gt; use Algorithm::OldDiff;
&gt; use Benchmark qw/:all/;
&gt; use Digest::MD5 qw/md5_hex/;
&gt;
&gt; my @aa = &#40;&#40;&#39;z&#39;&#41; x 100, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#40;&#39;dupa&#39;&#41;x70000, &#39;d&#39;, &#39;kupa&#39;&#41;;
&gt; my @bb = &#40;&#40;&#39;z&#39;&#41; x 100, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#40;&#39;dupz&#39;&#41;x70000, &#39;f&#39;, &#39;kupa&#39;&#41;;
&gt;
&gt; my $hash = sub { md5_hex&#40;shift&#41; };
&gt;
&gt; cmpthese&#40;50, {
&gt;     &#39;my patch&#39; =&gt; sub { Algorithm::Diff::LCS&#40;\@aa, \@bb&#41; },
&gt;     &#39;orginal&#39; =&gt; sub { Algorithm::OldDiff::LCS&#40;\@aa, \@bb&#41; },
&gt; }&#41;;
&gt;
&gt; cmpthese&#40;50, {
&gt;     &#39;my patch&#39; =&gt; sub { Algorithm::Diff::LCS&#40;\@aa, \@bb, $hash&#41; },
&gt;     &#39;original&#39; =&gt; sub { Algorithm::OldDiff::LCS&#40;\@aa, \@bb, $hash&#41; },
&gt; }&#41;;
&gt;
&gt; Results:
&gt;
&gt; PS E:\Dokumenty\difftest&gt; perl .\lcs.pl
&gt;            Rate  orginal my patch
&gt; orginal  2.41/s       --     -49%
&gt; my patch 4.72/s      96%       --
&gt;            Rate my patch original
&gt; my patch 1.39/s       --      -3%
&gt; original 1.44/s       4%       --
&gt;
</div></div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Dec&nbsp;25&nbsp;23:03:39&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;15&nbsp;16:43:24&nbsp;2015</span>
    <span class="description">XENU [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Czw 25 Gru 2014, 23:03:39, TYEMQ wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks!
&gt; 
&gt; I&#39;ll apply the patch and let you know.
&gt; 
&gt; Tye
</div>
Any news?

Tomasz
</div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
