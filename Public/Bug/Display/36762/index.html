<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #36762 for Module-Build: [PATCH] VMS update</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #36762 for Module-Build: [PATCH] VMS update</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Module-Build/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Module-Build/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Module-Build/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Module-Build/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Module-Build">Module-Build CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">36762</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Module-Build/Active/">Module-Build</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
cberry [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-21558-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.2808_01    </td>
  </tr>
  <tr id="CF-21559-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;15&nbsp;00:00:47&nbsp;2008</span>
    <span class="description">cberry [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] VMS update</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The attached patch builds on something John Malmberg posted to p5p, but his was against 
blead and this is against M::B trunk at revision 11420.  This also goes further with a few things, 
such as getting ext.t to pass.  
</div></div>
</div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> mb_vms_20080614.patch</td>
  </tr>
</table>
<div class="messageattachments">
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">--- lib/Module/Build.pm;-0	Fri May 30 18:45:02 2008
+++ lib/Module/Build.pm	Sun Jun  1 16:36:23 2008
@@ -99,9 +99,7 @@ if &#40;grep {-e File::Spec-&gt;catfile&#40;$_, qw&#40;
 
 sub os_type { $OSTYPES{$^O} }
 
-sub is_vmsish {
-    return &#40;&#40;os_type&#40;&#41; || &#39;&#39;&#41; eq &#39;VMS&#39; &#38;&#38; $Config::Config{make} =~ /MM[K|S]/i&#41;
-}
+sub is_vmsish { return &#40;&#40;os_type&#40;&#41; || &#39;&#39;&#41; eq &#39;VMS&#39;&#41; }
 sub is_windowsish { return &#40;&#40;os_type&#40;&#41; || &#39;&#39;&#41; eq &#39;Windows&#39;&#41; }
 sub is_unixish { return &#40;&#40;os_type&#40;&#41; || &#39;&#39;&#41; eq &#39;Unix&#39;&#41; }
 
--- lib/Module/Build/Compat.pm;-0	Fri May 30 18:45:02 2008
+++ lib/Module/Build/Compat.pm	Thu Jun  5 13:40:45 2008
@@ -181,18 +181,7 @@ sub makefile_to_build_args {
 		       die &#34;Malformed argument &#39;$arg&#39;&#34;&#41;;
 
     # Do tilde-expansion if it looks like a tilde prefixed path
-    if &#40;$val =~ /^~/&#41; {
-        if &#40;$^O ne &#39;VMS&#39;&#41; {
-            &#40; $val &#41; = glob&#40; $val &#41;;
-        } else {
-            # TODO Home grown glob for Perl/VMS can not handle ~ yet.
-            # Can not use is_vmsish because this is for all instances
-            # of perl on VMS, not just when MMS/MMK is being used.
-
-            my $class = &#39;Module::Build&#39;;
-            &#40; $val &#41; = $class-&gt;_detildefy&#40;$val&#41;;
-        }
-    }
+    &#40; $val &#41; = Module::Build-&gt;_detildefy&#40; $val &#41; if $val =~ /^~/;
 
     if &#40;exists $makefile_to_build{$key}&#41; {
       my $trans = $makefile_to_build{$key};
@@ -249,13 +238,12 @@ sub fake_makefile {
   my $perl = $class-&gt;find_perl_interpreter;
 
   # VMS MMS/MMK need to use MCR to run the Perl image.
-  $perl = &#39;MCR &#39; . $perl if $class-&gt;is_vmsish;
+  $perl = &#39;MCR &#39; . $perl if $self-&gt;_is_vms_mms;
 
   my $noop = &#40;$class-&gt;is_windowsish ? &#39;rem&gt;nul&#39;  :
-	      $class-&gt;is_vmsish     ? &#39;Continue&#39; :
+	      $self-&gt;_is_vms_mms    ? &#39;Continue&#39; :
 	      &#39;true&#39;&#41;;
 
-  # VMS has different file type.
   my $filetype = $class-&gt;is_vmsish ? &#39;.COM&#39; : &#39;&#39;;
 
   my $Build = &#39;Build&#39; . $filetype . &#39; --makefile_env_macros 1&#39;;
@@ -265,7 +253,7 @@ all : force_do_it
 	$perl $Build
 realclean : force_do_it
 	$perl $Build realclean
-	$perl -e 1 -e while -e unlink -e shift $args{makefile}
+	$perl -e 1 -e while -e unlink -e q=$args{makefile}=
 
 force_do_it :
 	@ $noop
@@ -279,10 +267,17 @@ $action : force_do_it
 EOF
   }
   
-  # MMS/MMK on VMS do not support .EXPORT
-  
-  $maketext .= &#34;\n.EXPORT : &#34; . join&#40;&#39; &#39;, keys %makefile_to_build&#41; . &#34;\n\n&#34;
-     unless $class-&gt;is_vmsish;
+  if &#40;$self-&gt;_is_vms_mms&#41; {
+    # Roll our own .EXPORT as MMS/MMK don&#39;t honor that directive.
+    $maketext .= &#34;\n.FIRST\n\t\@ $noop\n&#34;; 
+    for my $macro &#40;keys %makefile_to_build&#41; {
+      $maketext .= &#34;.IFDEF $macro\n\tDEFINE $macro \&#34;\$&#40;$macro&#41;\&#34;\n.ENDIF\n&#34;;
+    }
+    $maketext .= &#34;\n&#34;; 
+  }
+  else {
+    $maketext .= &#34;\n.EXPORT : &#34; . join&#40;&#39; &#39;, keys %makefile_to_build&#41; . &#34;\n\n&#34;;
+  }
   
   return $maketext;
 }
@@ -314,7 +309,7 @@ sub write_makefile {
     $in{build_class} = &#39;Module::Build&#39;;
   }
   my $class = $in{build_class};
-  $in{makefile} ||= $class-&gt;is_vmsish ? &#39;Descrip.MMS&#39; : &#39;Makefile&#39;;
+  $in{makefile} ||= $pack-&gt;_is_vms_mms ? &#39;Descrip.MMS&#39; : &#39;Makefile&#39;;
 
   open  MAKE, &#34;&gt; $in{makefile}&#34; or die &#34;Cannot write $in{makefile}: $!&#34;;
   print MAKE $pack-&gt;fake_prereqs;
@@ -322,6 +317,10 @@ sub write_makefile {
   close MAKE;
 }
 
+sub _is_vms_mms {
+  return Module::Build-&gt;is_vmsish &#38;&#38; &#40;$Config{make} =~ m/MM[SK]/i&#41;;
+}
+
 1;
 __END__
 
--- lib/Module/Build/Platform/VMS.pm;-0	Fri May 30 19:07:54 2008
+++ lib/Module/Build/Platform/VMS.pm	Sat Jun 14 16:45:01 2008
@@ -136,12 +136,15 @@ sub _quote_args {
                    ? 1 
                    : 0;
 
-  # Do not quote qualifiers that begin with &#39;/&#39; or already
-  # quoted arguments.
-  map { $_ = q&#40;&#34;&#41;.$_.q&#40;&#34;&#41; if !/^[\&#34;|\/]/ &#38;&#38; length&#40;$_&#41; &gt; 0 }
-     &#40;$got_arrayref ? @{$args[0]} 
-                    : @args
-     &#41;;
+  # Do not quote qualifiers that begin with &#39;/&#39;.
+  map { if &#40;!/^\//&#41; { 
+          $_ =~ s/\&#34;/&#34;&#34;/g;     # escape C&lt;&#34;&gt; by doubling
+          $_ = q&#40;&#34;&#41;.$_.q&#40;&#34;&#41;;
+        }
+  }
+    &#40;$got_arrayref ? @{$args[0]} 
+                   : @args
+    &#41;;
 
   return $got_arrayref ? $args[0] 
                        : join&#40;&#39; &#39;, @args&#41;;
--- t/compat.t;-0	Fri May 30 18:45:01 2008
+++ t/compat.t	Sat May 31 17:45:03 2008
@@ -23,6 +23,8 @@ if &#40; $Config{make} &#38;&#38; $^O ne &#39;VMS&#39; ? fin
     plan skip_all =&gt; &#34;Don&#39;t know how to invoke &#39;make&#39;&#34;;
 }
 
+my $is_vms_mms = &#40;$^O eq &#39;VMS&#39;&#41; &#38;&#38; &#40;$Config{make} =~ /MM[SK]/i&#41;;
+
 use_ok &#39;Module::Build&#39;;
 ensure_blib&#40;&#39;Module::Build&#39;&#41;;
 
@@ -51,8 +53,7 @@ my @make = $Config{make} eq &#39;nmake&#39; ? &#40;&#39;
 my $makefile = &#39;Makefile&#39;;
 
 # VMS MMK/MMS by convention use Descrip.MMS
-
-if &#40;$^O eq &#39;VMS&#39; &#38;&#38; $Config::Config{make} =~ /MM[K|S]/i&#41; {
+if &#40;$is_vms_mms&#41; {
     $makefile = &#39;Descrip.MMS&#39;;
 }
 
@@ -187,27 +188,14 @@ ok $mb, &#34;Module::Build-&gt;new_from_context
   my $make_macro = &#39;TEST_VERBOSE=0&#39;;
 
   # VMS MMK/MMS macros use different syntax.
-  # and this is not really a MMK/MMS macro, but one expected
-  # to be inherited by the child process running Perl.
-  my $old_test_verbose = $ENV{TEST_VERBOSE};
-  if &#40;$^O eq &#39;VMS&#39; &#38;&#38; $Config::Config{make} =~ /MM[K|S]/i&#41; {
-    $make_macro = &#39;&#39;;
-    $ENV{TEST_VERBOSE} = 0;
+  if &#40;$is_vms_mms&#41; {
+    $make_macro = &#39;/macro=&#40;&#34;&#39; . $make_macro . &#39;&#34;&#41;&#39;;
   }
 
   $output = stdout_of&#40; sub {
     $ran_ok = $mb-&gt;do_system&#40;@make, &#39;test&#39;, $make_macro&#41;
   } &#41;;
 
-  # Clean up on VMS
-  if &#40;$^O eq &#39;VMS&#39; &#38;&#38; $Config::Config{make} =~ /MM[K|S]/i&#41; {
-    if &#40;defined $old_test_verbose&#41; {
-      $ENV{TEST_VERBOSE} = $old_test_verbose;
-    } else {
-      delete $ENV{TEST_VERBOSE};
-    }
-  }
-
   ok $ran_ok, &#34;make test without verbose ran ok&#34;;
   $output =~ s/^/# /gm;  # Don&#39;t confuse our own test output
   like $output,
@@ -215,11 +203,15 @@ ok $mb, &#34;Module::Build-&gt;new_from_context
        &#39;Should be non-verbose&#39;;
 
   &#40;my $libdir2 = $libdir&#41; =~ s/libdir/lbiidr/;
+  my @make_args = &#40;&#39;INSTALLDIRS=vendor&#39;, &#34;INSTALLVENDORLIB=$libdir2&#34;&#41;;
+
+  if &#40;$is_vms_mms&#41; { # VMS MMK/MMS macros use different syntax.
+    $make_args[0] = &#39;/macro=&#40;&#34;&#39; . join&#40;&#39;&#34;,&#34;&#39;,@make_args&#41; . &#39;&#34;&#41;&#39;;
+    pop @make_args while scalar&#40;@make_args&#41; &gt; 1;
+  }
   &#40;$output&#41; = stdout_stderr_of&#40;
     sub {
-      $ran_ok = $mb-&gt;do_system&#40;@make, &#39;fakeinstall&#39;,
-			       &#39;INSTALLDIRS=vendor&#39;,
-			       &#34;INSTALLVENDORLIB=$libdir2&#34;&#41;;
+      $ran_ok = $mb-&gt;do_system&#40;@make, &#39;fakeinstall&#39;, @make_args&#41;;
     }
   &#41;;
 
--- t/tilde.t;-0	Fri May 30 18:45:01 2008
+++ t/tilde.t	Sat May 31 10:00:41 2008
@@ -38,6 +38,13 @@ my $p = &#39;install_base&#39;;
 
 SKIP: {
     my $home = $ENV{HOME} ? $ENV{HOME} : undef;
+
+    if &#40;$^O eq &#39;VMS&#39;&#41; {
+        # Convert the path to UNIX format, trim off the trailing slash
+        $home = VMS::Filespec::unixify&#40;$home&#41;;
+        $home =~ s#/$##;
+    }
+
     unless &#40;defined $home&#41; {
       my @info = eval { getpwuid $&gt; };
       skip &#34;No home directory for tilde-expansion tests&#34;, 14 if $@;
@@ -85,7 +92,16 @@ SKIP: {
     skip &#34;No home directory for tilde-expansion tests&#34;, 1 if $@;
     my &#40;$me, $home&#41; = @info[0,7];
     
-    is&#40; run_sample&#40; $p =&gt; &#34;~$me/foo&#34;&#41;-&gt;$p&#40;&#41;,  &#34;$home/foo&#34; &#41;;
+    my $expected = &#34;$home/foo&#34;;
+
+    if &#40;$^O eq &#39;VMS&#39;&#41; {
+        # Convert the path to UNIX format and trim off the trailing slash
+        $home = VMS::Filespec::unixify&#40;$home&#41;;
+        $home =~ s#/$##;
+        $expected = $home . &#39;/../[^/]+&#39; . &#39;/foo&#39;;
+    }
+
+    like&#40; run_sample&#40; $p =&gt; &#34;~$me/foo&#34;&#41;-&gt;$p&#40;&#41;,  qr&#40;$expected&#41;i &#41;;
 }
 
 
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;15&nbsp;23:20:13&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, applied.

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;15&nbsp;23:20:19&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;15&nbsp;23:20:20&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;16&nbsp;01:31:28&nbsp;2008</span>
    <span class="description">schwern [...] pobox.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36762] [PATCH] VMS update</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Jun 2008 00:30:23 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Michael G Schwern &lt;schwern [...] pobox.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">-       $perl -e 1 -e while -e unlink -e shift $args{makefile}
+       $perl -e 1 -e while -e unlink -e q=$args{makefile}=

I used to do madness like that in MakeMaker.  Then I write a one-liner 
builder.  Please steal it for Module::Build, everybody&#39;s sanity will thank you.


-- 
Reality is that which, when you stop believing in it, doesn&#39;t go away.
     -- Phillip K. Dick
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;16&nbsp;01:31:33&nbsp;2008</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;16&nbsp;07:57:38&nbsp;2008</span>
    <span class="description">craigberry [...] mac.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #36762] [PATCH] VMS update</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 16 Jun 2008 06:57:17 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Module-Build [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Craig A. Berry&#34; &lt;craigberry [...] mac.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">At 1:31 AM -0400 6/16/08, Michael G Schwern via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="http://rt.cpan.org/Ticket/Display.html?id=36762">http://rt.cpan.org/Ticket/Display.html?id=36762</a></span> &gt;
&gt;
&gt;-      $perl -e 1 -e while -e unlink -e shift $args{makefile}
&gt;+      $perl -e 1 -e while -e unlink -e q=$args{makefile}=
&gt;
&gt;I used to do madness like that in MakeMaker.  Then I write a one-liner
&gt;builder.  Please steal it for Module::Build, everybody&#39;s sanity will thank you.
&gt;
</div>
I wondered myself why it&#39;s not using Module::Build&#39;s own one-liner
builder but figured there must be a reason.  My change just replaced
something didn&#39;t quite work with something that does.  In the
original, the shift is inside the while loop and the argument is
consumed the first time through, so multiple versions of a file on
VMS do not get unlinked.  It took me a while to find it, but the
C&lt;q=foo=&gt; quoting construct is passed through by the shells on
Windows, VMS, and Mac OS X and of course properly interpreted by
Perl.  But if the M::B maintainers have a whole different approach
that avoids this, I&#39;m all for it.
-- 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">________________________________________
Craig A. Berry
mailto:craigberry@mac.com

&#34;... getting out of a sonnet is much more
 difficult than getting in.&#34;
                 Brad Leithauser
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;27&nbsp;22:54:41&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jun 16 01:31:28 2008, schwern@pobox.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; -     $perl -e 1 -e while -e unlink -e shift $args{makefile}
&gt; +     $perl -e 1 -e while -e unlink -e q=$args{makefile}=
&gt; 
&gt; I used to do madness like that in MakeMaker.  Then I write a one-liner
&gt; builder.  Please steal it for Module::Build, everybody&#39;s sanity will
&gt; thank you.
</div>
How come the one-liner builder ends them with &#39;--&#39;?

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;27&nbsp;23:09:38&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon Jun 16 01:31:28 2008, schwern@pobox.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I used to do madness like that in MakeMaker.  Then I write a one-liner
&gt; builder.  Please steal it for Module::Build, everybody&#39;s sanity will
&gt; thank you.
</div>
Also, if the perl code contains a dollar sign, it needs to be doubled up if you&#39;re putting it in a 
make command.  I believe that&#39;s true regardless of whether it&#39;s in quotes or not.

 -Ken
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jul&nbsp;06&nbsp;00:00:41&nbsp;2008</span>
    <span class="description">kwilliams [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
