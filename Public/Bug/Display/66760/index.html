<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #66760 for CGI: Bug in virtual_host method in some corner cases</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #66760 for CGI: Bug in virtual_host method in some corner cases</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CGI">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CGI">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CGI">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CGI">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="https://github.com/leejo/CGI.pm/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI">CGI CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">66760</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CGI">CGI</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
jmfernandez [...] cnio.es

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-230860-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<ul>
<li>
3.49</li>
<li>
3.50</li>
<li>
3.51</li>
<li>
3.52</li>
</ul>
    </td>
  </tr>
  <tr id="CF-230861-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=66760">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912518" href="/Public/Bug/Display.html?id=66760#txn-912518">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;21&nbsp;14:41:54&nbsp;2011</span>
    <span class="description">http://jmfernandez.myid.net/ -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Bug in virtual_host method in some corner cases</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912518/473294/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473294">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">We have found in one of our deployments a corner case where
&#39;virtual_host&#39; method returns a list of hosts separated by commas. A
sample of the return, which is not a real one:

publicname.ahost.thedomain, notsopublicname.ahost.thedomain

We have inspected code from CGI-3.49 to CGI-3.52, but we suspect the bug
is present since the creation of &#39;virtual_host&#39; method. We have tested
with Perl 5.8.8 in Mac OS X 10.5 PPC and with Perl 5.12.2 in Gentoo
Linux x86_64.

&#39;virtual_host&#39; method returns the information from X-Forwarded-Host
header. In configurations where you have a public HTTP virtual host
which is proxying HTTP servers behind a NAT, and one of those HTTP
servers is also a virtual host, you can get from X-Forwarded-Host header
a list of hostnames separated by commas. We think the scenario can be
reproduced with a couple of Apache servers in different machines, both
of them configured for virtual hosting, and one of them proxying the
another one.

The easy way to fix this corner case bug would be adding next line just
after first assignment of &#39;$vh&#39; variable:

$vh =~ s/^&#40;[^,]+&#41;,.*/$1/;

which discards the additional hostnames &#40;the first one should be the
right one&#41;.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912790" href="/Public/Bug/Display.html?id=66760#txn-912790">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;09:56:21&nbsp;2011</span>
    <span class="description">mark [...] summersault.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> jmfernandez [...] cnio.es</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #66760] Bug in virtual_host method in some corner cases</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 22 Mar 2011 09:56:13 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] summersault.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912790/473436/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473436">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 384b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; The easy way to fix this corner case bug would be adding next line just
&gt; after first assignment of &#39;$vh&#39; variable:
&gt; 
&gt; $vh =~ s/^&#40;[^,]+&#41;,.*/$1/;
&gt; 
&gt; which discards the additional hostnames &#40;the first one should be the
&gt; right one&#41;.
</div>
Thanks for the report and the suggested fix. Can you refer to any specs
which state what the correct behavior should be in this case?

    Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912793" href="/Public/Bug/Display.html?id=66760#txn-912793">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;09:56:22&nbsp;2011</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912794" href="/Public/Bug/Display.html?id=66760#txn-912794">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;10:20:23&nbsp;2011</span>
    <span class="description">http://jmfernandez.myid.net/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> José María Fernández</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912794/473439/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473439">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 438b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 22 09:56:21 2011, mark@summersault.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Thanks for the report and the suggested fix. Can you refer to any specs
&gt; which state what the correct behavior should be in this case?
&gt; 
&gt;     Mark
&gt; 
</div>
Hi Mark,
        I have just been looking for the documentation, and I have found
this:

<span class="clickylink"><a target="new" rel="nofollow" href="http://httpd.apache.org/docs/current/mod/mod_proxy.html#x-headers">http://httpd.apache.org/docs/current/mod/mod_proxy.html#x-headers</a></span>

where there is a paragraph explicitly warning about this behavior
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912815" href="/Public/Bug/Display.html?id=66760#txn-912815">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;11:13:27&nbsp;2011</span>
    <span class="description">mark [...] summersault.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #66760] Bug in virtual_host method in some corner cases</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 22 Mar 2011 11:13:13 -0400</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CGI [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] summersault.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912815/473452/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473452">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 286b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;         I have just been looking for the documentation, and I have found
&gt; this:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://httpd.apache.org/docs/current/mod/mod_proxy.html#x-headers">http://httpd.apache.org/docs/current/mod/mod_proxy.html#x-headers</a></span>
&gt; 
&gt; where there is a paragraph explicitly warning about this behavior
</div>
Thanks for the research! We&#39;ll look into further.

   Mark
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912853" href="/Public/Bug/Display.html?id=66760#txn-912853">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;12:17:28&nbsp;2011</span>
    <span class="description">LDS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/912853/473480/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473480">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 758b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 22 10:20:23 2011, <span class="clickylink"><a target="new" rel="nofollow" href="http://jmfernandez.myid.net/">http://jmfernandez.myid.net/</a></span> wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Mar 22 09:56:21 2011, mark@summersault.com wrote:
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; Thanks for the report and the suggested fix. Can you refer to any 
</div></div>specs
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; which state what the correct behavior should be in this case?
&gt; &gt; 
&gt; &gt;     Mark
&gt; &gt; 
</div>&gt; 
&gt; Hi Mark,
&gt;         I have just been looking for the documentation, and I have 
</div>found
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; this:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://httpd.apache.org/docs/current/mod/mod_proxy.html#x-headers">http://httpd.apache.org/docs/current/mod/mod_proxy.html#x-headers</a></span>
&gt; 
&gt; where there is a paragraph explicitly warning about this behavior
</div>
This is a very interesting bug and I&#39;m surprised it has not been noticed 
before. Are there any cases in which a comma might be embedded in the 
hostname itself? Otherwise I don&#39;t see any problems with your proposed 
fix.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-912856" href="/Public/Bug/Display.html?id=66760#txn-912856">#</a>      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;22&nbsp;12:47:33&nbsp;2011</span>
    <span class="description">http://jmfernandez.myid.net/ -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> José María Fernández</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/912856/473483/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/473483">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 712b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 22 12:17:28 2011, LDS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; This is a very interesting bug and I&#39;m surprised it has not been noticed 
&gt; before. Are there any cases in which a comma might be embedded in the 
&gt; hostname itself? Otherwise I don&#39;t see any problems with your proposed 
&gt; fix.
</div>
Well, I have just found next RFC:

<span class="clickylink"><a target="new" rel="nofollow" href="http://tools.ietf.org/html/rfc3696#page-3">http://tools.ietf.org/html/rfc3696#page-3</a></span>

Reading it I have realized that although each piece &#40;or label&#41; from a
qualified hostname shouldn&#39;t contain something different to letters,
digits or hyphens, it is not enforced as &#34;Any characters, or combination
of bits &#40;as octets&#41;, are permitted in DNS names&#34;.

Perhaps a safer fix could be next one, with an space after the comma:

$vh =~ s/^&#40;[^,]+&#41;, .*/$1/;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1136275" href="/Public/Bug/Display.html?id=66760#txn-1136275">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;03&nbsp;21:43:27&nbsp;2012</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1136275/598006/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/598006">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 976b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Tue Mar 22 12:47:33 2011, <span class="clickylink"><a target="new" rel="nofollow" href="http://jmfernandez.myid.net/">http://jmfernandez.myid.net/</a></span> wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On Tue Mar 22 12:17:28 2011, LDS wrote:
<div class="message-stanza open">&gt; &gt; 
&gt; &gt; This is a very interesting bug and I&#39;m surprised it has not been 
</div></div>noticed 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; before. Are there any cases in which a comma might be embedded in 
</div></div>the 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; hostname itself? Otherwise I don&#39;t see any problems with your 
</div></div>proposed 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; fix.
</div>&gt; 
&gt; Well, I have just found next RFC:
&gt; 
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="http://tools.ietf.org/html/rfc3696#page-3">http://tools.ietf.org/html/rfc3696#page-3</a></span>
&gt; 
&gt; Reading it I have realized that although each piece &#40;or label&#41; from a
&gt; qualified hostname shouldn&#39;t contain something different to letters,
&gt; digits or hyphens, it is not enforced as &#34;Any characters, or 
</div>combination
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; of bits &#40;as octets&#41;, are permitted in DNS names&#34;.
&gt; 
&gt; Perhaps a safer fix could be next one, with an space after the comma:
&gt; 
&gt; $vh =~ s/^&#40;[^,]+&#41;, .*/$1/;
</div>
Thanks for the continued effort on this. Could you check what a couple 
other Perl frameworks are doing to address this issue, for comparative 
reference?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1136278" href="/Public/Bug/Display.html?id=66760#txn-1136278">#</a>      
    </span>
    <span class="date">Sat&nbsp;Nov&nbsp;03&nbsp;21:43:52&nbsp;2012</span>
    <span class="description">jmfernandez [...] cnio.es -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Out of Office AutoReply: [rt.cpan.org #66760] Bug in virtual_host method in some corner cases</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 4 Nov 2012 02:43:36 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;MARKSTOS via RT&#34; &lt;bug-CGI [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> &#34;Fernandez.Jose_Maria&#34; &lt;jmfernandez [...] cnio.es&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1136278/598009/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/598009">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 903b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">I&#39;m out until November 11th with very limited connectivity.
Sorry for the inconvenience

**NOTA DE CONFIDENCIALIDAD** Este correo electr�nico, y en su caso los ficheros adjuntos, pueden contener informaci�n protegida para el uso exclusivo de su destinatario. Se proh�be la distribuci�n, reproducci�n o cualquier otro tipo de transmisi�n por parte de otra persona que no sea el destinatario. Si usted recibe por error este correo, se ruega comunicarlo al remitente y borrar el mensaje recibido.
**CONFIDENTIALITY NOTICE** This email communication and any attachments may contain confidential and privileged information for the sole use of the designated recipient named above. Distribution, reproduction or any other use of this transmission by any party other than the intended recipient is prohibited. If you are not the intended recipient please contact the sender and delete all copies.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1366156" href="/Public/Bug/Display.html?id=66760#txn-1366156">#</a>      
    </span>
    <span class="date">Thu&nbsp;May&nbsp;22&nbsp;08:10:25&nbsp;2014</span>
    <span class="description">LEEJO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1366156/725374/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/725374">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 240b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This issue has been copied to: <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/leejo/CGI.pm/issues/83">https://github.com/leejo/CGI.pm/issues/83</a></span> please take all future correspondence there.
This ticket will remain open but please do not reply here.
This ticket will be closed when the github issue is dealt with.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1385547" href="/Public/Bug/Display.html?id=66760#txn-1385547">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;11&nbsp;09:14:20&nbsp;2014</span>
    <span class="description">LEEJO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1385547/735730/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/735730">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 145b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Closing as a duplicate of #70, which was resolved by 786165e. N.B. We take the last value from the list, as this is what other web frameworks do.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1385550" href="/Public/Bug/Display.html?id=66760#txn-1385550">#</a>      
    </span>
    <span class="date">Fri&nbsp;Jul&nbsp;11&nbsp;09:14:23&nbsp;2014</span>
    <span class="description">LEEJO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.585101</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
