<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #5088 for Apache-Backhand: Error in Makefile.PL with ARGV handling</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #5088 for Apache-Backhand: Error in Makefile.PL with ARGV handling</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Apache-Backhand/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Apache-Backhand/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Apache-Backhand/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Apache-Backhand/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Apache-Backhand">Apache-Backhand CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">5088</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">new</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Apache-Backhand/Active/">Apache-Backhand</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
vfelix [...] tigr.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-1446-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-1447-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;28&nbsp;10:44:45&nbsp;2004</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Error in Makefile.PL with ARGV handling</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">The Makefile.PL does not properly pass arguments that may be necessary for ExtUtils::MakeMaker such as PREFIX or LIB. As is, the Makefile.PL does not allow the code to be installed in an alternate location as may be necessary if you do not have root privileges. The error seems to be with the grep calls with @ARGV. Inlcuded in this report is a modified version that fixes the problem.

Here are the corrected lines:

    @ARGV = grep { $_ !~ /BACKHAND_SRCDIR/ }  @ARGV;
    @ARGV = grep { $_ !~ /APACHE_SRCDIR/ } @ARGV;

Version: Apache-Backhand-0.02
Perl version: 5.6.0 &#40;problem is likely exhibited in 5.8.x as well&#41;
Operating system: Red Hat Linux 7.3 with a 2.4.18 kernel

Cheers!
</div></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">use ExtUtils::MakeMaker;

use strict;

my $backhand_incdir;
my $apache_incdir;
my $apache_osdir;

BEGIN {
    foreach my $arg &#40;@ARGV&#41; {
        if &#40;$arg =~ /BACKHAND_SRCDIR=&#40;.*&#41;/&#41; {
            $backhand_incdir = $1;
        }
        if &#40;$arg =~ /APACHE_SRCDIR=&#40;.*&#41;/&#41; {
            $apache_incdir   = $1;
        }
    }

    if &#40;! defined $backhand_incdir&#41; {
        die &#34;You must specify a BACKHAND_SRCDIR - the path to your\n&#34;
          . &#34;mod_backhand source tree&#34;;
    }
    if &#40;! defined $apache_incdir&#41; {
        die &#34;You must specify an APACHE_SRCDIR - the path to your\n&#34;
          . &#34;apache 1.3.X source tree&#34;;
    }

    if &#40;! -d $backhand_incdir&#41; {
        die &#39;BACKHAND_SRCDIR is not a directory&#39;;
    }
    if &#40;! -f &#34;${backhand_incdir}/mod_backhand.h&#34;&#41; {
        die &#39;mod_backhand.h not found&#39;;
    }
    if &#40;! -f &#34;${backhand_incdir}/serverstat.h&#34;&#41; {
        die &#39;serverstat.h not found&#39;;
    }

    if &#40;! -d $apache_incdir&#41; {
        die &#39;APACHE_SRCDIR is not a directory&#39;;
    }
    $apache_osdir = $apache_incdir . &#39;/os/unix&#39;;
    $apache_incdir .= &#39;/include&#39;;
    if &#40;! -f &#34;${apache_incdir}/httpd.h&#34;&#41; {
        die &#34;${apache_incdir}/httpd.h not found&#34;;
    }
    if &#40;! -f &#34;${apache_incdir}/http_log.h&#34;&#41; {
        die &#34;${apache_incdir}/http_log.h not found&#34;;
    }

    @ARGV = grep { $_ !~ /BACKHAND_SRCDIR/ }  @ARGV;
    @ARGV = grep { $_ !~ /APACHE_SRCDIR/ } @ARGV;

    print &lt;&lt;EOF;

** NOTICE **
The byPerl shared object file &#40;byPerl.so on most unix platforms&#41; is not
built or installed by default.  See the file README.byPerl for details.
** NOTICE **

EOF

}

WriteMakefile&#40;
    &#39;NAME&#39;	   =&gt; &#39;Apache::Backhand&#39;,
    &#39;VERSION_FROM&#39; =&gt; &#39;Backhand.pm&#39;,
    &#39;OPTIMIZE&#39;     =&gt; &#39;-O3&#39;,
    &#39;OBJECT&#39;       =&gt; &#39;Backhand.o magic_c_int.o&#39;,
    &#39;INC&#39;          =&gt; &#34;-I. -I${backhand_incdir} -I${apache_incdir} &#34;
                    . &#34;-I${apache_osdir}&#34;,
    &#39;realclean&#39;    =&gt; { &#39;FILES&#39; =&gt; &#39;byPerl.so byPerl.o&#39; },
&#41;;

package MY;

sub postamble { &#39;

byPerl: byPerl.$&#40;DLEXT&#41;

byPerl.$&#40;DLEXT&#41;: Makefile byPerl$&#40;OBJ_EXT&#41;
	$&#40;LD&#41; -o $@ $&#40;LDDLFLAGS&#41; $&#40;OTHERLDFLAGS&#41; byPerl$&#40;OBJ_EXT&#41;

&#39;; }
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
