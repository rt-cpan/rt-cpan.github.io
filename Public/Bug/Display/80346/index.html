<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #80346 for CGI-Session: Insecure dependency &#40;taint mode&#41; with file &#38; storable</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #80346 for CGI-Session: Insecure dependency &#40;taint mode&#41; with file &#38; storable</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CGI-Session">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CGI-Session">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CGI-Session">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CGI-Session">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CGI-Session">CGI-Session CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">80346</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CGI-Session">CGI-Session</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
tlhackque [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">
dom [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-5872-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
4.48    </td>
  </tr>
  <tr id="CF-5873-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=80346">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1132014" href="/Public/Bug/Display.html?id=80346#txn-1132014">#</a>      
    </span>
    <span class="date">Mon&nbsp;Oct&nbsp;22&nbsp;22:00:50&nbsp;2012</span>
    <span class="description">tlhackque [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Insecure dependency &#40;taint mode&#41; with file &#38; storable</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1132014/595675/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/595675">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Taint issue with driver:file;serializer:storable.

Problem is that storable returns tainted data; file::store constructs 
the filename using _SESSION_ID, which is tainted.  Result is that 
sysopen fails.

Test case:

#!/usr/bin/perl -T

use strict;
use warnings;

use CGI::Session;
use File::Spec;

print $CGI::Session::VERSION, &#34;\n&#34;;

my $session = CGI::Session-&gt;new&#40; &#34;driver:file;serializer:storable&#34;, 
undef,
                                 {Directory =&gt; File::Spec-&gt;tmpdir } &#41; or
  die CGI::Session-&gt;errstr&#40;&#41;;
my $sid = $session-&gt;id;
$session-&gt;flush;

print &#34;$sid\n&#34;;

$session = CGI::Session-&gt;load&#40; &#34;driver:file;serializer:storable&#34;, $sid,
                                 {Directory =&gt; File::Spec-&gt;tmpdir } &#41; or
  die CGI::Session-&gt;errstr&#40;&#41;;

$session-&gt;param&#40;&#39;a&#39;, 1 &#41;;
$session-&gt;flush;

./taint
4.48
5036c5c476f14f8c1adfb0b31947250c
Insecure dependency in sysopen while running with -T switch 
at /usr/local/share/perl5/CGI/Session/Driver/file.pm line 107.

Patch:

--- /usr/local/share/perl5/CGI/Session/Driver/file.pm~  2012-10-22 
20:23:11.357734505 -0400
+++ /usr/local/share/perl5/CGI/Session/Driver/file.pm   2012-10-22 
21:53:23.484981534 -0400
@@ -45,15 +45,16 @@
 sub _file {
     my &#40;$self,$sid&#41; = @_;
     my $id = $sid;
     $id =~ s|\\|/|g;

-       if &#40;$id =~ m|/|&#41;
+    if &#40;$id =~ m|/|&#41;
     {
         return $self-&gt;set_error&#40; &#34;_file&#40;&#41;: Session ids cannot contain 
\\ or / chars: $sid&#34; &#41;;
     }
-
+    $sid =~ /^&#40;.*&#41;$/;
+    $sid = $1;
     return File::Spec-&gt;catfile&#40;$self-&gt;{Directory}, sprintf&#40; $FileName, 
$sid &#41;&#41;;
 }

 sub retrieve {
     my $self = shift;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1132853" href="/Public/Bug/Display.html?id=80346#txn-1132853">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;25&nbsp;09:53:47&nbsp;2012</span>
    <span class="description">MARKSTOS [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1132853/596138/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/596138">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 99b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; +    $sid =~ /^&#40;.*&#41;$/;
</div>
This appears to let every possible value through. How is this any safer?
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1132856" href="/Public/Bug/Display.html?id=80346#txn-1132856">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;25&nbsp;09:53:48&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1132857" href="/Public/Bug/Display.html?id=80346#txn-1132857">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;25&nbsp;09:53:48&nbsp;2012</span>
    <span class="description">MARKSTOS [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1133036" href="/Public/Bug/Display.html?id=80346#txn-1133036">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;25&nbsp;20:20:42&nbsp;2012</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1133036/596246/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/596246">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 3k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Oct 25 09:53:47 2012, MARKSTOS wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
<div class="message-stanza open">&gt; &gt; +    $sid =~ /^&#40;.*&#41;$/;
</div>&gt; 
&gt; This appears to let every possible value through. How is this any 
</div>safer?

You can trust the session file because it is &#40;in theory&#41; written and 
writable only by CGI::Session.  It is the application&#39;s responsibility 
to provide a Directory that has suitable permissions, and the webserver 
administrator&#39;s responsibility to keep it that way.  Mechanisms are out 
of scope of CGI::Session - but include running the application setuid 
to an unprivileged application account; using dedicated webservers 
and/or virtual machines; selinux permissions and other standard 
techniques.  

The default serializer already more-or-less blindly untaints the 
contents - sure, it uses Safe for the eval, but the data from the 
structure is taint-free and can contain anything - which the 
application will rely on.

Typically the SESSION file provides access to sensitive data &#40;a 
shopping cart, access to an account&#41;, so if it&#39;s compromised, you have 
big&#40;ger&#41; problems.

If it makes you less nervous, I suppose one could do something like
 $sid =~ /^&#40;[\w_-]+&#41;$/ or die &#34;Invalid SID in session data\n&#34;;
 $sid = $1;
That should certainly work for the md5/sha/incr/uuid id generators.  

However, that gives a false sense of security for the reasons 
indicated.  It also makes some assumptions about what a generator will 
produce for a sid and what&#39;s acceptable for names on all filesystems. 
Some might want /&#38;&#40;[\w_{}-]&#41;$/...&#40;e.g. M$ {CLSID} in a sid&#41;, but {} is 
problematic with some shells... you can see the slippery slope.

But the way db_file currently works, you&#39;re already assuming that a sid 
is safe; e.g. if a generator produced ../proc/1/fd/1, interesting 
things would happen on unix back in store...

And db_file is quite happy to blindly unlink any symlink it gets, which 
is even more problematic.

In this case, the data from the session is used only by retrieve, and 
the file is opened read-only, so the potential for damage is somewhat 
more limited.  One can ratchet up the paranoia by adding something like

 return $self-&gt;set_error&#40;&#34;retrieve&#40;&#41;: &#39;$path&#39; is not a regular file&#34;&#41; 
unless&#40; -f FH &#41;;

following the sysopen&#40;&#41; in retrieve&#40;&#41;.

At some point, one has to draw the line and trust something.

That said, I&#39;m not wedded to the patch I proposed or to the alternative 
suggestions above.

And this bug report was not about all questionable practices of 
db_file, though they do deserve attention.  This report is about a 
specific taint failure that is entirely within out-of-the-box 
CGI::Session.

The test case that I provided is a carefully simplified version of a 
real application.  It demonstrates that db_file + storable will not 
work under taint mode for ANY application.  Google says this has been 
reported before, but without any analysis or reproducer, the reports 
were not acted on.

This case should not fail.  CGI::Session with storable+db_file should 
work out-of-the box under -T.

If you have a different/&#34;better&#34;/more comprehensive fix, that would be 
fine with me.

Thanks for looking into this.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1133038" href="/Public/Bug/Display.html?id=80346#txn-1133038">#</a>      
    </span>
    <span class="date">Thu&nbsp;Oct&nbsp;25&nbsp;20:20:43&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1583240" href="/Public/Bug/Display.html?id=80346#txn-1583240">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;12&nbsp;08:29:36&nbsp;2016</span>
    <span class="description">dom [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1583240/845955/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/845955">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 416b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">This has come up recently in Debian[1], as the taint fix for CVE-2015-8607 exposes this bug &#40;which had been hidden for a time by the bug in perl. Mark, the the OP provided a patch and an extensive justification of why it is correct back in 2012. It would be great to get your feedback on this and perhaps make a release, now that it is once more an issue seen in the real world.

[1] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.debian.org/810799">https://bugs.debian.org/810799</a></span>&gt;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1583284" href="/Public/Bug/Display.html?id=80346#txn-1583284">#</a>      
    </span>
    <span class="date">Tue&nbsp;Jan&nbsp;12&nbsp;10:07:23&nbsp;2016</span>
    <span class="description">mark [...] stosberg.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #80346] Insecure dependency &#40;taint mode&#41; with file &#38; storable</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 12 Jan 2016 10:07:01 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> Dominic Hargreaves via RT &lt;bug-CGI-Session [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Stosberg &lt;mark [...] stosberg.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1583284/845991/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/845991">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 842b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Thanks for the report. 

Sherzod, the original author, is the current maintainer of CGI::Session.

I no longer use the module myself, having a new job in Node.js.

Sherzod, could you review this patch with security implications?

      Mark

On Tue, Jan 12, 2016, at 08:29 AM, Dominic Hargreaves via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: CGI-Session
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=80346">https://rt.cpan.org/Ticket/Display.html?id=80346</a></span> &gt;
&gt; 
&gt; This has come up recently in Debian[1], as the taint fix for
&gt; CVE-2015-8607 exposes this bug &#40;which had been hidden for a time by the
&gt; bug in perl. Mark, the the OP provided a patch and an extensive
&gt; justification of why it is correct back in 2012. It would be great to get
&gt; your feedback on this and perhaps make a release, now that it is once
&gt; more an issue seen in the real world.
&gt; 
&gt; [1] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.debian.org/810799">https://bugs.debian.org/810799</a></span>&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people AddWatcher odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1583620" href="/Public/Bug/Display.html?id=80346#txn-1583620">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;13&nbsp;05:05:11&nbsp;2016</span>
    <span class="description">dom [...] cpan.org -  Cc DOM added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1583622" href="/Public/Bug/Display.html?id=80346#txn-1583622">#</a>      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;13&nbsp;05:05:57&nbsp;2016</span>
    <span class="description">dom [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1583622/846207/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/846207">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Ah, okay - thanks for clarifying that :&#41;

There is some discussion and a revised patch at <span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.debian.org/810799">https://bugs.debian.org/810799</a></span> which might be worth looking at.

On Tue Jan 12 15:07:23 2016, mark@stosberg.com wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Thanks for the report. 
&gt; 
&gt; Sherzod, the original author, is the current maintainer of CGI::Session.
&gt; 
&gt; I no longer use the module myself, having a new job in Node.js.
&gt; 
&gt; Sherzod, could you review this patch with security implications?
&gt; 
&gt;       Mark
&gt; 
&gt; On Tue, Jan 12, 2016, at 08:29 AM, Dominic Hargreaves via RT wrote:
<div class="message-stanza open">&gt; &gt;        Queue: CGI-Session
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=80346">https://rt.cpan.org/Ticket/Display.html?id=80346</a></span> &gt;
&gt; &gt; 
&gt; &gt; This has come up recently in Debian[1], as the taint fix for
&gt; &gt; CVE-2015-8607 exposes this bug &#40;which had been hidden for a time by the
&gt; &gt; bug in perl. Mark, the the OP provided a patch and an extensive
&gt; &gt; justification of why it is correct back in 2012. It would be great to get
&gt; &gt; your feedback on this and perhaps make a release, now that it is once
&gt; &gt; more an issue seen in the real world.
&gt; &gt; 
&gt; &gt; [1] &lt;<span class="clickylink"><a target="new" rel="nofollow" href="https://bugs.debian.org/810799">https://bugs.debian.org/810799</a></span>&gt;
</div></div></div></div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.447222</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
