<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #79161 for PID-File: Can&#39;t call method &#34;remove&#34; on an undefined value</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #79161 for PID-File: Can&#39;t call method &#34;remove&#34; on an undefined value</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=PID-File">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=PID-File">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=PID-File">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=PID-File">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/PID-File">PID-File CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">79161</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=PID-File">PID-File</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
holger [...] loomsday.co.nz

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-244032-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-244033-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=79161">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112215" href="/Public/Bug/Display.html?id=79161#txn-1112215">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;06:01:38&nbsp;2012</span>
    <span class="description">holger [...] loomsday.co.nz -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Can&#39;t call method &#34;remove&#34; on an undefined value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 23 Aug 2012 22:01:20 +1200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-pid-file [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Holger Jahn &lt;holger [...] loomsday.co.nz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112215/584932/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584932">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Rob,

We have been scratching our collective heads here for a while, since we 
always got greeted with the funny error message below:

&#40;in cleanup&#41; Can&#39;t call method &#34;remove&#34; on an undefined value at 
/usr/local/perl2exe/perl5/lib/site_perl/5.10.0/PID/File.pm line 322 
during global destruction.

This message is thrown when we were calling to call the &#34;guard&#34; method 
on a global variable when the script is exiting, like so:

use PID::File;
my $pid_file;

sub make_pid_file {

     $pid_file = PID::File-&gt;new;
     $pid_file-&gt;file&#40;&#39;pidfile&#39;&#41;;

     $pid_file-&gt;create;
     $pid_file-&gt;guard if $pid_file;
     print &#34;pidfile created $$\n&#34;;

     system&#40;&#34;ls -l pidfile&#34;&#41;;
     }

make_pid_file&#40;&#41;;
system&#40;&#34;ls -l pidfile&#34;&#41;;
exit;

When we kept the scope local, i.e. with &#34;my $pid_file&#34; inside the 
function, then the error is not thrown, but the PID file is removed when 
the functions returns to its caller.

After a while, I figured that PID::File started working correctly after 
changing line number 337 in PID/File.pm, like so:

$self-&gt;remove;
# $self-&gt;{ guard }-&gt;&#40;&#41;;

It would be great if you could have another look at the DESTROY function 
and see if my patch makes any sense.

Many thanks &#38; Kind regards,
Holger
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112229" href="/Public/Bug/Display.html?id=79161#txn-1112229">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;07:09:32&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112229/584945/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584945">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 76b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks Holgar,

I&#39;ll start looking into this today for you.

Cheers,
Rob
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112231" href="/Public/Bug/Display.html?id=79161#txn-1112231">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;07:09:33&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112242" href="/Public/Bug/Display.html?id=79161#txn-1112242">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;07:30:02&nbsp;2012</span>
    <span class="description">holger [...] loomsday.co.nz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79161] Can&#39;t call method &#34;remove&#34; on an undefined value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 23 Aug 2012 23:29:46 +1200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PID-File [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Holger Jahn &lt;holger [...] loomsday.co.nz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112242/584950/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584950">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 241b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Excellent, thanks Rob!

Cheers,
Holger

On 08/23/2012 11:09 PM, Rob Brown via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79161">https://rt.cpan.org/Ticket/Display.html?id=79161</a></span> &gt;
&gt;
&gt; Thanks Holgar,
&gt;
&gt; I&#39;ll start looking into this today for you.
&gt;
&gt; Cheers,
&gt; Rob
&gt;
&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112244" href="/Public/Bug/Display.html?id=79161#txn-1112244">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;07:43:21&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112244/584952/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584952">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 931b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">hmmm, I&#39;ve just re-created your script, with the global var, and ran it, 
with no problems on 5.14.2

[rob@intelcompute perl]$ ./pid-file.pl 
pidfile created 2382
-rw-rw-r-- 1 rob rob 4 Aug 23 12:39 pidfile
-rw-rw-r-- 1 rob rob 4 Aug 23 12:39 pidfile
[rob@intelcompute perl]$ 


#!/usr/bin/env perl
#
use PID::File;
my $pid_file;

sub make_pid_file {

     $pid_file = PID::File-&gt;new;
     $pid_file-&gt;file&#40;&#39;pidfile&#39;&#41;;

     $pid_file-&gt;create;
     $pid_file-&gt;guard if $pid_file;
     print &#34;pidfile created $$\n&#34;;

     system&#40;&#34;ls -l pidfile&#34;&#41;;
     }

make_pid_file&#40;&#41;;
system&#40;&#34;ls -l pidfile&#34;&#41;;
exit;

I&#39;m just building 5.10.0 to see if it&#39;s an issue specific to a version - 
I would&#39;ve spotted that error with the unit tests and my own testing, so 
was a bit surprised by it.

Cheers,
Rob



On Thu Aug 23 07:09:32 2012, CAGAO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks Holgar,
&gt; 
&gt; I&#39;ll start looking into this today for you.
&gt; 
&gt; Cheers,
&gt; Rob
&gt; 
&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112246" href="/Public/Bug/Display.html?id=79161#txn-1112246">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;07:54:25&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112246/584954/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584954">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Yup, it&#39;s a problem on 5.10.0, let me investigate further...



On Thu Aug 23 07:43:21 2012, CAGAO wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; hmmm, I&#39;ve just re-created your script, with the global var, and ran 
</div>it, 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; with no problems on 5.14.2
&gt; 
&gt; [rob@intelcompute perl]$ ./pid-file.pl 
&gt; pidfile created 2382
&gt; -rw-rw-r-- 1 rob rob 4 Aug 23 12:39 pidfile
&gt; -rw-rw-r-- 1 rob rob 4 Aug 23 12:39 pidfile
&gt; [rob@intelcompute perl]$ 
&gt; 
&gt; 
&gt; #!/usr/bin/env perl
&gt; #
&gt; use PID::File;
&gt; my $pid_file;
&gt; 
&gt; sub make_pid_file {
&gt; 
&gt;      $pid_file = PID::File-&gt;new;
&gt;      $pid_file-&gt;file&#40;&#39;pidfile&#39;&#41;;
&gt; 
&gt;      $pid_file-&gt;create;
&gt;      $pid_file-&gt;guard if $pid_file;
&gt;      print &#34;pidfile created $$\n&#34;;
&gt; 
&gt;      system&#40;&#34;ls -l pidfile&#34;&#41;;
&gt;      }
&gt; 
&gt; make_pid_file&#40;&#41;;
&gt; system&#40;&#34;ls -l pidfile&#34;&#41;;
&gt; exit;
&gt; 
&gt; I&#39;m just building 5.10.0 to see if it&#39;s an issue specific to a version 
</div>- 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; I would&#39;ve spotted that error with the unit tests and my own testing, 
</div>so 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; was a bit surprised by it.
&gt; 
&gt; Cheers,
&gt; Rob
&gt; 
&gt; 
&gt; 
&gt; On Thu Aug 23 07:09:32 2012, CAGAO wrote:
<div class="message-stanza open">&gt; &gt; Thanks Holgar,
&gt; &gt; 
&gt; &gt; I&#39;ll start looking into this today for you.
&gt; &gt; 
&gt; &gt; Cheers,
&gt; &gt; Rob
&gt; &gt; 
&gt; &gt; 
&gt; &gt; 
</div>&gt; 
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112265" href="/Public/Bug/Display.html?id=79161#txn-1112265">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;08:30:17&nbsp;2012</span>
    <span class="description">holger [...] loomsday.co.nz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79161] Can&#39;t call method &#34;remove&#34; on an undefined value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 24 Aug 2012 00:30:01 +1200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PID-File [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Holger Jahn &lt;holger [...] loomsday.co.nz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112265/584966/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584966">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks, Rob.

Yes, we are still using perl 5.10.

Hope this can be fixed. Otherwise, we would need to update our entire 
Perl infrastructure &#40;we are compiling for a bunch of different platforms&#41;.

Cheers,
Holger

On 08/23/2012 11:54 PM, Rob Brown via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79161">https://rt.cpan.org/Ticket/Display.html?id=79161</a></span> &gt;
&gt;
&gt; Yup, it&#39;s a problem on 5.10.0, let me investigate further...
&gt;
&gt;
&gt;
&gt; On Thu Aug 23 07:43:21 2012, CAGAO wrote:
<div class="message-stanza open">&gt;&gt; hmmm, I&#39;ve just re-created your script, with the global var, and ran
</div>&gt; it,
<div class="message-stanza open">&gt;&gt; with no problems on 5.14.2
&gt;&gt;
&gt;&gt; [rob@intelcompute perl]$ ./pid-file.pl
&gt;&gt; pidfile created 2382
&gt;&gt; -rw-rw-r-- 1 rob rob 4 Aug 23 12:39 pidfile
&gt;&gt; -rw-rw-r-- 1 rob rob 4 Aug 23 12:39 pidfile
&gt;&gt; [rob@intelcompute perl]$
&gt;&gt;
&gt;&gt;
&gt;&gt; #!/usr/bin/env perl
&gt;&gt; #
&gt;&gt; use PID::File;
&gt;&gt; my $pid_file;
&gt;&gt;
&gt;&gt; sub make_pid_file {
&gt;&gt;
&gt;&gt;       $pid_file = PID::File-&gt;new;
&gt;&gt;       $pid_file-&gt;file&#40;&#39;pidfile&#39;&#41;;
&gt;&gt;
&gt;&gt;       $pid_file-&gt;create;
&gt;&gt;       $pid_file-&gt;guard if $pid_file;
&gt;&gt;       print &#34;pidfile created $$\n&#34;;
&gt;&gt;
&gt;&gt;       system&#40;&#34;ls -l pidfile&#34;&#41;;
&gt;&gt;       }
&gt;&gt;
&gt;&gt; make_pid_file&#40;&#41;;
&gt;&gt; system&#40;&#34;ls -l pidfile&#34;&#41;;
&gt;&gt; exit;
&gt;&gt;
&gt;&gt; I&#39;m just building 5.10.0 to see if it&#39;s an issue specific to a version
</div>&gt; -
<div class="message-stanza open">&gt;&gt; I would&#39;ve spotted that error with the unit tests and my own testing,
</div>&gt; so
<div class="message-stanza open">&gt;&gt; was a bit surprised by it.
&gt;&gt;
&gt;&gt; Cheers,
&gt;&gt; Rob
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Thu Aug 23 07:09:32 2012, CAGAO wrote:
<div class="message-stanza open">&gt;&gt;&gt; Thanks Holgar,
&gt;&gt;&gt;
&gt;&gt;&gt; I&#39;ll start looking into this today for you.
&gt;&gt;&gt;
&gt;&gt;&gt; Cheers,
&gt;&gt;&gt; Rob
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;
</div>&gt;&gt;
&gt;&gt;
</div>&gt;
&gt;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112267" href="/Public/Bug/Display.html?id=79161#txn-1112267">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;08:32:50&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112267/584968/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584968">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 112b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Aye understandable, well done on even being on 5.10  :&#41;

Will let you know how I get on, sure I&#39;ll have a fix...
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112270" href="/Public/Bug/Display.html?id=79161#txn-1112270">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;08:38:52&nbsp;2012</span>
    <span class="description">holger [...] loomsday.co.nz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79161] Can&#39;t call method &#34;remove&#34; on an undefined value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 24 Aug 2012 00:38:42 +1200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PID-File [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Holger Jahn &lt;holger [...] loomsday.co.nz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112270/584970/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584970">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 350b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Eventually, we will go down the 5.14 path... we are just a bit laz..., 
err... reluctant in doing that right away. ;-&#41;

On 08/24/2012 12:32 AM, Rob Brown via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79161">https://rt.cpan.org/Ticket/Display.html?id=79161</a></span> &gt;
&gt;
&gt; Aye understandable, well done on even being on 5.10  :&#41;
&gt;
&gt; Will let you know how I get on, sure I&#39;ll have a fix...
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112272" href="/Public/Bug/Display.html?id=79161#txn-1112272">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;08:54:21&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112272/584972/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584972">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">OK, this is a strange issue which I&#39;ll have to dig into more.

But I do have a work around, and generally a better way of doing things anyway.

Don&#39;t have make_pid_file&#40;&#41; access global variables, instead, return back the pid file 
object as per the following example - this should solve all your problems.

The bug was still actually seen on 5.14.2 but just without the error, ie, the pidfile 
remains.


#!/usr/bin/env perl

use strict;
use warnings;

use PID::File;

sub make_pid_file {

    my $pid_file = PID::File-&gt;new;
    $pid_file-&gt;file&#40;&#39;pidfile&#39;&#41;;

    $pid_file-&gt;create;
    $pid_file-&gt;guard if $pid_file;
    print &#34;pidfile created $$\n&#34;;

    system&#40;&#34;ls -l pidfile&#34;&#41;;

    return $pid_file;
}

my $pid_file = make_pid_file&#40;&#41;;

system&#40;&#34;ls -l pidfile&#34;&#41;;

exit;






On Thu Aug 23 08:38:52 2012, holger@loomsday.co.nz wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Eventually, we will go down the 5.14 path... we are just a bit laz..., 
&gt; err... reluctant in doing that right away. ;-&#41;
&gt; 
&gt; On 08/24/2012 12:32 AM, Rob Brown via RT wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79161">https://rt.cpan.org/Ticket/Display.html?id=79161</a></span> &gt;
&gt; &gt;
&gt; &gt; Aye understandable, well done on even being on 5.10  :&#41;
&gt; &gt;
&gt; &gt; Will let you know how I get on, sure I&#39;ll have a fix...
&gt; &gt;
</div>&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112274" href="/Public/Bug/Display.html?id=79161#txn-1112274">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;08:54:22&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;stalled&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112287" href="/Public/Bug/Display.html?id=79161#txn-1112287">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;09:55:42&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112287/584977/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/584977">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 414b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">So, the issue was down to the fact that you had a sub routine closing 
over the $pid_file variable, and since subs are global, the object didn&#39;t 
go out of scope until the end of everything, ie, when the sub finally 
goes out of scope, and by that time, the object had gone too.

The wonderful world of garbage collection.

Issue fixed in PID-File-0.31, should be available on CPAN in a few hours.

Happy days!  :&#41;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112289" href="/Public/Bug/Display.html?id=79161#txn-1112289">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;09:55:43&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;stalled&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112290" href="/Public/Bug/Display.html?id=79161#txn-1112290">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;09:55:43&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112502" href="/Public/Bug/Display.html?id=79161#txn-1112502">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;21:09:37&nbsp;2012</span>
    <span class="description">holger [...] loomsday.co.nz -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #79161] Can&#39;t call method &#34;remove&#34; on an undefined value</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 24 Aug 2012 13:09:24 +1200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-PID-File [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Holger Jahn &lt;holger [...] loomsday.co.nz&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112502/585118/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/585118">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 679b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks again, Rob, for taking great care with so little response time.

Much appreciated! :-&#41;

Spring greetings from Auckland/NZ,
Holger

On 08/24/2012 01:55 AM, Rob Brown via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79161">https://rt.cpan.org/Ticket/Display.html?id=79161</a></span> &gt;
&gt;
&gt; So, the issue was down to the fact that you had a sub routine closing
&gt; over the $pid_file variable, and since subs are global, the object didn&#39;t
&gt; go out of scope until the end of everything, ie, when the sub finally
&gt; goes out of scope, and by that time, the object had gone too.
&gt;
&gt; The wonderful world of garbage collection.
&gt;
&gt; Issue fixed in PID-File-0.31, should be available on CPAN in a few hours.
&gt;
&gt; Happy days!  :&#41;
&gt;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112504" href="/Public/Bug/Display.html?id=79161#txn-1112504">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;21:09:37&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;resolved&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112505" href="/Public/Bug/Display.html?id=79161#txn-1112505">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;21:56:45&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1112505/585120/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/585120">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 964b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Holger,

No problem, I know how frustrating it can be raising bugs with cpan 
distros sometimes and not have them looked at for weeks, months, or even 
years.

Cheers,
Rob


On Thu Aug 23 21:09:37 2012, holger@loomsday.co.nz wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks again, Rob, for taking great care with so little response time.
&gt; 
&gt; Much appreciated! :-&#41;
&gt; 
&gt; Spring greetings from Auckland/NZ,
&gt; Holger
&gt; 
&gt; On 08/24/2012 01:55 AM, Rob Brown via RT wrote:
<div class="message-stanza open">&gt; &gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=79161">https://rt.cpan.org/Ticket/Display.html?id=79161</a></span> &gt;
&gt; &gt;
&gt; &gt; So, the issue was down to the fact that you had a sub routine 
</div></div>closing
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; over the $pid_file variable, and since subs are global, the object 
</div></div>didn&#39;t
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; go out of scope until the end of everything, ie, when the sub 
</div></div>finally
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; goes out of scope, and by that time, the object had gone too.
&gt; &gt;
&gt; &gt; The wonderful world of garbage collection.
&gt; &gt;
&gt; &gt; Issue fixed in PID-File-0.31, should be available on CPAN in a few 
</div></div>hours.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;
&gt; &gt; Happy days!  :&#41;
&gt; &gt;
</div>&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1112507" href="/Public/Bug/Display.html?id=79161#txn-1112507">#</a>      
    </span>
    <span class="date">Thu&nbsp;Aug&nbsp;23&nbsp;21:56:46&nbsp;2012</span>
    <span class="description">CAGAO [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.553227</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
