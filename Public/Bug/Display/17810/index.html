<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #17810 for WWW-Myspace: Function Ideas and samples</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #17810 for WWW-Myspace: Function Ideas and samples</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/WWW-Myspace/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/WWW-Myspace/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/WWW-Myspace/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/WWW-Myspace/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/WWW-Myspace">WWW-Myspace CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">17810</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/WWW-Myspace/Active/">WWW-Myspace</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">GRANTG [...] cpan.org
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
Plasma2002 [...] sch.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Unimportant    </td>
  </tr>
  <tr id="CF-38014-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-38015-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    




  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;22&nbsp;14:21:26&nbsp;2006</span>
    <span class="description">Guest -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Function Ideas and samples</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Per request, just some sample code i have for those functions i had 
described in the forum.

You might want to download this page so the code will be more readable




note that these were taken straight out of another script which 
handled an AIM bot, so each function handled multiple MySpace users 
and accounts. Be carefull if your copy and pasting. This is mainly 
just here for ideas.

#------------------------------------------------------
#post_bulletin posts a bulletin on myspace for the account holder
#------------------------------------------------------


sub post_bulletin{

        $sender = shift;
        $subject = shift;
        $message = shift;
        $account = decode_base64&#40;$people_myspace_names{$sender}&#41;;
        $pass = decode_base64&#40;$people_myspace_passes{$sender}&#41;;


        my &#40; $submitted, $res, $page &#41;;

        my $myspace = WWW::Myspace-&gt;new &#40;$account, $pass&#41;;

        $my_id = $myspace-&gt;my_friend_id;
        print &#34;      Users friend id is: $my_id\n&#34;;
        if&#40;&#40;$my_id&#41; &gt; &#34;1&#34;&#41;{
                #its good
        }else{

                #bad username/pass
                load_arrays&#40;&#41;;
                send_message&#40;$sender, &#34;It looks like your MySpace 
username or password is incorrect. Please go to my page at $bot_page 
and update it&#34;&#41;;
                return;
        }



        # Try to get the message form
        $res = $myspace-&gt;get_page&#40; &#34;${POST_BULLETIN_FORM}&#34; &#41;;

        # See if we can post or if there&#39;s an error.
        if &#40; $res-&gt;is_success &#41; {
                $page = $res-&gt;content;
                $page =~ s/[ \t\n\r]+/ /g;
        } else {
                print &#34;there was an html error &#40;1&#41;\n&#34;;
                send_message&#40;$sender, &#34;There was a MySpace internal 
error. It was beyond my control. Sorry :&#40;&#34;&#41;;
                return;
        }

        # Take care  &#34;\n&#34;s
        $message =~ s/\\n/\n/gs;

        # Submit the message
        print &#34;      Submitting the first form... &#34;;

        $submitted = $myspace-&gt;submit_form&#40; $res,
                                                1, &#34;&#34;,
                                                { &#39;subject&#39; 
=&gt; &#34;$subject&#34;,
                                                  &#39;body&#39; =&gt; &#34;$message&#34;
                                                }
                                          &#41;;

        $page = $myspace-&gt;{current_page}-&gt;content;
        $page =~ s/[ \t\n\r]+/ /g;

        print &#34;success!\n&#34;;


        if &#40; $res-&gt;is_success &#41; {
                $page = $res-&gt;content;
                $page =~ s/[ \t\n\r]+/ /g;
        }else{
                print &#34;there was an html error &#40;2&#41;\n&#34;;
                send_message&#40;$sender, &#34;There was a MySpace internal 
error. It was beyond my control. Sorry :&#40;&#34;&#41;;
                return;
        }

        print &#34;      Submitting the confirmation form... &#34;;
        $confirmed = $myspace-&gt;submit_form&#40; $myspace-&gt;{current_page}, 
1, &#34;&#34;,{} &#41;;
        print &#34;success!\n&#34;;

        $page = $myspace-&gt;{current_page}-&gt;content;
        $page =~ s/[ \t\n\r]+/ /g;


        # Return the result
        if &#40;! $confirmed &#41; {
                print &#34;      there was an html error &#40;3&#41;\n&#34;;
                send_message&#40;$sender, &#34;There was a MySpace internal 
error. It was beyond my control. Sorry :&#40;&#34;&#41;;
                return;
        } elsif &#40; $page =~ /$VERIFY_BULLETIN_SENT/ &#41; {
                print &#34;      SUCCESS ON BULLETIN!\n&#34;;
                send_message&#40;$sender, &#34;Your bulletin has successfully 
been posted :&#41; Remember... you might have to give it up to 5 minutes 
before it shows up ;&#41;&#34;&#41;;
                return;
        } else {
                print &#34;      there was an html error &#40;4&#41;\n&#34;;
                send_message&#40;$sender, &#34;There was a MySpace internal 
error. It was beyond my control. Sorry :&#40;&#34;&#41;;
                return;
        }
        print &#34;Killing myspace\n\n&#34;;
        #kill off the myspace class
        $myspace = &#39;&#39;
}










Heres a littl snippet i use in a function that grabs the friends on 
the top 8 list.....




        #lets get the top 8 friends


        $url = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://home.myspace.com/index.cfm?fuseaction=user">http://home.myspace.com/index.cfm?fuseaction=user</a></span>&#34;;
        dbg &#40;&#34;      Getting top 8 friends for $sender...\n&#34;&#41;;
        $res=$myspace-&gt;get_page&#40; $url &#41;;
        $offset = index&#40;$res-&gt;content,&#34;My Friend Space&#34;&#41;;
        $content = substr&#40;$res-&gt;content,$offset&#41; ;
        my @mylist = $myspace-&gt;get_friends_on_page&#40; $content &#41;;
        dbg &#40;&#34;      Got top 8 friends\n&#34;&#41;;

     #got top 8





basically it just cuts all the data from the page until it sees &#34;My 
Friend Space&#34;, then pulls get_friends_on_page to it. Which im glad 
get_friends_on_page uses raw content and not a url :&#41; haha











#------------------------------------------------------
#myspace_stats will return if there are new posts, 
#new comments, new pic comments, friend requests, event 
#invites, blog comments, or blog subscription posts
#------------------------------------------------------


sub myspace_stats{
        $sender = shift;
        $account = decode_base64&#40;$people_myspace_names{$sender}&#41;;
        $pass = decode_base64&#40;$people_myspace_passes{$sender}&#41;;

        print &#40;&#34;$sender has requested MySpace stats\n&#34;&#41;;

        dbg&#40;&#34;      Starting MySpace class\n&#34;&#41;;

        my $myspace = WWW::Myspace-&gt;new &#40;$account, $pass&#41;;

        dbg&#40;&#34;      Getting users homepage\n&#34;&#41;;

        $url = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://home.myspace.com/index.cfm?fuseaction=user">http://home.myspace.com/index.cfm?fuseaction=user</a></span>&#34;;
        print &#34;Getting MySpace status. Please be patient...\n&#34;;
        $res=$myspace-&gt;get_page&#40; $url &#41;;
        $page = $res-&gt;content;


        my $myspace_id = $myspace-&gt;my_friend_id;


        our $NEW_MESSAGES=&#39;&lt;div id=&#34;indicatorMail&#34; class=&#34;show 
indicator&#34;&gt;&#39;;
        our $NEW_COMMENTS=&#39;&lt;div id=&#34;indicatorComments&#34; class=&#34;show 
indicator&#34;&gt;&#39;;
        our $NEW_PIC_COMMENTS=&#39;&lt;div id=&#34;indicatorImageComments&#34; 
class=&#34;show indicator&#34;&gt;&#39;;
        our $NEW_FRIEND_REQ=&#39;&lt;div id=&#34;indicatorFriendRequest&#34; 
class=&#34;show indicator&#34;&gt;&#39;;
        our $NEW_EVENT_INV=&#39;&lt;div id=&#34;indicatorEvents&#34; class=&#34;show 
indicator&#34;&gt;&#39;;
        our $NEW_BLOG_COMMENTS=&#39;&lt;div  id=&#34;indicatorBlogComments&#34; 
class=&#34;show indicator&#34;&gt;&#39;;
        our $NEW_BLOG_SUB_POSTS=&#39;&lt;div id=&#34;indicatorBlogs&#34; class=&#34;show 
indicator&#34;&gt;&#39;;

        if &#40; $page =~ /$NEW_MESSAGES/ &#41; {
                $results .= &#34;&lt;br&gt;&lt;a 
href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://mail.myspace.com/index.cfm">http://mail.myspace.com/index.cfm</a></span>?
fuseaction=mail.inbox\&#34;&gt;MySpace&lt;/a&gt;: &lt;b&gt;You Have New Messages!&lt;/b&gt;&#34;;
                dbg&#40;&#34;            New Messages Found\n&#34;&#41;;
        }else{
                $results .= &#34;&lt;br&gt;&lt;a 
href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://mail.myspace.com/index.cfm">http://mail.myspace.com/index.cfm</a></span>?
fuseaction=mail.inbox\&#34;&gt;MySpace&lt;/a&gt;: 0 new messages&#34;;
                dbg&#40;&#34;            No New Messages\n&#34;&#41;;
        }


        if &#40; $page =~ /$NEW_COMMENTS/ &#41; {
                $results .= &#34;&lt;br&gt;&lt;a 
href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
fuseaction=user.HomeComments&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 
&lt;b&gt;You Have New Comments!&lt;/b&gt;&#34;;
                dbg&#40;&#34;            New Comments Found\n&#34;&#41;;
        }else{
                $results .= &#34;&lt;br&gt;&lt;a 
href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
fuseaction=user.HomeComments&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 0 
new comments&#34;;
                dbg&#40;&#34;            No New Comments\n&#34;&#41;;
        }

        if &#40; $page =~ /$NEW_PIC_COMMENTS/ &#41; {
                $results .= &#34;&lt;br&gt;&lt;a 
href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
fuseaction=user.viewPicture&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 
&lt;b&gt;You Have New Picture Comments!&lt;/b&gt;&#34;;
                dbg&#40;&#34;            New Pic Comments Found\n&#34;&#41;;
        }else{
                $results .= &#34;&lt;br&gt;&lt;a 
href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
fuseaction=user.viewPicture&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 0 
new pic comments&#34;;
                dbg&#40;&#34;            No New Pic Comments\n&#34;&#41;;
        }

.
.
.
.
i think you get the idea :&#41;


return $results;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;22&nbsp;16:14:27&nbsp;2006</span>
    <span class="description">GRANTG [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks - I&#39;m glad you updated the indicator handling.  That MySpace change &#40;which they&#39;d 
done once before, then changed back&#41; irritated me.

Could you also post the values of the $POST_BULLETIN_FORM and $VERIFY_BULLETIN_SENT 
Regexps?  That&#39;d be -really- handy.

Thanks,

Grant

On Wed Feb 22 14:21:26 2006, guest wrote:
[...]

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;       # Try to get the message form
&gt;       $res = $myspace-&gt;get_page&#40; &#34;${POST_BULLETIN_FORM}&#34; &#41;;
</div>
[...]

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;               return;
&gt;       } elsif &#40; $page =~ /$VERIFY_BULLETIN_SENT/ &#41; {
&gt;               print &#34;      SUCCESS ON BULLETIN!\n&#34;;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;22&nbsp;16:14:28&nbsp;2006</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;24&nbsp;13:06:50&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Plasma2002</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 22 16:14:27 2006, GRANTG wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Thanks - I&#39;m glad you updated the indicator handling.  That MySpace
&gt; change &#40;which they&#39;d
&gt; done once before, then changed back&#41; irritated me.
&gt; 
&gt; Could you also post the values of the $POST_BULLETIN_FORM and
&gt; $VERIFY_BULLETIN_SENT
&gt; Regexps?  That&#39;d be -really- handy.
&gt; 
&gt; Thanks,
&gt; 
&gt; Grant
&gt; 
&gt; On Wed Feb 22 14:21:26 2006, guest wrote:
&gt; [...]
&gt; 
<div class="message-stanza open">&gt; &gt;     # Try to get the message form
&gt; &gt;     $res = $myspace-&gt;get_page&#40; &#34;${POST_BULLETIN_FORM}&#34; &#41;;
</div>&gt; 
&gt; [...]
&gt; 
<div class="message-stanza open">&gt; &gt;             return;
&gt; &gt;     } elsif &#40; $page =~ /$VERIFY_BULLETIN_SENT/ &#41; {
&gt; &gt;             print &#34;      SUCCESS ON BULLETIN!\n&#34;;
</div></div>










haha, yeah... they changed those indicators 2 days after i posted that 
code. It pissed me off :&#41;

But yea, heres those value..... the varify isnt much of a regexp, just 
a single phrase it looks for. Im not sure what else it should look 
for, so thats all i could think of at the moment, haha





        # The URL of the bulletin posting page. No friend id required
        our $POST_BULLETIN_FORM=&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://bulletin.myspace.com/index.cfm">http://bulletin.myspace.com/index.cfm</a></span>?
fuseaction=bulletin.edit&#34;;

        # What regexp should we look for after sending a message that 
tells
        # us the message was sent?
        our $VERIFY_BULLETIN_SENT = &#34;Bulletin Has Been Posted&#34;;
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Feb&nbsp;24&nbsp;14:29:22&nbsp;2006</span>
    <span class="description">grantg [...] spamarrest.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #17810] Function Ideas and samples </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 24 Feb 2006 11:28:36 -0800</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-WWW-Myspace [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Grant Grueninger &lt;grantg [...] spamarrest.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">I think &#34;Bulletin has been posted&#34; is probably a pretty good  
verification. :&#41;

Thanks much.


-- 
Grant Grueninger
Commercial Systems Corporation
<span class="clickylink"><a target="new" rel="nofollow" href="http://www.cscorp.com/">http://www.cscorp.com/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction people Take even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;06&nbsp;03:16:35&nbsp;2006</span>
    <span class="description">GRANTG [...] cpan.org -  Taken</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;May&nbsp;13&nbsp;17:46:31&nbsp;2006</span>
    <span class="description">Guest -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Wed Feb 22 14:21:26 2006, guest wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Per request, just some sample code i have for those functions i had 
&gt; described in the forum.
&gt; 
&gt; You might want to download this page so the code will be more 
</div>readable
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; 
&gt; 
&gt; 
&gt; note that these were taken straight out of another script which 
&gt; handled an AIM bot, so each function handled multiple MySpace users 
&gt; and accounts. Be carefull if your copy and pasting. This is mainly 
&gt; just here for ideas.
&gt; 
&gt; #------------------------------------------------------
&gt; #post_bulletin posts a bulletin on myspace for the account holder
&gt; #------------------------------------------------------
&gt; 
&gt; 
&gt; sub post_bulletin{
&gt; 
&gt;       $sender = shift;
&gt;       $subject = shift;
&gt;       $message = shift;
&gt;       $account = decode_base64&#40;$people_myspace_names{$sender}&#41;;
&gt;       $pass = decode_base64&#40;$people_myspace_passes{$sender}&#41;;
&gt; 
&gt; 
&gt;       my &#40; $submitted, $res, $page &#41;;
&gt; 
&gt;       my $myspace = WWW::Myspace-&gt;new &#40;$account, $pass&#41;;
&gt; 
&gt;       $my_id = $myspace-&gt;my_friend_id;
&gt;       print &#34;      Users friend id is: $my_id\n&#34;;
&gt;       if&#40;&#40;$my_id&#41; &gt; &#34;1&#34;&#41;{
&gt;               #its good
&gt;       }else{
&gt; 
&gt;               #bad username/pass
&gt;               load_arrays&#40;&#41;;
&gt;               send_message&#40;$sender, &#34;It looks like your MySpace 
&gt; username or password is incorrect. Please go to my page at $bot_page 
&gt; and update it&#34;&#41;;
&gt;               return;
&gt;       }
&gt; 
&gt; 
&gt; 
&gt;       # Try to get the message form
&gt;       $res = $myspace-&gt;get_page&#40; &#34;${POST_BULLETIN_FORM}&#34; &#41;;
&gt; 
&gt;       # See if we can post or if there&#39;s an error.
&gt;       if &#40; $res-&gt;is_success &#41; {
&gt;               $page = $res-&gt;content;
&gt;               $page =~ s/[ \t\n\r]+/ /g;
&gt;       } else {
&gt;               print &#34;there was an html error &#40;1&#41;\n&#34;;
&gt;               send_message&#40;$sender, &#34;There was a MySpace internal 
&gt; error. It was beyond my control. Sorry :&#40;&#34;&#41;;
&gt;               return;
&gt;       }
&gt; 
&gt;       # Take care  &#34;\n&#34;s
&gt;       $message =~ s/\\n/\n/gs;
&gt; 
&gt;       # Submit the message
&gt;       print &#34;      Submitting the first form... &#34;;
&gt; 
&gt;       $submitted = $myspace-&gt;submit_form&#40; $res,
&gt;                                               1, &#34;&#34;,
&gt;                                               { &#39;subject&#39; 
&gt; =&gt; &#34;$subject&#34;,
&gt;                                                 &#39;body&#39; =&gt; &#34;$message&#34;
&gt;                                               }
&gt;                                         &#41;;
&gt; 
&gt;       $page = $myspace-&gt;{current_page}-&gt;content;
&gt;       $page =~ s/[ \t\n\r]+/ /g;
&gt; 
&gt;       print &#34;success!\n&#34;;
&gt; 
&gt; 
&gt;       if &#40; $res-&gt;is_success &#41; {
&gt;               $page = $res-&gt;content;
&gt;               $page =~ s/[ \t\n\r]+/ /g;
&gt;       }else{
&gt;               print &#34;there was an html error &#40;2&#41;\n&#34;;
&gt;               send_message&#40;$sender, &#34;There was a MySpace internal 
&gt; error. It was beyond my control. Sorry :&#40;&#34;&#41;;
&gt;               return;
&gt;       }
&gt; 
&gt;       print &#34;      Submitting the confirmation form... &#34;;
&gt;       $confirmed = $myspace-&gt;submit_form&#40; $myspace-&gt;{current_page}, 
&gt; 1, &#34;&#34;,{} &#41;;
&gt;       print &#34;success!\n&#34;;
&gt; 
&gt;       $page = $myspace-&gt;{current_page}-&gt;content;
&gt;       $page =~ s/[ \t\n\r]+/ /g;
&gt; 
&gt; 
&gt;       # Return the result
&gt;       if &#40;! $confirmed &#41; {
&gt;               print &#34;      there was an html error &#40;3&#41;\n&#34;;
&gt;               send_message&#40;$sender, &#34;There was a MySpace internal 
&gt; error. It was beyond my control. Sorry :&#40;&#34;&#41;;
&gt;               return;
&gt;       } elsif &#40; $page =~ /$VERIFY_BULLETIN_SENT/ &#41; {
&gt;               print &#34;      SUCCESS ON BULLETIN!\n&#34;;
&gt;               send_message&#40;$sender, &#34;Your bulletin has successfully 
&gt; been posted :&#41; Remember... you might have to give it up to 5 minutes 
&gt; before it shows up ;&#41;&#34;&#41;;
&gt;               return;
&gt;       } else {
&gt;               print &#34;      there was an html error &#40;4&#41;\n&#34;;
&gt;               send_message&#40;$sender, &#34;There was a MySpace internal 
&gt; error. It was beyond my control. Sorry :&#40;&#34;&#41;;
&gt;               return;
&gt;       }
&gt;       print &#34;Killing myspace\n\n&#34;;
&gt;       #kill off the myspace class
&gt;       $myspace = &#39;&#39;
&gt; }
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; Heres a littl snippet i use in a function that grabs the friends on 
&gt; the top 8 list.....
&gt; 
&gt; 
&gt; 
&gt; 
&gt;       #lets get the top 8 friends
&gt; 
&gt; 
&gt;       $url = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://home.myspace.com/index.cfm?fuseaction=user">http://home.myspace.com/index.cfm?fuseaction=user</a></span>&#34;;
&gt;       dbg &#40;&#34;      Getting top 8 friends for $sender...\n&#34;&#41;;
&gt;       $res=$myspace-&gt;get_page&#40; $url &#41;;
&gt;       $offset = index&#40;$res-&gt;content,&#34;My Friend Space&#34;&#41;;
&gt;       $content = substr&#40;$res-&gt;content,$offset&#41; ;
&gt;       my @mylist = $myspace-&gt;get_friends_on_page&#40; $content &#41;;
&gt;       dbg &#40;&#34;      Got top 8 friends\n&#34;&#41;;
&gt; 
&gt;      #got top 8
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; basically it just cuts all the data from the page until it sees &#34;My 
&gt; Friend Space&#34;, then pulls get_friends_on_page to it. Which im glad 
&gt; get_friends_on_page uses raw content and not a url :&#41; haha
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; #------------------------------------------------------
&gt; #myspace_stats will return if there are new posts, 
&gt; #new comments, new pic comments, friend requests, event 
&gt; #invites, blog comments, or blog subscription posts
&gt; #------------------------------------------------------
&gt; 
&gt; 
&gt; sub myspace_stats{
&gt;       $sender = shift;
&gt;       $account = decode_base64&#40;$people_myspace_names{$sender}&#41;;
&gt;       $pass = decode_base64&#40;$people_myspace_passes{$sender}&#41;;
&gt; 
&gt;       print &#40;&#34;$sender has requested MySpace stats\n&#34;&#41;;
&gt; 
&gt;       dbg&#40;&#34;      Starting MySpace class\n&#34;&#41;;
&gt; 
&gt;       my $myspace = WWW::Myspace-&gt;new &#40;$account, $pass&#41;;
&gt; 
&gt;       dbg&#40;&#34;      Getting users homepage\n&#34;&#41;;
&gt; 
&gt;       $url = &#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://home.myspace.com/index.cfm?fuseaction=user">http://home.myspace.com/index.cfm?fuseaction=user</a></span>&#34;;
&gt;       print &#34;Getting MySpace status. Please be patient...\n&#34;;
&gt;       $res=$myspace-&gt;get_page&#40; $url &#41;;
&gt;       $page = $res-&gt;content;
&gt; 
&gt; 
&gt;       my $myspace_id = $myspace-&gt;my_friend_id;
&gt; 
&gt; 
&gt;       our $NEW_MESSAGES=&#39;&lt;div id=&#34;indicatorMail&#34; class=&#34;show 
&gt; indicator&#34;&gt;&#39;;
&gt;       our $NEW_COMMENTS=&#39;&lt;div id=&#34;indicatorComments&#34; class=&#34;show 
&gt; indicator&#34;&gt;&#39;;
&gt;       our $NEW_PIC_COMMENTS=&#39;&lt;div id=&#34;indicatorImageComments&#34; 
&gt; class=&#34;show indicator&#34;&gt;&#39;;
&gt;       our $NEW_FRIEND_REQ=&#39;&lt;div id=&#34;indicatorFriendRequest&#34; 
&gt; class=&#34;show indicator&#34;&gt;&#39;;
&gt;       our $NEW_EVENT_INV=&#39;&lt;div id=&#34;indicatorEvents&#34; class=&#34;show 
&gt; indicator&#34;&gt;&#39;;
&gt;       our $NEW_BLOG_COMMENTS=&#39;&lt;div  id=&#34;indicatorBlogComments&#34; 
&gt; class=&#34;show indicator&#34;&gt;&#39;;
&gt;       our $NEW_BLOG_SUB_POSTS=&#39;&lt;div id=&#34;indicatorBlogs&#34; class=&#34;show 
&gt; indicator&#34;&gt;&#39;;
&gt; 
&gt;       if &#40; $page =~ /$NEW_MESSAGES/ &#41; {
&gt;               $results .= &#34;&lt;br&gt;&lt;a 
&gt; href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://mail.myspace.com/index.cfm">http://mail.myspace.com/index.cfm</a></span>?
&gt; fuseaction=mail.inbox\&#34;&gt;MySpace&lt;/a&gt;: &lt;b&gt;You Have New Messages!&lt;/b&gt;&#34;;
&gt;               dbg&#40;&#34;            New Messages Found\n&#34;&#41;;
&gt;       }else{
&gt;               $results .= &#34;&lt;br&gt;&lt;a 
&gt; href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://mail.myspace.com/index.cfm">http://mail.myspace.com/index.cfm</a></span>?
&gt; fuseaction=mail.inbox\&#34;&gt;MySpace&lt;/a&gt;: 0 new messages&#34;;
&gt;               dbg&#40;&#34;            No New Messages\n&#34;&#41;;
&gt;       }
&gt; 
&gt; 
&gt;       if &#40; $page =~ /$NEW_COMMENTS/ &#41; {
&gt;               $results .= &#34;&lt;br&gt;&lt;a 
&gt; href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
&gt; fuseaction=user.HomeComments&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 
&gt; &lt;b&gt;You Have New Comments!&lt;/b&gt;&#34;;
&gt;               dbg&#40;&#34;            New Comments Found\n&#34;&#41;;
&gt;       }else{
&gt;               $results .= &#34;&lt;br&gt;&lt;a 
&gt; href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
&gt; fuseaction=user.HomeComments&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 
</div>0 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; new comments&#34;;
&gt;               dbg&#40;&#34;            No New Comments\n&#34;&#41;;
&gt;       }
&gt; 
&gt;       if &#40; $page =~ /$NEW_PIC_COMMENTS/ &#41; {
&gt;               $results .= &#34;&lt;br&gt;&lt;a 
&gt; href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
&gt; fuseaction=user.viewPicture&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 
&gt; &lt;b&gt;You Have New Picture Comments!&lt;/b&gt;&#34;;
&gt;               dbg&#40;&#34;            New Pic Comments Found\n&#34;&#41;;
&gt;       }else{
&gt;               $results .= &#34;&lt;br&gt;&lt;a 
&gt; href=\&#34;<span class="clickylink"><a target="new" rel="nofollow" href="http://comments.myspace.com/index.cfm">http://comments.myspace.com/index.cfm</a></span>?
&gt; fuseaction=user.viewPicture&#38;friendID=&#34;.$myspace_id.&#34;\&#34;&gt;MySpace&lt;/a&gt;: 
</div>0 
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; new pic comments&#34;;
&gt;               dbg&#40;&#34;            No New Pic Comments\n&#34;&#41;;
&gt;       }
&gt; 
&gt; .
&gt; .
&gt; .
&gt; .
&gt; i think you get the idea :&#41;
&gt; 
&gt; 
&gt; return $results;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;01&nbsp;20:14:07&nbsp;2006</span>
    <span class="description">GRANTG [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">post_bulletin and get_notifications methods added
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Oct&nbsp;01&nbsp;20:14:09&nbsp;2006</span>
    <span class="description">GRANTG [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
