<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #93065 for Spreadsheet-ParseExcel: Colors black  and auto return white</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #93065 for Spreadsheet-ParseExcel: Colors black  and auto return white</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do Iâ€¦?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=Spreadsheet-ParseExcel">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=Spreadsheet-ParseExcel">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=Spreadsheet-ParseExcel">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=Spreadsheet-ParseExcel">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>




<div id="external_bugtracker">
<h3>Preferred bug tracker</h3>
<p>
<div>Please visit the <a href="http://github.com/runrig/spreadsheet-parseexcel/issues">preferred bug tracker</a> to report your issue.</div>
</p>
</div>

<p>This queue is for tickets about the <a href="https://metacpan.org/release/Spreadsheet-ParseExcel">Spreadsheet-ParseExcel CPAN distribution</a>.</p>


<h3>Maintainer&#40;s&#41;&#39; notes</h3>

<p><b>If you are reporting a bug in Spreadsheet::ParseExcel here are some pointers</b>
<p>
1) State the issues as clearly and as concisely as possible. A simple program or Excel test file (see below) will often explain the issue better than a lot of text.
<p>
2) Provide information on your system, version of perl and module versions. The following program will generate everything that is required. Put this information in your bug report.
<pre>
    #!/usr/bin/perl -w

    print "\n    Perl version   : $]";
    print "\n    OS name        : $^O";
    print "\n    Module versions: (not all are required)\n";

    my @modules = qw(
                      Spreadsheet::ParseExcel
                      Scalar::Util
                      Unicode::Map
                      Spreadsheet::WriteExcel
                      Parse::RecDescent
                      File::Temp
                      OLE::Storage_Lite
                      IO::Stringy
                    );

    for my $module (@modules) {
        my $version;
        eval "require $module";

        if (not $@) {
            $version = $module-&gt;VERSION;
            $version = '(unknown)' if not defined $version;
        }
        else {
            $version = '(not installed)';
        }

        printf "%21s%-24s\t%s\n", "", $module, $version;
    }

    __END__
</pre>
<p>
3) Upgrade to the latest version of Spreadsheet::ParseExcel (or at least test on a system with an upgraded version). The issue you are reporting may already have been fixed.
<p>
4) Create a small example program that demonstrates your problem. The program should be as small as possible. A few lines of codes are worth tens of lines of text when trying to describe a bug.
<p>
5) <b>Supply an Excel file that demonstrates the problem</b>. This is very important. If the file is big, or contains confidential information, try to reduce it down to the smallest Excel file that represents the issue. If you don't wish to post a file here then send it to me directly: jmcnamara@cpan.org
<p>
6) Say if the test file was created by Excel, OpenOffice, Gnumeric or something else. Say which version of that application you used.
<p>
7) If you are submitting a patch you should check with the maintainer whether the issue has already been patched or if a fix is in the works. Patches should be accompanied by test cases.
<p>
<b>Asking a question</b>
<p>
If you would like to ask a more general question there is the <a href="http://groups.google.com/group/spreadsheet-parseexcel">Spreadsheet::ParseExcel Google Group</a>.
<p></p>



<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">93065</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=Spreadsheet-ParseExcel">Spreadsheet-ParseExcel</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
tlhackque [...] yahoo.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-29454-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.59    </td>
  </tr>
  <tr id="CF-29455-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.63    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




TestSheet97.xls<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1327163/703924/TestSheet97.xls">
Sun Feb 16 11:19:20 2014 (13.5k) by tlhackque [...] yahoo.com
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=93065">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1327163" href="/Public/Bug/Display.html?id=93065#txn-1327163">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;16&nbsp;11:19:20&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Colors black  and auto return white</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1327163/703923/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/703923">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Never thought I&#39;d complain that &#34;black is white&#34;, but here it is:

When a cell&#39;s border color is set to &#39;auto&#39; or &#39;black&#39;, the RGB value returned is 0xFFFFFF, which is white.  

Reproducer:
Microsoft Excel 2003 - latest &#40;11.8404.8405&#41; SP3 under windows 7.

Create a new sheet, save it.
Ctrl/1 &#40;Format cells&#41;
Select border tab.
Click on left line &#40;Thin, color auto - which means black&#41;
Save. &#40;Default type - Microsoft Excel workbook &#40;.xls&#41;&#41;

Run the test program; the returned color index is 64; the conversion table @aColor in ParseExcel.pm translates this to 0xFFFFFF, which is white.

Ctrl/1, select black, click on left line to change color to black.

Result: index 8, also mapped to 0xFFFFFF.

All other colors return reasonable values.  I checked four at a time &#40;one on each side&#41;, so it appears that the color index is being found in the right place.

The fix is probably as simple as changing the entries at 8 and 64 to 0x000000.

Here is the supporting detail:

    Perl version   : 5.008008
    OS name        : linux
    Module versions: &#40;not all are required&#41;
                     Spreadsheet::ParseExcel    0.59
                     Scalar::Util               1.23
                     Unicode::Map               0.112
                     Spreadsheet::WriteExcel    &#40;not installed&#41;
                     Parse::RecDescent          1.967009
                     File::Temp                 0.22
                     OLE::Storage_Lite          0.19
                     IO::Stringy                2.110

My test program &#40;no error checking for clarity&#41;:
#!/usr/bin/perl 
use warnings;
use strict;
use Spreadsheet::ParseExcel;
use Data::Dumper;
$Data::Dumper::Sortkeys=1;

my $ss=Spreadsheet::ParseExcel-&gt;new;
my $wb=$ss-&gt;parse&#40;&#39;TestSheet97.xls&#39;&#41;;
my $ws=$wb-&gt;worksheet&#40;0&#41;;
my $c = $ws-&gt;get_cell&#40;0,0&#41;; 
exit unless $c;
print Dumper&#40; $c-&gt;{Format}{BdrColor} &#41;;
print&#40; $ss-&gt;ColorIdxToRGB&#40; $_ &#41;, &#34;\n&#34; &#41; foreach @{$c-&gt;{Format}{BdrColor}};

exit;
__END__

Output from first three tests &#40;auto, black, red&#41;:

$VAR1 = [
          64,
          0,
          0,
          0
        ];
FFFFFF  &lt;&lt; This is white!
000000
000000
000000

Switch to black:
$VAR1 = [
          8, &lt; Note different index
          0,
          0,
          0
        ];
FFFFFF &lt;&lt; Still white
000000
000000
000000

Switch to red
$VAR1 = [
          10,
          0,
          0,
          0
        ];
FF0000 &lt;&lt; This is red!
000000
000000
000000

The attached copy of a spreadsheet has all four sides set to automatic.
$VAR1 = [
          64,
          64,
          64,
          64
        ];
FFFFFF
FFFFFF
FFFFFF
FFFFFF
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> TestSheet97.xls</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1327163/703924/TestSheet97.xls">Download TestSheet97.xls</a><br />
<span class="downloadcontenttype">application/vnd.ms-excel 13.5k</span>
</div>
<div class="messagebody">
<p>Message body not shown because it is not plain text.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1327192" href="/Public/Bug/Display.html?id=93065#txn-1327192">#</a>      
    </span>
    <span class="date">Sun&nbsp;Feb&nbsp;16&nbsp;13:43:16&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque [...] yahoo.com</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1327192/703944/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/703944">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 474b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">With a bit more experience, I think the right fix is more like:

For 8 &#40;black&#41;, return 000000

For 64 &#40;auto&#41; return something unique - perhaps undef or 1000000.  Auto isn&#39;t always black; e.g. as a fill color it probably means &#39;transparent&#39;

FWIW, I have found some clues in the microsoft spec, which you might want to refer to in the pod:  <span class="clickylink"><a target="new" rel="nofollow" href="http://download.microsoft.com/download/0/B/E/0BE8BDD7-E5E8-422A-ABFD-4342ED7AD886/Excel97-2007BinaryFileFormat&#40;xls&#41;Specification.xps">http://download.microsoft.com/download/0/B/E/0BE8BDD7-E5E8-422A-ABFD-4342ED7AD886/Excel97-2007BinaryFileFormat&#40;xls&#41;Specification.xps</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331453" href="/Public/Bug/Display.html?id=93065#txn-1331453">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;26&nbsp;18:08:19&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331453/706304/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706304">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 476b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Sun Feb 16 13:43:16 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; With a bit more experience, I think the right fix is more like:
&gt; 
&gt; For 8 &#40;black&#41;, return 000000
&gt; 
&gt; For 64 &#40;auto&#41; return something unique - perhaps undef or 1000000.
&gt; Auto isn&#39;t always black; e.g. as a fill color it probably means
&gt; &#39;transparent&#39;
</div>
Auto may not always be black, but I think it is black most of the time, so &#39;000000&#39; might be considered reasonable. I&#39;ll get this fixed in github and push it out next release.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331454" href="/Public/Bug/Display.html?id=93065#txn-1331454">#</a>      
    </span>
    <span class="date">Wed&nbsp;Feb&nbsp;26&nbsp;18:08:19&nbsp;2014</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331580" href="/Public/Bug/Display.html?id=93065#txn-1331580">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;05:09:33&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93065] Colors black  and auto return white</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Feb 2014 05:09:23 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque &lt;tlhackque [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331580/706385/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706385">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 26-Feb-14 18:08, Douglas Wilson via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93065">https://rt.cpan.org/Ticket/Display.html?id=93065</a></span> &gt;
&gt;
&gt; On Sun Feb 16 13:43:16 2014, tlhackque wrote:
<div class="message-stanza open">&gt;&gt; With a bit more experience, I think the right fix is more like:
&gt;&gt;
&gt;&gt; For 8 &#40;black&#41;, return 000000
&gt;&gt;
&gt;&gt; For 64 &#40;auto&#41; return something unique - perhaps undef or 1000000.
&gt;&gt; Auto isn&#39;t always black; e.g. as a fill color it probably means
&gt;&gt; &#39;transparent&#39;
</div>&gt; Auto may not always be black, but I think it is black most of the time, so &#39;000000&#39; might be considered reasonable. I&#39;ll get this fixed in github and push it out next release.
&gt;
</div>Yes, though it would be nice to have a constant to know the difference.  
Even a constant for &#39;64&#39; so the caller can check if it cares...

As you can probably tell, I&#39;m re-rendering some spreadsheets with this 
and finding a bunch of issues.

If you prefer, send me the gitub repo &#38; I can incorporate several of my 
patches directly, or as pull requests.

Assuming that there will be a next release sometime soon, that may be 
easier for both of us.


-- 
This communication may not represent my employer&#39;s views,
if any, on the matters discussed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331759" href="/Public/Bug/Display.html?id=93065#txn-1331759">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;13:23:24&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331759/706498/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706498">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 645b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Feb 27 05:09:33 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;
&gt; If you prefer, send me the gitub repo &#38; I can incorporate several of
&gt; my
&gt; patches directly, or as pull requests.
</div>
The repo is at:
<span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/runrig/spreadsheet-parseexcel">https://github.com/runrig/spreadsheet-parseexcel</a></span>

But I still tend to think that ColorIdxToRGB&#40;&#41; should return an RGB value, not some other made up constant, and that &#39;black&#39; is the best default value for &#39;auto&#39;. If you want to handle it differently, then why not before you call ColorIdxToRGB, or, perhaps I can just change the lexical aColor array to a package global and/or maybe provide a SetColorIdxToRGB&#40;&#41; to set any custom index to RGB mapping you want to.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1331883" href="/Public/Bug/Display.html?id=93065#txn-1331883">#</a>      
    </span>
    <span class="date">Thu&nbsp;Feb&nbsp;27&nbsp;22:19:59&nbsp;2014</span>
    <span class="description">tlhackque [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #93065] Colors black  and auto return white</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 27 Feb 2014 22:19:49 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Spreadsheet-ParseExcel [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> tlhackque &lt;tlhackque [...] yahoo.com&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1331883/706554/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/706554">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 2.4k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On 27-Feb-14 13:23, Douglas Wilson via RT wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=93065">https://rt.cpan.org/Ticket/Display.html?id=93065</a></span> &gt;
&gt;
&gt; On Thu Feb 27 05:09:33 2014, tlhackque wrote:
<div class="message-stanza open">&gt;&gt; If you prefer, send me the gitub repo &#38; I can incorporate several of
&gt;&gt; my
&gt;&gt; patches directly, or as pull requests.
</div>&gt; The repo is at:
&gt; <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/runrig/spreadsheet-parseexcel">https://github.com/runrig/spreadsheet-parseexcel</a></span>
&gt;
&gt; But I still tend to think that ColorIdxToRGB&#40;&#41; should return an RGB value, not some other made up constant, and that &#39;black&#39; is the best default value for &#39;auto&#39;. If you want to handle it differently, then why not before you call ColorIdxToRGB, or, perhaps I can just change the lexical aColor array to a package global and/or maybe provide a SetColorIdxToRGB&#40;&#41; to set any custom index to RGB mapping you want to.
</div>No, don&#39;t want custom mapping.  Mapping should return what 
worksheet/book specifies.

It appears that the color array is updated as palette records are 
encountered &#40;!&#41;.   see _subPalette&#40;&#41;

This means that state is sticky across workbooks.  E.g., open one, it 
updates @aColor, open another, they shrare the table, but should not.  
Sigh.  Each workbook object needs a private copy.

For a constant, I suggest &#40;and meant&#41; that you provide a constant for 
&#39;64&#39; the caller can then check for &#39;auto&#39; BEFORE calling ColorIdxToRGB.  
It doesn&#39;t seem right for the caller to know that 64 is magic, better 
for caller to be able to use a name.  Just define a constant 
Spreadsheet::ParseExcel::AutoColor = 64 and I&#39;d be happy.

Agree the call should return black; it&#39;s the 98% case..

Have cloned the repo, pushed the changes for hidden row, col, active 
sheeet, hidden sheet, tab color and fixes for get_row/col_heights 
exceptions.

You can merge from <span class="clickylink"><a target="new" rel="nofollow" href="https://github.com/tlhackque/spreadsheet-parseexcel">https://github.com/tlhackque/spreadsheet-parseexcel</a></span>, 
or I can issue a formal pull request.  Your choice.  I added you as a 
collaborator in case you want to push any changes while I&#39;m working on 
using this.

I didn&#39;t merge my work-around for default col format - I think a 
different approach is in order there.  Suggest that cell-&gt;get_format do 
the work when a cell&#39;s format is requested. &#40;There are some other cases 
that get_cell_format could handle, like merged areas - for now I deal 
with those in the caller.&#41;

Note that there seems to be a corresponding default row format - but I 
haven&#39;t worried about it &#40;at least, not yet&#41;.


Thanks.

-- 
This communication may not represent my employer&#39;s views,
if any, on the matters discussed.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1336494" href="/Public/Bug/Display.html?id=93065#txn-1336494">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;14:38:05&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1336494/709158/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/709158">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 279b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Thu Feb 27 22:19:59 2014, tlhackque wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; On 27-Feb-14 13:23, Douglas Wilson via RT wrote:
&gt;  Just define a constant
&gt; Spreadsheet::ParseExcel::AutoColor = 64 and I&#39;d be happy.
</div>
This was done in 0.63, though some update to the docs is still needed. Black was already done.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1336497" href="/Public/Bug/Display.html?id=93065#txn-1336497">#</a>      
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;14:38:06&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1336499" href="/Public/Bug/Display.html?id=93065#txn-1336499">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Mar&nbsp;10&nbsp;14:38:06&nbsp;2014</span>
    <span class="description">DOUGW [...] cpan.org -  Fixed in 0.63 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.436723</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
