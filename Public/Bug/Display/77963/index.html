<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #77963 for XML-ExistDB: Problem with multi chunk uploads</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #77963 for XML-ExistDB: Problem with multi chunk uploads</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/XML-ExistDB/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/XML-ExistDB/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/XML-ExistDB/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/XML-ExistDB/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/XML-ExistDB">XML-ExistDB CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">77963</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/XML-ExistDB/Active/">XML-ExistDB</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
rvdeijnden [...] gmail.com

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Important    </td>
  </tr>
  <tr id="CF-231192-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.11    </td>
  </tr>
  <tr id="CF-231193-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;22&nbsp;09:34:56&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Problem with multi chunk uploads</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi there,

I just downloaded and installed the module and it looks great. I expect it to be really helpful for us.

However there seems to be a problem when uploading documents which are larger than the chunk_size set in the constructor.

By default chunk_size is set to 32kb. Files up to a size of 32767b are uploaded without any problems.
Add one character to the file and the module chokes with this message:
====
Use of uninitialized value in length at /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 829.
error: no match for required block `cho_i4&#39; at methodCall/params/param/value
====

If I set chunk_size to a larger value &#40;larger then the filesize&#41; in the constructor the problem goes away:
  my $obj = XML::eXistDB::RPC-&gt;new&#40;
    chunk_size=&gt;64, # &lt;== 64 instead 0f 32
    destination=&gt;&#39;<span class="clickylink"><a target="new" rel="nofollow" href="http://localhost.ibfd.org:8080/exist/xmlrpc&#39;">http://localhost.ibfd.org:8080/exist/xmlrpc&#39;</a></span>,
    format=&gt;{},
  &#41;;


So it appears to be caused by triggering an upload that consists of more then one chunk.


Distribution: 0.11
Perl: This is perl, v5.8.8 built for x86_64-linux-thread-multi
OS: Linux 2.6.18-308.8.2.el5 #1 SMP Tue May 29 11:54:17 EDT 2012 x86_64 x86_64 x86_64 GNU/Linux
ExistDB info:
System Status
General
eXist Version:  1.4.0
eXist Build:    20091111
eXist Home:     /opt/tomcat/webapps/exist/WEB-INF
SVN Revision:   10440
Operating System:       Linux 2.6.18-308.8.2.el5 amd64
File encoding:  UTF-8
Java
Vendor: Sun Microsystems Inc.
Version:        1.6.0_30
Implementation: Java HotSpot&#40;TM&#41; 64-Bit Server VM
Installation:   /usr/lib/jvm/jdk1.6.0_30/jre

Thanks,
Rik
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;22&nbsp;18:43:59&nbsp;2012</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 23 Jun 2012 00:43:46 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120622 13:35]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Fri Jun 22 09:34:56 2012: Request 77963 was acted upon.
&gt; Transaction: Ticket created by rvdeijnden@gmail.com
&gt;        Queue: XML-ExistDB
&gt; 
&gt; By default chunk_size is set to 32kb. Files up to a size of 32767b are uploaded without any problems.
&gt; Add one character to the file and the module chokes with this message:
&gt; ====
&gt; Use of uninitialized value in length at /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 829.
</div>
Ik heb niet meteen een idee waar dat ik kan zitten.  Komt waarschijnlijk
van regel 489.  Kun je voor regel 829 toevoegen:
     defined $_[3] or panic;
Dan krijg ik een mooie trace.

Toen ik deze module ontwikkelde kwam ik een aantal flinke fouten tegen
aan de server-kant van de ExistDB implementatie.  Op mijn bug-reports
werd niet gereageerd.  Ik hoop dat ze ondertussen gefixt zijn.
-- 
Met vriendelijke groet,

               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Jun&nbsp;22&nbsp;18:44:00&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;24&nbsp;04:27:53&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 24 Jun 2012 10:27:40 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 23, 2012, at 12:44 AM, Mark Overmeer via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; * R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120622 13:35]:
<div class="message-stanza open">&gt;&gt; Fri Jun 22 09:34:56 2012: Request 77963 was acted upon.
&gt;&gt; Transaction: Ticket created by rvdeijnden@gmail.com
&gt;&gt;       Queue: XML-ExistDB
&gt;&gt; 
&gt;&gt; By default chunk_size is set to 32kb. Files up to a size of 32767b are uploaded without any problems.
&gt;&gt; Add one character to the file and the module chokes with this message:
&gt;&gt; ====
&gt;&gt; Use of uninitialized value in length at /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 829.
</div>&gt; 
&gt; Ik heb niet meteen een idee waar dat ik kan zitten.  Komt waarschijnlijk
&gt; van regel 489.  Kun je voor regel 829 toevoegen:
&gt;     defined $_[3] or panic;
&gt; Dan krijg ik een mooie trace.
&gt; 
</div>
Als ik die regel toevoeg krijg ik de volgende foutmelding:

Bareword &#34;panic&#34; not allowed while &#34;strict subs&#34; in use at /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 829.


Groet,
Rik
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sun&nbsp;Jun&nbsp;24&nbsp;06:44:16&nbsp;2012</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sun, 24 Jun 2012 12:43:57 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120624 08:28]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-ExistDB
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Bareword &#34;panic&#34; not allowed while &#34;strict subs&#34; in use at
&gt; /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 829.
</div>
Oh, dit is mijn enige module met
     use Log::Report &#39;xml-existdb&#39;, syntax =&gt; &#39;LONG&#39;;

Dan moet het zijn:
   report PANIC =&gt; &#39;....bericht...&#39;;

Maar een Carp::confess geeft vergelijkbare duidelijkheid ;-&#41;
-- 
Met vriendelijke groet,

               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;03:39:18&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 25 Jun 2012 09:39:01 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik vd Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">2012/6/24 Mark Overmeer via RT &lt;bug-XML-ExistDB@rt.cpan.org&gt;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt;
&gt; Oh, dit is mijn enige module met
&gt;     use Log::Report &#39;xml-existdb&#39;, syntax =&gt; &#39;LONG&#39;;
&gt;
&gt; Dan moet het zijn:
&gt;   report PANIC =&gt; &#39;....bericht...&#39;;
&gt;
&gt; Maar een Carp::confess geeft vergelijkbare duidelijkheid ;-&#41;
&gt;
</div>

In dat geval is de output:
panic: panic
 at /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 828
XML::eXistDB::RPC::uploadDocument&#40;XML::eXistDB::RPC=HASH&#40;0xdc4e410&#41;,
&#34;IBFD/vla.xml&#34;, &#34;vla.xml&#34;, &#34;is_xml&#34;, 1, &#34;replace&#34;, 1&#41; at ./add.pl line 29
main::main&#40;&#41; at ./add.pl line 6


Bedankt,
Rik
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jun&nbsp;25&nbsp;04:43:44&nbsp;2012</span>
    <span class="description">solutions [...] overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Mon, 25 Jun 2012 10:43:25 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;solutions [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120625 07:39]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; In dat geval is de output:
&gt; panic: panic
&gt;  at /usr/lib/perl5/site_perl/5.8.8/XML/eXistDB/RPC.pm line 828
&gt; XML::eXistDB::RPC::uploadDocument&#40;XML::eXistDB::RPC=HASH&#40;0xdc4e410&#41;,
&gt; &#34;IBFD/vla.xml&#34;, &#34;vla.xml&#34;, &#34;is_xml&#34;, 1, &#34;replace&#34;, 1&#41; at ./add.pl line 29
&gt; main::main&#40;&#41; at ./add.pl line 6
</div>
Oh.

Zoals eerder uitgelegd: er waren een aantal bugs aan de serverkant die er
voor hebben gezorgd dat ik niet actief verder ben gegaan met de module.
Volgens mij zijn er momenteel ook geen andere gebruikers dan jij.
Ik wil wel graag gebruikers en zal ook zeker problemen patchen, maar
het vraagt wat zelfredzaamheid.  Zal dat lukken?  &#40;Ik kan ook worden
ingehuurd om het interface te verbeteren&#41;

Als ik er zo nog eens naar kijk, dan begrijp ik niet waarom deze fout
er nog in zit.  Ik heb namelijk echt wel een paar dingen werkend gezien.

   sub upload&#40;$;$&#41;
   {  my $self = shift;
      my $tmp  = @_ == 3 ? shift : undef;
      $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;&#41;&#41;
 -     , string =&gt; $_[3], int =&gt; length&#40;$_[3]&#41;&#41;;
 +     , string =&gt; $_[0], int =&gt; length&#40;$_[1]&#41;&#41;;
   }

Lost dit het probleem op?  Lijkt me wel, gezien de functie daarachter.
-- 
Succes,

               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Jun&nbsp;26&nbsp;05:26:27&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 26 Jun 2012 11:26:14 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 25, 2012, at 10:43 AM, Mark Overmeer via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Oh.
&gt; 
&gt; Zoals eerder uitgelegd: er waren een aantal bugs aan de serverkant die er
&gt; voor hebben gezorgd dat ik niet actief verder ben gegaan met de module.
&gt; Volgens mij zijn er momenteel ook geen andere gebruikers dan jij.
&gt; Ik wil wel graag gebruikers en zal ook zeker problemen patchen, maar
&gt; het vraagt wat zelfredzaamheid.  Zal dat lukken?  &#40;Ik kan ook worden
&gt; ingehuurd om het interface te verbeteren&#41;
&gt; 
&gt; Als ik er zo nog eens naar kijk, dan begrijp ik niet waarom deze fout
&gt; er nog in zit.  Ik heb namelijk echt wel een paar dingen werkend gezien.
&gt; 
&gt;   sub upload&#40;$;$&#41;
&gt;   {  my $self = shift;
&gt;      my $tmp  = @_ == 3 ? shift : undef;
&gt;      $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;&#41;&#41;
&gt; -     , string =&gt; $_[3], int =&gt; length&#40;$_[3]&#41;&#41;;
&gt; +     , string =&gt; $_[0], int =&gt; length&#40;$_[1]&#41;&#41;;
&gt;   }
&gt; 
</div>
Na deze aanpassing is de foutmelding:
====
error: no match for required block `cho_i4&#39; at methodCall/params/param/value
====

Zelfredzaamheid zal wel lukken, en ik zal waarschijnlijk de module wel blijven gebruiken, aangezien dit probleem eenvoudig is op te lossen door de chunk_size te vergroten.

Groet,
Rik
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;27&nbsp;05:30:14&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Jun 2012 11:30:02 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 25, 2012, at 10:43 AM, Mark Overmeer via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Zoals eerder uitgelegd: er waren een aantal bugs aan de serverkant die er
&gt; voor hebben gezorgd dat ik niet actief verder ben gegaan met de module.
&gt; Volgens mij zijn er momenteel ook geen andere gebruikers dan jij.
&gt; Ik wil wel graag gebruikers en zal ook zeker problemen patchen, maar
&gt; het vraagt wat zelfredzaamheid.  Zal dat lukken?  &#40;Ik kan ook worden
&gt; ingehuurd om het interface te verbeteren&#41;
&gt; 
&gt; Als ik er zo nog eens naar kijk, dan begrijp ik niet waarom deze fout
&gt; er nog in zit.  Ik heb namelijk echt wel een paar dingen werkend gezien.
&gt; 
&gt;   sub upload&#40;$;$&#41;
&gt;   {  my $self = shift;
&gt;      my $tmp  = @_ == 3 ? shift : undef;
&gt;      $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;&#41;&#41;
&gt; -     , string =&gt; $_[3], int =&gt; length&#40;$_[3]&#41;&#41;;
&gt; +     , string =&gt; $_[0], int =&gt; length&#40;$_[1]&#41;&#41;;
&gt;   }
&gt; 
</div>
Ik ben er zelf even ingedoken en heb het op deze manier werkend gekregen:

488c488
&lt;     while&#40;$sent + $chunks &lt;= $to_sent&#41;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     while&#40;$sent &lt; $to_sent&#41;
</div>828,830c828,830
&lt;     my $tmp  = @_ == 3 ? shift : undef;
&lt;     $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;&#41;&#41;
&lt;        , string =&gt; $_[3], int =&gt; length&#40;$_[3]&#41;&#41;;
---
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     my $tmp  = shift;
&gt;     $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;string =&gt; &#39;&#39;&#41;&#41;
&gt;         , base64 =&gt; $_[0], int =&gt; length&#40;$_[0]&#41;&#41;;
</div>
in uploadDocument werd de while loop 1 chunk te vroeg afgebroken. Dit is verholpen.

in de upload sub werd uitgegaan van een mogelijkheid van 3 argumenten. Volgens mij komt dat nooit voor.
het eerste argument is de tmpfile die terugkomt van de server, en die leeg is bij de eerste aanroep.
het tweede argument is de chunk om te uploaden.

De ontvangende Java functie wil als argumenten String, byte[], int, dus ik heb het tweede argument verandert in base64.

Kun je hier wat mee?

Groet,
Rik
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;27&nbsp;05:58:39&nbsp;2012</span>
    <span class="description">secretaris [...] nluug.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Jun 2012 11:58:25 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;secretaris [...] nluug.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120627 09:30]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 488c488
&gt; &lt;     while&#40;$sent + $chunks &lt;= $to_sent&#41;
&gt; ---
<div class="message-stanza open">&gt; &gt;     while&#40;$sent &lt; $to_sent&#41;
</div>&gt; in uploadDocument werd de while loop 1 chunk te vroeg afgebroken. Dit
&gt; is verholpen.
</div>
Ah, lijkt logish!

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 828,830c828,830
&gt; &lt;     my $tmp  = @_ == 3 ? shift : undef;
&gt; &lt;     $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;&#41;&#41;
&gt; &lt;        , string =&gt; $_[3], int =&gt; length&#40;$_[3]&#41;&#41;;
&gt; ---
<div class="message-stanza open">&gt; &gt;     my $tmp  = shift;
&gt; &gt;     $self-&gt;{rpc}-&gt;upload&#40;&#40;defined $tmp ? &#40;string =&gt; $tmp&#41; : &#40;string =&gt; &#39;&#39;&#41;&#41;
&gt; &gt;         , base64 =&gt; $_[0], int =&gt; length&#40;$_[0]&#41;&#41;;
</div>&gt; 
&gt; in de upload sub werd uitgegaan van een mogelijkheid van 3 argumenten.
&gt; Volgens mij komt dat nooit voor.
</div>
Lijkt me een bug.  De voorbeelden in de documentatie gaan ook uit van 1 of 2
argumenten.

   # start uploading
   my &#40;$rc1, $tmp&#41;  = $db-&gt;upload&#40;undef, substr&#40;$data, 0, 999&#41;&#41;;
   my &#40;$rc1, $tmp&#41;  = $db-&gt;upload&#40;substr&#40;$data, 0, 999&#41;&#41;;  # same

   # send more chunks
   my &#40;$rc2, undef&#41; = $db-&gt;upload&#40;$tmp,  substr&#40;$data, 1000&#41;&#41;;

   # insert the document in the database
   my &#40;$rc3, $ok&#41;   = $db-&gt;parseLocal&#40;$tmp, &#39;/db/file.xml&#39;, 0, &#39;text/xml&#39;&#41;
      if $rc1==0 &#38;&#38; $rc2==0;

&#40;Opgepoetst en regel zonder $tmp toegevoegd&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; het eerste argument is de tmpfile die terugkomt van de server, en die
&gt; leeg is bij de eerste aanroep. het tweede argument is de chunk om te
&gt; uploaden.
</div>
Ik heb jouw patch iets herschreven:

    my $tmp  = @_ == 2 ? shift : undef;
    $self-&gt;{rpc}-&gt;upload&#40;string =&gt; &#40;defined $tmp ? $tmp : &#39;&#39;&#41;
       , base64 =&gt; $_[0], int =&gt; length&#40;$_[0]&#41;&#41;;

Normaliter zou ik $_[0] wel eerst in een variabele zetten, maar deze
kan erg groot zijn, dus een kopie is duur.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Kun je hier wat mee?
</div>
Zeker.  Als het werkt dan is het goed ;-&#41;  Ik weete niet of de Java
documentatie ondertussen ook is verbeterd... in de tijd dat ik hier
mee bezig was leek het hele RPC interface nogal verwaarloosd.

Ik verwerk de patches meteen in de source.  Op elk moment dat je wil
maak ik een nieuwe CPAN release voor je.
-- 
Met vriendelijke groet,

               MarkOv

------------------------------------------------------------------------
       Mark Overmeer MSc                                MARKOV Solutions
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;27&nbsp;05:59:45&nbsp;2012</span>
    <span class="description">secretaris [...] nluug.nl -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Jun 2012 11:59:35 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;secretaris [...] nluug.nl&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
By the way: veel van de methods worden wel uitgetest.  De t/* scripts
kunnen dus ook goede voorbeelden geven.

* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120627 09:30]:
-- 
Met vriendelijke groet,

               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;27&nbsp;10:14:09&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Jun 2012 16:13:56 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 27, 2012, at 11:59 AM, Mark Overmeer via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; By the way: veel van de methods worden wel uitgetest.  De t/* scripts
&gt; kunnen dus ook goede voorbeelden geven.
</div>
Bedankt, daar zal ik gebruik van maken.

Ik loop tegen nog meer dingen aan die ik moet aanpassen om een en ander werkend te krijgen.

Hoe heb jij het liefst dat ik te werk ga? Een patch file per wijziging met een toelichting?
En moet die patch dan zijn op een CPAN release of gewoon doorgaan op mijn versie zoals die er dan bijstaat?

Mvg Rik
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jun&nbsp;27&nbsp;15:16:39&nbsp;2012</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 27 Jun 2012 21:16:22 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120627 14:14]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-ExistDB
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Hoe heb jij het liefst dat ik te werk ga? Een patch file per wijziging
&gt; met een toelichting?
&gt; En moet die patch dan zijn op een CPAN release of gewoon doorgaan op
&gt; mijn versie zoals die er dan bijstaat?
</div>
Een enkele patch is voldoende... in de huidige toestand van de module
vertrouw ik er op dat je altijd gelijk hebt!

Als je voor maandag een update kunt sturen, dan kan ik voor mijn
vakantie nog even een release maken.
-- 
Greetz,
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;28&nbsp;11:45:16&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Jun 2012 17:45:02 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
On Jun 27, 2012, at 9:16 PM, Mark Overmeer via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Een enkele patch is voldoende... in de huidige toestand van de module
&gt; vertrouw ik er op dat je altijd gelijk hebt!
&gt; 
&gt; Als je voor maandag een update kunt sturen, dan kan ik voor mijn
&gt; vakantie nog even een release maken.
</div>
Wat ik je in ieder geval nog kan geven voor maandag is deze, de rest komt eventueel later wel:


480,483d479
&lt;     my $to_sent = length $doc;
&lt;     return $self-&gt;parse&#40;$doc, $resource, $replace, @dates&#41;  # simple file
&lt;         if $to_sent &lt; $chunks;
&lt; 
484a481
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;     my $to_sent = length $doc;
</div>

Op deze manier worden ALLE uploads in chunks gedaan, ongeacht de filesize.
Dit omdat parse altijd uitgaat van XML.

De parseLocal kan middels de mime_type optie op ander gedachten worden gebracht.

Ik kwam hierbij uit omdat ik ook xquery bestanden in de database schiet, en die werden geweigerd wanneer ze kleiner waren dan de chunksize...

Goeie vakantie!

Rik
</div></div>

<div class="messagebody">
</div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Jun&nbsp;28&nbsp;14:19:22&nbsp;2012</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 28 Jun 2012 20:19:08 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120628 15:45]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-ExistDB
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Op deze manier worden ALLE uploads in chunks gedaan, ongeacht de filesize.
&gt; Dit omdat parse altijd uitgaat van XML.
</div>
ok.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Goeie vakantie!
</div>
Dank.  Mocht je vragen hebben dan kun je die gewoon mailen: ik lees
zeker om de dag mijn email.
-- 
Greetz,
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;04:19:21&nbsp;2012</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Tijd opm d3e draad weer op te pakken.  Heb je nog meer
uitbreidingen/bug-fixes &#40;of -reports&#41; voor me?

On Thu Jun 28 14:19:22 2012, Mark@Overmeer.net wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; * R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120628 15:45]:
<div class="message-stanza open">&gt; &gt;        Queue: XML-ExistDB
&gt; &gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; &gt; 
&gt; &gt; Op deze manier worden ALLE uploads in chunks gedaan, ongeacht de
</div></div>filesize.
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Dit omdat parse altijd uitgaat van XML.
</div>&gt; 
&gt; ok.
&gt; 
<div class="message-stanza open">&gt; &gt; Goeie vakantie!
</div></div>.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;04:25:45&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Aug 2012 10:25:33 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Nee, 

de module draait hier alweer een tijdje stabiel op development en test. Ben onlangs met de exist database geupgrade naar 1.4.2, ook zonder problemen.
Wij doen vooralsnog geen ingewikkelde dingen met de module, alleen resources en collections uploaden en verwijderen.

Groet,
Rik

On Aug 28, 2012, at 10:19 AM, Mark Overmeer via RT wrote:

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Tijd opm d3e draad weer op te pakken.  Heb je nog meer
&gt; uitbreidingen/bug-fixes &#40;of -reports&#41; voor me?
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;04:29:41&nbsp;2012</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Aug 2012 10:29:27 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120828 08:25]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-ExistDB
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; Nee, 
&gt; 
&gt; de module draait hier alweer een tijdje stabiel op development en test. Ben onlangs met de exist database geupgrade naar 1.4.2, ook zonder problemen.
&gt; Wij doen vooralsnog geen ingewikkelde dingen met de module, alleen resources en collections uploaden en verwijderen.
</div>
Misschien handig om even te kijken of ik al jouw verbeteringen heb
overgenomen.  Kun je mij een diff sturen of de gehele files van
XML/eXistDB*.pm  &#40;3 stuks&#41;
-- 
Thanks,

               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;05:08:07&nbsp;2012</span>
    <span class="description">rvdeijnden [...] gmail.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Aug 2012 11:07:26 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-XML-ExistDB [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Rik van den Eijnden &lt;rvdeijnden [...] gmail.com&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">&lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;


<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; 
&gt; Misschien handig om even te kijken of ik al jouw verbeteringen heb
&gt; overgenomen.  Kun je mij een diff sturen of de gehele files van
&gt; XML/eXistDB*.pm  &#40;3 stuks&#41;
</div></div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">


Dit is de enige gewijzigde file, zoals ik hem nu in gebruik heb.

Rik
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;05:17:33&nbsp;2012</span>
    <span class="description">Mark [...] Overmeer.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #77963] Problem with multi chunk uploads</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 28 Aug 2012 11:17:23 +0200</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> R vd E via RT &lt;bug-XML-ExistDB [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Mark Overmeer &lt;mark [...] overmeer.net&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">* R vd E via RT &#40;bug-XML-ExistDB@rt.cpan.org&#41; [120828 09:08]:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;        Queue: XML-ExistDB
&gt;  Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=77963">https://rt.cpan.org/Ticket/Display.html?id=77963</a></span> &gt;
&gt; 
<div class="message-stanza open">&gt; &gt; Misschien handig om even te kijken of ik al jouw verbeteringen heb
&gt; &gt; overgenomen.  Kun je mij een diff sturen of de gehele files van
&gt; &gt; XML/eXistDB*.pm  &#40;3 stuks&#41;
</div></div>
Ok, wijzigingen kloppen.  Release 0.12
-- 
Thanks,
               MarkOv

------------------------------------------------------------------------
drs Mark A.C.J. Overmeer                                MARKOV Solutions
       Mark@Overmeer.net                          solutions@overmeer.net
<span class="clickylink"><a target="new" rel="nofollow" href="http://Mark.Overmeer.net">http://Mark.Overmeer.net</a></span>                   <span class="clickylink"><a target="new" rel="nofollow" href="http://solutions.overmeer.net">http://solutions.overmeer.net</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;05:28:40&nbsp;2012</span>
    <span class="description">MARKOV [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">released as 0.12
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Aug&nbsp;28&nbsp;05:28:40&nbsp;2012</span>
    <span class="description">MARKOV [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
