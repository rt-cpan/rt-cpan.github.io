<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #61486 for Catalyst-Manual: bug in http://search.cpan.org/~hkclark/Catalyst-Manual-5.8004/lib/Catalyst/Manual/Tutorial/10_Appendices.pod#MySQL and a fix solution</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #61486 for Catalyst-Manual: bug in http://search.cpan.org/~hkclark/Catalyst-Manual-5.8004/lib/Catalyst/Manual/Tutorial/10_Appendices.pod#MySQL and a fix solution</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Catalyst-Manual/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Catalyst-Manual/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Catalyst-Manual/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Catalyst-Manual/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Catalyst-Manual">Catalyst-Manual CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">61486</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">open</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Catalyst-Manual/Active/">Catalyst-Manual</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
darwick [...] cyberground.hu

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-41462-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
5.8004    </td>
  </tr>
  <tr id="CF-41463-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;20&nbsp;11:21:29&nbsp;2010</span>
    <span class="description">darwick [...] cyberground.hu -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> bug in <span class="clickylink"><a target="new" rel="nofollow" href="http://search.cpan.org/~hkclark/Catalyst-Manual-5.8004/lib/Catalyst/Manual/Tutorial/10_Appendices.pod#MySQL">http://search.cpan.org/~hkclark/Catalyst-Manual-5.8004/lib/Catalyst/Manual/Tutorial/10_Appendices.pod#MySQL</a></span>
 and a fix solution</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">In the Catalyst::Manual::Tutorial::10_Appendices the MySQL section is 
wrong and out of date, as it told us. Fortunetly, I use MySQL as 
backend so I can provide a fix for it.

1; The database and user creation don&#39;t use password for the MySQL 
user, we could fix this thing. The database creation procedure is 
almost the same as in the tutorial:

# mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; CREATE DATABASE `myapp`;
</div>Query OK, 1 row affected &#40;0.01 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; GRANT ALL PRIVILEGES ON myapp.* TO &#39;tutorial&#39;@&#39;localhost&#39; 
</div>IDENTIFIED BY &#39;yourpassword&#39;;
Query OK, 0 rows affected &#40;0.00 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; FLUSH PRIVILEGES;
</div>Query OK, 0 rows affected &#40;0.00 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; exit
</div>Bye

2; The *.sql example files are wrong at all. First of all, the original 
example use table name book, author, book_author and not books, authors 
and book_authors. Same as the user, role and user_role. This isn&#39;t a 
big problem at all, but it might confuse someone else who follow the 
tutorial step by step. More bigger problem is that you don&#39;t use 
extended inserts, so with most of modern mysql versions it won&#39;t work 
&#40;like mine, which is 5.1&#41;. And the bigest problem is, there are no 
foreign keys but that is a most important part of the catalyst 
tutorial. The correct SQL examples looks like this:

myapp01_mysql.sql:

DROP TABLE IF EXISTS `author`;
CREATE TABLE IF NOT EXISTS `author` &#40;
  `id` int&#40;11&#41; NOT NULL AUTO_INCREMENT,
  `first_name` text CHARACTER SET utf8,
  `last_name` text CHARACTER SET utf8,
  PRIMARY KEY &#40;`id`&#41;
&#41; ENGINE=InnoDB  DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `book`;
CREATE TABLE IF NOT EXISTS `book` &#40;
  `id` int&#40;11&#41; NOT NULL AUTO_INCREMENT,
  `title` text CHARACTER SET utf8,
  `rating` int&#40;11&#41; DEFAULT NULL,
  PRIMARY KEY &#40;`id`&#41;
&#41; ENGINE=InnoDB  DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `book_author`;
CREATE TABLE IF NOT EXISTS `book_author` &#40;
  `book_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
  `author_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
  PRIMARY KEY &#40;`book_id`,`author_id`&#41;,
  KEY `author_id` &#40;`author_id`&#41;
&#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `author` &#40;`id`, `first_name`, `last_name`&#41; VALUES
&#40;1, &#39;Greg&#39;, &#39;Bastien&#39;&#41;,
&#40;2, &#39;Sara&#39;, &#39;Nasseh&#39;&#41;,
&#40;3, &#39;Christian&#39;, &#39;Degu&#39;&#41;,
&#40;4, &#39;Richard&#39;, &#39;Stevens&#39;&#41;,
&#40;5, &#39;Douglas&#39;, &#39;Comer&#39;&#41;,
&#40;6, &#39;Tom&#39;, &#39;Christiansen&#39;&#41;,
&#40;7, &#39;Nathan&#39;, &#39;Torkington&#39;&#41;,
&#40;8, &#39;Jeffrey&#39;, &#39;Zeldman&#39;&#41;;

INSERT INTO `book` &#40;`id`, `title`, `rating`&#41; VALUES
&#40;1, &#39;CCSP SNRS Exam Certification Guide&#39;, 5&#41;,
&#40;2, &#39;TCP/IP Illustrated, Volume 1&#39;, 5&#41;,
&#40;3, &#39;Internetworking with TCP/IP Vol.1&#39;, 4&#41;,
&#40;4, &#39;Perl Cookbook&#39;, 5&#41;,
&#40;5, &#39;Designing with Web Standards&#39;, 5&#41;;

INSERT INTO `book_author` &#40;`book_id`, `author_id`&#41; VALUES
&#40;1, 1&#41;,
&#40;1, 2&#41;,
&#40;1, 3&#41;,
&#40;2, 4&#41;,
&#40;3, 5&#41;,
&#40;4, 6&#41;,
&#40;4, 7&#41;,
&#40;5, 8&#41;;

ALTER TABLE `book_author` ADD CONSTRAINT `book_author_ibfk_2` FOREIGN 
KEY &#40;`author_id`&#41; REFERENCES `author` &#40;`id`&#41; ON DELETE CASCADE ON 
UPDATE CASCADE, ADD CONSTRAINT `book_author_ibfk_1` FOREIGN KEY 
&#40;`book_id`&#41; REFERENCES `book` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE 
CASCADE;

myapp02_mysql.sql:

DROP TABLE IF EXISTS `role`;
CREATE TABLE IF NOT EXISTS `role` &#40;
  `id` int&#40;11&#41; NOT NULL,
  `role` text CHARACTER SET utf8,
  PRIMARY KEY &#40;`id`&#41;
&#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `user`;
CREATE TABLE IF NOT EXISTS `user` &#40;
  `id` int&#40;11&#41; NOT NULL,
  `username` text CHARACTER SET utf8,
  `password` text CHARACTER SET utf8,
  `email_address` text CHARACTER SET utf8,
  `first_name` text CHARACTER SET utf8,
  `last_name` text CHARACTER SET utf8,
  `active` int&#40;11&#41; DEFAULT NULL,
  PRIMARY KEY &#40;`id`&#41;
&#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;

DROP TABLE IF EXISTS `user_role`;
CREATE TABLE IF NOT EXISTS `user_role` &#40;
  `user_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
  `role_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
  PRIMARY KEY &#40;`user_id`,`role_id`&#41;,
  KEY `role_id` &#40;`role_id`&#41;
&#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `role` &#40;`id`, `role`&#41; VALUES
&#40;1, &#39;user&#39;&#41;,
&#40;2, &#39;admin&#39;&#41;;

INSERT INTO `user` &#40;`id`, `username`, `password`, `email_address`, 
`first_name`, `last_name`, `active`&#41; VALUES
&#40;1, &#39;test01&#39;, &#39;mypass&#39;, &#39;t01@na.com&#39;, &#39;Joe&#39;, &#39;Blow&#39;, 1&#41;,
&#40;2, &#39;test02&#39;, &#39;mypass&#39;, &#39;t02@na.com&#39;, &#39;Jane&#39;, &#39;Doe&#39;, 1&#41;,
&#40;3, &#39;test03&#39;, &#39;mypass&#39;, &#39;t03@na.com&#39;, &#39;No&#39;, &#39;Go&#39;, 0&#41;;

INSERT INTO `user_role` &#40;`user_id`, `role_id`&#41; VALUES
&#40;1, 1&#41;,
&#40;2, 1&#41;,
&#40;3, 1&#41;,
&#40;1, 2&#41;;

ALTER TABLE `user_role` ADD CONSTRAINT `user_role_ibfk_2` FOREIGN KEY 
&#40;`role_id`&#41; REFERENCES `role` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE 
CASCADE, ADD CONSTRAINT `user_role_ibfk_1` FOREIGN KEY &#40;`user_id`&#41; 
REFERENCES `user` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE CASCADE;

As you can see in this two examples, we use InnoDB storage engine 
instead of MyISAM. InnoDB fully support the foreign keys, so we can use 
it and it will work for sure in the tutorial. You may notice the 
readers that MySQL 5.0 or above is requied to use InnoDB storage engine 
and the foreign keys. Anybody should test it that is enabled or not:

# mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; SHOW VARIABLES LIKE &#39;have_innodb&#39;;
</div>+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| have_innodb   | YES   |
+---------------+-------+
1 row in set &#40;0.01 sec&#41;

<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">mysql&gt; exit
</div>Bye

3; The database Schema to create, I use this command:

script/myapp_create.pl model DB DBIC::Schema MyApp::Schema 
create=static components=TimeStamp,EncodedColumn 
dbi:mysql:myapp &#39;tutorial&#39; &#39;yourpassword&#39; &#39;{ AutoCommit =&gt; 1 }&#39;

I made the tutorial from the begining to the end and it works me great 
with MySQL. The other parts of the mysql appendicies are good, there is 
no need to fix anything.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;20&nbsp;11:38:22&nbsp;2010</span>
    <span class="description">bobtfish [...] bobtfish.net -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Can you hop into #catalyst-dev on irc.perl.org and we&#39;ll give you a
commit bit and a branch in which to make these changes.

Cheers
t0m
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;20&nbsp;11:38:23&nbsp;2010</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Sep&nbsp;20&nbsp;13:13:36&nbsp;2010</span>
    <span class="description">darwick [...] cyberground.hu -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> darwick [...] cyberground.hu</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Hétf 2010. Szept 20 11:38:22, BOBTFISH wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Can you hop into #catalyst-dev on irc.perl.org and we&#39;ll give you a
&gt; commit bit and a branch in which to make these changes.
&gt; 
&gt; Cheers
&gt; t0m
</div>

Made the diff with your help. Uploaded, I hope I didn&#39;t miss 
anything. :&#41;
Thanks for commiting. :&#41;

Darwick
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> changes.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Index: lib/Catalyst/Manual/Tutorial/10_Appendices.pod
===================================================================
--- lib/Catalyst/Manual/Tutorial/10_Appendices.pod	&#40;revision 13596&#41;
+++ lib/Catalyst/Manual/Tutorial/10_Appendices.pod	&#40;working copy&#41;
@@ -513,11 +513,8 @@
 
 =head2 MySQL
 
-B&lt;NOTE:&gt; This section is out of date with the rest of the tutorial.
-Consider using SQLite or PostgreSQL since they are current.
-
 Use the following steps to adapt the tutorial to MySQL.  Thanks to Jim
-Howard for the help.
+Howard for the help and Zsolt Zemancsik for the up to date fixes.
 
 =over 4
 
@@ -551,27 +548,59 @@
     yum -y install mysql mysql-server
     service mysqld start
 
+For Debian users you can use the following commands to install the software and start the MySQL
+daemon:
+
+    apt-get install mysql-client mysql-server
+    /etc/init.d/mysql start
+
+B&lt;NOTE:&gt; The tutorial is based on Foreign Keys in database which is supported by InnoDB.
+Only MySQL 5.0 and above supports InnoDB storage Engine so you need to have InnoDB support
+in you MySQL. You can simply figure out that your install supports it or not:
+
+    # mysql -u root -p
+    Enter password:
+    Welcome to the MySQL monitor.  Commands end with ; or \g.
+    
+    Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input 
+    statement.
+    
+    mysql&gt; SHOW VARIABLES LIKE &#39;have_innodb&#39;;
+    +---------------+-------+
+    | Variable_name | Value |
+    +---------------+-------+
+    | have_innodb   | YES   |
+    +---------------+-------+
+    1 row in set &#40;0.01 sec&#41;
+    
+    mysql&gt; exit
+    Bye
+
+If the Value is &#34;YES&#34; you can use your setup &#40;Debian based mysql supports it by default&#41;.
+Else, you need to configure your my.cnf or start your MySQL daemon without --skip-innodb option.
+
 =item *
 
 Create the database and set the permissions:
 
-    $ mysql
+    # mysql -u root -p
+    Enter password:
     Welcome to the MySQL monitor.  Commands end with ; or \g.
-    Your MySQL connection id is 2 to server version: 4.1.20
     
-    Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the buffer.
+    Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
     
-    mysql&gt; create database myapp;
+    mysql&gt; CREATE DATABASE `myapp`;
     Query OK, 1 row affected &#40;0.01 sec&#41;
     
-    mysql&gt; grant all on myapp.* to tutorial@&#39;localhost&#39;;
+    mysql&gt; GRANT ALL PRIVILEGES ON myapp.* TO &#39;tutorial&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;yourpassword&#39;;
     Query OK, 0 rows affected &#40;0.00 sec&#41;
     
-    mysql&gt; flush privileges;
+    mysql&gt; FLUSH PRIVILEGES;
     Query OK, 0 rows affected &#40;0.00 sec&#41;
     
-    mysql&gt; quit
+    mysql&gt; exit
     Bye
+    
 
 =item *
 
@@ -586,66 +615,74 @@
     --
     -- Create a very simple database to hold book and author information
     --
-    DROP TABLE IF EXISTS books;
-    DROP TABLE IF EXISTS book_authors;
-    DROP TABLE IF EXISTS authors;
-    CREATE TABLE books &#40;
-           id          INT&#40;11&#41; PRIMARY KEY AUTO_INCREMENT,
-           title       TEXT ,
-           rating      INT&#40;11&#41;
-    &#41;;
+    CREATE TABLE IF NOT EXISTS `book` &#40;
+      `id` int&#40;11&#41; NOT NULL AUTO_INCREMENT,
+      `title` text CHARACTER SET utf8,
+      `rating` int&#40;11&#41; DEFAULT NULL,
+      PRIMARY KEY &#40;`id`&#41;
+    &#41; ENGINE=InnoDB  DEFAULT CHARSET=utf8;
     -- &#39;book_authors&#39; is a many-to-many join table between books &#38; authors
-    CREATE TABLE book_authors &#40;
-           book_id     INT&#40;11&#41;,
-           author_id   INT&#40;11&#41;,
-           PRIMARY KEY &#40;book_id, author_id&#41;
-    &#41;;
-    CREATE TABLE authors &#40;
-           id          INT&#40;11&#41; PRIMARY KEY AUTO_INCREMENT,
-           first_name  TEXT,
-           last_name   TEXT
-    &#41;;
+    CREATE TABLE IF NOT EXISTS `book_author` &#40;
+      `book_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
+      `author_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
+      PRIMARY KEY &#40;`book_id`,`author_id`&#41;,
+      KEY `author_id` &#40;`author_id`&#41;
+    &#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;
+    CREATE TABLE IF NOT EXISTS `author` &#40;
+      `id` int&#40;11&#41; NOT NULL AUTO_INCREMENT,
+      `first_name` text CHARACTER SET utf8,
+      `last_name` text CHARACTER SET utf8,
+      PRIMARY KEY &#40;`id`&#41;
+    &#41; ENGINE=InnoDB  DEFAULT CHARSET=utf8;
     ---
     --- Load some sample data
     ---
-    INSERT INTO books VALUES &#40;1, &#39;CCSP SNRS Exam Certification Guide&#39;, 5&#41;;
-    INSERT INTO books VALUES &#40;2, &#39;TCP/IP Illustrated, Volume 1&#39;, 5&#41;;
-    INSERT INTO books VALUES &#40;3, &#39;Internetworking with TCP/IP Vol.1&#39;, 4&#41;;
-    INSERT INTO books VALUES &#40;4, &#39;Perl Cookbook&#39;, 5&#41;;
-    INSERT INTO books VALUES &#40;5, &#39;Designing with Web Standards&#39;, 5&#41;;
-    INSERT INTO authors VALUES &#40;1, &#39;Greg&#39;, &#39;Bastien&#39;&#41;;
-    INSERT INTO authors VALUES &#40;2, &#39;Sara&#39;, &#39;Nasseh&#39;&#41;;
-    INSERT INTO authors VALUES &#40;3, &#39;Christian&#39;, &#39;Degu&#39;&#41;;
-    INSERT INTO authors VALUES &#40;4, &#39;Richard&#39;, &#39;Stevens&#39;&#41;;
-    INSERT INTO authors VALUES &#40;5, &#39;Douglas&#39;, &#39;Comer&#39;&#41;;
-    INSERT INTO authors VALUES &#40;6, &#39;Tom&#39;, &#39;Christiansen&#39;&#41;;
-    INSERT INTO authors VALUES &#40;7, &#39; Nathan&#39;, &#39;Torkington&#39;&#41;;
-    INSERT INTO authors VALUES &#40;8, &#39;Jeffrey&#39;, &#39;Zeldman&#39;&#41;;
-    INSERT INTO book_authors VALUES &#40;1, 1&#41;;
-    INSERT INTO book_authors VALUES &#40;1, 2&#41;;
-    INSERT INTO book_authors VALUES &#40;1, 3&#41;;
-    INSERT INTO book_authors VALUES &#40;2, 4&#41;;
-    INSERT INTO book_authors VALUES &#40;3, 5&#41;;
-    INSERT INTO book_authors VALUES &#40;4, 6&#41;;
-    INSERT INTO book_authors VALUES &#40;4, 7&#41;;
-    INSERT INTO book_authors VALUES &#40;5, 8&#41;;
+    INSERT INTO `book` &#40;`id`, `title`, `rating`&#41; VALUES
+    &#40;1, &#39;CCSP SNRS Exam Certification Guide&#39;, 5&#41;,
+    &#40;2, &#39;TCP/IP Illustrated, Volume 1&#39;, 5&#41;,
+    &#40;3, &#39;Internetworking with TCP/IP Vol.1&#39;, 4&#41;,
+    &#40;4, &#39;Perl Cookbook&#39;, 5&#41;,
+    &#40;5, &#39;Designing with Web Standards&#39;, 5&#41;;
+    
+    INSERT INTO `book_author` &#40;`book_id`, `author_id`&#41; VALUES
+    &#40;1, 1&#41;,
+    &#40;1, 2&#41;,
+    &#40;1, 3&#41;,
+    &#40;2, 4&#41;,
+    &#40;3, 5&#41;,
+    &#40;4, 6&#41;,
+    &#40;4, 7&#41;,
+    &#40;5, 8&#41;;
+    
+    INSERT INTO `author` &#40;`id`, `first_name`, `last_name`&#41; VALUES
+    &#40;1, &#39;Greg&#39;, &#39;Bastien&#39;&#41;,
+    &#40;2, &#39;Sara&#39;, &#39;Nasseh&#39;&#41;,
+    &#40;3, &#39;Christian&#39;, &#39;Degu&#39;&#41;,
+    &#40;4, &#39;Richard&#39;, &#39;Stevens&#39;&#41;,
+    &#40;5, &#39;Douglas&#39;, &#39;Comer&#39;&#41;,
+    &#40;6, &#39;Tom&#39;, &#39;Christiansen&#39;&#41;,
+    &#40;7, &#39;Nathan&#39;, &#39;Torkington&#39;&#41;,
+    &#40;8, &#39;Jeffrey&#39;, &#39;Zeldman&#39;&#41;;
+    
+    ALTER TABLE `book_author`
+    ADD CONSTRAINT `book_author_ibfk_2` FOREIGN KEY &#40;`author_id`&#41; REFERENCES `author` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE CASCADE,
+    ADD CONSTRAINT `book_author_ibfk_1` FOREIGN KEY &#40;`book_id`&#41; REFERENCES `book` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE CASCADE;
 
 =item *
 
 Load the data:
 
-    mysql -ututorial myapp &lt; myapp01_mysql.sql
+    mysql -u tutorial -p myapp &lt; myapp01_mysql.sql
 
 =item *
 
 Make sure the data loaded correctly:
 
-    $ mysql -ututorial myapp
+    $ mysql -u tutorial -p myapp
     Reading table information for completion of table and column names
     You can turn off this feature to get a quicker startup with -A
     
     Welcome to the MySQL monitor.  Commands end with ; or \g.
-    Your MySQL connection id is 4 to server version: 4.1.20
     
     Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the buffer.
     
@@ -691,8 +728,8 @@
 
 Regenerate the model using the Catalyst &#34;_create.pl&#34; script:
 
-    script/myapp_create.pl model DB DBIC::Schema MyApp::Schema \
-        dbi:mysql:myapp &#39;_username_here_&#39; &#39;_password_here_&#39; &#39;{ AutoCommit =&gt; 1 }&#39;
+    script/myapp_create.pl model DB DBIC::Schema MyApp::Schema create=static \
+	dbi:mysql:myapp &#39;tutorial&#39; &#39;yourpassword&#39; &#39;{ AutoCommit =&gt; 1 }&#39;
 
 =back
 
@@ -713,45 +750,72 @@
     --
     -- Add users and roles tables, along with a many-to-many join table
     --
-    CREATE TABLE users &#40;
-            id            INT&#40;11&#41; PRIMARY KEY,
-            username      TEXT,
-            password      TEXT,
-            email_address TEXT,
-            first_name    TEXT,
-            last_name     TEXT,
-            active        INT&#40;11&#41;
-    &#41;;
-    CREATE TABLE roles &#40;
-            id   INTEGER PRIMARY KEY,
-            role TEXT
-    &#41;;
-    CREATE TABLE user_roles &#40;
-            user_id INT&#40;11&#41;,
-            role_id INT&#40;11&#41;,
-            PRIMARY KEY &#40;user_id, role_id&#41;
-    &#41;;
+    CREATE TABLE IF NOT EXISTS `role` &#40;
+      `id` int&#40;11&#41; NOT NULL,
+      `role` text CHARACTER SET utf8,
+      PRIMARY KEY &#40;`id`&#41;
+    &#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;
+    CREATE TABLE IF NOT EXISTS `user` &#40;
+      `id` int&#40;11&#41; NOT NULL,
+      `username` text CHARACTER SET utf8,
+      `password` text CHARACTER SET utf8,
+      `email_address` text CHARACTER SET utf8,
+      `first_name` text CHARACTER SET utf8,
+      `last_name` text CHARACTER SET utf8,
+      `active` int&#40;11&#41; DEFAULT NULL,
+      PRIMARY KEY &#40;`id`&#41;
+    &#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;
+    CREATE TABLE IF NOT EXISTS `user_role` &#40;
+      `user_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
+      `role_id` int&#40;11&#41; NOT NULL DEFAULT &#39;0&#39;,
+      PRIMARY KEY &#40;`user_id`,`role_id`&#41;,
+      KEY `role_id` &#40;`role_id`&#41;
+    &#41; ENGINE=InnoDB DEFAULT CHARSET=utf8;
     --
     -- Load up some initial test data
     --
-    INSERT INTO users VALUES &#40;1, &#39;test01&#39;, &#39;mypass&#39;, &#39;t01@na.com&#39;, &#39;Joe&#39;,  &#39;Blow&#39;, 1&#41;;
-    INSERT INTO users VALUES &#40;2, &#39;test02&#39;, &#39;mypass&#39;, &#39;t02@na.com&#39;, &#39;Jane&#39;, &#39;Doe&#39;,  1&#41;;
-    INSERT INTO users VALUES &#40;3, &#39;test03&#39;, &#39;mypass&#39;, &#39;t03@na.com&#39;, &#39;No&#39;,   &#39;Go&#39;,   0&#41;;
-    INSERT INTO roles VALUES &#40;1, &#39;user&#39;&#41;;
-    INSERT INTO roles VALUES &#40;2, &#39;admin&#39;&#41;;
-    INSERT INTO user_roles VALUES &#40;1, 1&#41;;
-    INSERT INTO user_roles VALUES &#40;1, 2&#41;;
-    INSERT INTO user_roles VALUES &#40;2, 1&#41;;
-    INSERT INTO user_roles VALUES &#40;3, 1&#41;;
+    INSERT INTO `role` &#40;`id`, `role`&#41; VALUES
+    &#40;1, &#39;user&#39;&#41;,
+    &#40;2, &#39;admin&#39;&#41;;
+    
+    INSERT INTO `user` &#40;`id`, `username`, `password`, `email_address`, `first_name`, `last_name`, `active`&#41; VALUES
+    &#40;1, &#39;test01&#39;, &#39;mypass&#39;, &#39;t01@na.com&#39;, &#39;Joe&#39;, &#39;Blow&#39;, 1&#41;,
+    &#40;2, &#39;test02&#39;, &#39;mypass&#39;, &#39;t02@na.com&#39;, &#39;Jane&#39;, &#39;Doe&#39;, 1&#41;,
+    &#40;3, &#39;test03&#39;, &#39;mypass&#39;, &#39;t03@na.com&#39;, &#39;No&#39;, &#39;Go&#39;, 0&#41;;
+    
+    INSERT INTO `user_role` &#40;`user_id`, `role_id`&#41; VALUES
+    &#40;1, 1&#41;,
+    &#40;2, 1&#41;,
+    &#40;3, 1&#41;,
+    &#40;1, 2&#41;;
+    
+    ALTER TABLE `user_role`
+    ADD CONSTRAINT `user_role_ibfk_2` FOREIGN KEY &#40;`role_id`&#41; REFERENCES `role` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE CASCADE,
+    ADD CONSTRAINT `user_role_ibfk_1` FOREIGN KEY &#40;`user_id`&#41; REFERENCES `user` &#40;`id`&#41; ON DELETE CASCADE ON UPDATE CASCADE;
 
 =item *
 
 Load the user/roles data:
 
-    mysql -ututorial myapp &lt; myapp02_mysql.sql
+    mysql -u tutorial -p myapp &lt; myapp02_mysql.sql
 
 =item *
 
+Update the model:
+
+=over 4
+
+=item *
+
+Regenerate the model using the Catalyst &#34;_create.pl&#34; script:
+
+    script/myapp_create.pl model DB DBIC::Schema MyApp::Schema create=static \
+	components=TimeStamp,EncodedColumn dbi:mysql:myapp &#39;tutorial&#39; &#39;yourpassword&#39; &#39;{ AutoCommit =&gt; 1 }&#39;
+
+=back
+
+=item *
+
 Create the C&lt;.sql&gt; file for the hashed password data:
 
 Open C&lt;myapp03_mysql.sql&gt; in your editor and enter:
@@ -767,7 +831,7 @@
 
 Load the user/roles data:
 
-    mysql -ututorial myapp &lt; myapp03_mysql.sql
+    mysql -u tutorial -p myapp &lt; myapp03_mysql.sql
 
 =back
 
</div></div>
</div>
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
