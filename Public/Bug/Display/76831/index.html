<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #76831 for CPAN: make install fails with spaces in make_install_make_command</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="https://rt.cpan.org/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #76831 for CPAN: make install fails with spaces in make_install_make_command</h1></div>


<div id="main-navigation"><ul id="app-nav" class="toplevel">
 <li id="li-search_dist"><a id="search_dist" class="menu-item " href="/Public/">Search Distributions</a></li>
 <li id="li-browse_dist"><a id="browse_dist" class="menu-item " href="/Public/Dist/Browse.html">Browse Distributions</a></li>
 <li id="li-about" class="has-children"><a id="about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About rt.cpan.org</a>
 <ul>
  <li id="li-about-usage"><a id="about-usage" class="menu-item " href="/NoAuth/RT/CPAN/Usage.html">How do I…?</a></li>
  <li id="li-about-about"><a id="about-about" class="menu-item " href="/NoAuth/RT/CPAN/About.html">About</a></li>
 </ul>
 </li>
 <li id="li-preferences"><a id="preferences" class="menu-item ">Welcome <span class="current-user">anonymous guest</span>.</a></li>
 <li id="li-login"><a id="login" class="menu-item " href="/NoAuth/Logout.html">Login as another user</a></li>
</ul></div>
<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Active;Name=CPAN">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Resolved;Name=CPAN">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Display.html?Status=Rejected;Name=CPAN">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Bug/Report.html?Queue=CPAN">Report a new bug</a></li>
</ul></div>
<div id="topactions"><form action="/Public/Search/Simple.html" id="simple-search">
  <input size="12" name="q" accesskey="0" class="field" value="" placeholder="Search..." />
</form>

<form action="/Public/Bug/Report.html" name="CreateTicketInQueue" id="CreateTicketInQueue" >
<input type="submit" class="button" value="New ticket in" />&nbsp;<label accesskey="9">
  <input name="Queue" size="25" placeholder="Module or distribution" value="" class="select-queue" data-autocomplete="Queues" data-autocomplete-autosubmit=1 data-autocomplete-params="right=CreateTicket" />

</label>

</form>

</div>
<div id="body">
<div id="announcement" style="padding: 1em; margin: 1em; border: solid black 1px; background: #eee">
<a href="https://log.perl.org/2020/12/rtcpanorg-sunset.html">rt.cpan.org will be shut down on March 1st, 2021.</a>
</div>

<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/CPAN">CPAN CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">76831</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Dist/Display.html?Queue=CPAN">CPAN</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
RURBAN [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Critical    </td>
  </tr>
  <tr id="CF-8164-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
2.02-TRIAL    </td>
  </tr>
  <tr id="CF-8165-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
2.05    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-attachments">
  <div class="titlebox ticket-info-attachments " id="">
  <div class="titlebox-title inverse">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dattachments\x2D\x2D\x2D\x2DQXR0YWNobWVudHM\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Attachments</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-attachments----QXR0YWNobWVudHM_---0">




install.patch<br />
<ul>


<li><font size="-2">
<a href="/Ticket/Attachment/1261416/667868/install.patch">
Wed Sep 11 04:20:54 2013 (1.5k) by shay [...] cpan.org
</a>
</font></li>
</ul>

    <hr class="clear" />
  </div>
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a> &mdash; <a href="/Public/Bug/Display.html?ShowHeaders=1;id=76831">Show full headers</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1071890" href="/Public/Bug/Display.html?id=76831#txn-1071890">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;26&nbsp;16:15:03&nbsp;2012</span>
    <span class="description">RURBAN [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> make install fails with spaces in make_install_make_command</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1071890/563886/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/563886">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.7k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Default ActiveState/MSVC9 build, with 
make_install_make_command being stored as
q[C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\nmake.EXE]

make test correctly quotes the system call, make install not.
Error:
  &#34;C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\nmake.EXE&#34; test -
- OK
Running make install
&#39;C:\Program&#39; is not recognized as an internal or external command,
operable program or batch file.

This looks right to me:

diff --git a/cpan/CPAN/lib/CPAN/Distribution.pm 
b/cpan/CPAN/lib/CPAN/Distribution.pm
index 32648ec..18a11da 100644
--- a/cpan/CPAN/lib/CPAN/Distribution.pm
+++ b/cpan/CPAN/lib/CPAN/Distribution.pm
@@ -3555,7 +3555,9 @@ sub install {
                     $CPAN::Config-&gt;{mbuild_install_build_command} :
                         $self-&gt;_build_command&#40;&#41;;
         $system = sprintf&#40;&#34;%s install %s&#34;,
-                          $mbuild_install_build_command,
+                          $mbuild_install_build_command =~ m/\s/
+                           ? qq{&#34;$mbuild_install_build_command&#34;}
+                           : $mbuild_install_build_command,
                           $CPAN::Config-&gt;{mbuild_install_arg},
                          &#41;;
     } else {
@@ -3564,7 +3566,9 @@ sub install {
                                              
q{make_install_make_command}&#41;
                   || $self-&gt;_make_command&#40;&#41;;
         $system = sprintf&#40;&#34;%s install %s&#34;,
-                          $make_install_make_command,
+                         $make_install_make_command =~ m/\s/
+                           ? qq{&#34;$make_install_make_command&#34;}
+                           : $make_install_make_command,
                           $CPAN::Config-&gt;{make_install_arg},
                          &#41;;
     }


-- 
Reini Urban
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1071896" href="/Public/Bug/Display.html?id=76831#txn-1071896">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;26&nbsp;16:19:58&nbsp;2012</span>
    <span class="description">RURBAN [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1071896/563892/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/563892">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.9k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Nope. This approach will fail with 
&#39;sudo make&#39;

Better store the command already quoted correctly and fix the quoting in 
sub test.

On Thu Apr 26 16:15:03 2012, RURBAN wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Default ActiveState/MSVC9 build, with 
&gt; make_install_make_command being stored as
&gt; q[C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\nmake.EXE]
&gt; 
&gt; make test correctly quotes the system call, make install not.
&gt; Error:
&gt;   &#34;C:\Program Files\Microsoft Visual Studio 9.0\VC\BIN\nmake.EXE&#34; test 
</div>-
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; - OK
&gt; Running make install
&gt; &#39;C:\Program&#39; is not recognized as an internal or external command,
&gt; operable program or batch file.
&gt; 
&gt; This looks right to me:
&gt; 
&gt; diff --git a/cpan/CPAN/lib/CPAN/Distribution.pm 
&gt; b/cpan/CPAN/lib/CPAN/Distribution.pm
&gt; index 32648ec..18a11da 100644
&gt; --- a/cpan/CPAN/lib/CPAN/Distribution.pm
&gt; +++ b/cpan/CPAN/lib/CPAN/Distribution.pm
&gt; @@ -3555,7 +3555,9 @@ sub install {
&gt;                      $CPAN::Config-&gt;{mbuild_install_build_command} :
&gt;                          $self-&gt;_build_command&#40;&#41;;
&gt;          $system = sprintf&#40;&#34;%s install %s&#34;,
&gt; -                          $mbuild_install_build_command,
&gt; +                          $mbuild_install_build_command =~ m/\s/
&gt; +                           ? qq{&#34;$mbuild_install_build_command&#34;}
&gt; +                           : $mbuild_install_build_command,
&gt;                            $CPAN::Config-&gt;{mbuild_install_arg},
&gt;                           &#41;;
&gt;      } else {
&gt; @@ -3564,7 +3566,9 @@ sub install {
&gt;                                               
&gt; q{make_install_make_command}&#41;
&gt;                    || $self-&gt;_make_command&#40;&#41;;
&gt;          $system = sprintf&#40;&#34;%s install %s&#34;,
&gt; -                          $make_install_make_command,
&gt; +                         $make_install_make_command =~ m/\s/
&gt; +                           ? qq{&#34;$make_install_make_command&#34;}
&gt; +                           : $make_install_make_command,
&gt;                            $CPAN::Config-&gt;{make_install_arg},
&gt;                           &#41;;
&gt;      }
&gt; 
</div>

-- 
Reini Urban
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1071898" href="/Public/Bug/Display.html?id=76831#txn-1071898">#</a>      
    </span>
    <span class="date">Thu&nbsp;Apr&nbsp;26&nbsp;16:19:59&nbsp;2012</span>
    <span class="description">RURBAN [...] cpan.org -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1073249" href="/Public/Bug/Display.html?id=76831#txn-1073249">#</a>      
    </span>
    <span class="date">Mon&nbsp;Apr&nbsp;30&nbsp;23:56:01&nbsp;2012</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1073249/564648/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564648">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 201b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space"><span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Better store the command already quoted correctly
&gt; and fix the quoting in sub test.
</div>
What do you think needs fixing in sub test? *_install_make_command is
only used for installing, not for testing.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1073369" href="/Public/Bug/Display.html?id=76831#txn-1073369">#</a>      
    </span>
    <span class="date">Tue&nbsp;May&nbsp;01&nbsp;13:25:40&nbsp;2012</span>
    <span class="description">rurban [...] x-ray.at -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">CC:</td>
    <td class="message-header-value"> RURBAN [...] cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #76831] make install fails with spaces in make_install_make_command</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 1 May 2012 12:25:28 -0500</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-CPAN [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Reini Urban &lt;rurban [...] x-ray.at&gt;</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1073369/564695/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/564695">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 1.1k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">On Mon, Apr 30, 2012 at 10:56 PM, Andreas Koenig via RT
&lt;bug-CPAN@rt.cpan.org&gt; wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=76831">https://rt.cpan.org/Ticket/Display.html?id=76831</a></span> &gt;
&gt;
<div class="message-stanza open">&gt;&gt; Better store the command already quoted correctly
&gt;&gt; and fix the quoting in sub test.
</div>&gt;
&gt; What do you think needs fixing in sub test? *_install_make_command is
&gt; only used for installing, not for testing.
</div>
For the common MSVC nmake case we have two CPAN Config make settings
with spaces in the path.

&#39;make&#39; =&gt; q[c:\\Program Files\\Microsoft Visual Studio 9.0\\VC\\BIN\\nmake.EXE],
&#39;make_install_make_command&#39; =&gt; q[c:\\Program Files\\Microsoft Visual
Studio 9.0\\VC\\BIN\\nmake.EXE],

make test works fine &#40;using the first&#41;, make install &#40;using the second&#41; not.
The quoting rules are different for the two commands. Easy to explain why.
&#39;make&#39; is only a program, it cannot be a program with args. cpan quotes it.
make_install_make_command can be &#39;sudo make&#39;, so it is mostly a
program with args,
so it cannot quoted as whole.

The only sane solution to fix this is to quote spaces in both hash entries,
and do not bother with it in the commands.
-- 
Reini Urban
<span class="clickylink"><a target="new" rel="nofollow" href="http://cpanel.net/">http://cpanel.net/</a></span>   <span class="clickylink"><a target="new" rel="nofollow" href="http://www.perl-compiler.org/">http://www.perl-compiler.org/</a></span>
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1261416" href="/Public/Bug/Display.html?id=76831#txn-1261416">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;11&nbsp;04:20:54&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> [PATCH] make install fails with spaces in make_install_make_command</td>
  </tr>
</table>
<div class="messageattachments">
<div class="downloadattachment">
<a href="/Ticket/Attachment/1261416/667867/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/667867">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 830b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">The attached patch against 2.02-TRIAL gives a pragmatic solution: quote the make_install_make_command just like make_command is quoted, but only on Windows. The problem of spaces in the path arises most commonly on Windows, and whilst there are versions of &#34;sudo&#34; around for Windows I&#39;ve never encountered it myself so I&#39;m guessing it&#39;s extremely unusual.

I agree that quoting the program paths in the stored hash is a fuller/better solution but there are many other program paths in the same hash, so arguably they should all be quoted if necessary too. I don&#39;t have the time or know enough about CPAN.pm to go down that road so I favour this simpler approach instead, which I believe will solve the vast majority of cases.

Please can we have a new release in the near future with this problem fixed? It has bugged me for ages!
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> install.patch</td>
  </tr>
</table>
<div class="downloadattachment">
<a href="/Ticket/Attachment/1261416/667868/install.patch">Download install.patch</a><br />
<span class="downloadcontenttype">text/x-diff 1.5k</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -ruN CPAN-2.02-TRIAL.orig/lib/CPAN/Distribution.pm CPAN-2.02-TRIAL/lib/CPAN/Distribution.pm
--- CPAN-2.02-TRIAL.orig/lib/CPAN/Distribution.pm	2013-06-23 07:18:08.000000000 +0100
+++ CPAN-2.02-TRIAL/lib/CPAN/Distribution.pm	2013-09-11 09:04:22.874356400 +0100
@@ -2554,6 +2554,21 @@
     }
 }
 
+sub _make_install_make_command {
+    my &#40;$self&#41; = @_;
+    my $mimc =
+        CPAN::HandleConfig-&gt;prefs_lookup&#40;$self, q{make_install_make_command}&#41;;
+    return $self-&gt;_make_command&#40;&#41; unless $mimc;
+
+    # Quote the &#34;make install&#34; make command on Windows, where it is commonly
+    # found in, e.g., C:\Program Files\... and therefore needs quoting. We can&#39;t
+    # do this in general because the command maybe &#34;sudo make...&#34; &#40;i.e. a
+    # program with arguments&#41;, but that is unlikely to be the case on Windows.
+    $mimc = CPAN::HandleConfig-&gt;safe_quote&#40;$mimc&#41; if $^O eq &#39;MSWin32&#39;;
+
+    return $mimc;
+}
+
 #-&gt; sub CPAN::Distribution::follow_prereqs ;
 sub follow_prereqs {
     my&#40;$self&#41; = shift;
@@ -3706,10 +3721,7 @@
                          &#41;;
         
     } else {
-        my&#40;$make_install_make_command&#41; =
-            CPAN::HandleConfig-&gt;prefs_lookup&#40;$self,
-                                             q{make_install_make_command}&#41;
-                  || $self-&gt;_make_command&#40;&#41;;
+        my&#40;$make_install_make_command&#41; = $self-&gt;_make_install_make_command&#40;&#41;;
         $system = sprintf&#40;&#34;%s install %s&#34;,
                           $make_install_make_command,
                           $CPAN::Config-&gt;{make_install_arg},
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1261419" href="/Public/Bug/Display.html?id=76831#txn-1261419">#</a>      
    </span>
    <span class="date">Wed&nbsp;Sep&nbsp;11&nbsp;04:20:55&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Fixed in 2.02-TRIAL added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1262644" href="/Public/Bug/Display.html?id=76831#txn-1262644">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;13&nbsp;18:31:14&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Broken in 2.02-TRIAL added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1262645" href="/Public/Bug/Display.html?id=76831#txn-1262645">#</a>      
    </span>
    <span class="date">Fri&nbsp;Sep&nbsp;13&nbsp;18:31:14&nbsp;2013</span>
    <span class="description">shay [...] cpan.org -  Fixed in 2.02-TRIAL deleted</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1263098" href="/Public/Bug/Display.html?id=76831#txn-1263098">#</a>      
    </span>
    <span class="date">Sun&nbsp;Sep&nbsp;15&nbsp;06:02:02&nbsp;2013</span>
    <span class="description">ANDK [...] cpan.org -  Status changed from &#39;open&#39; to &#39;patched&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1826631" href="/Public/Bug/Display.html?id=76831#txn-1826631">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;28&nbsp;17:26:30&nbsp;2018</span>
    <span class="description">ANDK [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="downloadattachment">
<a href="/Ticket/Attachment/1826631/982577/">Download &#40;untitled&#41;</a> / <a href="/Ticket/Attachment/WithHeaders/982577">with headers</a>
<br />
<span class="downloadcontenttype">text/plain 43b</span>
</div>
<div class="messagebody">
<div class="message-stanza plain-text-white-space">Thanks Reini, Steve. Resolving finally now.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1826634" href="/Public/Bug/Display.html?id=76831#txn-1826634">#</a>      
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;28&nbsp;17:26:31&nbsp;2018</span>
    <span class="description">ANDK [...] cpan.org -  Status changed from &#39;patched&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      <a name="txn-1826636" href="/Public/Bug/Display.html?id=76831#txn-1826636">#</a>      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Fri&nbsp;Dec&nbsp;28&nbsp;17:26:31&nbsp;2018</span>
    <span class="description">ANDK [...] cpan.org -  Fixed in 2.05 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
<p id="sponsors">
  This service is sponsored and maintained by
  <a href="http://bestpractical.com">Best Practical Solutions</a> and runs on
  <a href="http://noc.perl.org">Perl.org</a> infrastructure.
</p>

<p id="contact-info">
  Please report any issues with rt.cpan.org to <a href="mailto:rt-cpan-admin@bestpractical.com">rt-cpan-admin@bestpractical.com</a>.
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA\x2D937849\x2D12');
  ga('send', 'pageview');
</script>

<div id="footer">
  <p id="time"><span>Time to display: 0.554779</span></p>
  <p id="bpscredits"><span>&#187;&#124;&#171; RT 4.0.18 Copyright 1996-2013 <a href="http://www.bestpractical.com?rt=4.0.18">Best Practical Solutions, LLC</a>.
</span></p>
</div>
  </body>
</html>
