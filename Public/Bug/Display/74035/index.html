<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #74035 for Net-FTPSSL: &#34;Use of uninitialized value in uc&#34; on Perl 5.12.1</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #74035 for Net-FTPSSL: &#34;Use of uninitialized value in uc&#34; on Perl 5.12.1</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-FTPSSL/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-FTPSSL/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-FTPSSL/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-FTPSSL/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-FTPSSL">Net-FTPSSL CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">74035</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">resolved</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-FTPSSL/Active/">Net-FTPSSL</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
MENDEL [...] cpan.org

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
Normal    </td>
  </tr>
  <tr id="CF-22628-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
0.20    </td>
  </tr>
  <tr id="CF-22629-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
0.21    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;07:01:46&nbsp;2012</span>
    <span class="description">MENDEL [...] cpan.org -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> &#34;Use of uninitialized value in uc&#34; on Perl 5.12.1</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">It seems that the behaviour of uc&#40;&#41; for undefined values changed with
recent Perl versions, it produces a warning on 5.12.1:

mendel@server1:~$ perl -wE &#39;say $^V; my $x = uc undef;&#39;
v5.10.1
mendel@server1:~$

mendel@server2:~$ perl -wE &#39;say $^V; my $x = uc undef;&#39;
v5.12.1
Use of uninitialized value in uc at -e line 1.
mendel@server2:~$

Consequently the code in lines 1483, 1484 and 1796 produce a warning on
Perl 5.12.1. The attached patch fixes it &#40;and includes a test for it, too&#41;.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net-FTPSSL-0.20-uc_fix.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -Naur a/Net-FTPSSL-0.20/FTPSSL.pm b/Net-FTPSSL-0.20/FTPSSL.pm
--- a/Net-FTPSSL-0.20/FTPSSL.pm	2012-01-01 18:48:03.000000000 +0100
+++ b/Net-FTPSSL-0.20/FTPSSL.pm	2012-01-10 16:46:23.000000000 +0100
@@ -1480,8 +1480,11 @@
 # A true boolean func, should never call croak!
 sub supported {
    my $self = shift;
-   my $cmd = uc &#40;shift&#41;;  # uc&#40;&#41; converts undef to &#34;&#34;.
-   my $site_cmd = uc &#40;shift&#41;;
+   my $cmd = shift;
+   my $site_cmd = shift;
+
+   $cmd = uc &#40;$cmd&#41; if defined $cmd;
+   $site_cmd = uc &#40;$site_cmd&#41; if defined $site_cmd;
 
    my $result = 0;        # Assume invalid FTP command
 
@@ -1793,7 +1796,7 @@
 sub _help {
    # Only shift off self, bug otherwise!
    my $self = shift;
-   my $cmd = uc &#40;$_[0]&#41;;   # Will convert undef to &#34;&#34;. &#40;Do not do a shift!&#41;
+   my $cmd = defined $_[0] ? uc &#40;$_[0]&#41; : undef;   # Do not do a shift!
 
    # Check if requesting a list of all commands or details on specific command.
    my $all_cmds = &#40;! defined $_[0]&#41;;
diff -Naur a/Net-FTPSSL-0.20/t/10-complex.t b/Net-FTPSSL-0.20/t/10-complex.t
--- a/Net-FTPSSL-0.20/t/10-complex.t	2011-09-26 20:05:30.000000000 +0200
+++ b/Net-FTPSSL-0.20/t/10-complex.t	2012-01-16 12:55:47.000000000 +0100
@@ -14,12 +14,12 @@
 # Proper values are: debug0, debug1, debug2 &#38; debug3.  3 is the most verbose!
 # use IO::Socket::SSL qw&#40;debug3&#41;;
 
-use Test::More tests =&gt; 60;   # Also update skipper &#40;one less&#41;
+use Test::More tests =&gt; 61;   # Also update skipper &#40;one less&#41;
 use File::Copy;
 
-my $skipper = 59;
+my $skipper = 60;
 
-# plan tests =&gt; 59;  # Can&#39;t use due to BEGIN block
+# plan tests =&gt; 60;  # Can&#39;t use due to BEGIN block
 
 BEGIN { use_ok&#40;&#39;Net::FTPSSL&#39;&#41; }    # Test # 1
 
@@ -145,7 +145,14 @@
 
     isa_ok&#40; $ftp, &#39;Net::FTPSSL&#39;, &#39;Net::FTPSSL object creation&#39; &#41;;
 
-    ok&#40; $ftp-&gt;login &#40;$user, $pass&#41;, &#34;Login to $server&#34; &#41;;
+    {
+      my $warnings = &#34;&#34;;
+      local $SIG{__WARN__} = sub {
+        $warnings .= $_[0];
+      };
+      ok&#40; $ftp-&gt;login &#40;$user, $pass&#41;, &#34;Login to $server&#34; &#41;;
+      is&#40; $warnings, &#34;&#34;, &#34;Login produces no warnings&#34; &#41;;
+    }
 
     # Turning off croak now that our environment is correct!
     $ftp-&gt;set_croak &#40;0&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;07:33:56&nbsp;2012</span>
    <span class="description">MENDEL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Sorry, i just noticed that i attached the wrong patch &#40;it did not
completely solve the warnings problem&#41;. This new patch does.
</div></div>
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net-FTPSSL-0.20-uc_fix-2.diff</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">diff -Naur a/Net-FTPSSL-0.20/FTPSSL.pm b/Net-FTPSSL-0.20/FTPSSL.pm
--- a/Net-FTPSSL-0.20/FTPSSL.pm	2012-01-01 18:48:03.000000000 +0100
+++ b/Net-FTPSSL-0.20/FTPSSL.pm	2012-01-16 13:21:42.000000000 +0100
@@ -1480,8 +1480,11 @@
 # A true boolean func, should never call croak!
 sub supported {
    my $self = shift;
-   my $cmd = uc &#40;shift&#41;;  # uc&#40;&#41; converts undef to &#34;&#34;.
-   my $site_cmd = uc &#40;shift&#41;;
+   my $cmd = shift;
+   my $site_cmd = shift;
+
+   $cmd = defined $cmd ? uc &#40;$cmd&#41; : &#39;&#39;;
+   $site_cmd = defined $site_cmd ? uc &#40;$site_cmd&#41; : &#39;&#39;;
 
    my $result = 0;        # Assume invalid FTP command
 
@@ -1793,7 +1796,7 @@
 sub _help {
    # Only shift off self, bug otherwise!
    my $self = shift;
-   my $cmd = uc &#40;$_[0]&#41;;   # Will convert undef to &#34;&#34;. &#40;Do not do a shift!&#41;
+   my $cmd = defined $_[0] ? uc &#40;$_[0]&#41; : &#39;&#39;;   # Do not do a shift!
 
    # Check if requesting a list of all commands or details on specific command.
    my $all_cmds = &#40;! defined $_[0]&#41;;
diff -Naur a/Net-FTPSSL-0.20/t/10-complex.t b/Net-FTPSSL-0.20/t/10-complex.t
--- a/Net-FTPSSL-0.20/t/10-complex.t	2011-09-26 20:05:30.000000000 +0200
+++ b/Net-FTPSSL-0.20/t/10-complex.t	2012-01-16 13:27:28.000000000 +0100
@@ -14,12 +14,12 @@
 # Proper values are: debug0, debug1, debug2 &#38; debug3.  3 is the most verbose!
 # use IO::Socket::SSL qw&#40;debug3&#41;;
 
-use Test::More tests =&gt; 60;   # Also update skipper &#40;one less&#41;
+use Test::More tests =&gt; 61;   # Also update skipper &#40;one less&#41;
 use File::Copy;
 
-my $skipper = 59;
+my $skipper = 60;
 
-# plan tests =&gt; 59;  # Can&#39;t use due to BEGIN block
+# plan tests =&gt; 60;  # Can&#39;t use due to BEGIN block
 
 BEGIN { use_ok&#40;&#39;Net::FTPSSL&#39;&#41; }    # Test # 1
 
@@ -145,7 +145,14 @@
 
     isa_ok&#40; $ftp, &#39;Net::FTPSSL&#39;, &#39;Net::FTPSSL object creation&#39; &#41;;
 
-    ok&#40; $ftp-&gt;login &#40;$user, $pass&#41;, &#34;Login to $server&#34; &#41;;
+    {
+      my $warnings = &#34;&#34;;
+      local $SIG{__WARN__} = sub {
+        $warnings .= $_[0];
+      };
+      ok&#40; $ftp-&gt;login &#40;$user, $pass&#41;, &#34;Login to $server&#34; &#41;;
+      is&#40; $warnings, &#34;&#34;, &#34;Login produces no warnings&#34; &#41;;
+    }
 
     # Turning off croak now that our environment is correct!
     $ftp-&gt;set_croak &#40;0&#41;;
</div></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;17:26:23&nbsp;2012</span>
    <span class="description">CLEACH [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Norbert,

Thank you for letting me know about the change in behavior with uc&#40;&#41; in
Perl 5.12.  I was depending on that auto conversion from undefined to &#34;&#34;
to avoid some checks in a few places when I used uc&#40;&#41;.  Looks like I&#39;ll
have to explicitly check for this from now on.  :&#40;

The fix will be in the next release, but I&#39;m not sure when it will be
out yet.  If this is important to you, let me know and it will be sooner
rather than later.

Curtis

On Mon Jan 16 07:33:56 2012, MENDEL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Sorry, i just noticed that i attached the wrong patch &#40;it did not
&gt; completely solve the warnings problem&#41;. This new patch does.
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Jan&nbsp;16&nbsp;17:26:25&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Jan&nbsp;18&nbsp;03:41:03&nbsp;2012</span>
    <span class="description">MENDEL [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Curtis,

thanks for the prompt response! The release is not urgent for us &#40;we use
a packaged version of the module and we already patched it&#41;, knowing
that it will contain the fix is good enough &#40;so that we don&#39;t have to
patch it again&#41;.

norbi
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;20&nbsp;11:13:40&nbsp;2012</span>
    <span class="description">CLEACH [...] cpan.org -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi Norbert,

This is just an FYI that v0.21 has finally been released with your
requested fix in it. &#40;Among others&#41;  I just uploaded it, so it will
probably take a few hours to become available.

Curtis

On Wed Jan 18 03:41:03 2012, MENDEL wrote:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Hi Curtis,
&gt; 
&gt; thanks for the prompt response! The release is not urgent for us &#40;we use
&gt; a packaged version of the module and we already patched it&#41;, knowing
&gt; that it will contain the fix is good enough &#40;so that we don&#39;t have to
&gt; patch it again&#41;.
&gt; 
&gt; norbi
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;20&nbsp;20:06:59&nbsp;2012</span>
    <span class="description">CLEACH [...] cpan.org -  Status changed from &#39;open&#39; to &#39;resolved&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction other CustomField even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Mon&nbsp;Feb&nbsp;20&nbsp;20:06:59&nbsp;2012</span>
    <span class="description">CLEACH [...] cpan.org -  Fixed in 0.21 added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
