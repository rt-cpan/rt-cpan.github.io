<!DOCTYPE html>

<html lang="en">
  <head>
    <title>Bug #75745 for Net-SFTP-Foreign: Net::SFTP:Foreign, setcwd&#40;&#41; error</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- The X-UA-Compatible <meta> tag above must be very early in <head> -->

    <script>
if (window.top !== window.self) {
    document.write = "";

    window.top.location = window.self.location;

    setTimeout(function(){
        document.body.innerHTML = "";
    }, 1);

    window.self.onload = function(){
        document.body.innerHTML = "";
    };
}
</script>



<link rel="shortcut icon" href="/NoAuth/images/favicon.png" type="image/png" />
<link rel="stylesheet" href="/NoAuth/css/aileron-squished-00f758259152f8b6670ee485f462e6b8.css" type="text/css" media="all" />
<link rel="stylesheet" href="/NoAuth/css/print.css" type="text/css" media="print" />




<script type="text/javascript" src="/NoAuth/js/squished-42167f2409ce368da2d31038e5cb2a57.js"></script>

<script type="text/javascript"><!--
	jQuery( loadTitleBoxStates );

--></script>


<!--[if lt IE 8]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie.css" type="text/css" media="all" />
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" href="/NoAuth/css/aileron/msie6.css" type="text/css" media="all" />
<![endif]-->
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery.fn.supersubs.defaults = {
        maxWidth: 30,
        extraWidth: 2
    };

    jQuery("#app-nav.toplevel").addClass('sf-menu sf-js-enabled sf-shadow').supersubs().superfish({ speed: 'fast' });
    jQuery("#page-menu.toplevel").addClass('sf-menu sf-js-enabled').supersubs().superfish({ dropShadows: false, speed: 'fast' }).supposition();
});
</script>


<!-- Site CSS from theme editor -->
<style type="text/css" media="all" id="sitecss">
</style>

<meta name="google-site-verification" content="kD3-uEJK1AkTqaC-rckcSt_HPkAj674DPPuEN6i-y0g" />

</head>
  <body class="aileron sidebyside" id="comp-Public-Bug-Display">

<div id="logo">
<a href="/"><img
    src="/NoAuth/images/cpan.png"
    alt="CPAN"
    width="181"
    height="38" /></a>
    <span class="rtname">RT for rt.cpan.org</span>
</div>


<div id="quickbar">
  <div id="quick-personal">
    <span class="hide"><a href="#skipnav">Skip Menu</a> | </span>
</div>

</div>
<div id="header"><h1>Bug #75745 for Net-SFTP-Foreign: Net::SFTP:Foreign, setcwd&#40;&#41; error</h1></div>



<div id="page-navigation"><ul id="page-menu" class="toplevel">
 <li id="li-page-active_bugs"><a id="page-active_bugs" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Active/">Active bugs</a></li>
 <li id="li-page-resolved_bugs"><a id="page-resolved_bugs" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Resolved/">Resolved bugs</a></li>
 <li id="li-page-rejected_bugs"><a id="page-rejected_bugs" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Rejected/">Rejected bugs</a></li>
 <li id="li-page-report"><a id="page-report" class="menu-item " href="/Public/Dist/Net-SFTP-Foreign/Active/"></a></li>
</ul></div>
<div id="topactions">



</div>
<div id="body">


<a name="skipnav" id="skipnav" accesskey="8"></a>





<p>This queue is for tickets about the <a href="https://metacpan.org/release/Net-SFTP-Foreign">Net-SFTP-Foreign CPAN distribution</a>.</p>





<div class="">
  <div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DUmVwb3J0IGluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Report information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------UmVwb3J0IGluZm9ybWF0aW9u---0">


<table width="100%" class="ticket-summary">
<tr>
  <td valign="top" class="boxcontainer">
    <div class="ticket-info-basics">
  <div class="titlebox ticket-info-basics " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dbasics\x2D\x2D\x2D\x2DVGhlIEJhc2ljcw\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">The Basics</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-basics----VGhlIEJhc2ljcw__---0">


        <table>
  <tr class="id">
    <td class="label">Id:</td>
    <td class="value">75745</td>
  </tr>
  <tr class="status">
    <td class="label">Status:</td>
    <td class="value">rejected</td>
  </tr>
  <tr class="time worked">
    <td class="label">Worked:</td>
    <td class="value">2 hours (120 min)

</td>
  </tr>
  <tr class="priority">
    <td class="label">Priority:</td>
    <td class="value">0/
</td>
  </tr>
  <tr class="queue">
    <td class="label">Queue:</td>
    <td class="value"><a href="/Public/Dist/Net-SFTP-Foreign/Active/">Net-SFTP-Foreign</a>
</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>


    <div class="ticket-info-people">
  <div class="titlebox ticket-info-people " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dpeople\x2D\x2D\x2D\x2DUGVvcGxl\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">People</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-people----UGVvcGxl---0">


        <table>
  <tr>
    <td class="label">Owner:</td>
    <td class="value">Nobody in particular
    
    </td>
  </tr>
  <tr>
    <td class="labeltop">Requestors:</td>
    <td class="value">
josemalonsom [...] yahoo.es

<br />

</td>
  </tr>
  <tr>
    <td class="labeltop">Cc:</td>
    <td class="value">

</td>
  </tr>
  <tr>
    <td class="labeltop">AdminCc:</td>
    <td class="value">

</td>
  </tr>
</table>

        <hr class="clear" />
  </div>
</div>




</div>



  </td>
  <td valign="top" class="boxcontainer">
    
    <div class="ticket-info-cfs">
  <div class="titlebox ticket-info-cfs " id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2Dticket\x2Dinfo\x2Dcfs\x2D\x2D\x2D\x2DQnVnIEluZm9ybWF0aW9u\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">Bug Information</span>
    <span class="right-empty">		    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html--ticket-info-cfs----QnVnIEluZm9ybWF0aW9u---0">

 
        <table>
  <tr id="CF-1-ShowRow">
    <td class="label">Severity:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23164-ShowRow">
    <td class="label">Broken in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
  <tr id="CF-23165-ShowRow">
    <td class="label">Fixed in:</td>
    <td class="value">
<i>(no value)</i>
    </td>
  </tr>
</table>


        <hr class="clear" />
  </div>
</div>




</div>


    
</div>




</div>







  </td>
</tr>
</table>

    <hr class="clear" />
  </div>
</div>




</div>


<br />


<div class="history">
<div class="titlebox" id="">
  <div class="titlebox-title">
    <span class="widget"><a href="#" onclick="return rollup('TitleBox\x2D\x2D\x5FPublic\x5FBug\x5FDisplay\x5Fhtml\x2D\x2D\x2D\x2D\x2D\x2DSGlzdG9yeQ\x5F\x5F\x2D\x2D\x2D0');" title="Toggle visibility"></a></span>
    <span class="left">History</span>
    <span class="right">		<a href="#" data-direction="open" onclick="return toggle_all_folds(this, 'Show\x20all\x20quoted\x20text', 'Hide\x20all\x20quoted\x20text');">Show all quoted text</a>    </span>
  </div>
  <div class="titlebox-content " id="TitleBox--_Public_Bug_Display_html------SGlzdG9yeQ__---0">


<div id="ticket-history">
<div class="ticket-transaction message Create odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;13&nbsp;15:03:20&nbsp;2012</span>
    <span class="description">josemalonsom [...] yahoo.es -  Ticket created</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Mar 2012 20:03:03 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jose Mar√≠a &lt;josemalonsom [...] yahoo.es&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">Hi,

i want to report a problem with Net::SFTP:Foreign that causes an error
&#34;Couldn&#39;t stat remote file &#40;stat&#41;: File not found!&#34; when a setcwd&#40;&#41;
command is executed.

The problem has appeared in a single server. Once the connection has
opened the working directory is /, and there is a directory named INPUT,
when setcwd&#40;&#39;INPUT&#39;&#41; is executed the error is thrown. If instead the
command setcwd&#40;&#39;/INPUT&#39;&#41; is executed no error is thrown. As i said the
current directory is /, so that should not be necessary to give the
absolute path, it works perfectly on other sftp servers.

I have temporarily solved the problem with a small patch in my script
concatenating the current path with the directory name. I think it&#39;s a
server problem &#40;the server belongs to a client and my only access is via
sftp, is a J2SSH server&#41;, but perhaps there can be a solution from the
module.


Attached the following files:
- script_error.pl: the script that thrown the error.
- debug_with_error: the debug output of the error.
- script_with_patch.pl: script with my patch.
- debug_without_error: the debug output of the script with patch.

The version of Net::SFTP::Foreign is 1.69.
The version of perl is 5.8.8.
And the uname -a output is:
Linux myhostname 2.6.18-92.el5 #1 SMP Tue Apr 29 13:16:15 EDT 2008
x86_64 x86_64 x86_64 GNU/Linux


Thank you very much.

&#40;Sorry for my bad English&#41;.
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;13&nbsp;18:20:44&nbsp;2012</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error </td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 13 Mar 2012 15:20:28 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message -----
<div class="message-stanza open">&gt; From: Jose Mar√≠a via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; To: 
&gt; Cc: 
&gt; Sent: Tuesday, March 13, 2012 8:03 PM
&gt; Subject: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error 
&gt; 
&gt;T ue Mar 13 15:03:20 2012: Request 75745 was acted upon.
&gt; Transaction: Ticket created by josemalonsom@yahoo.es
&gt; ¬† ¬† ¬†  Queue: Net-SFTP-Foreign
&gt; ¬† ¬†  Subject: Net::SFTP:Foreign, setcwd&#40;&#41; error
&gt; ¬†  Broken in: &#40;no value&#41;
&gt; ¬† ¬† Severity: &#40;no value&#41;
&gt; ¬† ¬† ¬†  Owner: Nobody
&gt; ¬† Requestors: josemalonsom@yahoo.es
&gt; ¬† ¬† ¬† Status: new
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; 
&gt; 
&gt; Hi,
</div>
Hola,

<div class="message-stanza open">&gt; i want to report a problem with Net::SFTP:Foreign that causes an error
&gt; &#34;Couldn&#39;t stat remote file &#40;stat&#41;: File not found!&#34; when a 
&gt; setcwd&#40;&#41;
&gt; command is executed.
&gt; 
&gt; The problem has appeared in a single server. Once the connection has
&gt; opened the working directory is /,
</div>
Normalmente esto no es as√≠. Cuando se inicia una nueva sesi√≥n de SFTP, el cwd es &#39;.&#39;, un path relativo que el servidor convierte en absoluto de una manera no especificada. Por ejemplo, con OpenSSH, &#39;.&#39; se convierte en &#39;~/&#39; &#40;el home del usuario&#41; y otros servidores pueden hacer cosas distintas.

La forma m√°s f√°cil que se me ocurre de solucionar tu problema es hacer una llamada a $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; nada m√°s crear el objeto $sftp. As√≠, cuando despues llames a $sftp-&gt;setcwd&#40;&#39;INPUT&#39;&#41; el modulo ya se encargara de resolver &#39;INPUT&#39; como &#39;/INPUT&#39;
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;13&nbsp;18:20:46&nbsp;2012</span>
    <span class="description">The RT System itself -  Status changed from &#39;new&#39; to &#39;open&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Thu&nbsp;Mar&nbsp;15&nbsp;14:19:52&nbsp;2012</span>
    <span class="description">josemalonsom [...] yahoo.es -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Thu, 15 Mar 2012 19:19:39 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jose Mar√≠a &lt;josemalonsom [...] yahoo.es&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">
Hola,

muchas gracias por la pronta respuesta :&#41;.

El problema es que Net::SFTP::Foreign::realpath&#40;&#39;INPUT&#39;&#41; retorna INPUT,
pero este directorio se encuentra en la ra√≠z &#40;me refiero a lo que est√©
configurado como ra√≠z en el servidor sftp para el usuario de conexi√≥n,
no a la del sistema operativo&#41; por lo que entiendo que deber√≠a
retornar /INPUT, de hecho en otros servidores es lo que hace. Cuando se
ejecuta el setcwd&#40;&#39;INPUT&#39;&#41; dentro del m√≥dulo hace un
$sftp-&gt;realpath&#40;$cwd&#41;, el cual retorna INPUT y falla el stat&#40;&#41;
posterior, lo curioso es que Net::SFTP::Foreign::cwd&#40;&#41; retorna &#39;/&#39;, o
sea, que s√≠ que existe informaci√≥n como para obtener el path absoluto.

No s√© si el problema es realmente del m√≥dulo, cuando al servidor se le
pide que realice el SSH_FXP_REALPATH √©ste deber√≠a retornar el path
absoluto correctamente, cosa que parece que no hace en este caso. Sin
embargo utilizando directamente el comando sftp desde la shell funciona
sin problema, te pego un debug del cambio de directorio:

debug1: Sending subsystem: sftp
debug2: channel 0: request subsystem confirm 1
debug2: callback done
debug2: channel 0: open confirm rwindow 1024000 rmax 65535
debug2: Remote version: 3
debug3: Sent message fd 3 T:16 I:1
debug3: SSH_FXP_REALPATH . -&gt; /
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sftp&gt; cd INPUT
</div>debug3: Sent message fd 3 T:16 I:2
debug3: SSH_FXP_REALPATH /INPUT -&gt; /INPUT
debug3: Sent message fd 3 T:17 I:3
debug3: Received stat reply T:105 I:3
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sftp&gt;
</div>
como se puede ver en este caso s√≠ que retorna correctamente el nombre
absoluto del directorio.

Hablo un poco desde la ignorancia, pero si con el comando sftp
SSH_FXP_REALPATH est√° retornando el nombre absoluto correctamente, ¬øno
deber√≠a hacerlo tambi√©n para el m√≥dulo?


El utilizar directamente $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; en mi caso no es una opci√≥n,
el script realiza env√≠os a una larga lista de diferentes servidores ftp
utilizando un archivo de configuraci√≥n, en el que el directorio destino
puede estar expresado como path relativo o absoluto y en el que el
directorio de trabajo actual una vez abierta la conexi√≥n no se conoce de
antemano.

Yo he solucionado el problema a√±adiendo el siguiente parche antes de
realizar cualquier setcwd&#40;&#41; &#40;suponiendo que $dir tenga el directorio
destino&#41;:

    if &#40;$dir !~ /^\//&#41; {
      $dir = File::Spec-&gt;canonpath&#40;$sftp-&gt;cwd&#40;&#41; . &#39;/&#39; . $dir&#41;;
    }

y con eso, por lo menos para todos los servidores a los que env√≠o,
funciona en todos los casos, independientemente del directorio de
trabajo actual en el que se quede la sesi√≥n una vez abierta y de si el
directorio destino tiene configurado el nombre como absoluto o relativo.



El mar, 13-03-2012 a las 18:20 -0400, Salvador \&#34;Fandi√±o\&#34; via RT
escribi√≥:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; ----- Original Message -----
<div class="message-stanza open">&gt; &gt; From: Jose Mar√≠a via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; &gt; To: 
&gt; &gt; Cc: 
&gt; &gt; Sent: Tuesday, March 13, 2012 8:03 PM
&gt; &gt; Subject: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error 
&gt; &gt; 
&gt; &gt;T ue Mar 13 15:03:20 2012: Request 75745 was acted upon.
&gt; &gt; Transaction: Ticket created by josemalonsom@yahoo.es
&gt; &gt;        Queue: Net-SFTP-Foreign
&gt; &gt;      Subject: Net::SFTP:Foreign, setcwd&#40;&#41; error
&gt; &gt;    Broken in: &#40;no value&#41;
&gt; &gt;     Severity: &#40;no value&#41;
&gt; &gt;        Owner: Nobody
&gt; &gt;   Requestors: josemalonsom@yahoo.es
&gt; &gt;       Status: new
&gt; &gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; &gt; 
&gt; &gt; 
&gt; &gt; Hi,
</div>&gt; 
&gt; Hola,
&gt; 
<div class="message-stanza open">&gt; &gt; i want to report a problem with Net::SFTP:Foreign that causes an error
&gt; &gt; &#34;Couldn&#39;t stat remote file &#40;stat&#41;: File not found!&#34; when a 
&gt; &gt; setcwd&#40;&#41;
&gt; &gt; command is executed.
&gt; &gt; 
&gt; &gt; The problem has appeared in a single server. Once the connection has
&gt; &gt; opened the working directory is /,
</div>&gt; 
&gt; Normalmente esto no es as√≠. Cuando se inicia una nueva sesi√≥n de SFTP, el cwd es &#39;.&#39;, un path relativo que el servidor convierte en absoluto de una manera no especificada. Por ejemplo, con OpenSSH, &#39;.&#39; se convierte en &#39;~/&#39; &#40;el home del usuario&#41; y otros servidores pueden hacer cosas distintas.
&gt; 
&gt; La forma m√°s f√°cil que se me ocurre de solucionar tu problema es hacer una llamada a $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; nada m√°s crear el objeto $sftp. As√≠, cuando despues llames a $sftp-&gt;setcwd&#40;&#39;INPUT&#39;&#41; el modulo ya se encargara de resolver &#39;INPUT&#39; como &#39;/INPUT&#39;
&gt; 
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Fri&nbsp;Mar&nbsp;16&nbsp;12:21:23&nbsp;2012</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Fri, 16 Mar 2012 09:21:14 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;________________________________
&gt; From: Jose Mar√≠a via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt;To: 
&gt;Sent: Thursday, March 15, 2012 7:19 PM
&gt;Subject: Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error
&gt; 
&gt;¬† ¬† ¬†¬†¬†Queue: Net-SFTP-Foreign
&gt;Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt;
&gt;
&gt;Hola,
&gt;
&gt;muchas gracias por la pronta respuesta :&#41;.
&gt;
&gt;El problema es que Net::SFTP::Foreign::realpath&#40;&#39;INPUT&#39;&#41; retorna INPUT,
&gt;pero este directorio se encuentra en la ra√≠z &#40;me refiero a lo que est√©
&gt;configurado como ra√≠z en el servidor sftp para el usuario de conexi√≥n,
&gt;no a la del sistema operativo&#41; por lo que entiendo que deber√≠a
&gt;retornar /INPUT, de hecho en otros servidores es lo que hace. Cuando se
&gt;ejecuta el setcwd&#40;&#39;INPUT&#39;&#41; dentro del m√≥dulo hace un
&gt;$sftp-&gt;realpath&#40;$cwd&#41;, el cual retorna INPUT y falla el stat&#40;&#41;
&gt;posterior, lo curioso es que Net::SFTP::Foreign::cwd&#40;&#41; retorna &#39;/&#39;, o
&gt;sea, que s√≠ que existe informaci√≥n como para obtener el path absoluto.
&gt;
&gt;No s√© si el problema es realmente del m√≥dulo, cuando al servidor se le
&gt;pide que realice el SSH_FXP_REALPATH √©ste deber√≠a retornar el path
&gt;absoluto correctamente, cosa que parece que no hace en este caso. Sin
&gt;embargo utilizando directamente el comando sftp desde la shell funciona
&gt;sin problema, te pego un debug del cambio de directorio:
&gt;
&gt;debug1: Sending subsystem: sftp
&gt;debug2: channel 0: request subsystem confirm 1
&gt;debug2: callback done
&gt;debug2: channel 0: open confirm rwindow 1024000 rmax 65535
&gt;debug2: Remote version: 3
&gt;debug3: Sent message fd 3 T:16 I:1
&gt;debug3: SSH_FXP_REALPATH . -&gt; /
<div class="message-stanza open">&gt;sftp&gt; cd INPUT
</div>&gt;debug3: Sent message fd 3 T:16 I:2
&gt;debug3: SSH_FXP_REALPATH /INPUT -&gt; /INPUT
</div>
Aqui tu cliente de SFTP no esta resolviendo &#34;INPUT&#34;, sino &#34;/INPUT&#34;


Si quieres que el modulo haga lo mismo, llama a $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; primero.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;17&nbsp;04:48:12&nbsp;2012</span>
    <span class="description">josemalonsom [...] yahoo.es -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 17 Mar 2012 09:48:02 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jose Mar√≠a &lt;josemalonsom [...] yahoo.es&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">El vie, 16-03-2012 a las 12:21 -0400, Salvador \&#34;Fandi√±o\&#34; via RT
escribi√≥:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt;debug1: Sending subsystem: sftp
&gt; &gt;debug2: channel 0: request subsystem confirm 1
&gt; &gt;debug2: callback done
&gt; &gt;debug2: channel 0: open confirm rwindow 1024000 rmax 65535
&gt; &gt;debug2: Remote version: 3
&gt; &gt;debug3: Sent message fd 3 T:16 I:1
&gt; &gt;debug3: SSH_FXP_REALPATH . -&gt; /
<div class="message-stanza open">&gt; &gt;sftp&gt; cd INPUT
</div>&gt; &gt;debug3: Sent message fd 3 T:16 I:2
&gt; &gt;debug3: SSH_FXP_REALPATH /INPUT -&gt; /INPUT
</div>&gt; 
&gt; Aqui tu cliente de SFTP no esta resolviendo &#34;INPUT&#34;, sino &#34;/INPUT&#34;
&gt; 
&gt; 
&gt; Si quieres que el modulo haga lo mismo, llama a $sftp-&gt;setcwd&#40;&#39;/&#39;&#41;
&gt; primero. 
</div>
Quiz√° no me haya explicado bien: hacer $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; no funciona de
modo general, pongamos el siguiente ejemplo:

~$ sftp user1@myhost
Connecting to myhost...
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sftp&gt; pwd
</div>Remote working directory: /home/user1
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sftp&gt; cd INPUT
sftp&gt; pwd
</div>Remote working directory: /home/user1/INPUT
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">sftp&gt; 
</div>
en este caso si hiciera $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; simplemente fallar√≠a cuando
despu√©s hiciera $sftp-&gt;setcwd&#40;&#39;INPUT&#39;&#41; porque &#39;/INPUT&#39; no existe,
deber√≠a valer con √∫nicamente hacer $sftp-&gt;setcwd&#40;&#39;INPUT&#39;&#41; desde el
principio, que es como funciona en el resto de servidores.

Si otros clientes de sftp resuelven bien el nombre del directorio, ¬øpor
qu√© raz√≥n no lo hace el m√≥dulo?.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Sat&nbsp;Mar&nbsp;17&nbsp;07:49:13&nbsp;2012</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Sat, 17 Mar 2012 04:49:04 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message -----
<div class="message-stanza open">&gt; From: Jose Mar√≠a via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; To: 
&gt; Cc: 
&gt; Sent: Saturday, March 17, 2012 9:48 AM
&gt; Subject: Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error
&gt; 
&gt; ¬† ¬† ¬†  Queue: Net-SFTP-Foreign
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; 
&gt; El vie, 16-03-2012 a las 12:21 -0400, Salvador \&#34;Fandi√±o\&#34; via 
&gt; RT
&gt; escribi√≥:
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt;  &gt;debug1: Sending subsystem: sftp
&gt;&gt;  &gt;debug2: channel 0: request subsystem confirm 1
&gt;&gt;  &gt;debug2: callback done
&gt;&gt;  &gt;debug2: channel 0: open confirm rwindow 1024000 rmax 65535
&gt;&gt;  &gt;debug2: Remote version: 3
&gt;&gt;  &gt;debug3: Sent message fd 3 T:16 I:1
&gt;&gt;  &gt;debug3: SSH_FXP_REALPATH . -&gt; /
<div class="message-stanza open">&gt;&gt;  &gt;sftp&gt; cd INPUT
</div>&gt;&gt;  &gt;debug3: Sent message fd 3 T:16 I:2
&gt;&gt;  &gt;debug3: SSH_FXP_REALPATH /INPUT -&gt; /INPUT
</div>&gt;&gt; 
&gt;&gt;  Aqui tu cliente de SFTP no esta resolviendo &#34;INPUT&#34;, sino 
</div>&gt; &#34;/INPUT&#34;
<div class="message-stanza open">&gt;&gt; 
&gt;&gt; 
&gt;&gt;  Si quieres que el modulo haga lo mismo, llama a 
</div>&gt; $sftp-&gt;setcwd&#40;&#39;/&#39;&#41;
<div class="message-stanza open">&gt;&gt;  primero. 
</div>&gt; 
&gt; Quiz√° no me haya explicado bien: hacer $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; no funciona 
&gt; de
&gt; modo general, pongamos el siguiente ejemplo:
&gt; 
&gt; ~$ sftp user1@myhost
&gt; Connecting to myhost...
<div class="message-stanza open">&gt; sftp&gt; pwd
</div>&gt; Remote working directory: /home/user1
<div class="message-stanza open">&gt; sftp&gt; cd INPUT
&gt; sftp&gt; pwd
</div>&gt; Remote working directory: /home/user1/INPUT
<div class="message-stanza open">&gt; sftp&gt; 
</div>&gt;
&gt; en este caso si hiciera $sftp-&gt;setcwd&#40;&#39;/&#39;&#41; simplemente fallar√≠a 
&gt; cuando
&gt; despu√©s hiciera $sftp-&gt;setcwd&#40;&#39;INPUT&#39;&#41; porque &#39;/INPUT&#39; no 
&gt; existe,
&gt; deber√≠a valer con √∫nicamente hacer $sftp-&gt;setcwd&#40;&#39;INPUT&#39;&#41; desde el
&gt; principio, que es como funciona en el resto de servidores.
&gt; 
&gt; Si otros clientes de sftp resuelven bien el nombre del directorio, ¬øpor
&gt; qu√© raz√≥n no lo hace el m√≥dulo?.
</div>
Pues no lo se.

Puedes mostrarme la salida del programa sftp y del modulo, corriendo ambos en modo debug cuando accedes a uno de esos servidores en los que se comportan de manera distinta?
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;20&nbsp;14:11:27&nbsp;2012</span>
    <span class="description">josemalonsom [...] yahoo.es -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 20 Mar 2012 19:11:13 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jose Mar√≠a &lt;josemalonsom [...] yahoo.es&gt;</td>
  </tr>
</table>
<div class="messageattachments">

<div class="messagebody">
<div class="message-stanza plain-text-white-space">El s√°b, 17-03-2012 a las 07:49 -0400, Salvador \&#34;Fandi√±o\&#34; via RT
escribi√≥:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; 
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed"><div class="message-stanza open">&gt; &gt; Si otros clientes de sftp resuelven bien el nombre del directorio, ¬øpor
&gt; &gt; qu√© raz√≥n no lo hace el m√≥dulo?.
</div>&gt; 
&gt; Pues no lo se.
&gt; 
&gt; Puedes mostrarme la salida del programa sftp y del modulo, corriendo ambos en modo debug cuando accedes a uno de esos servidores en los que se comportan de manera distinta?
&gt; 
</div>
S√≠, sin problema, te adjunto dos archivos:

- salida.net_sftp_foreign.debug: contiene la salida de
Net::SFTP::Foreign con $Net::SFTP::Foreign::debug = -1

- salida.comando_sftp.vvv: contiene la salida del comando sftp con -vvv

si necesitas alguna otra salida d√≠melo.
</div></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>

<div class="messagebody">
<p>Message body is not shown because sender requested not to inline it.</p></div>
</div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Tue&nbsp;Mar&nbsp;20&nbsp;18:26:37&nbsp;2012</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Tue, 20 Mar 2012 15:26:28 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">




<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt;________________________________
&gt; From: Jose Mar√≠a via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt;To: 
&gt;Sent: Tuesday, March 20, 2012 7:11 PM
&gt;Subject: Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error
&gt; 
&gt;¬† ¬† ¬†¬†¬†Queue: Net-SFTP-Foreign
&gt;Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt;
&gt;El s√°b, 17-03-2012 a las 07:49 -0400, Salvador \&#34;Fandi√±o\&#34; via RT
&gt;escribi√≥:
<div class="message-stanza open">&gt;&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt;&gt; 
</div>&gt;
<div class="message-stanza open"><div class="message-stanza open">&gt;&gt; &gt; Si otros clientes de sftp resuelven bien el nombre del directorio, ¬øpor
&gt;&gt; &gt; qu√© raz√≥n no lo hace el m√≥dulo?.
</div>&gt;&gt; 
&gt;&gt; Pues no lo se.
&gt;&gt; 
&gt;&gt; Puedes mostrarme la salida del programa sftp y del modulo, corriendo ambos en modo debug cuando accedes a uno de esos servidores en los que se comportan de manera distinta?
&gt;&gt; 
</div>&gt;
&gt;S√≠, sin problema, te adjunto dos archivos:
&gt;
&gt;- salida.net_sftp_foreign.debug: contiene la salida de
&gt;Net::SFTP::Foreign con $Net::SFTP::Foreign::debug = -1
&gt;
&gt;- salida.comando_sftp.vvv: contiene la salida del comando sftp con -vvv
</div>

Lo que muestran ambas salidas es que el servidor no resuelve los directorios de manera coherente.

El cliente de sftp invoca el comando REALPATH pasandole &#39;.&#39; como argumento y de vuelta obtiene &#39;/&#39;. Luego abre &#39;/INPUT&#39;, resultado de unir &#39;/&#39; e &#39;INPUT&#39; y todo funciona correctamente.

El modulo Net::SFTP::Foreign simplemente abre &#39;INPUT&#39; lo cual deber√≠a de producir el mismo resultado, al resolverse en el servidor como &#39;/INPUT&#39;, pero no es as√≠.


La forma m√°s sencilla de solucionar esto es haciendo  la siguiente llamada al principio de tu script:

¬† $sftp-&gt;setcwd&#40;&#39;.&#39;&#41;;

Eso hara que el modulo se comporte como el binario sftp.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;21&nbsp;13:30:36&nbsp;2012</span>
    <span class="description">josemalonsom [...] yahoo.es -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 21 Mar 2012 18:30:24 +0100</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> bug-Net-SFTP-Foreign [...] rt.cpan.org</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Jose Mar√≠a &lt;josemalonsom [...] yahoo.es&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">El mar, 20-03-2012 a las 18:26 -0400, Salvador \&#34;Fandi√±o\&#34; via RT
escribi√≥:
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; 
</div>
<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">&gt; Lo que muestran ambas salidas es que el servidor no resuelve los directorios de manera coherente.
&gt; 
&gt; El cliente de sftp invoca el comando REALPATH pasandole &#39;.&#39; como argumento y de vuelta obtiene &#39;/&#39;. Luego abre &#39;/INPUT&#39;, resultado de unir &#39;/&#39; e &#39;INPUT&#39; y todo funciona correctamente.
&gt; 
&gt; El modulo Net::SFTP::Foreign simplemente abre &#39;INPUT&#39; lo cual deber√≠a de producir el mismo resultado, al resolverse en el servidor como &#39;/INPUT&#39;, pero no es as√≠.
&gt; 
&gt; 
&gt; La forma m√°s sencilla de solucionar esto es haciendo  la siguiente llamada al principio de tu script:
&gt; 
&gt;   $sftp-&gt;setcwd&#40;&#39;.&#39;&#41;;
&gt; 
&gt; Eso hara que el modulo se comporte como el binario sftp.
&gt; 
</div>
S√≠, tienes raz√≥n, ejecutando $sftp-&gt;setcwd&#40;&#39;.&#39;&#41; al principio funciona en
todos los casos. Entiendo entonces que al final es un problema del
servidor y se puede dar esto por solucionado; no s√© si en la lista de
deseos se podr√≠a a√±adir que el m√≥dulo hiciera por defecto el setcwd&#40;&#39;.&#39;&#41;
una vez abierta la conexi√≥n :&#41;.

Otra cosa, creo que no merece la pena abrir otro bug por esto: con la
versi√≥n 1.71 se produce un warning por una variable no inicializada al
realizar una conexi√≥n utilizando password:

Use of uninitialized value in length at 
/usr/lib/perl5/site_perl/5.8.8/Net/SFTP/Foreign/Backend/Unix.pm line
282.

no te pongo c√≥digo de ejemplo porque es muy f√°cil de reproducir, basta
con realizar una conexi√≥n en la que la autenticaci√≥n se realice por
password.


Un saludo y gracias; el m√≥dulo es muy √∫til.
</div></div>
    </div>
</div>
</div>
<div class="ticket-transaction message Correspond odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;Mar&nbsp;21&nbsp;14:12:06&nbsp;2012</span>
    <span class="description">sfandino [...] yahoo.com -  Correspondence added</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
      
<table>
  <tr>
    <td align="right" class="message-header-key">Subject:</td>
    <td class="message-header-value"> Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">Date:</td>
    <td class="message-header-value"> Wed, 21 Mar 2012 11:11:57 -0700 &#40;PDT&#41;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">To:</td>
    <td class="message-header-value"> &#34;bug-Net-SFTP-Foreign [...] rt.cpan.org&#34; &lt;bug-Net-SFTP-Foreign [...] rt.cpan.org&gt;</td>
  </tr>
  <tr>
    <td align="right" class="message-header-key">From:</td>
    <td class="message-header-value"> Salvador Fandino &lt;sfandino [...] yahoo.com&gt;</td>
  </tr>
</table>

<div class="messagebody">
<div class="message-stanza plain-text-white-space">



<span
    class="message-stanza-folder closed"
    onclick="fold_message_stanza(this, 'Show\x20quoted\x20text', 'Hide\x20quoted\x20text');">Show quoted text</span><br /><div class="message-stanza closed">----- Original Message -----
<div class="message-stanza open">&gt; From: Jose Mar√≠a via RT &lt;bug-Net-SFTP-Foreign@rt.cpan.org&gt;
&gt; To: 
&gt; Cc: 
&gt; Sent: Wednesday, March 21, 2012 6:30 PM
&gt; Subject: Re: [rt.cpan.org #75745] Net::SFTP:Foreign, setcwd&#40;&#41; error
&gt; 
&gt; ¬† ¬† ¬†  Queue: Net-SFTP-Foreign
&gt; Ticket &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt; 
&gt; El mar, 20-03-2012 a las 18:26 -0400, Salvador \&#34;Fandi√±o\&#34; via 
&gt; RT
&gt; escribi√≥:
<div class="message-stanza open">&gt;&gt;  &lt;URL: <span class="clickylink"><a target="new" rel="nofollow" href="https://rt.cpan.org/Ticket/Display.html?id=75745">https://rt.cpan.org/Ticket/Display.html?id=75745</a></span> &gt;
&gt;&gt; 
</div>&gt; 
<div class="message-stanza open">&gt;&gt;  Lo que muestran ambas salidas es que el servidor no resuelve los 
</div>&gt; directorios de manera coherente.
<div class="message-stanza open">&gt;&gt; 
&gt;&gt;  El cliente de sftp invoca el comando REALPATH pasandole &#39;.&#39; como 
</div>&gt; argumento y de vuelta obtiene &#39;/&#39;. Luego abre &#39;/INPUT&#39;, 
&gt; resultado de unir &#39;/&#39; e &#39;INPUT&#39; y todo funciona correctamente.
<div class="message-stanza open">&gt;&gt; 
&gt;&gt;  El modulo Net::SFTP::Foreign simplemente abre &#39;INPUT&#39; lo cual 
</div>&gt; deber√≠a de producir el mismo resultado, al resolverse en el servidor como 
&gt; &#39;/INPUT&#39;, pero no es as√≠.
<div class="message-stanza open">&gt;&gt; 
&gt;&gt; 
&gt;&gt;  La forma m√°s sencilla de solucionar esto es haciendo¬† la siguiente llamada 
</div>&gt; al principio de tu script:
<div class="message-stanza open">&gt;&gt; 
&gt;&gt; ¬†  $sftp-&gt;setcwd&#40;&#39;.&#39;&#41;;
&gt;&gt; 
&gt;&gt;  Eso hara que el modulo se comporte como el binario sftp.
&gt;&gt; 
</div>&gt; 
&gt; S√≠, tienes raz√≥n, ejecutando $sftp-&gt;setcwd&#40;&#39;.&#39;&#41; al principio funciona 
&gt; en
&gt; todos los casos. Entiendo entonces que al final es un problema del
&gt; servidor y se puede dar esto por solucionado; no s√© si en la lista de
&gt; deseos se podr√≠a a√±adir que el m√≥dulo hiciera por defecto el setcwd&#40;&#39;.&#39;&#41;
&gt; una vez abierta la conexi√≥n :&#41;.
</div>
No puede ser, porque alguien podr√≠a querer el comportamiento de ahora.

El modulo tiene ya muchos a√±os y esta es la primera vez que alguien reporta un bug como ese.

<div class="message-stanza open">&gt; Otra cosa, creo que no merece la pena abrir otro bug por esto: con la
&gt; versi√≥n 1.71 se produce un warning por una variable no inicializada al
&gt; realizar una conexi√≥n utilizando password:
&gt;
&gt; Use of uninitialized value in length at 
&gt; /usr/lib/perl5/site_perl/5.8.8/Net/SFTP/Foreign/Backend/Unix.pm line
&gt; 282.
</div>
si, ese problema ya esta solucionado en la version 1.72_01
</div></div></div>
    </div>
</div>
</div>
<div class="ticket-transaction basics Set even">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      
    </span>
    <span class="date">Wed&nbsp;May&nbsp;02&nbsp;11:03:16&nbsp;2012</span>
    <span class="description">salva [...] cpan.org -  TimeWorked changed from &#40;no value&#41; to &#39;120&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
<div class="ticket-transaction basics Status odd">
<div class="ticket-transaction">
  <div class="metadata">
    <span class="type">
      &nbsp;      <a id="lasttrans" name="lasttrans"></a>
    </span>
    <span class="date">Wed&nbsp;May&nbsp;02&nbsp;11:03:16&nbsp;2012</span>
    <span class="description">salva [...] cpan.org -  Status changed from &#39;open&#39; to &#39;rejected&#39;</span>
    <span class="time-taken"></span>    <span class="actions hidden"></span>
  </div>
    <div class="content">
    </div>
</div>
</div>
</div>
    <hr class="clear" />
  </div>
</div>




</div>
 


  <hr class="clear" />
</div>
</body>
</html>
